import{j as e,_ as vt,r as Pt,k as Mt,u as Qe,c as Re,b as We,a5 as St,B as Be,G as o,T as xe,D as ue,S as et,a6 as jt,a7 as Ye,a8 as Xe,a9 as Je,aa as tt,ab as ot,ac as kt,ad as at,C as ve,d as Ce,ae as Ze,e as Ee,af as Ot,ag as Nt,ah as At,ai as Lt,aj as wt,ak as Tt,al as Bt,am as Ft,an as Qt,M as Rt,ao as Wt,ap as zt}from"./index-DXk1I2ah.js";import{r as a}from"./vendor-BXCbSo2_.js";import{B as he,a as Pe,I as Fe}from"./axios-DrhUYzHU.js";import{d as mt,c as De,A as ht,e as gt,f as bt,S as Ut,a as Ht,b as qt,F as Et}from"./Fabrication-CHuEJ5g6.js";import{d as Ge}from"./VisibilityOutlined-BbWOEgfP.js";import{A as Ve,R as Ue,F as It,C as ft,D as Ke,a as rt,b as $e,c as nt,B as st,e as Gt,f as qe,g as ct,h as Yt}from"./ReuseableDataGrid-B6Lh6qhR.js";import{d as lt,a as it}from"./PersonAddAlt1Outlined-B8AjaYv1.js";import{T as d,P as Xt}from"./TextField-BFajs3IE.js";import{M as F}from"./Skeleton-DN2QxhyP.js";import"./dayjs.min-DO4_1a-m.js";let ut=!1;const _t=a.forwardRef(function(S,$){return ut||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),ut=!0),e.jsx(Ve,vt({ref:$},S))});var dt={},Vt=Mt;Object.defineProperty(dt,"__esModule",{value:!0});var xt=dt.default=void 0,Dt=Vt(Pt()),Jt=e;xt=dt.default=(0,Dt.default)((0,Jt.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const Zt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",Kt=({initialFormData:h,setAdditionalProcessData:S,refetchDyeingPrintingData:$,handleClickOpen:re,showUpperDiv:v})=>{const{user:t}=Qe(),[y,s]=a.useState([]),[g,n]=a.useState([]),{enqueueSnackbar:x}=Re(),[q,m]=a.useState({}),P=y.reduce((f,W)=>f+(W.assignedQty??0),0).toFixed(2);console.log("Quantity",P);const[c,T]=a.useState({dpIdDet:0,dpId:h.dpId||0,designId:h.designId||"",batchNo:h.batchNo||"",planningHeaderId:h.planningHeaderId||0,fabricId:h.fabricId||"",fabricName:h.fabricName||"",colorId:h.colorId||"",colorName:h.colorName||"",uomId:h.uomId||"",uom:h.uom||"",poPcs:h.poPcs||"",vendorId:"",processType:h.processType||"",availableQty:h.availableQty||"",remainingQty:h.availableQty-P||"",shrinkage:h.allowedWastage||"",wastage:h.allowedWastage||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});a.useEffect(()=>{T(f=>({...c,dpIdDet:g.dpIdDet||0,dpId:g.dpId||0,designId:(g==null?void 0:g.designId)||"",planningHeaderId:(g==null?void 0:g.planningHeaderId)||0,batchNo:(g==null?void 0:g.batchNo)||"",vendorId:(g==null?void 0:g.vendorId)||"",shrinkage:(g==null?void 0:g.shrinkage)||"",wastage:(g==null?void 0:g.wastage)||"",outputQty:(g==null?void 0:g.outputQty)||0,remainingQty:f.remainingQty+(g==null?void 0:g.assignedQty)||"",assignedQty:(g==null?void 0:g.assignedQty)||"",rate:(g==null?void 0:g.rate)||0,unitRatePerPo:(g==null?void 0:g.unitRatePerPo)||"",totalExcGst:(g==null?void 0:g.totalExcGst)||"",gst:(g==null?void 0:g.gst)||0,TotalIncludingGst:(g==null?void 0:g.totalIncludingGst)||"",createdOn:(g==null?void 0:g.createdOn)||new Date().toISOString(),createdBy:(g==null?void 0:g.createdBy)||t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId}))},[g]),a.useEffect(()=>{T({...c,remainingQty:h.availableQty-P>=0?h.availableQty-P:""})},[y,h.availableQty,P]);const{data:u}=We(),{data:M,refetch:ee}=St(c.dpId,{skip:!c.dpId}),[_,U]=a.useState([]);a.useEffect(()=>{if(u){const f=u.result[0];U(f.vendorList)}},[u]),a.useEffect(()=>{M&&s(M.result.map((f,W)=>({id:W+1,...f})))},[M,ee]),console.log("initialRows",y);const B=f=>{const{name:W,value:O}=f.target;T({...c,[W]:O}),T(J=>{const p={...J,[W]:O};if(W==="assignedQty"||W==="remainingQty"){const z=p.assignedQty,G=p.remainingQty;z>G?m(oe=>({...oe,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):m(oe=>({...oe,assignedQty:""}))}return p})};a.useEffect(()=>{const f=()=>{const ce=parseFloat(c.assignedQty)||0,fe=parseFloat(c.shrinkage)||0,Me=parseFloat(c.wastage)||0,C=fe+Me;return(ce*100/(100+C)).toFixed(2)},W=()=>{const ce=parseFloat(c.assignedQty)||0,fe=parseFloat(c.rate)||0;return(ce*fe).toFixed(2)},O=(ce,fe)=>(ce*(1+fe/100)).toFixed(2),J=f(),p=W(),z=parseFloat(c.gst)||0,G=O(p,z),oe=parseFloat(c.poPcs)||0,Ie=oe?G/oe:0;T(ce=>({...ce,outputQty:J,totalExcGst:p,TotalIncludingGst:G,unitRatePerPo:Ie.toFixed(2)}))},[c.availableQty,c.assignedQty,c.shrinkage,c.wastage,c.rate,c.gst,c.poPcs,c.unitRatePerPo]),console.log("formData",c);const X=async()=>{console.log(c);try{if(c.assignedQty>c.remainingQty){x("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}const f=await Pe.post("http://100.42.177.77:81/api/DyeingPrinting/SaveDyeingPrintingDetails",c);console.log("Save response:",f.data),T(W=>({...W,dpIdDet:0,vendorId:"",availableQty:h.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",remainingQty:h.availableQty-P||"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),ee(),$()}catch(f){console.error("Error saving data:",f)}},D=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:f=>f.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:f=>f.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:f=>f.toLocaleString()},{field:"outputQty",headerName:"Output Qty",flex:1}];return e.jsxs(Be,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!v,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"Fabric",name:"fabricName",value:c.fabricName,onChange:B,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Process Type",name:"processType",value:c.processType,onChange:B,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"Color",name:"colorName",value:c.colorName,onChange:B,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"UOM",name:"uom",value:c.uom,onChange:B,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:c.poPcs,onChange:B,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:c.availableQty,onChange:B,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:c.remainingQty,onChange:B,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:c.vendorId,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}},children:_.map(f=>e.jsx(F,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:c.assignedQty,onChange:B,disabled:!c.remainingQty,error:!!q.assignedQty,helperText:q.assignedQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:c.rate,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:c.shrinkage,onChange:B,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:c.wastage,onChange:B,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:c.outputQty,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:c.totalExcGst,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:c.gst,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:c.TotalIncludingGst,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:c.unitRatePerPo,onChange:B,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(he,{variant:"contained",size:"small",onClick:X,children:"Save"})})]})]}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:D,initialRows:y,setInitialData:n,deleteApi:"http://100.42.177.77:81/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:ee})})]})]})},$t=({initialFormData:h,setAdditionalProcessData:S,refetchDyeingPrintingData:$,handleClickOpen:re,showUpperDiv:v})=>{const t=et(),{enqueueSnackbar:y}=Re(),[s,g]=a.useState({}),{user:n}=Qe(),[x,q]=a.useState([]),[m,P]=a.useState([]),c=x.reduce((C,E)=>C+(E.assignedQty??0),0).toFixed(2);console.log("Quantity",c);const T=x.reduce((C,E)=>C+(E.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",T);const[u,M]=a.useState({embroideryIdDet:0,embroideryId:h.embroideryId||0,designId:h.designId||"",batchNo:h.batchNo||"",planningHeaderId:h.planningHeaderId||0,componentId:h.componentId||"",componentName:h.componentName||"",fabricId:h.fabricId||"",fabricName:h.fabricName||"",vendorId:"",colorId:h.colorId||"",colourName:h.colourName||"",availableQty:h.availableQty||"",assignedQty:0,remainingQty:(h.availableQty-c).toFixed(2)||0,remainingRepeats:h.repeats-T||"",noOfHead:h.noOfHead||"",noOfHeadsName:h.noOfHeadsName||"",repeats:h.repeats||"",assignedRepeats:"",cuttingSize:h.cuttingSize||"",itemsPerRepeat:h.itemsPerRepeat||"",poPcs:h.poPcs||"",totalPcs:h.totalPcs||"",remainingPcs:(h.totalPcs-T).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:n.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:n.empId});a.useEffect(()=>{M(C=>({...u,embroideryIdDet:m.embroideryIdDet||0,embroideryId:m.embroideryId||0,vendorId:(m==null?void 0:m.vendorId)||"",assignedQty:(m==null?void 0:m.assignedQty)||0,requiredPcs:(m==null?void 0:m.requiredPcs)||0,remainingQty:C.remainingQty+(m==null?void 0:m.assignedQty)||0,remainingPcs:C.remainingPcs+(m==null?void 0:m.requiredPcs)||0,totalAmount:(m==null?void 0:m.totalAmount)||0,threadStiches:(m==null?void 0:m.threadStiches)||0,threadRate:(m==null?void 0:m.threadRate)||0,threadAmount:(m==null?void 0:m.threadAmount)||0,tillaStiches:(m==null?void 0:m.tillaStiches)||0,tilaRate:(m==null?void 0:m.tilaRate)||0,tilaAmount:(m==null?void 0:m.tilaAmount)||0,sequence:(m==null?void 0:m.sequence)||0,sequenceRate:(m==null?void 0:m.sequenceRate)||0,sequenceAmount:(m==null?void 0:m.sequenceAmount)||0,isSolving:(m==null?void 0:m.isSolving)||!1,solvingLayers:(m==null?void 0:m.solvingLayers)||0,solvingInMeters:(m==null?void 0:m.solvingInMeters)||0,solvingRate:(m==null?void 0:m.solvingRate)||0,solvingAmount:(m==null?void 0:m.solvingAmount)||0,additional:(m==null?void 0:m.additional)||0,costPerComponent:(m==null?void 0:m.costPerComponent)||0,createdOn:(m==null?void 0:m.createdOn)||new Date().toISOString(),createdBy:(m==null?void 0:m.createdBy)||n.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:n.empId}))},[m]);const ee=["Boring","Pooni","Laser","Doori","Dissolving"];function _(C,E,Q){return{fontWeight:E.indexOf(C)===-1?Q.typography.fontWeightRegular:Q.typography.fontWeightMedium}}a.useEffect(()=>{M({...u,remainingQty:(h.availableQty-c).toFixed(2)||0,remainingPcs:h.totalPcs-T||0})},[x]);const{data:U}=We(),{data:B,refetch:X}=jt(u.embroideryId,{skip:!u.embroideryId}),[D,L]=a.useState([]);a.useEffect(()=>{if(U){const C=U.result[0];L(C.vendorList)}},[U]),a.useEffect(()=>{B&&q(B.result.map((C,E)=>({id:E+1,...C})))},[B,X]),console.log("initialRows",x);const f=C=>{const{name:E,value:Q}=C.target;M({...u,[E]:Q})},W=C=>{const{name:E,checked:Q}=C.target;M(Z=>({...Z,[E]:Q}))};console.log("formData",u);const[O,J]=a.useState(null),[p,z]=a.useState(u);a.useEffect(()=>{const C=setTimeout(()=>{z(u)},10);return()=>{clearTimeout(C)}},[u]);const G=C=>new Intl.NumberFormat("en-US").format(C);a.useEffect(()=>{const C=()=>{const w=parseFloat(p.repeats)||0,A=parseFloat(p.itemsPerRepeat)||0;return(w*A).toFixed(2)},E=()=>{const w=parseFloat(p.threadStiches)||0,A=parseFloat(p.threadRate)||0,ie=parseFloat(p.noOfHeadsName)||0,pe=parseFloat(p.repeats)||0;return(w/1e3*(A*pe*ie)).toFixed(2)},Q=()=>{const w=parseFloat(p.tillaStiches)||0,A=parseFloat(p.tilaRate)||0,ie=parseFloat(p.noOfHeadsName)||0,pe=parseFloat(p.repeats)||0;return(w/1e3*(A*pe*ie)).toFixed(2)},Z=()=>{const w=parseFloat(p.sequence)||0,A=parseFloat(p.sequenceRate)||0,ie=parseFloat(p.noOfHeadsName)||0,pe=parseFloat(p.repeats)||0;return(w/1e3*(A*pe*ie)).toFixed(2)},le=()=>{const w=parseFloat(p.repeats)||0,A=parseFloat(p.noOfHeadsName)||0,ie=parseFloat(p.solvingLayers)||0;return(w*A*13/39.37*ie).toFixed(2)},ae=()=>{const w=parseFloat(p.solvingInMeters)||0,A=parseFloat(p.solvingRate)||0;return(w*A).toFixed(2)},ge=()=>{const w=parseFloat(p.threadAmount)||0,A=parseFloat(p.tilaAmount)||0,ie=parseFloat(p.sequenceAmount)||0,pe=parseFloat(p.solvingAmount)||0;return(w+A+ie+pe).toFixed(2)},K=()=>{const w=parseFloat(String(p.totalAmount).replace(/,/g,""))||0,A=parseFloat(p.requiredPcs)||0;return(w/A).toFixed(2)},H=ge(),ne=K();E(),M(w=>({...w,totalPcs:C(),threadAmount:E(),tilaAmount:Q(),sequenceAmount:Z(),solvingInMeters:le(),solvingAmount:ae(),totalAmount:G(H),costPerComponent:G(ne)}))},[p.threadAmount,p.totalAmount,p.sequenceAmount,p.solvingAmount,p.repeats,p.tilaAmount,p.itemsPerRepeat,p.threadRate,p.threadStiches,p.noOfHeadsName,p.tilaRate,p.tillaStiches,p.sequenceRate,p.sequence,p.solvingLayers,p.solvingInMeters,p.solvingRate,p.requiredPcs]),a.useEffect(()=>{if(O==="assignedQty"){const C=()=>{const E=parseFloat(p.assignedQty)||0,Q=parseFloat(p.availableQty)||0,Z=parseFloat(p.totalPcs)||0;return Math.round(E*(Z/Q))};M(E=>({...E,requiredPcs:C()}))}else if(O==="requiredPcs"){const C=()=>{const E=parseFloat(p.requiredPcs)||0,Q=parseFloat(p.availableQty)||0,Z=parseFloat(p.totalPcs)||0;return(E*Q/Z).toFixed(2)};M(E=>({...E,assignedQty:C()}))}},[p.assignedQty,p.requiredPcs,O]);const oe=C=>{const E=C.target.value,Q=C.target.name;J("assignedQty"),M(Z=>({...Z,assignedQty:E})),M(Z=>{const le={...Z,[Q]:E};if(Q==="assignedQty"||Q==="remainingQty"){const ae=parseFloat(le.assignedQty),ge=parseFloat(le.remainingQty);ae>ge?g(K=>({...K,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):g(K=>({...K,assignedQty:""}))}return le})},Ie=C=>{const E=C.target.value,Q=C.target.name;J("requiredPcs"),M(Z=>({...Z,requiredPcs:E})),M(Z=>{const le={...Z,[Q]:E};if(Q==="requiredPcs"||Q==="remainingPcs"){const ae=parseFloat(le.requiredPcs),ge=parseFloat(le.remainingPcs);ae>ge?(console.log(),g(K=>({...K,requiredPcs:"Required Pcs cannot be greater than Remaining Pcs"}))):g(K=>({...K,requiredPcs:""}))}return le})},ce=async()=>{if(console.log(u),u.totalAmount==0||u.costPerComponent==0){y("Please Enter Thread, Tilla or Sequnce values , Total Amount cannot be zero",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(u.assignedQty)>parseFloat(u.remainingQty)){y("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(u.requiredPcs)>parseFloat(u.remainingPcs)){y("Required Pcs can not be greater then Remaining Pcs !",{variant:"error",autoHideDuration:5e3});return}try{const C=await Pe.post("http://100.42.177.77:81/api/Embroidery/SaveEmbroideryDetails",{...u,additional:u.additional.join(", ")});C.data.success?y("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(y(`${C.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",C.data.message)),console.log("Save response:",C.data),M(E=>({...E,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,remainingQty:(h.availableQty-c).toFixed(2)||0,remainingRepeats:h.repeats-T||"",costPerComponent:0,createdOn:new Date().toISOString(),createdBy:n.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:n.empId})),X(),$()}catch(C){console.error("Error saving data:",C),y("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},fe=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"Additional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Be,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!v,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"Fabric",name:"fabricName",value:u.fabricName,onChange:f,size:"small",disabled:!0,sx:C=>({...u.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Component",name:"componentName",value:u.componentName,onChange:f,size:"small",disabled:!0,sx:C=>({...u.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"Color",name:"colourName",value:u.colourName,onChange:f,size:"small",disabled:!0,sx:C=>({...u.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:u.poPcs,onChange:f,size:"small",disabled:!0,sx:C=>({...u.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Heads",size:"small",name:"noOfHeadsName",value:u.noOfHeadsName,onChange:f,disabled:!0,sx:C=>({...u.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:u.cuttingSize,onChange:f,disabled:!0,sx:C=>({...u.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:u.itemsPerRepeat,onChange:f,disabled:!0,sx:C=>({...u.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total Available Qty",fullWidth:!0,size:"small",name:"availableQty",value:u.availableQty,onChange:f,disabled:!0,sx:C=>({...u.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:u.remainingQty,type:"number",error:!!s.remainingQty,helperText:s.remainingQty,onChange:f,disabled:!0,sx:C=>({...u.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:u.repeats,onChange:f,disabled:!0,sx:C=>({...u.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:u.totalPcs,onChange:f,disabled:!0,sx:C=>({...u.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Remaining Pcs",fullWidth:!0,size:"small",name:"remainingPcs",value:u.remainingPcs,onChange:f,disabled:!0,sx:C=>({...u.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:u.vendorId,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}},children:D.map(C=>e.jsx(F,{value:C.lookUpId,children:C.lookUpName},C.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:u.assignedQty,onChange:oe,error:!!s.assignedQty,helperText:s.assignedQty,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Required Pcs",fullWidth:!0,disabled:!u.remainingPcs&&!u.remainingQty,size:"small",type:"number",name:"requiredPcs",value:u.requiredPcs,error:!!s.requiredPcs,helperText:s.requiredPcs,onChange:Ie,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{select:!0,label:"Additional",value:u.additional,name:"additional",size:"small",onChange:f,fullWidth:!0,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:ee.map(C=>e.jsx(F,{value:C,style:_(C,u.additional,t),children:C},C))})}),e.jsx(o,{item:!0,xs:12,md:1,children:e.jsx(It,{control:e.jsx(ft,{checked:u.isSolving,onChange:W,disabled:!u.remainingPcs&&!u.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:u.threadStiches,onChange:f,required:!0,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:u.threadRate,onChange:f,required:!0,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:u.threadAmount,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:u.tillaStiches,onChange:f,required:!0,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:u.tilaRate,onChange:f,required:!0,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:u.tilaAmount,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:u.sequence,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:u.sequenceRate,onChange:f,required:!0,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:u.sequenceAmount,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),u.isSolving?e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:u.solvingLayers,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:u.solvingInMeters,disabled:!u.remainingPcs&&!u.remainingQty,onChange:f,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:u.solvingRate,onChange:f,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:u.solvingAmount,disabled:!u.remainingPcs&&!u.remainingQty,onChange:f,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(d,{label:"Total Amount",fullWidth:!0,size:"small",disabled:!u.remainingPcs&&!u.remainingQty,name:"totalAmount",value:u.totalAmount,onChange:f,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(d,{label:"Cost Per Component",fullWidth:!0,type:"number",size:"small",name:"costPerComponent",value:u.costPerComponent,onChange:f,disabled:!u.remainingPcs&&!u.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(he,{variant:"contained",size:"small",onClick:ce,children:"Save"})})]})]}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(xe,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:fe,initialRows:x,setInitialData:P,deleteApi:"http://100.42.177.77:81/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:X})})]})})]})},eo=({initialValues:h})=>{et();const{user:S}=Qe(),[$,re]=a.useState(!0),{enqueueSnackbar:v}=Re(),[t,y]=a.useState([]),[s,g]=a.useState(!1),[n,x]=a.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:S.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId});a.useEffect(()=>{x({...n,embroideryId:(t==null?void 0:t.embroideryId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})},[t]);const{data:q}=Ye(),[m,P]=a.useState("");a.useEffect(()=>{P(h.collectionId)},[]);const{data:c}=We(),{data:T,refetch:u}=Xe(m,{skip:!m}),{data:M,refetch:ee}=Je(n.designId,{skip:!n.designId}),{data:_,refetch:U}=tt({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:B}=ot({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:X,refetch:D}=kt(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:L}=at(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("formData.planningHeaderId",n.planningHeaderId),console.log("collectionData",q);const[f,W]=a.useState(!1),[O,J]=a.useState([]),[p,z]=a.useState([]),[G,oe]=a.useState([]),[Ie,ce]=a.useState([]),[fe,Me]=a.useState([]),[C,E]=a.useState([]),[Q,Z]=a.useState([]),[le,ae]=a.useState([]);console.log("batchList",p),console.log("formData",n),a.useEffect(()=>{T&&J(T.result)},[T]),a.useEffect(()=>{M&&z(M.result)},[M]),a.useEffect(()=>{_&&(U(),oe(_.result))},[_,U]),a.useEffect(()=>{B&&E(_.result)},[B]),a.useEffect(()=>{L&&ae(L.result)},[L]),a.useEffect(()=>{X&&(re(!1),Z(X.result.map((I,Y)=>({id:Y+1,...I}))))},[X,D]),console.log("embroideryList",X),console.log("initialRows",Q),a.useEffect(()=>{if(c){const I=c.result[0];ce(I.vendorList),Me(I.noOfHeadsList)}},[c]);const ge=(q==null?void 0:q.result)||[];a.useEffect(()=>{const I=()=>{const se=parseFloat(n.repeats)||0,we=parseFloat(n.itemsPerRepeat)||0;return(se*we).toFixed(2)};x(se=>({...se,totalPcs:I()}));const Y=()=>{const se=parseFloat(n.threadStiches)||0,we=parseFloat(n.threadRate)||0,ze=parseFloat(n.noOfHead)||0,He=parseFloat(n.repeats)||0;return(se/1e3*(we*He*ze)).toFixed(2)};x(se=>({...se,threadAmount:Y()}));const be=()=>{const se=parseFloat(n.tillaStiches)||0,we=parseFloat(n.tilaRate)||0,ze=parseFloat(n.noOfHead)||0,He=parseFloat(n.repeats)||0;return(se/1e3*(we*He*ze)).toFixed(2)};x(se=>({...se,tilaAmount:be()}));const te=()=>{const se=parseFloat(n.sequence)||0,we=parseFloat(n.sequenceRate)||0,ze=parseFloat(n.noOfHead)||0,He=parseFloat(n.repeats)||0;return(se/1e3*(we*He*ze)).toFixed(2)};x(se=>({...se,sequenceAmount:te()}));const ye=()=>{const se=parseFloat(n.repeats)||0,we=parseFloat(n.noOfHead)||0,ze=parseFloat(n.solvingLayers)||0;return(se*we*13/39.37*ze).toFixed(2)};x(se=>({...se,solvingInMeters:ye()}));const Te=()=>{const se=parseFloat(n.solvingInMeters)||0,we=parseFloat(n.solvingRate)||0;return parseFloat(n.solvingLayers),(se*we).toFixed(2)};x(se=>({...se,solvingAmount:Te()}));const Ct=()=>{const se=parseFloat(n.threadAmount)||0,we=parseFloat(n.tilaAmount)||0,ze=parseFloat(n.sequenceAmount)||0,He=parseFloat(n.solvingAmount)||0;return(se+we+ze+He).toFixed(2)};x(se=>({...se,totalAmount:Ct()||0}))},[n.threadAmount,n.totalAmount,n.sequenceAmount,n.solvingAmount,n.repeats,n.tilaAmount,n.itemsPerRepeat,n.threadRate,n.threadStiches,n.noOfHead,n.tilaRate,n.tillaStiches,n.sequenceRate,n.sequence,n.solvingLayers,n.solvingInMeters,n.solvingRate]);const K=I=>{const{name:Y,value:be}=I.target;if(Y==="collectionId")ge.find(te=>te.collectionId===parseInt(be)),P(be),g(!0),Z([]),re(!0),x({...n,collectionId:be,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]});else if(Y==="designId"){const te=O.find(ye=>ye.designId===parseInt(be));Z([]),re(!0),x({...n,designId:be,baseColorId:te?te.colorId:"",baseColorName:te?te.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(Y==="colorId"){const te=C.find(ye=>ye.colorId===be);x({...n,colorId:be,availableQty:te?te.total:"",cuttingSize:te?te.cuttingSize:"",repeats:te?te.repeats:"",noOfHead:te?te.noOfHeads:""})}else if(Y==="batchNo"){const te=p.find(ye=>ye.batchNo===be);x({...n,batchNo:be,planningHeaderId:te?te.planningHeaderId:"",poPcs:te?te.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),W(!0),g(!1)}else x({...n,[Y]:be}),ne(te=>({...te,[Y]:""}))},[H,ne]=a.useState({}),w=async()=>{try{const I=await Pe.post("http://100.42.177.77:81/api/Embroidery/SaveEmbroidery",{...n,threadAdditional:n.threadAdditional.join(", ")});console.log("Save response:",I.data),I.data.success?v("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(v(`${I.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",I.data.message)),x(Y=>({embroideryId:0,designId:Y.designId,batchNo:Y.batchNo,planningHeaderId:Y.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:Y.poPcs,baseColorId:Y.baseColorId,baseColorName:Y.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})),D()}catch(I){console.error("Error saving data:",I),v("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",Q);const[A,ie]=a.useState({}),[pe,Se]=a.useState(!1),ke=I=>{ie(I),Se(!0)},[Oe,je]=a.useState(!0),Ne=I=>{ie(I),Se(!0),je(!1)},Ae=()=>{je(!0),Se(!1),ie({}),refetchDyeingPrintingData()};console.log("show div",Oe);const[Le,j]=a.useState(0),[V,me]=a.useState(0),[i,l]=a.useState(0),[k,r]=a.useState(0);a.useEffect(()=>{const I=Q.reduce((ye,Te)=>ye+(Te.availableQty??0),0).toFixed(2),Y=Q.reduce((ye,Te)=>ye+(Te.assignedQty??0),0).toFixed(2),be=Q.reduce((ye,Te)=>ye+(Te.totalPcs??0),0).toFixed(2),te=Q.reduce((ye,Te)=>ye+(Te.requiredPcs??0),0).toFixed(2);j(parseFloat(I).toLocaleString()),me(parseFloat(Y).toLocaleString()),l(parseFloat(be).toLocaleString()),r(parseFloat(te).toLocaleString())},[Q]);const b=[...Q,{id:"TOTAL_SUMMARY",availableQty:Le,assignedQty:V,totalPcs:i,requiredPcs:k}],R={sortable:!1,pinnable:!1,hideable:!1},N=[{field:"id",headerName:"Sr#",...R,colSpan:(I,Y)=>Y.id==="TOTAL_SUMMARY"?4:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):I.value},{field:"designNo",headerName:"Design",...R,colSpan:(I,Y)=>Y.id==="TOTAL_SUMMARY"?3:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):I.value},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component ",renderCell:I=>e.jsx(Ee,{label:I.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric "},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty",...R,valueGetter:I=>I.toLocaleString(),renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"assignedQty",headerName:"Assigned Qty",...R,valueGetter:I=>I,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"totalPcs",headerName:"Total Pcs",renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"requiredPcs",headerName:"Assigned Pcs",colSpan:(I,Y)=>Y.id==="TOTAL_SUMMARY"?4:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:I=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(st,{variant:"text",size:"small",children:[e.jsx(Fe,{color:"primary",onClick:()=>ke(I.row),children:e.jsx(it,{})}),e.jsx(Fe,{color:"primary",onClick:()=>Ne(I.row),children:e.jsx(Ge,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ze,{src:Zt,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:m,onChange:K,size:"small",InputLabelProps:{sx:{color:"black"}},children:ge.map(I=>e.jsx(F,{value:I.collectionId,children:I.collectionName},I.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:K,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(I=>e.jsx(F,{value:I.designId,children:I.designNo},I.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:K,size:"small",InputLabelProps:{sx:{color:"black"}},children:p.map(I=>e.jsx(F,{value:I.batchNo,children:I.batchNo},I.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:K,disabled:!0,sx:I=>({...n.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:K,size:"small",required:!0,error:!!H.componentId,helperText:H.componentId,InputLabelProps:{sx:{color:"black"}},children:le.map(I=>e.jsx(F,{value:I.componentId,children:I.componentName},I.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:K,required:!0,error:!!H.fabricId,helperText:H.fabricId,InputLabelProps:{sx:{color:"black"}},children:G.map(I=>e.jsx(F,{value:I.fabricId,children:I.fabric},I.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:K,required:!0,error:!!H.colorId,helperText:H.colorId,InputLabelProps:{sx:{color:"black"}},children:C.map(I=>e.jsx(F,{value:I.colorId,children:I.color},I.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:K,disabled:!0,sx:I=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:n.availableQty,onChange:K,InputLabelProps:{sx:{color:"black"}},sx:I=>({...n.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:n.repeats,onChange:K,InputLabelProps:{sx:{color:"black"}},sx:I=>({...n.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:n.noOfHead,onChange:K,required:!0,error:!!H.noOfHead,helperText:H.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:I=>({...n.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:fe.map(I=>e.jsx(F,{value:I.lookUpId,children:I.lookUpName},I.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:n.cuttingSize,onChange:K,InputLabelProps:{sx:{color:"black"}},sx:I=>({...n.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:n.itemsPerRepeat,onChange:K,required:!0,error:!!H.itemsPerRepeat,helperText:H.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:I=>({...n.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:n.totalPcs,onChange:K})}),e.jsx(o,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(he,{variant:"contained",size:"small",onClick:w,children:"Save"})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(ue,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(ue,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ge,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(Ue,{iColumns:N,initialRows:b,setInitialData:y,deleteApi:"http://100.42.177.77:81/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:D,setAccordionExpanded:W,fileName:"Embroidery List",isLoading:$}),e.jsxs(Ke,{open:pe,onClose:Ae,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(rt,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(xe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Embroidery > Assign Vendors "}),e.jsx(Fe,{onClick:Ae,sx:{color:"#ffffff"},children:e.jsx(lt,{})})]}),e.jsxs($e,{children:[e.jsx(nt,{id:"alert-dialog-slide-description"}),e.jsx($t,{initialFormData:A,setInitialFormData:ie,refetchDyeingPrintingData:D,handleClickOpen:ke,showUpperDiv:Oe})]})]})]})})]})]})},to=eo,oo=({setInitialValues:h,initialValues:S})=>{const{user:$}=Qe();console.log("user",$);const[re,v]=a.useState(!0),[t,y]=a.useState([]),[s,g]=a.useState([]),[n,x]=a.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:$.empId,lastUpdatedBy:$.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",n),a.useEffect(()=>{x({...n,processType:(t==null?void 0:t.processType)||"MultiHead",planningId:(t==null?void 0:t.planningId)||0,baseColorId:(t==null?void 0:t.baseColorId)||"",componentId:(t==null?void 0:t.componentId)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",colorId:(t==null?void 0:t.colorId)||"",fabricId:(t==null?void 0:t.fabricId)||"",noOfHeads:(t==null?void 0:t.noOfHeads)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,repeats:(t==null?void 0:t.repeats)||0,repeatSize:(t==null?void 0:t.repeatSize)||0,uomId:(t==null?void 0:t.uomId)||"",totalFabric:(t==null?void 0:t.totalFabric)||"",shrinkage:(t==null?void 0:t.shrinkage)||"",wastage:(t==null?void 0:t.wastage)||"",total:(t==null?void 0:t.total)||"",appId:1,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||$.empId,lastUpdatedBy:$.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(t==null?void 0:t.repeatsInMtr)||""})},[t]);const{data:q}=Ye(),[m,P]=a.useState(""),{data:c,refetch:T}=Xe(m,{skip:!m}),{data:u,refetch:M}=Ot(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:ee}=We(),[_,U]=a.useState([]),{enqueueSnackbar:B}=Re();console.log("lookupData",ee);const[X,D]=a.useState([]);a.useEffect(()=>{q&&D(q.result)},[q]),a.useEffect(()=>{c&&(U(c.result),T())},[c]),a.useEffect(()=>{u&&(v(!1),g(u.result.map((r,b)=>({id:b+1,...r}))))},[u,M]),console.log("designList",_),console.log("collectionData",q);const[L,f]=a.useState(!1),[W,O]=a.useState([]),[J,p]=a.useState([]),[z,G]=a.useState([]),[oe,Ie]=a.useState([]),[ce,fe]=a.useState([]),[Me,C]=a.useState([]),[E,Q]=a.useState([]),[Z,le]=a.useState([]);console.log("components:",z),console.log("Fabrications:",oe),console.log("colors:",ce),console.log("uoms:",Me),console.log("heads:",E),console.log("lookupData",ee),a.useEffect(()=>{if(ee){const r=ee.result[0];G(r.componentList),fe(r.colorList),Ie(r.fabricList),Q(r.noOfHeadsList),C(r.uomList),O(r.planningTypeProcessList),p(r.operatingMachineList)}},[ee]),a.useEffect(()=>{const r=async b=>{try{const R=await Pe.get(`http://100.42.177.77:81/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${b}`);console.log(R.data),le(R.data.result)}catch(R){console.error("Error fetching pre-planning lookup data:",R)}};n.designId&&r(n.designId)},[n.designId,n.planningHeaderId]);const ae=n.planningProcessTypeId===212||n.planningProcessTypeId===1219;console.log("initialValues",S),console.log("selectedCollectionId",m),a.useEffect(()=>{P((S==null?void 0:S.collectionId)||""),x({...n,designId:(S==null?void 0:S.designId)||"",planningHeaderId:(S==null?void 0:S.planningHeaderId)||"",batchNo:(S==null?void 0:S.batchNo)||""})},[S]),a.useEffect(()=>{const r=()=>{const Y=parseFloat(n.poPcs)||0,be=parseFloat(n.cuttingSize)||0,te=(Y*be).toFixed(2);return parseFloat(te).toLocaleString()},b=()=>{const Y=parseFloat(n.repeats)||0,be=parseFloat(n.repeatSize)||0,te=(Y*be).toFixed(2);return parseFloat(te).toLocaleString()},R=Y=>{const be=Y||0,te=parseFloat(n.shrinkage)||0,ye=parseFloat(n.wastage)||0,Te=(be*(100+(te+ye))/100).toFixed(2);return parseFloat(Te).toLocaleString()},N=()=>(.9144*(parseFloat(n.repeatSize)||0)).toFixed(2),de=()=>{const Y=parseFloat(n.repeats)||0;return((parseFloat(n.repeatsInMtr)||0)*Y).toFixed(2)};let I=0;ae?I=parseFloat(r().replace(/,/g,""))||0:I=parseFloat(b().replace(/,/g,""))||0,x(Y=>({...Y,totalFabric:I.toLocaleString(),total:R(I),repeatsInMtr:N()})),!ae&&n.isSchiffili&&x(Y=>({...Y,totalFabric:de()}))},[n.poPcs,n.cuttingSize,n.repeats,n.repeatSize,n.totalFabric,n.shrinkage,n.wastage,n.repeatsInMtr,n.isSchiffili,ae]);const[ge,K]=a.useState(!1);a.useState(!1);const H=r=>{const{name:b,value:R}=r.target;if(b==="collectionId"){const N=X.find(de=>de.collectionId===parseInt(R));f(!0),g([]),v(!0),P(R),x({...n,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:R,noOfDesigns:N?N.noOfDesigns:"",noOfColors:N?N.noOfColors:""})}else if(b==="designId"){const N=_.find(de=>de.designId===parseInt(R));g([]),v(!0),x({...n,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:R,baseColorId:N?N.colorId:"",baseColorName:N?N.colorName:""})}else if(b==="batchNo"){const N=Z.find(de=>de.batchNo===R);x({...n,componentId:"",processType:"MultiHead",poPcs:N?N.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:R,planningHeaderId:N?N.planningHeaderId:""}),K(!0),f(!1)}else if(b==="planningProcessTypeId"){const N=W.find(de=>de.lookUpId===R);console.log("selectedProcess",N),x({...n,planningProcessTypeId:R,planningProcessTypeName:N?N.lookUpName:"",noOfHeads:0,operatingMachineId:0}),K(!0),f(!1)}else x({...n,[b]:R})},[ne,w]=a.useState({}),[A,ie]=a.useState(!1),pe=()=>{ie(!A)},Se=async()=>{const r=ke();if(Object.keys(r).length>0){w(r);return}try{const b={...n,totalFabric:parseFloat(n.totalFabric.replace(/,/g,"")),total:parseFloat(n.total.replace(/,/g,""))},R=await Pe.post("http://100.42.177.77:81/api/PrePlanning/SavePrePlanning",b);console.log("Data saved successfully:",R.data),console.log("Save response:",R.data),R.data.success?R.data.success&&B("PrePlanning saved successfully!",{variant:"success",autoHideDuration:5e3}):(B(`${R.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",R.data.message)),x(N=>({processType:"MultiHead",planningId:0,collectionId:N.collectionId,designId:N.designId,batchNo:N.batchNo,planningHeaderId:N.planningHeaderId,baseColorId:N.baseColorId,baseColorName:N.baseColorName,noOfDesigns:N.noOfDesigns,noOfColors:N.noOfColors,poPcs:N.poPcs,fabricId:N.fabricId,shrinkage:N.shrinkage,wastage:N.wastage,componentId:"",cuttingSize:"",colorId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:$.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:$.empId,isSchiffili:!1,repeatsInMtr:""})),M()}catch(b){console.error("Error saving data:",b),B("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ke=()=>{const r={};return n.componentId||(r.componentId="componentId is required"),n.colorId||(r.colorId="colorId is required"),n.fabricId||(r.fabricId="fabricId is required"),n.cuttingSize||(r.cuttingSize="cuttingSize is required"),n.uomId||(r.uomId="uomId is required"),n.shrinkage||(r.shrinkage="shrinkage is required"),n.wastage||(r.wastage="wastage is required"),r};console.log("initialRows",s);const Oe=s.reduce((r,b)=>r+(b.totalFabric??0),0).toFixed(2),je=parseFloat(Oe).toLocaleString();console.log("localizedTotalFabric",je);const Ne=s.reduce((r,b)=>r+(b.total??0),0).toFixed(2),Ae=parseFloat(Ne).toLocaleString(),Le=[...s,{id:"TOTAL_SUMMARY",label:"Total Fabric",totalFabric:je,total:Ae}],j={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",Le);const V=[{field:"id",headerName:"Sr#",...j,colSpan:(r,b)=>{if(b.id==="TOTAL_SUMMARY")return 10},valueGetter:(r,b)=>b.id==="TOTAL_SUMMARY"?b.label:r,renderCell:r=>e.jsx("div",{style:{color:r.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:r.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:r.value})},{field:"componentName",headerName:"Component",...j},{field:"planningProcessTypeName",headerName:"Process Type",...j,renderCell:r=>{const b=r.value==="MultiHead"?"primary.dark":r.value==="Schiffili"?theme.palette.grey[900]:r.value==="Dyeing"?"success.dark":"default";return e.jsx(Ee,{label:r.value,sx:{backgroundColor:b==="primary"||b==="default"?void 0:b,color:b==="primary"||b==="default"?void 0:"white"},color:b==="primary"?"primary":b==="default"?"default":void 0})}},{field:"color",headerName:"Color",...j},{field:"cuttingSize",headerName:"Cutting Size",...j},{field:"fabric",headerName:"Fabrication",...j},{field:"noOfHeadName",headerName:"No. Of Heads",...j},{field:"operatingMachineName",headerName:"Operating Machine",...j},{field:"repeats",headerName:"Repeats",valueGetter:r=>r.toLocaleString(),...j},{field:"repeatSize",headerName:"Repeat Size",valueGetter:r=>r.toLocaleString(),...j},{field:"totalFabric",headerName:"Total Fabric",valueGetter:r=>r.toLocaleString(),renderCell:r=>e.jsx("div",{style:{color:r.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:r.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:r.value}),...j},{field:"uom",headerName:"UOM",colSpan:(r,b)=>b.id==="TOTAL_SUMMARY"?2:void 0,valueGetter:(r,b)=>b.id==="TOTAL_SUMMARY"?"OverAll Total":r,renderCell:r=>e.jsx("div",{style:{color:r.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:r.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:r.value}),...j},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:r=>r.toLocaleString(),colSpan:(r,b)=>b.id==="TOTAL_SUMMARY"?2:void 0,renderCell:r=>e.jsx("div",{style:{color:r.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:r.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:r.value}),...j}],me=n.planningProcessTypeId===198;a.useEffect(()=>{me&&x({...n,uomId:139})},[me]),console.log("formData",n);const i=({row:r,field:b})=>r.id==="TOTAL_SUMMARY"&&(b==="componentName"||b==="uom")?"bold":"";console.log("batchList:",Z);const l="http://100.42.177.77:81/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",k=(r,b)=>{K(!ge)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(xt,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:2.4,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:m,onChange:H,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:X.map(r=>e.jsx(F,{value:r.collectionId,children:r.collectionName},r.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:H,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:_.map(r=>e.jsx(F,{value:r.designId,children:r.designNo},r.designId))})}),e.jsxs(o,{item:!0,xs:12,md:2.4,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:H,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:Z.map(r=>e.jsx(F,{value:r.batchNo,children:r.batchNo},r.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(d,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:H,disabled:!0,sx:r=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(d,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:H,disabled:!0,sx:r=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"MainCard",avatar:e.jsx(mt,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Fe,{onClick:k,sx:{mt:"-18px"},children:e.jsx(De,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(ht,{expanded:ge,onChange:k,sx:{},children:[e.jsx(gt,{expandIcon:e.jsx(De,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(bt,{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(Ve,{fullWidth:!0,options:oe,getOptionLabel:r=>r.lookUpName,value:oe.find(r=>r.lookUpId===n.fabricId)||null,onChange:(r,b)=>{H({target:{name:"fabricId",value:b?b.lookUpId:""}})},renderInput:r=>e.jsx(d,{...r,label:"Fabrication",size:"small",name:"fabricId",value:n.fabricId,required:!0,error:!!ne.fabricId,helperText:ne.fabricId,disabled:A,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:n.shrinkage,onChange:H,error:!!ne.shrinkage,helperText:ne.shrinkage,required:!0,disabled:A,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:n.wastage,onChange:H,error:!!ne.wastage,helperText:ne.wastage,required:!0,disabled:A,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(he,{variant:"contained",size:"small",onClick:pe,children:A||A?"Unlock":"Lock"})}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(ue,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsxs(o,{item:!0,xs:12,md:2,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:n.planningProcessTypeId,onChange:H,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:W.map(r=>e.jsx(F,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})," "]}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(Ve,{fullWidth:!0,options:z,getOptionLabel:r=>r.lookUpName,value:z.find(r=>r.lookUpId===n.componentId)||null,onChange:(r,b)=>{H({target:{name:"componentId",value:b?b.lookUpId:""}})},renderOption:(r,b)=>{const{lookUpName:R}=b;return e.jsx("span",{...r,children:R})},renderInput:r=>e.jsx(d,{...r,label:"Select Component",size:"small",name:"componentId",value:n.componentId,required:!0,error:!!ne.componentId,helperText:ne.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})}),e.jsxs(o,{item:!0,xs:12,md:2,children:[" ",e.jsx(Ve,{fullWidth:!0,options:ce,getOptionLabel:r=>r.lookUpName,value:ce.find(r=>r.lookUpId===n.colorId)||null,onChange:(r,b)=>{H({target:{name:"colorId",value:b?b.lookUpId:""}})},renderInput:r=>e.jsx(d,{...r,label:"Color",size:"small",value:n.colorId,name:"colorId",required:!0,error:!!ne.colorId,helperText:ne.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})]}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:n.cuttingSize,onChange:H,required:!0,error:!!ne.cuttingSize,helperText:ne.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:me?e.jsx(d,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:n.operatingMachineId,onChange:H,required:!0,disabled:ae,InputLabelProps:{sx:{color:"black"}},children:J.map(r=>e.jsx(F,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))}):e.jsx(d,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:n.noOfHeads,onChange:H,required:!0,disabled:ae,InputLabelProps:{sx:{color:"black"}},children:E.map(r=>e.jsx(F,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:n.repeatSize,onChange:H,disabled:ae,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"No. of Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:n.repeats,onChange:H,required:!0,disabled:ae,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:n.totalFabric,onChange:H,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:n.uomId,onChange:H,error:!!ne.uomId,helperText:ne.uomId,required:!0,disabled:me,InputLabelProps:{sx:{color:"black"}},children:Me.map(r=>e.jsx(F,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Repeats in Meter",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:n.repeatsInMtr,onChange:H,sx:r=>({...n.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(d,{label:"Total",fullWidth:!0,size:"small",name:"total",value:n.total,onChange:H,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(o,{container:!0,spacing:1,width:"Inherit"})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",children:e.jsx(he,{variant:"contained",size:"small",onClick:Se,children:"Save"})})]})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(ue,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"MainCard",avatar:e.jsx(Ge,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{sx:{paddingY:1,paddingX:1},children:e.jsx(o,{sx:{},item:!0,xs:12,children:e.jsx(Ue,{iColumns:V,initialRows:Le,setInitialData:y,deleteApi:l,deleteBy:"planningId",refetch:M,getCellClassName:i,setAccordionExpanded:K,fileName:"PrePlanningList",isLoading:re})})})]})]})},ao=oo,ro="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",no=({initialValues:h})=>{const{user:S}=Qe();console.log("user",S);const[$,re]=a.useState(!0),[v,t]=a.useState([]),[y,s]=a.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:S.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId});a.useEffect(()=>{s({...y,dpId:v.dpId||0,fabricId:(v==null?void 0:v.fabricId)||"",colorId:(v==null?void 0:v.colorId)||"",color:(v==null?void 0:v.color)||"",processType:(v==null?void 0:v.processType)||"",availableQty:(v==null?void 0:v.availableQty)||"",Shrinkage:(v==null?void 0:v.shrinkage)||"",Wastage:(v==null?void 0:v.wastage)||"",outputQty:(v==null?void 0:v.outputQty)||0,UOM:(v==null?void 0:v.uom)||0,uomId:(v==null?void 0:v.uomId)||"",poPcs:(v==null?void 0:v.poPcs)||0,createdOn:(v==null?void 0:v.createdOn)||new Date().toISOString(),createdBy:(v==null?void 0:v.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})},[v]);const{enqueueSnackbar:g}=Re(),[n,x]=a.useState(!1);console.log("Dyeing form data to send",y);const{data:q}=Ye(),[m,P]=a.useState("");a.useEffect(()=>{P(h.collectionId)},[]);const{data:c}=We(),{data:T,refetch:u}=Xe(m,{skip:!m}),{data:M,refetch:ee}=Je(y.designId,{skip:!y.designId}),{data:_}=Nt({batchNo:y.planningHeaderId,processType:"Fabrication"},{skip:!y.planningHeaderId}),{data:U}=At({fabricId:y.fabricId,planningHeaderId:y.planningHeaderId},{skip:!y.fabricId||!y.planningHeaderId}),{data:B,refetch:X}=Lt(y.planningHeaderId,{skip:!y.planningHeaderId}),[D,L]=a.useState([]),[f,W]=a.useState([]),[O,J]=a.useState([]),[p,z]=a.useState([]),[G,oe]=a.useState([]),[Ie,ce]=a.useState([]);a.useState([]);const[fe,Me]=a.useState(!1);console.log("batchList",f),console.log("formData",y),a.useEffect(()=>{T&&L(T.result)},[T]),a.useEffect(()=>{M&&W(M.result)},[M]),a.useEffect(()=>{_&&J(_.result)},[_]),a.useEffect(()=>{U&&ce(U.result)},[U]),a.useEffect(()=>{B&&(re(!1),oe(B.result.map((i,l)=>({id:l+1,...i}))))},[B,X]),a.useEffect(()=>{if(c){const i=c.result[0];z(i.uomList)}},[c]);const[C,E]=a.useState([]);a.useEffect(()=>{q&&E(q.result)},[q]);const Q=i=>{const{name:l,value:k}=i.target;if(l==="collectionId")C.find(r=>r.collectionId===parseInt(k)),P(k),x(!0),oe([]),re(!0),s({...y,collectionId:k,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:""});else if(l==="designId"){const r=D.find(b=>b.designId===parseInt(k));oe([]),re(!0),s({...y,designId:k,baseColorId:r?r.colorId:"",baseColorName:r?r.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(l==="batchNo"){const r=f.find(b=>b.batchNo===k);s({...y,batchNo:k,planningHeaderId:r?r.planningHeaderId:"",poPcs:r?r.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),Me(!0),x(!1)}else if(l==="fabricId")O.find(r=>r.fabricId===k),console.log("Selected Fabric:",O),s({...y,fabricId:k});else if(l==="ColorId"){const r=Ie.find(b=>b.colorId===k.colorId);s({...y,ColorId:k.colorId,color:r.color,availableQty:r.total,UOM:r.uom,Shrinkage:r.shrinkage,Wastage:r.wastage})}else l==="processType"?s({...y,processType:k}):l==="vendorId"?s({...y,vendorId:k}):(s({...y,[l]:k}),le(r=>({...r,[l]:""})))};a.useEffect(()=>{const i=()=>{const N=parseFloat(y.availableQty)||0,de=parseFloat(y.Shrinkage)||0,I=parseFloat(y.Wastage)||0;return(N*(100-(de+I))/100).toFixed(2)},l=()=>{const N=parseFloat(y.availableQty)||0,de=parseFloat(y.RatePerUOM)||0;return(N*de).toFixed(2)},k=(N,de)=>(N*(1+de/100)).toFixed(2),r=i(),b=l(),R=parseFloat(y.GST)||0;k(b,R),parseFloat(y.poPcs),s(N=>({...N,outputQty:r}))},[y.availableQty,y.Shrinkage,y.Wastage,y.RatePerUOM,y.GST,y.poPcs,y.UnitRatePerPo]);const[Z,le]=a.useState({}),ae=async()=>{try{const i=await Pe.post("http://100.42.177.77:81/api/DyeingPrinting/SaveDyeingPrinting",y);console.log("Save response:",i.data),i.data.success?g("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(g(`${i.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",i.data.message)),s(l=>({designId:l.designId,planningHeaderId:l.planningHeaderId,batchNo:l.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:l.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})),X()}catch(i){console.error("Error saving data:",i),g("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ge=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[K,H]=a.useState(!0),[ne,w]=a.useState({}),[A,ie]=a.useState(!1),pe=i=>{w(i),ie(!0)},Se=i=>{w(i),ie(!0),H(!1)},ke=()=>{H(!0),ie(!1),w({}),X()},[Oe,je]=a.useState(0),[Ne,Ae]=a.useState(0);a.useEffect(()=>{const i=G.reduce((k,r)=>k+(r.availableQty??0),0).toFixed(2),l=G.reduce((k,r)=>k+(r.assignedQty??0),0).toFixed(2);je(parseFloat(i).toLocaleString()),Ae(parseFloat(l).toLocaleString())},[G]);const Le=[...G,{id:"TOTAL_SUMMARY",componentName:"Total Summary",availableQty:Oe,assignedQty:Ne}],j={sortable:!1,pinnable:!1,hideable:!1},V=[{field:"id",headerName:"Sr#",...j,renderCell:i=>i.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):i.value},{field:"fabricName",headerName:"Fabric",...j},{field:"colorName",headerName:"Color",...j,colSpan:(i,l)=>l.id==="TOTAL_SUMMARY"?2:void 0},{field:"processType",headerName:"Process Type",...j,renderCell:i=>{const l=i.value==="Dyeing"?"primary.dark":i.value==="Printing"?"success.dark":"default";return e.jsx(Ee,{label:i.value,sx:{backgroundColor:l==="primary"||l==="default"?void 0:l,color:l==="primary"||l==="default"?void 0:"white"},color:l==="primary"?"primary":l==="default"?"default":void 0})}},{field:"uom",headerName:" UOM",...j},{field:"poPcs",headerName:" PO PCS.",...j},{field:"availableQty",headerName:"Available Quantitity",...j,valueGetter:i=>i.toLocaleString(),renderCell:i=>i.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:i.value}):i.value},{field:"assignedQty",headerName:"Assigned Qty",...j,valueGetter:i=>i.toLocaleString(),colSpan:(i,l)=>l.id==="TOTAL_SUMMARY"?4:void 0,renderCell:i=>i.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:i.value}):i.value},{field:"AddVendor",headerName:"Add Vendor",...j,renderCell:i=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(st,{variant:"text",size:"small",children:[e.jsx(Fe,{color:"primary",onClick:()=>pe(i.row),children:e.jsx(it,{})}),e.jsx(Fe,{color:"primary",onClick:()=>Se(i.row),children:e.jsx(Ge,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ze,{src:ro,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:m,onChange:Q,size:"small",InputLabelProps:{sx:{color:"black"}},children:C.map(i=>e.jsx(F,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:y.designId,onChange:Q,size:"small",InputLabelProps:{sx:{color:"black"}},children:D.map(i=>e.jsx(F,{value:i.designId,children:i.designNo},i.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:y.batchNo,onChange:Q,size:"small",InputLabelProps:{sx:{color:"black"}},children:f.map(i=>e.jsx(F,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:y.baseColorName,onChange:Q,disabled:!0,sx:i=>({...y.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:y.fabricId,onChange:Q,error:!!Z.fabricId,helperText:Z.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:O.map(i=>e.jsx(F,{value:i.fabricId,children:i.fabric},i.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(_t,{fullWidth:!0,options:Ie,getOptionLabel:i=>i.color||"",renderInput:i=>e.jsx(d,{...i,label:"Color",name:"colorId",size:"small",error:!!Z.colorId,helperText:Z.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:i})=>e.jsx("div",{style:{backgroundColor:"white",boxShadow:"0 3px 5px rgba(0, 0, 0, 0.2)"},children:i}),value:Ie.find(i=>i.colorId===y.colorId)||null,onChange:(i,l)=>{s(k=>({...k,colorId:l?l.colorId:"",color:l?l.color:"",availableQty:l?l.total:"",UOM:l?l.uom:"",uomId:l?l.uomId:"",Shrinkage:l?l.shrinkage:"",Wastage:l?l.wastage:""}))}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:y.processType,onChange:Q,error:!!Z.processType,helperText:Z.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:ge.map(i=>e.jsx(F,{value:i.value,children:i.label},i.value))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:y.poPcs,onChange:Q,disabled:!0,sx:i=>({...y.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:y.UOM,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Available Qty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:y.availableQty,onChange:Q,disabled:!0,sx:i=>({...y.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(he,{variant:"contained",color:"primary",size:"small",onClick:ae,children:"Save"})})]})]}),e.jsx(ue,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(ue,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ge,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(Ue,{iColumns:V,initialRows:Le,setInitialData:t,deleteApi:"http://100.42.177.77:81/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:X,setAccordionExpanded:Me,fileName:"Dyeing&PrintingList",isLoading:$}),e.jsxs(Ke,{open:A,onClose:ke,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(rt,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(xe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Dyeing and Printing > Assign Vendors "}),e.jsx(Fe,{onClick:ke,sx:{color:"#ffffff"},children:e.jsx(lt,{})})]}),e.jsxs($e,{children:[e.jsx(nt,{id:"alert-dialog-slide-description"}),e.jsx(Kt,{initialFormData:ne,setInitialFormData:w,refetchDyeingPrintingData:X,handleClickOpen:pe,showUpperDiv:K})]})]})]})})]})]})},so=no,yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",lo=({initialValues:h})=>{const{user:S}=Qe(),{enqueueSnackbar:$}=Re(),[re,v]=a.useState(!0),[t,y]=a.useState([]),[s,g]=a.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:S.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId});a.useEffect(()=>{g({...s,schiffiliId:t.schiffiliId||0,componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})},[t]);const[n,x]=a.useState(!1),q=(l,k)=>{x(!n)},[m,P]=a.useState(!1),{data:c}=Ye(),[T,u]=a.useState("");a.useEffect(()=>{u(h.collectionId)},[]);const{data:M}=We(),{data:ee,refetch:_}=Xe(T,{skip:!T}),{data:U,refetch:B}=Je(s.designId,{skip:!s.designId}),{data:X}=tt({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:D}=ot({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:L,refetch:f}=wt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:W}=at(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("formData.planningHeaderId",s.planningHeaderId),console.log("collectionData",c),console.log("schiffliList",L);const[O,J]=a.useState([]),[p,z]=a.useState([]),[G,oe]=a.useState([]),[Ie,ce]=a.useState([]),[fe,Me]=a.useState([]),[C,E]=a.useState([]),[Q,Z]=a.useState([]),[le,ae]=a.useState([]),[ge,K]=a.useState([]);a.useEffect(()=>{ee&&J(ee.result)},[ee]),a.useEffect(()=>{U&&z(U.result)},[U]),a.useEffect(()=>{X&&oe(X.result)},[X]),a.useEffect(()=>{D&&Z(X.result)},[D]),a.useEffect(()=>{W&&K(W.result)},[W]),a.useEffect(()=>{L&&(v(!1),ae(L.result.map((l,k)=>({id:k+1,...l}))))},[L,f]),a.useEffect(()=>{if(M){const l=M.result[0];ce(l.vendorList),Me(l.operatingMachineList),E(l.workingHeadList)}},[M]),console.log("initialRows",le);const H=(c==null?void 0:c.result)||[];a.useEffect(()=>{const l=()=>{const N=parseFloat(s.thaanQty)||0,de=parseFloat(s.operatingMachine)||0;return(N*de).toFixed(2)};g(N=>({...N,totalEmbroidry:l()}));const k=()=>{const N=parseFloat(s.thaanQty)||0,de=parseFloat(s.noOfItemPerThaan)||0;return(N*de).toFixed(2)};g(N=>({...N,totalPcs:k()}));const r=()=>{const N=parseFloat(s.noOfStichesPerYard)||0,de=parseFloat(s.rate)||0;return(N/1e3*de).toFixed(2)};g(N=>({...N,amountPerYard:r()}));const b=()=>{const N=parseFloat(s.totalAmount)||0,de=parseFloat(s.totalPcs)||0;return(N/de).toFixed(2)};g(N=>({...N,costPerComponent:b()}));const R=()=>{const N=parseFloat(s.amountPerYard)||0,de=parseFloat(s.totalEmbroidry)||0,I=parseFloat(s.laserCutRate)||0,Y=parseFloat(s.pcsForLaserCut)||0;return(N*de+Y*I).toFixed(2)};g(N=>({...N,totalAmount:R()}))},[s.thaanQty,s.operatingMachine,s.noOfStichesPerYard,s.rate,s.totalAmount,s.totalPcs,s.amountPerYard,s.totalEmbroidry,s.laserCutRate,s.pcsForLaserCut]);const ne=l=>{const{name:k,checked:r}=l.target;g(b=>({...b,[k]:r}))},w=l=>{const{name:k,value:r}=l.target;if(k==="collectionId")H.find(b=>b.collectionId===parseInt(r)),u(r),P(!0),ae([]),v(!0),g({...s,collectionId:r,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(k==="designId"){const b=O.find(R=>R.designId===parseInt(r));ae([]),v(!0),g({...s,designId:r,baseColorId:b?b.colorId:"",baseColorName:b?b.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(k==="batchNo"){const b=p.find(R=>R.batchNo===r);g({...s,batchNo:r,planningHeaderId:b?b.planningHeaderId:"",poPcs:b?b.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),x(!0),P(!1)}else if(k==="colorId"){const b=Q.find(R=>R.colorId===r);g({...s,colorId:r,availableQty:b?b.total:"",cuttingSize:b?b.cuttingSize:"",repeats:b?b.repeats:""})}else if(k==="operatingMachineId"){const b=fe.find(R=>R.lookUpId===r);g({...s,operatingMachineId:r,operatingMachine:b?b.lookUpName:""})}else g({...s,[k]:r})};console.log("colors",Q);const[A,ie]=a.useState({}),pe=async()=>{const l=Se();if(Object.keys(l).length>0){ie(l);return}try{const k=await Pe.post("http://100.42.177.77:81/api/Schiffli/SaveSchiffili",s);console.log("Save response:",k.data),k.data.success?$("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):($(`${k.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",k.data.message)),g(r=>({designId:r.designId,planningHeaderId:r.planningHeaderId,batchNo:r.batchNo,baseColorName:r.baseColorName,schiffiliId:0,componentId:"",poPcs:r.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})),f()}catch(k){console.error("Error saving data:",k),$("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Se=()=>{const l={};return s.fabricId||(l.fabricId="fabricId is required"),s.colorId||(l.colorId="colorId is required"),s.vendorId||(l.vendorId="vendorId is required"),s.componentId||(l.componentId="componentId is required"),s.thaanQty||(l.thaanQty="thaanQty is required"),s.workingHeadId||(l.workingHeadId="workingHeadId is required"),s.rate||(l.rate="rate is required"),s.operatingMachineId||(l.operatingMachineId="operatingMachineId is required"),s.noOfStichesPerYard||(l.noOfStichesPerYard="noOfStichesPerYard is required"),s.noOfItemPerThaan||(l.noOfItemPerThaan="noOfItemPerThaan is required"),l};console.log("formData",s);const[ke,Oe]=a.useState(0),[je,Ne]=a.useState(0),[Ae,Le]=a.useState(0);a.useEffect(()=>{const l=le.reduce((b,R)=>b+(R.totalAmount??0),0).toFixed(2),k=le.reduce((b,R)=>b+(R.totalEmbroidry??0),0).toFixed(2),r=le.reduce((b,R)=>b+(R.totalPcs??0),0).toFixed(2);Oe(parseFloat(l).toLocaleString()),Ne(parseFloat(k).toLocaleString()),Le(parseFloat(r).toLocaleString())},[le]);const j={id:"TOTAL_SUMMARY",fabricName:"Total Summary",totalAmount:ke,totalEmbroidry:je,totalPcs:Ae},V=[...le,j],me=[{field:"id",headerName:"Sr#",colSpan:(l,k)=>k.id==="TOTAL_SUMMARY"?3:void 0,renderCell:l=>l.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):l.value},{field:"fabricName",headerName:"Fabric",colSpan:(l,k)=>k.id==="TOTAL_SUMMARY"?2:void 0,renderCell:l=>l.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):l.value},{field:"componentName",headerName:"Component",renderCell:l=>e.jsx(Ee,{label:l.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:l=>l.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:l.value}):l.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:l=>l.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:l.value}):l.value},{field:"totalAmount",headerName:"Total Amount",renderCell:l=>l.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:l.value}):l.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ze,{src:yt,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:T,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:H.map(l=>e.jsx(F,{value:l.collectionId,children:l.collectionName},l.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(l=>e.jsx(F,{value:l.designId,children:l.designNo},l.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:p.map(l=>e.jsx(F,{value:l.batchNo,children:l.batchNo},l.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:l=>({...s.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(ue,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(mt,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Fe,{onClick:q,sx:{mt:"-18px"},children:e.jsx(De,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(ht,{expanded:n,onChange:q,sx:{},children:[e.jsx(gt,{expandIcon:e.jsx(De,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(bt,{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:w,size:"small",required:!0,error:!!A.componentId,helperText:A.componentId,InputLabelProps:{sx:{color:"black"}},children:ge.map(l=>e.jsx(F,{value:l.componentId,children:l.componentName},l.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:w,required:!0,error:!!A.fabricId,helperText:A.fabricId,InputLabelProps:{sx:{color:"black"}},children:G.map(l=>e.jsx(F,{value:l.fabricId,children:l.fabric},l.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:s.vendorId,onChange:w,required:!0,error:!!A.vendorId,helperText:A.vendorId,InputLabelProps:{sx:{color:"black"}},children:Ie.map(l=>e.jsx(F,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:w,required:!0,error:!!A.colorId,helperText:A.colorId,InputLabelProps:{sx:{color:"black"}},children:Q.map(l=>e.jsx(F,{value:l.colorId,children:l.color},l.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,disabled:!0,onChange:w,sx:l=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:s.availableQty,onChange:w,sx:l=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:s.thaanQty,onChange:w,required:!0,error:!!A.thaanQty,helperText:A.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:s.operatingMachineId,onChange:w,required:!0,error:!!A.operatingMachineId,helperText:A.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:fe.map(l=>e.jsx(F,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:s.workingHeadId,onChange:w,required:!0,error:!!A.workingHeadId,helperText:A.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:C.map(l=>e.jsx(F,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:s.cuttingSize,onChange:w,sx:l=>({...s.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:s.rate,onChange:w,required:!0,error:!!A.rate,helperText:A.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:s.noOfStichesPerYard,onChange:w,required:!0,error:!!A.noOfStichesPerYard,helperText:A.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:s.noOfItemPerThaan,onChange:w,required:!0,error:!!A.noOfItemPerThaan,helperText:A.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:s.totalEmbroidry,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:s.amountPerYard,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:s.totalPcs,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:s.costPerComponent,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:s.totalAmount,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(It,{control:e.jsx(ft,{checked:s.laserCut,onChange:ne,name:"laserCut"}),label:"Laser Cut"})}),s.laserCut?e.jsx(o,{item:!0,xs:12,md:4.5,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(d,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:s.laserCutRate,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(d,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:s.pcsForLaserCut,onChange:w,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(he,{variant:"contained",size:"small",onClick:pe,children:"Save"})})]})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(ue,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ge,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:me,initialRows:V,setInitialData:y,deleteApi:"http://100.42.177.77:81/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:f,setAccordionExpanded:x,fileName:"Schffili List",isLoading:re})})})]})]})},io=lo,co=({additionalProcessData:h,setAdditionalProcessData:S,refetchAdditionalProcessList:$,handleClickOpen:re})=>{const{user:v}=Qe(),[t,y]=a.useState([]),{enqueueSnackbar:s}=Re(),[g,n]=a.useState({}),[x,q]=a.useState([]),m=t.reduce((L,f)=>L+(f.quantity??0),0).toFixed(2);console.log("Quantity",m);const[P,c]=a.useState({additionalProcessDetId:0,additionalProcessId:h.additionalProcessId||0,designId:h.designNo||"",planningHeaderId:h.planningHeaderId||0,batchNo:h.batchNo||"",componentName:h.componentName||"",componentId:h.componentId||"",colorName:h.colorName||"",colorId:h.colorId||"",fabricName:h.fabricName||"",fabricId:h.fabricId||"",uomId:h.uomId||"",uom:h.uom||"",vendorId:"",pcsPerComponent:h.pcsPerComponent||"",remainingPcsPerComponent:h.pcsPerComponent-m||"",processTypeName:h.processTypeName||"",processTypeId:h.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:v.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:v.empId});a.useEffect(()=>{c(L=>({...L,additionalProcessDetId:x.additionalProcessDetId||0,vendorId:(x==null?void 0:x.vendorId)||"",quantity:(x==null?void 0:x.quantity)||"",ratePerPcs:(x==null?void 0:x.ratePerPcs)||"",remainingPcsPerComponent:L.remainingPcsPerComponent+(x==null?void 0:x.quantity)||"",totalAmount:(x==null?void 0:x.totalAmount)||"",costPerComponent:(x==null?void 0:x.costPerComponent)||0,createdOn:(x==null?void 0:x.createdOn)||new Date().toISOString(),createdBy:(x==null?void 0:x.createdBy)||v.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:v.empId}))},[x]),a.useEffect(()=>{c({...P,remainingPcsPerComponent:h.pcsPerComponent-m>=0?h.pcsPerComponent-m:""})},[t,h.pcsPerComponent,m]);const{data:T}=We(),{data:u,refetch:M}=Tt(P.additionalProcessId,{skip:!P.additionalProcessId}),[ee,_]=a.useState([]);a.useEffect(()=>{if(T){const L=T.result[0];_(L.vendorList)}},[T]),a.useEffect(()=>{u&&y(u.result.map((L,f)=>({id:f+1,...L})))},[u,M]),console.log("initialRows",t);const U=L=>{const{name:f,value:W}=L.target;c({...P,[f]:W}),c(O=>{const J={...O,[f]:W};if(f==="quantity"||f==="remainingPcsPerComponent"){const p=J.quantity,z=J.remainingPcsPerComponent;p>z?n(G=>({...G,quantity:"Assigned Quantity cannot be greater than Remaining Quantity"})):n(G=>({...G,quantity:""}))}return J})};a.useEffect(()=>{const L=()=>{const W=parseFloat(P.quantity)||0,O=parseFloat(P.ratePerPcs)||0;return(W*O).toFixed(2)};c(W=>({...W,totalAmount:L()}));const f=()=>{const W=parseFloat(P.totalAmount)||0,O=parseFloat(P.poPcs)||0;return(W/O).toFixed(2)};c(W=>({...W,costPerComponent:f()}))},[P.quantity,P.ratePerPcs,P.totalAmount]);const B=async()=>{if(console.log(P),P.quantity>P.remainingPcsPerComponent){s("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}try{const L=await Pe.post("http://100.42.177.77:81/api/AdditionalProcess/SaveAdditionalProcessDetails",P);console.log("Save response:",L.data),L.data.success?s("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(s(`${L.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",L.data.message)),M(),c(f=>({...f,vendorId:"",pcsPerComponent:h.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",remainingPcsPerComponent:h.pcsPerComponent-m||"",createdOn:new Date().toISOString(),createdBy:v.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:v.empId})),$()}catch(L){console.error("Error saving data:",L),s("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},X=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:2},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Be,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Select Design",name:"designId",value:P.designId,onChange:U,size:"small",disabled:!0,sx:L=>({...P.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:P.batchNo,onChange:U,size:"small",disabled:!0,sx:L=>({...P.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,label:"Components",name:"componentName",value:P.componentName,onChange:U,size:"small",disabled:!0,sx:L=>({...P.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:P.fabricName,onChange:U,disabled:!0,sx:L=>({...P.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:P.colorName,onChange:U,disabled:!0,sx:L=>({...P.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:P.processTypeName,onChange:U,disabled:!0,sx:L=>({...P.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:P.pcsPerComponent,onChange:U,disabled:!0,sx:L=>({...P.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:P.remainingPcsPerComponent,onChange:U,disabled:!0,sx:L=>({...P.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:P.uom,onChange:U,disabled:!0,sx:L=>({...P.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:P.vendorId,onChange:U,disabled:!P.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}},children:ee.map(L=>e.jsx(F,{value:L.lookUpId,children:L.lookUpName},L.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:P.quantity,onChange:U,disabled:!P.remainingPcsPerComponent,error:!!g.quantity,helperText:g.quantity,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:P.ratePerPcs,onChange:U,disabled:!P.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:P.totalAmount,onChange:U,disabled:!P.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(he,{variant:"contained",size:"small",onClick:B,disabled:!P.remainingPcsPerComponent,children:"Save"})})]}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:X,initialRows:t,setInitialData:q,deleteApi:"http://100.42.177.77:81/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:M})})})]})},uo=({initialValues:h})=>{const{user:S}=Qe(),{enqueueSnackbar:$}=Re(),[re,v]=a.useState(!0),[t,y]=a.useState([]),[s,g]=a.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId});console.log("initialData",t),a.useEffect(()=>{g({...s,additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId})},[t]);const[n,x]=a.useState(!1),{data:q}=Ye(),[m,P]=a.useState("");a.useEffect(()=>{P(h.collectionId)},[]);const{data:c}=We(),{data:T,refetch:u}=Xe(m,{skip:!m}),{data:M,refetch:ee}=Je(s.designId,{skip:!s.designId}),{data:_}=tt({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:U}=ot({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:B,refetch:X}=Bt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:D}=at(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("lookupData",c),console.log("collectionData",q),console.log("colorData",U);const[L,f]=a.useState([]),[W,O]=a.useState([]),[J,p]=a.useState([]),[z,G]=a.useState([]),[oe,Ie]=a.useState([]),[ce,fe]=a.useState([]),[Me,C]=a.useState([]),[E,Q]=a.useState([]),[Z,le]=a.useState([]),[ae,ge]=a.useState([]),[K,H]=a.useState([]);console.log("batchData",M);const[ne,w]=a.useState([]);a.useEffect(()=>{q&&w(q.result)},[q]),a.useEffect(()=>{T&&f(T.result)},[T]),a.useEffect(()=>{M&&O(M.result)},[M]),a.useEffect(()=>{_&&p(_.result)},[_]),a.useEffect(()=>{U&&le(U.result)},[U]),a.useEffect(()=>{D&&H(D.result)},[D]),a.useEffect(()=>{if(c){const i=c.result[0];Ie(i.uomList),fe(i.processList)}},[c]),a.useEffect(()=>{B&&(v(!1),ge(B.result.map((i,l)=>({id:l+1,...i}))))},[B,X]),a.useEffect(()=>{if(c){const i=c.result[0];G(i.vendorList),C(i.operatingMachineList),Q(i.workingHeadList)}},[c]),console.log("initialRows",ae);const A=i=>{const{name:l,value:k}=i.target;if(l==="collectionId")ne.find(r=>r.collectionId===parseInt(k)),P(k),ge([]),v(!0),g({...s,collectionId:k,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId});else if(l==="designId"){const r=L.find(b=>b.designId===parseInt(k));ge([]),v(!0),g({...s,designId:k,baseColorId:r?r.colorId:"",baseColorName:r?r.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId})}else if(l==="batchNo"){const r=W.find(b=>b.batchNo===k);g({...s,batchNo:k,planningHeaderId:r?r.planningHeaderId:"",poPcs:r?r.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId}),x(!0)}else g({...s,[l]:k})};console.log("colors",Z);const ie=async()=>{console.log("formData",s);try{const i=await Pe.post("http://100.42.177.77:81/api/AdditionalProcess/SaveAdditionalProcess",s);console.log("Save response:",i.data),i.data.success?$("Process saved successfully!",{variant:"success",autoHideDuration:5e3}):($(`${i.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",i.data.message)),g(l=>({additionalProcessId:0,designId:l.designId,planningHeaderId:l.planningHeaderId,batchNo:l.batchNo,baseColorName:l.baseColorName,poPcs:l.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId})),X()}catch(i){console.error("Error saving data:",i),$("Process not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",s),a.forwardRef(function(l,k){return e.jsx(Ft,{direction:"up",ref:k,...l})});const[pe,Se]=a.useState({}),[ke,Oe]=a.useState(!1),je=i=>{Se(i),Oe(!0)},Ne=()=>{Oe(!1),Se({}),X()},[Ae,Le]=a.useState(0);a.useEffect(()=>{const i=ae.reduce((l,k)=>l+(k.assignedQty??0),0).toFixed(2);Le(parseFloat(i).toLocaleString())},[ae]);const j=[...ae,{id:"TOTAL_SUMMARY",assignedQty:Ae}],V=[{field:"id",headerName:"Sr#",colSpan:(i,l)=>l.id==="TOTAL_SUMMARY"?4:void 0,renderCell:i=>i.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):i.value},{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component",renderCell:i=>e.jsx(Ee,{label:i.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity",colSpan:(i,l)=>l.id==="TOTAL_SUMMARY"?3:void 0,valueGetter:i=>i,renderCell:i=>i.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:i.value}):i.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:i=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(Fe,{color:"primary",onClick:()=>je(i.row),children:e.jsx(it,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ze,{src:yt,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:m,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:ne.map(i=>e.jsx(F,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:L.map(i=>e.jsx(F,{value:i.designId,children:i.designNo},i.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:W.map(i=>e.jsx(F,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:A,disabled:!0,sx:i=>({...s.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(d,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:K.map(i=>e.jsx(F,{value:i.componentId,children:i.componentName},i.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:J.map(i=>e.jsx(F,{value:i.fabricId,children:i.fabric},i.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:Z.map(i=>e.jsx(F,{value:i.colorId,children:i.color},i.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,onChange:A,disabled:!0,sx:i=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(d,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:s.pcsPerComponent,onChange:A,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:s.uomId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:oe.map(i=>e.jsx(F,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:s.processTypeId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:ce.map(i=>e.jsx(F,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(he,{variant:"contained",size:"small",onClick:ie,children:"Save"})})]})]}),e.jsx(ue,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ge,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(Ue,{iColumns:V,initialRows:j,setInitialData:y,deleteApi:"http://100.42.177.77:81/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:X,setAccordionExpanded:x,fileName:"AdditionalProcess",isLoading:re}),e.jsxs(Ke,{open:ke,onClose:Ne,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(rt,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(xe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Additional Process > Assign Vendors "}),e.jsx(Fe,{onClick:Ne,sx:{color:"#ffffff"},children:e.jsx(lt,{})})]}),e.jsxs($e,{children:[e.jsx(nt,{id:"alert-dialog-slide-description"}),e.jsx(co,{additionalProcessData:pe,setAdditionalProcessData:Se,refetchAdditionalProcessList:X,handleClickOpen:je})]})]})]})})]})]})},po=uo;function mo({initialValues:h}){const[S,$]=a.useState(!0),{data:re}=We(),[v,t]=a.useState([]),[y,s]=a.useState([]),[g,n]=a.useState([]),[x,q]=a.useState([]),[m,P]=a.useState([]),[c,T]=a.useState([]),{user:u}=Qe();a.useEffect(()=>{re&&(n(re.result[0].vendorList),s(re.result[0].serviceList),t(re.result[0].serviceTypeList),P(re.result[0].uomList))},[re]);const[M,ee]=a.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()});a.useEffect(()=>{ee({...M,additionalServiceId:c.additionalServiceId||0,collectionId:(c==null?void 0:c.collectionId)||"",serviceTypeId:(c==null?void 0:c.serviceTypeId)||"",serviceListId:(c==null?void 0:c.serviceListId)||"",vendorId:(c==null?void 0:c.vendorId)||"",qty:(c==null?void 0:c.qty)||"",uomId:(c==null?void 0:c.uomId)||"",rate:(c==null?void 0:c.rate)||"",totalAmount:(c==null?void 0:c.totalAmount)||0,UOM:(c==null?void 0:c.uom)||0,uom:(c==null?void 0:c.uom)||"",createdOn:(c==null?void 0:c.createdOn)||new Date().toISOString(),createdBy:(c==null?void 0:c.createdBy)||u.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId})},[c]),a.useEffect(()=>{ee({...M,collectionId:(h==null?void 0:h.collectionId)||""})},[ee]);const _=async p=>{const{name:z,value:G}=p.target;if(console.log(`Updating ${z} to ${G}`),ee({...M,[z]:G}),z==="collectionId"){const oe=x.find(Ie=>Ie.collectionId===G);oe&&ee(Ie=>({...Ie,poPcs:oe.poPcs}))}};a.useEffect(()=>{const p=()=>{const G=parseFloat(M.qty)||0,oe=parseFloat(M.rate)||0;return(G*oe).toFixed(2)};ee(G=>({...G,totalAmount:p()}));const z=()=>{const G=parseFloat(M.poPcs)||0,oe=parseFloat(M.totalAmount)||0;return(G/oe).toFixed(2)};ee(G=>({...G,costperPiece:z()}))},[M.qty,M.rate,M.totalAmount,M.costperPiece]);const U=async()=>{try{const p=await Pe.post("http://100.42.177.77:81/api/AdditionalServices/SaveAdditionalServices",M);console.log("Form data saved:",p.data),ee({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(p){console.error("Error saving data:",p)}};a.useEffect(()=>{(async()=>{try{const z=await Pe.get("http://100.42.177.77:81/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",z),q(z.data.result)}catch(z){console.error("Error fetching design options:",z)}})()},[]);const[B,X]=a.useState([]),D=a.useCallback(async()=>{try{const p=await Pe.get(`http://100.42.177.77:81/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${M.collectionId}`);Array.isArray(p.data.result)?($(!1),X(p.data.result.map((z,G)=>({id:G+1,...z})))):(console.error("API returned unexpected data format:",p.data.result),X([]))}catch(p){console.error("Error fetching data:",p),X([])}},[M.collectionId]);a.useEffect(()=>{D()},[D]);const[L,f]=a.useState(0);a.useEffect(()=>{const p=B.reduce((z,G)=>z+(G.totalAmount??0),0).toFixed(2);f(parseFloat(p).toLocaleString())},[B]);const W=[...B,{id:"TOTAL_SUMMARY",totalAmount:L}],O=[{field:"id",headerName:"Sr#",colSpan:(p,z)=>z.id==="TOTAL_SUMMARY"?4:void 0,renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):p.value},{field:"collectionName",headerName:"Collection Name"},{field:"serviceType",headerName:"Service Type",renderCell:p=>e.jsx(Ee,{label:p.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"serviceListName",headerName:"Service List Name",renderCell:p=>e.jsx(Ee,{label:p.value,sx:{backgroundColor:"success.dark",color:"white"},color:void 0})},{field:"vendor",headerName:"Vendor"},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount",colSpan:(p,z)=>z.id==="TOTAL_SUMMARY"?3:void 0,renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:p.value}):p.value},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:M.collectionId,onChange:_,size:"small",InputLabelProps:{sx:{color:"black"}},children:x.length>0?x.map(p=>e.jsx(F,{id:"collectionId",value:p.collectionId,children:p.collectionName},p.collectionId)):e.jsx(F,{disabled:!0,children:"No Collections Available"})})}),e.jsx(o,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:M.serviceTypeId,onChange:_,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:v.map(p=>e.jsx(F,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(o,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:M.serviceListId,onChange:_,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:y.map(p=>e.jsx(F,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:M.vendorId,onChange:_,InputLabelProps:{sx:{color:"black"}},children:g.map(p=>e.jsx(F,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:M.poPcs,onChange:_,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:p=>({...M.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-required",label:"Qty",name:"qty",value:M.qty,onChange:_,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(d,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:M.uomId,onChange:_,InputLabelProps:{sx:{color:"black"}},children:m.map(p=>e.jsx(F,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-required",label:"Rate",name:"rate",value:M.rate,onChange:_,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:M.totalAmount,onChange:_,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(d,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:M.costperPiece,onChange:_,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(he,{variant:"contained",color:"primary",size:"small",onClick:U,children:"Save"})})]})]}),e.jsx(ue,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Ue,{iColumns:O,initialRows:W,isLoading:S,setInitialData:T,deleteApi:"http://100.42.177.77:81/api/AdditionalServices/DeleteAdditionalProcess?servicesId=",refetch:D,deleteBy:"additionalServiceId"})]})]})}Qt(Rt)(({theme:h})=>({backgroundColor:h.palette.primary.main,color:h.palette.primary.light,overflow:"hidden",position:"relative","&:after":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(210.04deg, ${h.palette.grey[400]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,borderRadius:"50%",top:-30,right:-180},"&:before":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(140.9deg, ${h.palette.grey[400]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,borderRadius:"50%",top:-160,right:-130}}));const ho=({initialValues:h,setActiveStep:S,collectionId:$,setInitialValues:re})=>{var ke,Oe,je,Ne,Ae,Le;const{user:v}=Qe(),{enqueueSnackbar:t}=Re();a.useState([]);const{data:y}=Ye(),[s,g]=a.useState(null),[n,x]=a.useState(!1);et();const[q,m]=a.useState(!1),[P,c]=a.useState($||""),[T,u]=a.useState({designId:"",planningHeaderId:"",batchNo:"",distinctId:"",collectionBatchId:"",collectionId:P||""}),M=j=>{pe.current&&pe.current.autosizeColumns&&pe.current.autosizeColumns({includeOutliers:!0,includeHeaders:!0})},[ee,_]=a.useState([]),U=j=>{_(j),console.log("New Selection:",j)},{data:B,refetch:X}=Wt(P,{skip:!P}),[D,L]=a.useState([]),[f,W]=a.useState([]),[O,J]=a.useState([]);console.log("distinctData",B),a.useEffect(()=>{y&&J(y.result)},[y]),a.useEffect(()=>{B&&(console.log("Distinct Data:",B.result),W(B||[]))},[B]);const p=j=>{const{name:V,value:me}=j.target;if(console.log(`handleChange called with name: ${V}, value: ${me}`),V==="collectionId")c(me),u({...T,collectionId:me,collectionBatchId:""}),X($);else if(V==="collectionBatchId")u({...T,collectionBatchId:me,planningHeaderId:T.planningHeaderId});else{const i={...T,[V]:me};u(i)}},{data:z,refetch:G}=zt({collectionId:T.collectionId,collectionBatchId:T.collectionBatchId},{skip:!T.collectionId||!T.collectionBatchId});a.useEffect(()=>{z&&z.length>0&&L(z)},[z]),console.log("Selected collection ID:",P),console.log("distinctCollectionList data:",f);const oe=async j=>{x(!0);try{console.log("Fetching Summary Data for ID:",j);const V=await Pe.get(`http://100.42.177.77:81/api/PrePlanning/GetPrePlanningSummaryByBatchId?planningHeaderId=${j}`);V.data.success?g(V.data.result):console.error(V.data.message)}catch(V){console.error("Failed to fetch summary data",V)}finally{x(!1)}};console.log("formData",T);const Ie=j=>{console.log("Selected PlanningHeaderId:",j),oe(j),m(!0)},ce=()=>{m(!1)},fe=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"planningProcessTypeName",headerName:"Process Type"},{field:"componentsCount",headerName:"Components Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalFabricSum",headerName:"Total Fabric Sum"},{field:"totalFabricRequiredSum",headerName:"Total Fabric Required Sum"}],Me=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalExcGst",headerName:"Total Excluding GST"},{field:"totalIncGst",headerName:"Total Including GST"}],C=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"processType",headerName:"Process Type"},{field:"assignedQtySum",headerName:"Assigned Qty Sum"},{field:"availableQtySum",headerName:"Available Qty Sum"},{field:"colorCount",headerName:"Color Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"outputQtySum",headerName:"Output Qty Sum"},{field:"totalIncGst",headerName:"Total Including GST"}],E=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150},{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150},{field:"requiredPcsSum",headerName:"Required Pcs Sum",width:150},{field:"totalAmountSum",headerName:"Total Amount Sum",width:150}],Q=[{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"totalPcsSum",headerName:"Total Pcs Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150}],Z=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"pcsPerComponent",headerName:"Pcs Per Component",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150}],le=[{field:"planningHeaderId",headerName:"ID"},{field:"orderNumber",headerName:"Order Number"},{field:"collectionName",headerName:"Collection Name"},{field:"batchNo",headerName:"Batch No"},{field:"designNo",headerName:"Design No"},{field:"designerName",headerName:"Designer Name"},{field:"colorName",headerName:"Color Name"},{field:"poPcs",headerName:"PO Pieces"},{field:"batchStatus",headerName:"Batch Status"},{field:"planningDate",headerName:"Planning Date"},{field:"action",headerName:"Action",renderCell:j=>e.jsx(st,{variant:"outlined",size:"small","aria-label":"outlined primary button group",children:e.jsx(he,{onClick:()=>Ie(j.row.planningHeaderId),children:"View"})}),sortable:!1,filterable:!1}],[ae,ge]=a.useState([]);a.useEffect(()=>{const j=(D==null?void 0:D.map((V,me)=>({id:V.planningHeaderId||me,...V})))||[];ge(j)},[D]);const K=((ke=s==null?void 0:s.prePlanningList)==null?void 0:ke.map((j,V)=>({id:V,...j})))||[],H=((Oe=s==null?void 0:s.fabricationList)==null?void 0:Oe.map((j,V)=>({id:V,...j})))||[],ne=((je=s==null?void 0:s.dyeingPrintingList)==null?void 0:je.map((j,V)=>({id:V,...j})))||[],w=((Ne=s==null?void 0:s.embroideryList)==null?void 0:Ne.map((j,V)=>({id:V,...j})))||[],A=((Ae=s==null?void 0:s.schiffiliList)==null?void 0:Ae.map((j,V)=>({id:V,...j})))||[],ie=((Le=s==null?void 0:s.additionalProcessList)==null?void 0:Le.map((j,V)=>({id:V,...j})))||[],pe=Gt(),Se=async()=>{if(ee.length===0){t("No rows selected",{variant:"warning"});return}const V={planningHeaderId:ee,collectionBatchId:T.collectionBatchId,createdBy:v.empId,batchStatus:3};try{const me=await Pe.get("http://100.42.177.77:81/api/PrePlanning/FinalizePrePlanningBatch",V);me.data.success?(t("Data saved successfully",{variant:"success"}),console.log("requestbody",V)):t(me.data.message,{variant:"error"})}catch(me){console.error("Failed to save data",me),console.log("requestbody",V),t("Failed to save data",{variant:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:T.collectionId,onChange:p,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(j=>e.jsx(F,{value:j.collectionId,children:j.collectionName},j.collectionId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(d,{fullWidth:!0,select:!0,label:"Select Collection Batch",name:"collectionBatchId",value:T.collectionBatchId,onChange:p,size:"small",InputLabelProps:{sx:{color:"black"}},children:f.length>0?f.map(j=>e.jsx(F,{value:j.collectionBatchId,children:j.distinctId},j.collectionBatchId)):e.jsx(F,{disabled:!0,children:"No batches available"})})}),e.jsx(o,{item:!0,xs:4,textAlign:"right",sx:{mt:1},children:e.jsx(he,{variant:"contained",size:"small",onClick:Se,color:"success",children:"Finalize"})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,mb:1}),e.jsxs(ve,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"inherit",sx:{paddingY:1,paddingX:1},children:[e.jsx(o,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(qe,{rows:ae,columns:le,checkboxSelection:!0,getRowId:j=>j.id,disableRowSelectionOnClick:!0,autosizeOnMount:!0,apiRef:pe,onStateChange:M,onRowSelectionModelChange:j=>U(j)})}),e.jsxs(Ke,{open:q,onClose:ce,maxWidth:"lg",fullWidth:!0,children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsx($e,{children:n?e.jsx(Be,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(ct,{})}):s?e.jsxs(e.Fragment,{children:[e.jsx(xe,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(0),children:"Pre Planning"}),e.jsx(qe,{rows:K,columns:fe,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,onStateChange:M,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ue,{color:"#921e22",sx:{height:3,width:"100%",mb:1}}),e.jsx(xe,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(1),children:"Fabrication"}),e.jsx(qe,{rows:H,columns:Me,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%",mt:1,mb:1}}),e.jsx(xe,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(2),children:"Dyeing"}),e.jsx(qe,{rows:ne,columns:C,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(xe,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(3),children:"Embroidery"}),e.jsx(qe,{rows:w,columns:E,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(xe,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(4),children:"Schiffli"}),e.jsx(qe,{rows:A,columns:Q,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ue,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(xe,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(5),children:"Additional Process"}),e.jsx(qe,{rows:ie,columns:Z,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}})]}):e.jsx(ct,{})}),e.jsx(Yt,{children:e.jsx(he,{onClick:ce,children:"Close"})})]})]})]})]})},pt=ho,_e=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services","Summary"];function So(){const[h,S]=a.useState(0),[$,re]=a.useState(new Set),[v,t]=a.useState(null),[y,s]=a.useState([]),{enqueueSnackbar:g}=Re(),{data:n,refetch:x}=We(),[q,m]=a.useState({});console.log("initialValues",q);const P=O=>{t(O.currentTarget)},c=()=>{t(null)},T=!!v,u=T?"simple-popover":void 0,M=O=>O===1,ee=O=>$.has(O),_=()=>{let O=$;ee(h)&&(O=new Set(O.values()),O.delete(h)),S(J=>J+1),re(O)},U=()=>{S(O=>O-1)},B=()=>{if(!M(h))throw new Error("You can't skip a step that isn't optional.");S(O=>O+1),re(O=>{const J=new Set(O.values());return J.add(h),J})},X=()=>{S(0)},[D,L]=a.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),f=async()=>{if(!D.lookUpDomain||!D.lookUpName){g("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const O=await Pe.get(`http://100.42.177.77:81/api/Common/SaveLookUp?lookupDomain=${D.lookUpDomain}&LookUpName=${D.lookUpName}&appId=1`);return console.log("Form data saved:",O.data),g("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),L({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),x(),O.data}catch(O){throw console.error("Error saving data:",O),g("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),O}},W=O=>{L({...D,[O.target.name]:O.target.value})};return a.useEffect(()=>{(async()=>{try{const J=await Pe.get("http://100.42.177.77:81/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",J),s(J.data.result)}catch(J){console.error("Error fetching design options:",J)}})()},[]),e.jsxs(Be,{sx:{width:"100%"},children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,sm:6,children:e.jsx(xe,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(o,{item:!0,sm:6,textAlign:"right",children:[e.jsx(he,{"aria-describedby":u,variant:"outlined",size:"small",onClick:P,children:"+Lookup"}),e.jsx(Xt,{id:"mouse-over-popover",open:T,anchorEl:v,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(o,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(o,{item:!0,sm:12,children:e.jsx(d,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:D.lookUpDomain,name:"lookUpDomain",onChange:W,children:y.map(O=>e.jsx(F,{value:O.lookUpDomain,children:O.lookUpDomain},O.lookUpDomain))})}),e.jsx(o,{item:!0,sm:12,children:e.jsx(d,{fullWidth:!0,label:"Add Lookup Description",value:D.lookUpName,onChange:W,name:"lookUpName",size:"small"})}),e.jsx(o,{item:!0,sm:3,textAlign:"right",children:e.jsx(he,{variant:"contained",size:"small",onClick:f,children:"Save"})})]})})]})]}),e.jsx(Ut,{activeStep:h,children:_e.map((O,J)=>{const p={},z={};return M(J)&&(z.optional=e.jsx(xe,{variant:"caption"})),ee(J)&&(p.completed=!1),e.jsx(Ht,{...p,children:e.jsxs(qt,{...z,onClick:()=>S(J),style:{cursor:"pointer"},children:[" ",O]})},O)})}),e.jsxs(Be,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(he,{color:"inherit",disabled:h===0,onClick:U,sx:{mr:1},children:"Back"}),e.jsx(Be,{sx:{flex:"1 1 auto"}}),M(h)&&e.jsx(he,{color:"inherit",onClick:B,sx:{mr:1},children:"Skip"}),e.jsx(he,{onClick:_,children:h===_e.length-1?"Finish":"Next"})]}),h===_e.length?e.jsxs(a.Fragment,{children:[e.jsx(pt,{setActiveStep:S}),e.jsxs(Be,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Be,{sx:{flex:"1 1 auto"}}),e.jsx(he,{onClick:X,children:"Reset"})]})]}):e.jsxs(a.Fragment,{children:[h===0&&e.jsx(ao,{setInitialValues:m,initialValues:q}),h===1&&e.jsx(Et,{setInitialValues:m,initialValues:q}),h===2&&e.jsx(so,{initialValues:q}),h===3&&e.jsx(to,{initialValues:q}),h===4&&e.jsx(io,{initialValues:q}),h===5&&e.jsx(po,{initialValues:q}),h===6&&e.jsx(mo,{initialValues:q}),h===7&&e.jsx(pt,{setActiveStep:S,setInitialValues:m,initialValues:q}),e.jsxs(Be,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(he,{color:"inherit",disabled:h===0,onClick:U,sx:{mr:1},children:"Back"}),e.jsx(Be,{sx:{flex:"1 1 auto"}}),M(h)&&e.jsx(he,{color:"inherit",onClick:B,sx:{mr:1},children:"Skip"}),e.jsx(he,{onClick:_,children:h===_e.length-1?"Finish":"Next"})]})]})]})}export{So as default};
