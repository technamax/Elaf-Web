import{r as j,l as _,j as o,A as O,_ as B,Z as K,u as Q,B as X}from"./index-DnIh2Wd7.js";import{r as m}from"./vendor-BXCbSo2_.js";import{u as Y,G as h,d as ee,a as oe,D as te,b as re,E as ae,c as se}from"./ExcelExport-DdhRZJhP.js";import{d as le}from"./Close-ec_L8JKK.js";import{B as de,a as N}from"./axios-DRu-V1sv.js";import"./dayjs.min-DO4_1a-m.js";import{M as ne}from"./Skeleton-CxEcuNdD.js";var g={},ie=_;Object.defineProperty(g,"__esModule",{value:!0});var ce=g.default=void 0,ue=ie(j()),fe=o;ce=g.default=(0,ue.default)((0,fe.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");var D={},he=_;Object.defineProperty(D,"__esModule",{value:!0});var me=D.default=void 0,ve=he(j()),xe=o;me=D.default=(0,ve.default)((0,xe.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddCircle");var $={},pe=_;Object.defineProperty($,"__esModule",{value:!0});var z=$.default=void 0,Ce=pe(j()),we=o;z=$.default=(0,Ce.default)((0,we.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var P={},Me=_;Object.defineProperty(P,"__esModule",{value:!0});var q=P.default=void 0,je=Me(j()),_e=o;q=P.default=(0,je.default)((0,_e.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");const be=["label","icon","showInMenu","onClick"],Re=["label","icon","showInMenu","onClick","closeMenuOnClick","closeMenu"],M=m.forwardRef((a,v)=>{var C;const x=Y();if(!a.showInMenu){const{label:s,icon:n,onClick:d}=a,i=O(a,be),E=I=>{d==null||d(I)};return o.jsx(x.slots.baseIconButton,B({ref:v,size:"small",role:"menuitem","aria-label":s},i,{onClick:E},(C=x.slotProps)==null?void 0:C.baseIconButton,{children:m.cloneElement(n,{fontSize:"small"})}))}const{label:b,icon:p,onClick:u,closeMenuOnClick:R=!0,closeMenu:f}=a,k=O(a,Re),S=s=>{u==null||u(s),R&&(f==null||f())};return o.jsxs(ne,B({ref:v},k,{onClick:S,children:[p&&o.jsx(K,{children:p}),b]}))});function $e({initialRows:a,ncolumns:v,formData:x,deleteApi:b,disableDelete:p,deleteBy:u,editAPi:R,disableEdit:f,disableAddRecord:k,refetch:S}){const{user:C}=Q(),[s,n]=m.useState(a),[d,i]=m.useState({});m.useEffect(()=>{n(a)},[a]);function E(e){const{setRows:r,setRowModesModel:t}=e,l=()=>{const w=s.length+1,y={id:w,...x,isNew:!0};r(c=>[...c,y]),t(c=>({...c,[w]:{mode:h.Edit,fieldToFocus:"collectionName"}}))};return o.jsxs(re,{sx:{justifyContent:"space-between"},children:[o.jsx(de,{color:"primary",startIcon:o.jsx(z,{}),onClick:l,disabled:k,disab:!0,children:"Add record"}),o.jsx(ae,{data:a,fileName:"collection"})]})}const I=(e,r)=>{e.reason===se.rowFocusOut&&(r.defaultMuiPrevented=!0)},V=e=>()=>{i({...d,[e]:{mode:h.Edit}})},F=e=>async()=>{const t=s.find(l=>l.id===e)[u];try{await N.delete(`${b}${t}`),n(s.filter(l=>l.id!==e))}catch(l){console.error("Error deleting data:",l)}},T=e=>()=>{i({...d,[e]:{mode:h.View,ignoreModifications:!0}}),s.find(t=>t.id===e).isNew&&n(s.filter(t=>t.id!==e))},U=async(e,r)=>{console.log("newRow",e);try{const{id:t,...l}=e;console.log("formattedRow",l);const w={lastUpdatedBy:C.empId,lastUpdatedOn:new Date().toISOString()},y={...l,...w},c=await N.post(R,y),A={...c.data.result,id:e.id};return n(J=>J.map(G=>G.id===e.id?A:G)),console.log("response.data:",c.data),A;S()}catch(t){throw console.error("Error updating data:",t),t}},H=e=>{i(e)},L=e=>async()=>{i(r=>({...r,[e]:{mode:h.View}}))},W=[...v,{field:"actions",type:"actions",headerName:"Actions",width:100,cellClassName:"actions",getActions:({id:e})=>{var t;return((t=d[e])==null?void 0:t.mode)===h.Edit?[o.jsx(M,{icon:o.jsx(q,{}),label:"Save",sx:{color:"primary.main"},onClick:L(e)}),o.jsx(M,{icon:o.jsx(le,{}),label:"Cancel",className:"textPrimary",onClick:T(e),color:"inherit",sx:{color:"error.dark"}})]:[o.jsx(M,{icon:o.jsx(ee,{}),label:"Edit",className:"textPrimary",onClick:V(e),color:"inherit",sx:{color:"secondary.dark"},disabled:f}),o.jsx(M,{icon:o.jsx(oe,{}),label:"Delete",onClick:F(e),color:"inherit",sx:{color:"error.dark"},disabled:p})]}}],Z=(e,r)=>{r.defaultMuiPrevented=!0};return o.jsx(X,{sx:{height:500,width:"inherit","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}},children:o.jsx(te,{sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)"},rows:s,columns:W,editMode:"row",rowModesModel:d,onRowModesModelChange:H,onRowEditStop:I,processRowUpdate:U,slots:{toolbar:E},slotProps:{toolbar:{setRows:n,setRowModesModel:i}},getRowId:e=>e.id,onCellDoubleClick:Z})})}export{$e as F,ce as a,me as d};
