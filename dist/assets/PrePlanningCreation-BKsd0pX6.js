import{u as p,c as k,r as a,b as R,j as e,C as W,d as z,B as C,G as o,T as I,M}from"./index-CqwCPNYa.js";import{a as i}from"./axios-KgIAJknq.js";import{F as $}from"./EditAbleDataGrid-CK0_d68Y.js";import{T as A,a as O,b as f,d as Q,c as _,e as j}from"./AddCircle-BWYXlaUy.js";import{T as r,B as q}from"./TextField-DipHsdrY.js";import{M as c}from"./Skeleton-DgEYGL6M.js";const te=()=>{const{data:V,error:X,isLoading:J,refetch:b}=p(),{data:d}=p();k(),a.useState(!0);const{enqueueSnackbar:y}=R(),P=(d==null?void 0:d.result)||[],[l,h]=a.useState({collectionName:"",collectionId:"",plannedCollectionId:"",plannedDesignedId:"",designId:"",poPcs:"",batchNo:"",createdBy:0,createdOn:new Date().toISOString()}),[v,D]=a.useState([]),[m,S]=a.useState([]),[B,G]=a.useState([]),[N,x]=a.useState([]),g=a.useCallback(async()=>{try{const n=await i.get(`https://gecxc.com:4041/api/PrePlanning/GetPlanningHeaderListByDesignId?designId=${l.plannedDesignedId}`);console.log("DataGridResponse",n);const t=n.data.result.map((u,L)=>({...u,id:L+1}));x(t)}catch(n){console.error("Error fetching data:",n),x([])}},[l.plannedDesignedId]);a.useEffect(()=>{g()},[g]);const w=[{field:"collectionName",headerName:"Collection",editable:!0,flex:2},{field:"batchNo",headerName:"Batch#",flex:1,editable:!0},{field:"designNo",headerName:"Design Number",flex:1,editable:!0},{field:"Status",headerName:"Status",flex:1,editable:!0}],[F,H]=a.useState("1"),T=(n,t)=>{H(t)},s=async n=>{const{name:t,value:u}=n.target;h({...l,[t]:u})},E=async()=>{console.log(l);try{const n=await i.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanningHeader",l);console.log("Form data saved:",n.data),y("Planning Batch saved successfully!",{variant:"success",autoHideDuration:5e3}),h({collectionName:"",collectionId:"",designId:"",poPcs:"",batchNo:""}),b()}catch(n){console.error("Error saving data:",n)}};return a.useEffect(()=>{(async()=>{if(l.collectionId)try{const t=await i.get(`https://gecxc.com:4041/API/DesignRegistration/GetDesignListByCollectionId?CollectionId=${l.collectionId}`);console.log(l.collectionId),console.log(t),D(t.data.result)}catch(t){console.error("Error fetching design options:",t)}})()},[l.collectionId]),a.useEffect(()=>{(async()=>{try{const t=await i.get("https://gecxc.com:4041/api/PrePlanning/GetCollectionFromPlanningHeader");console.log("GetCollectionFromPlanningHeader",t),S(t.data.result)}catch(t){console.error("Error fetching design options:",t)}})()},[]),a.useEffect(()=>{(async()=>{if(l.plannedCollectionId)try{const t=await i.get(`https://gecxc.com:4041/api/PrePlanning/GetDesignFromPlanningHeaderByCollectionId?collectionid=${l.plannedCollectionId}`);console.log("GetDesignFromPlanningHeaderByCollectionId",t),G(t.data.result)}catch(t){console.error("Error fetching design options:",t)}})()},[l.plannedCollectionId]),console.log("formData",l),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:10,borderRadius:7,width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto",padding:5},children:e.jsxs(W,{variant:"outlined",children:[e.jsx(z,{style:{backgroundColor:"#a31f23",color:"white"},title:"Create Batch Planning",titleTypographyProps:{style:{color:"white"}}}),e.jsx(C,{sx:{width:"100%",typography:"body1"},children:e.jsxs(A,{value:F,children:[e.jsx(C,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(O,{onChange:T,"aria-label":"lab API tabs example",children:[e.jsx(f,{icon:e.jsx(Q,{}),label:"Add Collection",value:"1",sx:n=>({"& .MuiTouchRipple-child":{backgroundColor:`${n.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(_,{}),label:"Search Collection",value:"2",sx:n=>({"& .MuiTouchRipple-child":{backgroundColor:`${n.palette.primary.main} !important`}})})]})}),e.jsx(j,{value:"1",children:e.jsxs(o,{container:!0,spacing:2,width:"inherit",sx:{paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:l.collectionId,onChange:s,size:"small",children:P.map(n=>e.jsx(c,{value:n.collectionId,children:n.collectionName},n.collectionId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:s,size:"small",children:v.map(n=>e.jsx(c,{value:n.designId,children:n.designNo},n.designId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Po PCs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:s})}),e.jsx(o,{item:!0,xs:12,md:12,textAlign:"right",sx:{marginBottom:2},children:e.jsx(q,{variant:"contained",size:"small",onClick:E,children:"Save"})})]})}),e.jsx(j,{value:"2",children:e.jsx(o,{container:!0,spacing:2,width:"inherit",children:e.jsx(o,{item:!0,xs:9,md:9,children:e.jsx(I,{variant:"h3",gutterBottom:!0,children:"Search Collection"})})})})]})})]})}),e.jsx(M,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23"},children:e.jsxs(o,{container:!0,spacing:2,width:"inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(I,{variant:"h4",gutterBottom:!0,children:"Search"})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"plannedCollectionId",value:l.plannedCollectionId,onChange:s,size:"small",children:m.length>0?m.map(n=>e.jsx(c,{id:"ddlCollection",value:n.collectionId,children:n.collectionName},n.planningHeaderId)):e.jsx(c,{disabled:!0,children:"No Collections Available"})})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Design",name:"plannedDesignedId",value:l.plannedDesignedId,onChange:s,size:"small",children:B.map(n=>e.jsx(c,{value:n.designId,children:n.designNo},n.planningHeaderId))})}),e.jsx(o,{item:!0,xs:12,paddingTop:1,children:e.jsx($,{initialRows:N,ncolumns:w,formData:l,fetchData:g})})]})})]})};export{te as default};
