import{j as e,_ as it,r as dt,i as ct,u as Oe,b as Se,a5 as ut,B as je,G as a,T as pe,D as ce,S as _e,c as Le,a6 as pt,a7 as Be,a8 as Te,a9 as We,aa as Ue,ab as qe,ac as mt,ad as Ee,C as me,d as he,ae as He,af as ht,ag as gt,ah as bt,ai as It,aj as xt,ak as ft,al as yt,am as Ct}from"./index-CHPntchW.js";import{r as o}from"./vendor-BXCbSo2_.js";import{B as de,a as ge,I as ke}from"./axios-BZa4OVGw.js";import{d as $e,c as ze,A as et,e as tt,f as at,S as vt,a as Pt,b as Mt,F as jt}from"./Fabrication-C9E-VY9z.js";import{R as Ne,d as Ae,D as Ge,a as Ye,b as Xe,c as Ve,B as ot}from"./ReuseableDataGrid-BVWn1bZO.js";import{d as De}from"./Close-D23vg8fu.js";import{d as Je}from"./PersonAddAlt1Outlined-IPLIULT2.js";import{T as n,P as kt}from"./TextField-BphhxPl1.js";import{M as k}from"./Skeleton-CAX52mm3.js";import{A as we,F as st,C as nt}from"./ExcelExport-CdBYHEuR.js";import"./dayjs.min-DO4_1a-m.js";let Ke=!1;const St=o.forwardRef(function(_,U){return Ke||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),Ke=!0),e.jsx(we,it({ref:U},_))});var Ze={},Ot=ct;Object.defineProperty(Ze,"__esModule",{value:!0});var rt=Ze.default=void 0,Nt=Ot(dt()),Lt=e;rt=Ze.default=(0,Nt.default)((0,Lt.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const At="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",Bt=({initialFormData:c,setAdditionalProcessData:_,refetchDyeingPrintingData:U,handleClickOpen:m,showUpperDiv:t})=>{const{user:f}=Oe(),[s,h]=o.useState([]),u=s.reduce((x,g)=>x+(g.assignedQty??0),0).toFixed(2);console.log("Quantity",u);const[i,w]=o.useState({dpIdDet:0,dpId:c.dpId||0,designId:c.designId||"",batchNo:c.batchNo||"",planningHeaderId:c.planningHeaderId||0,fabricId:c.fabricId||"",colorId:c.colorId||"",colorName:c.colorName||"",vendorId:"",processType:c.processType||"",availableQty:c.availableQty||"",remainingQty:c.availableQty-u||"",shrinkage:"",wastage:"",uomId:c.uomId||"",uom:c.uom||"",poPcs:c.poPcs||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:f.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:f.empId});o.useEffect(()=>{w({...i,remainingQty:c.availableQty-u||""})},[s]);const{data:E}=Se(),{data:p,refetch:y}=ut(i.dpId,{skip:!i.dpId}),[q,X]=o.useState([]);o.useEffect(()=>{if(E){const x=E.result[0];X(x.vendorList)}},[E]),o.useEffect(()=>{p&&h(p.result.map((x,g)=>({id:g,...x})))},[p,y]),console.log("initialRows",s);const M=x=>{const{name:g,value:S}=x.target;w({...i,[g]:S})};o.useEffect(()=>{const x=()=>{const re=parseFloat(i.availableQty)||0,se=parseFloat(i.shrinkage)||0,be=parseFloat(i.wastage)||0;return(re*(100-(se+be))/100).toFixed(2)},g=()=>{const re=parseFloat(i.assignedQty)||0,se=parseFloat(i.rate)||0;return(re*se).toFixed(2)},S=(re,se)=>(re*(1+se/100)).toFixed(2),T=x(),G=g(),b=parseFloat(i.gst)||0,Y=S(G,b),oe=parseFloat(i.poPcs)||0,ne=oe?Y/oe:0;w(re=>({...re,outputQty:T,totalExcGst:G,TotalIncludingGst:Y,unitRatePerPo:ne.toFixed(2)}))},[i.availableQty,i.shrinkage,i.wastage,i.rate,i.gst,i.poPcs,i.unitRatePerPo]),console.log("formData",i);const te=async()=>{console.log(i);try{const x=await ge.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrintingDetails",i);console.log("Save response:",x.data),w(g=>({...g,dpIdDet:0,vendorId:"",availableQty:c.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:f.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:f.empId})),y(),U()}catch(x){console.error("Error saving data:",x)}},V=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:x=>x.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:x=>x.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:x=>x.toLocaleString()},{field:"unitRatePerPo",headerName:"unitRatePerPo.",flex:1}];return e.jsxs(je,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!t,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"Fabric",name:"fabricName",value:i.fabricName,onChange:M,size:"small",disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Process Type",name:"processType",value:i.processType,onChange:M,size:"small",disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"Color",name:"colorName",value:i.colorName,onChange:M,size:"small",disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"UOM",name:"uom",value:i.uom,onChange:M,size:"small",disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:i.poPcs,onChange:M,disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:i.availableQty,onChange:M,disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:i.remainingQty,onChange:M,disabled:!0,sx:x=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:i.vendorId,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}},children:q.map(x=>e.jsx(k,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:i.assignedQty,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:i.rate,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:i.shrinkage,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:i.wastage,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:i.outputQty,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:i.totalExcGst,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:i.gst,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:i.TotalIncludingGst,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:i.unitRatePerPo,onChange:M,disabled:!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(de,{variant:"contained",size:"small",onClick:te,children:"Save"})})]})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ne,{iColumns:V,initialRows:s,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:y,disableEdit:!0})})]})]})},Tt=({initialFormData:c,setAdditionalProcessData:_,refetchDyeingPrintingData:U,handleClickOpen:m,showUpperDiv:t})=>{const f=_e(),{enqueueSnackbar:s}=Le(),{user:h}=Oe(),[u,i]=o.useState([]),w=u.reduce((C,z)=>C+(z.assignedQty??0),0).toFixed(2);console.log("Quantity",w);const E=u.reduce((C,z)=>C+(z.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",E);const[p,y]=o.useState({embroideryIdDet:0,embroideryId:c.embroideryId||0,designId:c.designId||"",batchNo:c.batchNo||"",planningHeaderId:c.planningHeaderId||0,componentId:c.componentId||"",componentName:c.componentName||"",fabricId:c.fabricId||"",fabricName:c.fabricName||"",vendorId:"",colorId:c.colorId||"",colourName:c.colourName||"",availableQty:c.availableQty||"",assignedQty:"",remainingQty:(c.availableQty-w).toFixed(2)||0,noOfHead:c.noOfHead||"",noOfHeadsName:c.noOfHeadsName||"",repeats:c.repeats||"",assignedRepeats:"",remainingRepeats:c.repeats-E||"",cuttingSize:c.cuttingSize||"",itemsPerRepeat:c.itemsPerRepeat||"",poPcs:c.poPcs||"",totalPcs:c.totalPcs||"",remainingPcs:(c.totalPcs-E).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:h.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:h.empId}),q=["Boring","Pooni","Laser","Doori","Dissolving"];function X(C,z,K){return{fontWeight:z.indexOf(C)===-1?K.typography.fontWeightRegular:K.typography.fontWeightMedium}}o.useEffect(()=>{y({...p,remainingQty:c.availableQty-w||0,remainingPcs:c.totalPcs-E||0})},[u]);const{data:M}=Se(),{data:te,refetch:V}=pt(p.embroideryId,{skip:!p.embroideryId}),[J,x]=o.useState([]);o.useEffect(()=>{if(M){const C=M.result[0];x(C.vendorList)}},[M]),o.useEffect(()=>{te&&i(te.result.map((C,z)=>({id:z,...C})))},[te,V]),console.log("initialRows",u);const g=C=>{const{name:z,value:K}=C.target;y({...p,[z]:K})},S=C=>{const{name:z,checked:K}=C.target;y(le=>({...le,[z]:K}))};console.log("formData",p);const[T,G]=o.useState(null),[b,Y]=o.useState(p);o.useEffect(()=>{const C=setTimeout(()=>{Y(p)},50);return()=>{clearTimeout(C)}},[p]),o.useEffect(()=>{const C=()=>{const F=parseFloat(b.repeats)||0,D=parseFloat(b.itemsPerRepeat)||0;return(F*D).toFixed(2)},z=()=>{const F=parseFloat(b.threadStiches)||0,D=parseFloat(b.threadRate)||0,W=parseFloat(b.noOfHead)||0,O=parseFloat(b.repeats)||0;return(F/1e3*(D*O*W)).toFixed(2)},K=()=>{const F=parseFloat(b.tillaStiches)||0,D=parseFloat(b.tilaRate)||0,W=parseFloat(b.noOfHead)||0,O=parseFloat(b.repeats)||0;return(F/1e3*(D*O*W)).toFixed(2)},le=()=>{const F=parseFloat(b.sequence)||0,D=parseFloat(b.sequenceRate)||0,W=parseFloat(b.noOfHead)||0,O=parseFloat(b.repeats)||0;return(F/1e3*(D*O*W)).toFixed(2)},Ie=()=>{const F=parseFloat(b.repeats)||0,D=parseFloat(b.noOfHead)||0,W=parseFloat(b.solvingLayers)||0;return(F*D*13/39.37*W).toFixed(2)},fe=()=>{const F=parseFloat(b.solvingInMeters)||0,D=parseFloat(b.solvingRate)||0;return(F*D).toFixed(2)},$=()=>{const F=parseFloat(b.threadAmount)||0,D=parseFloat(b.tilaAmount)||0,W=parseFloat(b.sequenceAmount)||0,O=parseFloat(b.solvingAmount)||0;return(F+D+W+O).toFixed(2)},ue=()=>{const F=parseFloat(b.totalAmount)||0,D=parseFloat(b.totalPcs)||0;return(F/D).toFixed(2)};y(F=>({...F,totalPcs:C(),threadAmount:z(),tilaAmount:K(),sequenceAmount:le(),solvingInMeters:Ie(),solvingAmount:fe(),totalAmount:$(),costPerComponent:ue()}))},[b.threadAmount,b.totalAmount,b.sequenceAmount,b.solvingAmount,b.repeats,b.tilaAmount,b.itemsPerRepeat,b.threadRate,b.threadStiches,b.noOfHead,b.tilaRate,b.tillaStiches,b.sequenceRate,b.sequence,b.solvingLayers,b.solvingInMeters,b.solvingRate]),o.useEffect(()=>{if(T==="assignedQty"){const C=()=>{const z=parseFloat(b.assignedQty)||0,K=parseFloat(b.availableQty)||0,le=parseFloat(b.totalPcs)||0;return Math.round(z*(le/K))};y(z=>({...z,requiredPcs:C()}))}else if(T==="requiredPcs"){const C=()=>{const z=parseFloat(b.requiredPcs)||0,K=parseFloat(b.availableQty)||0,le=parseFloat(b.totalPcs)||0;return(z*K/le).toFixed(2)};y(z=>({...z,assignedQty:C()}))}},[b.assignedQty,b.requiredPcs,T]);const oe=C=>{const z=C.target.value;G("assignedQty"),y(K=>({...K,assignedQty:z}))},ne=C=>{const z=C.target.value;G("requiredPcs"),y(K=>({...K,requiredPcs:z}))},re=async()=>{if(console.log(p),p.totalAmount===0&&p.costPerComponent===0){s("Please Thread, Tilla or Sequnce values ",{variant:"error",autoHideDuration:5e3});return}try{const C=await ge.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroideryDetails",{...p,additional:p.additional.join(", ")});C.data.success?s("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(s(`${C.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",C.data.message)),console.log("Save response:",C.data),y(z=>({...z,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,costPerComponent:0,createdOn:new Date().toISOString(),createdBy:h.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:h.empId})),V(),U()}catch(C){console.error("Error saving data:",C),s("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},se=[{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"ThreadAdditional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(je,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!t,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"Fabric",name:"fabricName",value:p.fabricName,onChange:g,size:"small",disabled:!0,sx:C=>({...p.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Component",name:"componentName",value:p.componentName,onChange:g,size:"small",disabled:!0,sx:C=>({...p.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"Color",name:"colourName",value:p.colourName,onChange:g,size:"small",disabled:!0,sx:C=>({...p.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:p.poPcs,onChange:g,size:"small",disabled:!0,sx:C=>({...p.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"noOfHead",size:"small",name:"noOfHeadsName",value:p.noOfHeadsName,onChange:g,disabled:!0,sx:C=>({...p.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:p.cuttingSize,onChange:g,disabled:!0,sx:C=>({...p.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:p.itemsPerRepeat,onChange:g,disabled:!0,sx:C=>({...p.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:p.availableQty,onChange:g,disabled:!0,sx:C=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:p.remainingQty,onChange:g,disabled:!0,sx:C=>({...p.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:p.repeats,onChange:g,disabled:!0,sx:C=>({...p.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:p.totalPcs,onChange:g,disabled:!0,sx:C=>({...p.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"remainingPcs",fullWidth:!0,size:"small",name:"remainingPcs",value:p.remainingPcs,onChange:g,disabled:!0,sx:C=>({...p.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:p.vendorId,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}},children:J.map(C=>e.jsx(k,{value:C.lookUpId,children:C.lookUpName},C.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:p.assignedQty,onChange:oe,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Required Pcs",fullWidth:!0,disabled:!p.remainingPcs&&!p.remainingQty,size:"small",type:"number",name:"requiredPcs",value:p.requiredPcs,onChange:ne,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsx(n,{select:!0,label:"Additional",value:p.additional,name:"additional",size:"small",onChange:g,fullWidth:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:q.map(C=>e.jsx(k,{value:C,style:X(C,p.additional,f),children:C},C))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(st,{control:e.jsx(nt,{checked:p.isSolving,onChange:S,disabled:!p.remainingPcs&&!p.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:p.threadStiches,onChange:g,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:p.threadRate,onChange:g,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:p.threadAmount,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:p.tillaStiches,onChange:g,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:p.tilaRate,onChange:g,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:p.tilaAmount,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(a,{item:!0,xs:12,md:6,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:p.sequence,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:p.sequenceRate,onChange:g,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:p.sequenceAmount,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),p.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:p.solvingLayers,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:p.solvingInMeters,disabled:!p.remainingPcs&&!p.remainingQty,onChange:g,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:p.solvingRate,onChange:g,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:p.solvingAmount,disabled:!p.remainingPcs&&!p.remainingQty,onChange:g,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(n,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",disabled:!p.remainingPcs&&!p.remainingQty,name:"totalAmount",value:p.totalAmount,onChange:g,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(n,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:p.costPerComponent,onChange:g,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(de,{variant:"contained",size:"small",onClick:re,children:"Save"})})]})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(pe,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ne,{iColumns:se,initialRows:u,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:V,disableEdit:!0})})]})})]})},Ft=()=>{_e();const{user:c}=Oe(),[_,U]=o.useState(!0),{enqueueSnackbar:m}=Le(),[t,f]=o.useState([]),[s,h]=o.useState(!1),[u,i]=o.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});o.useEffect(()=>{i({embroideryId:(t==null?void 0:t.embroideryId)||0,designId:(t==null?void 0:t.designId)||"",batchNo:(t==null?void 0:t.batchNo)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorId:(t==null?void 0:t.baseColorId)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[t]);const{data:w}=Be(),[E,p]=o.useState(""),{data:y}=Se(),{data:q,refetch:X}=Te(E,{skip:!E}),{data:M,refetch:te}=We(u.designId,{skip:!u.designId}),{data:V}=Ue({batchNo:u.planningHeaderId,componentId:u.componentId},{skip:!u.planningHeaderId||!u.componentId}),{data:J}=qe({batchNo:u.planningHeaderId,componentId:u.componentId,fabricId:u.fabricId},{skip:!u.planningHeaderId||!u.componentId||!u.fabricId}),{data:x,refetch:g}=mt(u.planningHeaderId,{skip:!u.planningHeaderId}),{data:S}=Ee(u.planningHeaderId,{skip:!u.planningHeaderId});console.log("formData.planningHeaderId",u.planningHeaderId),console.log("collectionData",w);const[T,G]=o.useState(!1),[b,Y]=o.useState([]),[oe,ne]=o.useState([]),[re,se]=o.useState([]),[be,C]=o.useState([]),[z,K]=o.useState([]),[le,Ie]=o.useState([]),[fe,$]=o.useState([]),[ue,F]=o.useState([]);console.log("batchList",oe),console.log("formData",u),o.useEffect(()=>{q&&Y(q.result)},[q]),o.useEffect(()=>{M&&ne(M.result)},[M]),o.useEffect(()=>{V&&se(V.result)},[V]),o.useEffect(()=>{J&&Ie(V.result)},[J]),o.useEffect(()=>{S&&F(S.result)},[S]),o.useEffect(()=>{x&&(U(!1),$(x.result.map((r,N)=>({id:N,...r}))))},[x,g]),console.log("embroideryList",x),console.log("initialRows",fe),o.useEffect(()=>{if(y){const r=y.result[0];C(r.vendorList),K(r.noOfHeadsList)}},[y]);const D=(w==null?void 0:w.result)||[];o.useEffect(()=>{const r=()=>{const P=parseFloat(u.repeats)||0,A=parseFloat(u.itemsPerRepeat)||0;return(P*A).toFixed(2)};i(P=>({...P,totalPcs:r()}));const N=()=>{const P=parseFloat(u.threadStiches)||0,A=parseFloat(u.threadRate)||0,R=parseFloat(u.noOfHead)||0,ae=parseFloat(u.repeats)||0;return(P/1e3*(A*ae*R)).toFixed(2)};i(P=>({...P,threadAmount:N()}));const l=()=>{const P=parseFloat(u.tillaStiches)||0,A=parseFloat(u.tilaRate)||0,R=parseFloat(u.noOfHead)||0,ae=parseFloat(u.repeats)||0;return(P/1e3*(A*ae*R)).toFixed(2)};i(P=>({...P,tilaAmount:l()}));const I=()=>{const P=parseFloat(u.sequence)||0,A=parseFloat(u.sequenceRate)||0,R=parseFloat(u.noOfHead)||0,ae=parseFloat(u.repeats)||0;return(P/1e3*(A*ae*R)).toFixed(2)};i(P=>({...P,sequenceAmount:I()}));const d=()=>{const P=parseFloat(u.repeats)||0,A=parseFloat(u.noOfHead)||0,R=parseFloat(u.solvingLayers)||0;return(P*A*13/39.37*R).toFixed(2)};i(P=>({...P,solvingInMeters:d()}));const j=()=>{const P=parseFloat(u.solvingInMeters)||0,A=parseFloat(u.solvingRate)||0;return parseFloat(u.solvingLayers),(P*A).toFixed(2)};i(P=>({...P,solvingAmount:j()}));const H=()=>{const P=parseFloat(u.threadAmount)||0,A=parseFloat(u.tilaAmount)||0,R=parseFloat(u.sequenceAmount)||0,ae=parseFloat(u.solvingAmount)||0;return(P+A+R+ae).toFixed(2)};i(P=>({...P,totalAmount:H()||0}))},[u.threadAmount,u.totalAmount,u.sequenceAmount,u.solvingAmount,u.repeats,u.tilaAmount,u.itemsPerRepeat,u.threadRate,u.threadStiches,u.noOfHead,u.tilaRate,u.tillaStiches,u.sequenceRate,u.sequence,u.solvingLayers,u.solvingInMeters,u.solvingRate]);const W=r=>{const{name:N,value:l}=r.target;if(N==="collectionId")D.find(I=>I.collectionId===parseInt(l)),p(l),h(!0),$([]),U(!0),i({...u,collectionId:l,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]});else if(N==="designId"){const I=b.find(d=>d.designId===parseInt(l));$([]),U(!0),i({...u,designId:l,baseColorId:I?I.colorId:"",baseColorName:I?I.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(N==="colorId"){const I=le.find(d=>d.colorId===l);i({...u,colorId:l,availableQty:I?I.total:"",cuttingSize:I?I.cuttingSize:"",repeats:I?I.repeats:"",noOfHead:I?I.noOfHeads:""})}else if(N==="batchNo"){const I=oe.find(d=>d.batchNo===l);i({...u,batchNo:l,planningHeaderId:I?I.planningHeaderId:"",poPcs:I?I.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),G(!0),h(!1)}else i({...u,[N]:l}),Z(I=>({...I,[N]:""}))},[O,Z]=o.useState({}),Me=async()=>{try{const r=await ge.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroidery",{...u,threadAdditional:u.threadAdditional.join(", ")});console.log("Save response:",r.data),r.data.success?m("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(m(`${r.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",r.data.message)),i(N=>({embroideryId:0,designId:N.designId,batchNo:N.batchNo,planningHeaderId:N.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:N.poPcs,baseColorId:N.baseColorId,baseColorName:N.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),g()}catch(r){console.error("Error saving data:",r),m("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",fe);const[Q,B]=o.useState({}),[ve,xe]=o.useState(!1),ye=r=>{B(r),xe(!0)},[Pe,Ce]=o.useState(!0),ie=r=>{B(r),xe(!0),Ce(!1)},v=()=>{Ce(!0),xe(!1),B({}),refetchDyeingPrintingData()};console.log("show div",Pe);const L=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component "},{field:"fabricName",headerName:"Fabric "},{field:"vendorId",headerName:"Vendor"},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty"},{field:"assignedQty",headerName:"Assigned Qty"},{field:"totalPcs",headerName:"Total Pcs"},{field:"requiredPcs",headerName:"Assigned Pcs"},{field:"AddVendor",headerName:"Add Vendor",renderCell:r=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(ot,{variant:"text",size:"small",children:[e.jsx(ke,{color:"primary",onClick:()=>ye(r.row),children:e.jsx(Je,{})}),e.jsx(ke,{color:"primary",onClick:()=>ie(r.row),children:e.jsx(Ae,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:At,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:E,onChange:W,size:"small",InputLabelProps:{sx:{color:"black"}},children:D.map(r=>e.jsx(k,{value:r.collectionId,children:r.collectionName},r.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:u.designId,onChange:W,size:"small",InputLabelProps:{sx:{color:"black"}},children:b.map(r=>e.jsx(k,{value:r.designId,children:r.designNo},r.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:u.batchNo,onChange:W,size:"small",InputLabelProps:{sx:{color:"black"}},children:oe.map(r=>e.jsx(k,{value:r.batchNo,children:r.batchNo},r.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:u.baseColorName,onChange:W,disabled:!0,sx:r=>({...u.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:u.componentId,onChange:W,size:"small",required:!0,error:!!O.componentId,helperText:O.componentId,InputLabelProps:{sx:{color:"black"}},children:ue.map(r=>e.jsx(k,{value:r.componentId,children:r.componentName},r.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:u.fabricId,onChange:W,required:!0,error:!!O.fabricId,helperText:O.fabricId,InputLabelProps:{sx:{color:"black"}},children:re.map(r=>e.jsx(k,{value:r.fabricId,children:r.fabric},r.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:u.colorId,onChange:W,required:!0,error:!!O.colorId,helperText:O.colorId,InputLabelProps:{sx:{color:"black"}},children:le.map(r=>e.jsx(k,{value:r.colorId,children:r.color},r.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:u.poPcs,onChange:W,disabled:!0,sx:r=>({...u.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:u.availableQty,onChange:W,InputLabelProps:{sx:{color:"black"}},sx:r=>({...u.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:u.repeats,onChange:W,InputLabelProps:{sx:{color:"black"}},sx:r=>({...u.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:u.noOfHead,onChange:W,required:!0,error:!!O.noOfHead,helperText:O.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:r=>({...u.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:z.map(r=>e.jsx(k,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:u.cuttingSize,onChange:W,InputLabelProps:{sx:{color:"black"}},sx:r=>({...u.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:u.itemsPerRepeat,onChange:W,required:!0,error:!!O.itemsPerRepeat,helperText:O.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:r=>({...u.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:u.totalPcs,onChange:W})}),e.jsx(a,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(de,{variant:"contained",size:"small",onClick:Me,children:"Save"})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(Ne,{iColumns:L,initialRows:fe,setInitialData:f,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:g,setAccordionExpanded:G,fileName:"Embroidery List",isLoading:_}),e.jsxs(Ge,{open:ve,onClose:v,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(Ye,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(pe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Vendors "}),e.jsx(ke,{onClick:v,sx:{color:"#ffffff"},children:e.jsx(De,{})})]}),e.jsxs(Xe,{children:[e.jsx(Ve,{id:"alert-dialog-slide-description"}),e.jsx(Tt,{initialFormData:Q,setInitialFormData:B,refetchDyeingPrintingData:g,handleClickOpen:ye,showUpperDiv:Pe})]})]})]})})]})]})},wt=Ft,zt=()=>{const{user:c}=Oe();console.log("user",c);const[_,U]=o.useState(!0),[m,t]=o.useState([]),[f,s]=o.useState([]),[h,u]=o.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedBy:c.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",h),o.useEffect(()=>{u({...h,processType:(m==null?void 0:m.processType)||"MultiHead",planningId:(m==null?void 0:m.planningId)||0,baseColorId:(m==null?void 0:m.baseColorId)||"",componentId:(m==null?void 0:m.componentId)||"",cuttingSize:(m==null?void 0:m.cuttingSize)||"",colorId:(m==null?void 0:m.colorId)||"",fabricId:(m==null?void 0:m.fabricId)||"",noOfHeads:(m==null?void 0:m.noOfHeads)||0,operatingMachineId:(m==null?void 0:m.operatingMachineId)||0,repeats:(m==null?void 0:m.repeats)||"",repeatSize:(m==null?void 0:m.repeatSize)||"",uomId:(m==null?void 0:m.uomId)||"",totalFabric:(m==null?void 0:m.totalFabric)||"",shrinkage:(m==null?void 0:m.shrinkage)||"",wastage:(m==null?void 0:m.wastage)||"",total:(m==null?void 0:m.total)||"",appId:1,createdOn:(m==null?void 0:m.createdOn)||new Date().toISOString(),createdBy:(m==null?void 0:m.createdBy)||c.empId,lastUpdatedBy:c.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(m==null?void 0:m.repeatsInMtr)||""})},[m]);const{data:i}=Be(),[w,E]=o.useState(""),{data:p,refetch:y}=Te(w,{skip:!w}),{data:q,refetch:X}=ht(h.planningHeaderId,{skip:!h.planningHeaderId}),{data:M}=Se(),[te,V]=o.useState([]),{enqueueSnackbar:J}=Le();console.log("lookupData",M);const[x,g]=o.useState([]);o.useEffect(()=>{i&&g(i.result)},[i]),o.useEffect(()=>{p&&(V(p.result),y())},[p]),o.useEffect(()=>{q&&(U(!1),s(q.result.map((l,I)=>({id:I,...l}))))},[q,X]),console.log("designList",te),console.log("collectionData",i);const[S,T]=o.useState(!1),[G,b]=o.useState([]),[Y,oe]=o.useState([]),[ne,re]=o.useState([]),[se,be]=o.useState([]),[C,z]=o.useState([]),[K,le]=o.useState([]),[Ie,fe]=o.useState([]),[$,ue]=o.useState([]);console.log("components:",ne),console.log("Fabrications:",se),console.log("colors:",C),console.log("uoms:",K),console.log("heads:",Ie),console.log("lookupData",M),o.useEffect(()=>{if(M){const l=M.result[0];re(l.componentList),z(l.colorList),be(l.fabricList),fe(l.noOfHeadsList),le(l.uomList),b(l.planningTypeProcessList),oe(l.operatingMachineList)}},[M]),o.useEffect(()=>{const l=async I=>{try{const d=await ge.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${I}`);console.log(d.data),ue(d.data.result)}catch(d){console.error("Error fetching pre-planning lookup data:",d)}};h.designId&&l(h.designId)},[h.designId,h.planningHeaderId]);const F=h.planningProcessTypeId===212;console.log("isDyeing",F),o.useEffect(()=>{const l=()=>{const A=parseFloat(h.poPcs)||0,R=parseFloat(h.cuttingSize)||0,ae=(A*R).toFixed(2);return parseFloat(ae).toLocaleString()},I=()=>{const A=parseFloat(h.repeats)||0,R=parseFloat(h.repeatSize)||0,ae=(A*R).toFixed(2);return parseFloat(ae).toLocaleString()},d=A=>{const R=A||0,ae=parseFloat(h.shrinkage)||0,Re=parseFloat(h.wastage)||0,Qe=(R*(100+(ae+Re))/100).toFixed(2);return parseFloat(Qe).toLocaleString()},j=()=>(.9144*(parseFloat(h.repeatSize)||0)).toFixed(2),H=()=>{const A=parseFloat(h.repeats)||0;return((parseFloat(h.repeatsInMtr)||0)*A).toFixed(2)};let P=0;F?P=parseFloat(l().replace(/,/g,""))||0:P=parseFloat(I().replace(/,/g,""))||0,u(A=>({...A,totalFabric:P.toLocaleString(),total:d(P),repeatsInMtr:j()})),!F&&h.isSchiffili&&u(A=>({...A,totalFabric:H()}))},[h.poPcs,h.cuttingSize,h.repeats,h.repeatSize,h.totalFabric,h.shrinkage,h.wastage,h.repeatsInMtr,h.isSchiffili,F]);const[D,W]=o.useState(!1);o.useState(!1);const O=l=>{const{name:I,value:d}=l.target;if(I==="collectionId"){const j=x.find(H=>H.collectionId===parseInt(d));T(!0),s([]),U(!0),E(d),u({...h,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:d,noOfDesigns:j?j.noOfDesigns:"",noOfColors:j?j.noOfColors:""})}else if(I==="designId"){const j=te.find(H=>H.designId===parseInt(d));s([]),U(!0),u({...h,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:d,baseColorId:j?j.colorId:"",baseColorName:j?j.colorName:""})}else if(I==="batchNo"){const j=$.find(H=>H.batchNo===d);u({...h,componentId:"",processType:"MultiHead",poPcs:j?j.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:d,planningHeaderId:j?j.planningHeaderId:""}),W(!0),T(!1)}else if(I==="planningProcessTypeId"){const j=G.find(H=>H.planningProcessTypeId===d);u({...h,planningProcessTypeId:d,planningProcessTypeName:j?j.lookUpName:"",noOfHeads:0,operatingMachineId:0}),W(!0),T(!1)}else u({...h,[I]:d})},[Z,Me]=o.useState({}),Q=async()=>{const l=B();if(Object.keys(l).length>0){Me(l);return}try{const I={...h,totalFabric:parseFloat(h.totalFabric.replace(/,/g,"")),total:parseFloat(h.total.replace(/,/g,""))},d=await ge.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",I);console.log("Data saved successfully:",d.data),console.log("Save response:",d.data),d.data.success?J("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(J(`${d.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",d.data.message)),u(j=>({processType:"MultiHead",planningId:0,collectionId:j.collectionId,designId:j.designId,batchNo:j.batchNo,planningHeaderId:j.planningHeaderId,baseColorId:j.baseColorId,baseColorName:j.baseColorName,noOfDesigns:j.noOfDesigns,noOfColors:j.noOfColors,poPcs:j.poPcs,componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId,isSchiffili:!1,repeatsInMtr:""})),X()}catch(I){console.error("Error saving data:",I),J("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},B=()=>{const l={};return h.componentId||(l.componentId="componentId is required"),h.colorId||(l.colorId="colorId is required"),h.fabricId||(l.fabricId="fabricId is required"),h.cuttingSize||(l.cuttingSize="cuttingSize is required"),h.repeats||(l.repeats="repeats is required"),h.repeatSize||(l.repeatSize="repeatSize is required"),h.uomId||(l.uomId="uomId is required"),h.shrinkage||(l.shrinkage="shrinkage is required"),h.wastage||(l.wastage="wastage is required"),l};console.log("initialRows",f);const ve=f.reduce((l,I)=>l+(I.totalFabric??0),0).toFixed(2),xe=parseFloat(ve).toLocaleString();console.log("localizedTotalFabric",xe);const ye=f.reduce((l,I)=>l+(I.total??0),0).toFixed(2),Pe=parseFloat(ye).toLocaleString(),Ce=[...f,{id:"TOTAL_FABRIC",label:"Total Fabric",totalFabric:xe,total:Pe}],ie={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",Ce);const v=[{field:"componentName",headerName:"Component",...ie,colSpan:(l,I)=>{if(I.id==="TOTAL_FABRIC")return 9},valueGetter:(l,I)=>I.id==="TOTAL_FABRIC"?I.label:l},{field:"planningProcessTypeName",headerName:"Process Type",...ie},{field:"color",headerName:"Color",...ie},{field:"cuttingSize",headerName:"Cutting Size",...ie},{field:"fabric",headerName:"Fabrication",...ie},{field:"noOfHeadName",headerName:"No. Of Heads",...ie},{field:"operatingMachineName",headerName:"Operating Machine",...ie},{field:"repeats",headerName:"Repeats",valueGetter:l=>l.toLocaleString(),...ie},{field:"repeatSize",headerName:"Repeat Size",valueGetter:l=>l.toLocaleString(),...ie},{field:"totalFabric",headerName:"Total Fabric",valueGetter:l=>l.toLocaleString(),...ie},{field:"uom",headerName:"UOM",colSpan:(l,I)=>{if(I.id==="TOTAL_FABRIC")return 2},valueGetter:(l,I)=>I.id==="TOTAL_FABRIC"?"OverAll Total":l},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:l=>l.toLocaleString(),colSpan:(l,I)=>{if(I.id==="TOTAL_FABRIC")return 2}}],L=h.planningProcessTypeId===198;o.useEffect(()=>{L&&u({...h,uomId:139})},[L]),console.log("formData",h);const ee=({row:l,field:I})=>l.id==="TOTAL_FABRIC"&&(I==="componentName"||I==="uom")?"bold":"";console.log("batchList:",$);const r="https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",N=(l,I)=>{W(!D)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:h.collectionId,onChange:O,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:x.map(l=>e.jsx(k,{value:l.collectionId,children:l.collectionName},l.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:h.designId,onChange:O,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:te.map(l=>e.jsx(k,{value:l.designId,children:l.designNo},l.designId))})}),e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:h.batchNo,onChange:O,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:$.map(l=>e.jsx(k,{value:l.batchNo,children:l.batchNo},l.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:h.poPcs,onChange:O,disabled:!0,sx:l=>({...h.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:h.baseColorName,onChange:O,disabled:!0,sx:l=>({...h.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"MainCard",avatar:e.jsx($e,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ke,{onClick:N,sx:{mt:"-18px"},children:e.jsx(ze,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(et,{expanded:D,onChange:N,sx:{},children:[e.jsx(tt,{expandIcon:e.jsx(ze,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(at,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:h.planningProcessTypeId,onChange:O,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:G.map(l=>e.jsx(k,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(we,{fullWidth:!0,options:ne,getOptionLabel:l=>l.lookUpName,value:ne.find(l=>l.lookUpId===h.componentId)||null,onChange:(l,I)=>{O({target:{name:"componentId",value:I?I.lookUpId:""}})},renderOption:(l,I)=>{const{lookUpName:d}=I;return e.jsx("span",{...l,children:d})},renderInput:l=>e.jsx(n,{...l,label:"Select Component",size:"small",name:"componentId",value:h.componentId,required:!0,error:!!Z.componentId,helperText:Z.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:l})=>e.jsx("div",{style:{backgroundColor:"white"},children:l})})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[" ",e.jsx(we,{fullWidth:!0,options:C,getOptionLabel:l=>l.lookUpName,value:C.find(l=>l.lookUpId===h.colorId)||null,onChange:(l,I)=>{O({target:{name:"colorId",value:I?I.lookUpId:""}})},renderInput:l=>e.jsx(n,{...l,label:"Color",size:"small",value:h.colorId,name:"colorId",required:!0,error:!!Z.colorId,helperText:Z.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:l})=>e.jsx("div",{style:{backgroundColor:"white"},children:l})})]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:h.cuttingSize,onChange:O,required:!0,error:!!Z.cuttingSize,helperText:Z.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(we,{fullWidth:!0,options:se,getOptionLabel:l=>l.lookUpName,value:se.find(l=>l.lookUpId===h.fabricId)||null,onChange:(l,I)=>{O({target:{name:"fabricId",value:I?I.lookUpId:""}})},renderInput:l=>e.jsx(n,{...l,label:"Fabrication",size:"small",name:"fabricId",value:h.fabricId,required:!0,error:!!Z.fabricId,helperText:Z.fabricId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:l})=>e.jsx("div",{style:{backgroundColor:"white"},children:l})})}),e.jsx(a,{item:!0,xs:12,md:2,children:L?e.jsx(n,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:h.operatingMachineId,onChange:O,required:!0,disabled:F,InputLabelProps:{sx:{color:"black"}},children:Y.map(l=>e.jsx(k,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))}):e.jsx(n,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:h.noOfHeads,onChange:O,required:!0,disabled:F,InputLabelProps:{sx:{color:"black"}},children:Ie.map(l=>e.jsx(k,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:h.repeats,onChange:O,error:!!Z.repeats,helperText:Z.repeats,required:!0,disabled:F,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:h.repeatSize,onChange:O,disabled:F,error:!!Z.repeatSize,helperText:Z.repeatSize,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:h.totalFabric,onChange:O,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:h.uomId,onChange:O,error:!!Z.uomId,helperText:Z.uomId,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}},children:K.map(l=>e.jsx(k,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:h.shrinkage,onChange:O,error:!!Z.shrinkage,helperText:Z.shrinkage,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:h.wastage,onChange:O,error:!!Z.wastage,helperText:Z.wastage,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(n,{label:"Total",fullWidth:!0,size:"small",name:"total",value:h.total,onChange:O,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(a,{container:!0,spacing:1,width:"Inherit",children:e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"repeat in mtr",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:h.repeatsInMtr,onChange:O,sx:l=>({...h.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",children:e.jsx(de,{variant:"contained",size:"small",onClick:Q,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"MainCard",avatar:e.jsx(Ae,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{sx:{paddingY:1,paddingX:1},children:e.jsx(a,{sx:{},item:!0,xs:12,children:e.jsx(Ne,{iColumns:v,initialRows:Ce,setInitialData:t,deleteApi:r,deleteBy:"planningId",refetch:X,getCellClassName:ee,setAccordionExpanded:W,fileName:"PrePlanningList",isLoading:_})})})]})]})},Wt=zt,Ht="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",Rt=()=>{const{user:c}=Oe();console.log("user",c);const[_,U]=o.useState(!0),[m,t]=o.useState([]),[f,s]=o.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});o.useEffect(()=>{s({...f,dpId:m.dpId||0,fabricId:(m==null?void 0:m.fabricId)||"",colorId:(m==null?void 0:m.colorId)||"",color:(m==null?void 0:m.color)||"",processType:(m==null?void 0:m.processType)||"",availableQty:(m==null?void 0:m.availableQty)||"",Shrinkage:(m==null?void 0:m.shrinkage)||"",Wastage:(m==null?void 0:m.wastage)||"",outputQty:(m==null?void 0:m.outputQty)||0,UOM:(m==null?void 0:m.uom)||0,uomId:(m==null?void 0:m.uomId)||"",poPcs:(m==null?void 0:m.poPcs)||0,createdOn:(m==null?void 0:m.createdOn)||new Date().toISOString(),createdBy:(m==null?void 0:m.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[m]);const{enqueueSnackbar:h}=Le(),[u,i]=o.useState(!1);console.log("Dyeing form data to send",f);const{data:w}=Be(),[E,p]=o.useState(""),{data:y}=Se(),{data:q,refetch:X}=Te(E,{skip:!E}),{data:M,refetch:te}=We(f.designId,{skip:!f.designId}),{data:V}=gt({batchNo:f.planningHeaderId,processType:"Fabrication"},{skip:!f.planningHeaderId}),{data:J}=bt({fabricId:f.fabricId,planningHeaderId:f.planningHeaderId},{skip:!f.fabricId||!f.planningHeaderId}),{data:x,refetch:g}=It(f.planningHeaderId,{skip:!f.planningHeaderId}),[S,T]=o.useState([]),[G,b]=o.useState([]),[Y,oe]=o.useState([]),[ne,re]=o.useState([]),[se,be]=o.useState([]),[C,z]=o.useState([]);o.useState([]);const[K,le]=o.useState(!1);console.log("batchList",G),console.log("formData",f),o.useEffect(()=>{q&&T(q.result)},[q]),o.useEffect(()=>{M&&b(M.result)},[M]),o.useEffect(()=>{V&&oe(V.result)},[V]),o.useEffect(()=>{J&&z(J.result)},[J]),o.useEffect(()=>{x&&(U(!1),be(x.result.map((v,L)=>({id:L,...v}))))},[x,g]),o.useEffect(()=>{if(y){const v=y.result[0];re(v.uomList)}},[y]);const[Ie,fe]=o.useState([]);o.useEffect(()=>{w&&fe(w.result)},[w]);const $=v=>{const{name:L,value:ee}=v.target;if(L==="collectionId")Ie.find(r=>r.collectionId===parseInt(ee)),p(ee),i(!0),be([]),U(!0),s({...f,collectionId:ee,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:""});else if(L==="designId"){const r=S.find(N=>N.designId===parseInt(ee));be([]),U(!0),s({...f,designId:ee,baseColorId:r?r.colorId:"",baseColorName:r?r.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(L==="batchNo"){const r=G.find(N=>N.batchNo===ee);s({...f,batchNo:ee,planningHeaderId:r?r.planningHeaderId:"",poPcs:r?r.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),le(!0),i(!1)}else if(L==="fabricId")Y.find(r=>r.fabricId===ee),console.log("Selected Fabric:",Y),s({...f,fabricId:ee});else if(L==="ColorId"){const r=C.find(N=>N.colorId===ee.colorId);s({...f,ColorId:ee.colorId,color:r.color,availableQty:r.total,UOM:r.uom,Shrinkage:r.shrinkage,Wastage:r.wastage})}else L==="processType"?s({...f,processType:ee}):L==="vendorId"?s({...f,vendorId:ee}):(s({...f,[L]:ee}),F(r=>({...r,[L]:""})))};o.useEffect(()=>{const v=()=>{const I=parseFloat(f.availableQty)||0,d=parseFloat(f.Shrinkage)||0,j=parseFloat(f.Wastage)||0;return(I*(100-(d+j))/100).toFixed(2)},L=()=>{const I=parseFloat(f.availableQty)||0,d=parseFloat(f.RatePerUOM)||0;return(I*d).toFixed(2)},ee=(I,d)=>(I*(1+d/100)).toFixed(2),r=v(),N=L(),l=parseFloat(f.GST)||0;ee(N,l),parseFloat(f.poPcs),s(I=>({...I,outputQty:r}))},[f.availableQty,f.Shrinkage,f.Wastage,f.RatePerUOM,f.GST,f.poPcs,f.UnitRatePerPo]);const[ue,F]=o.useState({}),D=async()=>{try{const v=await ge.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",f);console.log("Save response:",v.data),v.data.success?h("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(h(`${v.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",v.data.message)),s(L=>({designId:L.designId,planningHeaderId:L.planningHeaderId,batchNo:L.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:L.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),g()}catch(v){console.error("Error saving data:",v),h("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},W=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[O,Z]=o.useState(!0),[Me,Q]=o.useState({}),[B,ve]=o.useState(!1),xe=v=>{Q(v),ve(!0)},ye=v=>{Q(v),ve(!0),Z(!1)},Pe=()=>{Z(!0),ve(!1),Q({}),g()},Ce=[{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processType",headerName:"Process Type"},{field:"uom",headerName:" UOM"},{field:"poPcs",headerName:" PO PCS."},{field:"availableQty",headerName:"Available Quantitity",valueGetter:v=>v.toLocaleString()},{field:"assignedQty",headerName:"Assigned Qty",valueGetter:v=>v.toLocaleString()},{field:"AddVendor",headerName:"Add Vendor",renderCell:v=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(ot,{variant:"text",size:"small",children:[e.jsx(ke,{color:"primary",onClick:()=>xe(v.row),children:e.jsx(Je,{})}),e.jsx(ke,{color:"primary",onClick:()=>ye(v.row),children:e.jsx(Ae,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:Ht,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:E,onChange:$,size:"small",InputLabelProps:{sx:{color:"black"}},children:Ie.map(v=>e.jsx(k,{value:v.collectionId,children:v.collectionName},v.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:f.designId,onChange:$,size:"small",InputLabelProps:{sx:{color:"black"}},children:S.map(v=>e.jsx(k,{value:v.designId,children:v.designNo},v.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:f.batchNo,onChange:$,size:"small",InputLabelProps:{sx:{color:"black"}},children:G.map(v=>e.jsx(k,{value:v.batchNo,children:v.batchNo},v.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:f.baseColorName,onChange:$,disabled:!0,sx:v=>({...f.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:f.fabricId,onChange:$,error:!!ue.fabricId,helperText:ue.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:Y.map(v=>e.jsx(k,{value:v.fabricId,children:v.fabric},v.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(St,{fullWidth:!0,options:C,getOptionLabel:v=>v.color||"",renderInput:v=>e.jsx(n,{...v,label:"Color",name:"colorId",size:"small",error:!!ue.colorId,helperText:ue.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),value:C.find(v=>v.colorId===f.colorId)||null,onChange:(v,L)=>{s(ee=>({...ee,colorId:L?L.colorId:"",color:L?L.color:"",availableQty:L?L.total:"",UOM:L?L.uom:"",uomId:L?L.uomId:"",Shrinkage:L?L.shrinkage:"",Wastage:L?L.wastage:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:f.processType,onChange:$,error:!!ue.processType,helperText:ue.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:W.map(v=>e.jsx(k,{value:v.value,children:v.label},v.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:f.poPcs,onChange:$,disabled:!0,sx:v=>({...f.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:f.UOM,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"availableQty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:f.availableQty,onChange:$,disabled:!0,sx:v=>({...f.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(de,{variant:"contained",color:"primary",size:"small",onClick:D,children:"Save"})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(Ne,{iColumns:Ce,initialRows:se,setInitialData:t,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:g,setAccordionExpanded:le,fileName:"Dyeing&PrintingList",isLoading:_}),e.jsxs(Ge,{open:B,onClose:Pe,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(Ye,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(pe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(ke,{onClick:Pe,sx:{color:"#ffffff"},children:e.jsx(De,{})})]}),e.jsxs(Xe,{children:[e.jsx(Ve,{id:"alert-dialog-slide-description"}),e.jsx(Bt,{initialFormData:Me,setInitialFormData:Q,refetchDyeingPrintingData:g,handleClickOpen:xe,showUpperDiv:O})]})]})]})})]})]})},Qt=Rt,lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",Ut=()=>{const{user:c}=Oe(),{enqueueSnackbar:_}=Le(),[U,m]=o.useState(!0),[t,f]=o.useState([]),[s,h]=o.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});o.useEffect(()=>{h({...s,schiffiliId:t.schiffiliId||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[t]);const[u,i]=o.useState(!1),w=(d,j)=>{i(!u)},[E,p]=o.useState(!1),{data:y}=Be(),[q,X]=o.useState(""),{data:M}=Se(),{data:te,refetch:V}=Te(q,{skip:!q}),{data:J,refetch:x}=We(s.designId,{skip:!s.designId}),{data:g}=Ue({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:S}=qe({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:T,refetch:G}=xt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:b}=Ee(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("formData.planningHeaderId",s.planningHeaderId),console.log("collectionData",y),console.log("schiffliList",T);const[Y,oe]=o.useState([]),[ne,re]=o.useState([]),[se,be]=o.useState([]),[C,z]=o.useState([]),[K,le]=o.useState([]),[Ie,fe]=o.useState([]),[$,ue]=o.useState([]),[F,D]=o.useState([]),[W,O]=o.useState([]);o.useEffect(()=>{te&&oe(te.result)},[te]),o.useEffect(()=>{J&&re(J.result)},[J]),o.useEffect(()=>{g&&be(g.result)},[g]),o.useEffect(()=>{S&&ue(g.result)},[S]),o.useEffect(()=>{b&&O(b.result)},[b]),o.useEffect(()=>{T&&(m(!1),D(T.result.map((d,j)=>({id:j,...d}))))},[T,G]),o.useEffect(()=>{if(M){const d=M.result[0];z(d.vendorList),le(d.operatingMachineList),fe(d.workingHeadList)}},[M]),console.log("initialRows",F);const Z=(y==null?void 0:y.result)||[];o.useEffect(()=>{const d=()=>{const R=parseFloat(s.thaanQty)||0,ae=parseFloat(s.operatingMachine)||0;return(R*ae).toFixed(2)};h(R=>({...R,totalEmbroidry:d()}));const j=()=>{const R=parseFloat(s.thaanQty)||0,ae=parseFloat(s.noOfItemPerThaan)||0;return(R*ae).toFixed(2)};h(R=>({...R,totalPcs:j()}));const H=()=>{const R=parseFloat(s.noOfStichesPerYard)||0,ae=parseFloat(s.rate)||0;return(R/1e3*ae).toFixed(2)};h(R=>({...R,amountPerYard:H()}));const P=()=>{const R=parseFloat(s.totalAmount)||0,ae=parseFloat(s.totalPcs)||0;return(R/ae).toFixed(2)};h(R=>({...R,costPerComponent:P()}));const A=()=>{const R=parseFloat(s.amountPerYard)||0,ae=parseFloat(s.totalEmbroidry)||0,Re=parseFloat(s.laserCutRate)||0,Qe=parseFloat(s.pcsForLaserCut)||0;return(R*ae+Qe*Re).toFixed(2)};h(R=>({...R,totalAmount:A()}))},[s.thaanQty,s.operatingMachine,s.noOfStichesPerYard,s.rate,s.totalAmount,s.totalPcs,s.amountPerYard,s.totalEmbroidry,s.laserCutRate,s.pcsForLaserCut]);const Me=d=>{const{name:j,checked:H}=d.target;h(P=>({...P,[j]:H}))},Q=d=>{const{name:j,value:H}=d.target;if(j==="collectionId")Z.find(P=>P.collectionId===parseInt(H)),X(H),p(!0),D([]),m(!0),h({...s,collectionId:H,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(j==="designId"){const P=Y.find(A=>A.designId===parseInt(H));D([]),m(!0),h({...s,designId:H,baseColorId:P?P.colorId:"",baseColorName:P?P.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(j==="batchNo"){const P=ne.find(A=>A.batchNo===H);h({...s,batchNo:H,planningHeaderId:P?P.planningHeaderId:"",poPcs:P?P.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),i(!0),p(!1)}else if(j==="colorId"){const P=$.find(A=>A.colorId===H);h({...s,colorId:H,availableQty:P?P.total:"",cuttingSize:P?P.cuttingSize:"",repeats:P?P.repeats:""})}else if(j==="operatingMachineId"){const P=K.find(A=>A.lookUpId===H);h({...s,operatingMachineId:H,operatingMachine:P?P.lookUpName:""})}else h({...s,[j]:H})};console.log("colors",$);const[B,ve]=o.useState({}),xe=async()=>{const d=ye();if(Object.keys(d).length>0){ve(d);return}try{const j=await ge.post("https://gecxc.com:4041/api/Schiffli/SaveSchiffili",s);console.log("Save response:",j.data),j.data.success?_("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(_(`${j.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",j.data.message)),h(H=>({designId:H.designId,planningHeaderId:H.planningHeaderId,batchNo:H.batchNo,baseColorName:H.baseColorName,schiffiliId:0,componentId:"",poPcs:H.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),G()}catch(j){console.error("Error saving data:",j),_("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ye=()=>{const d={};return s.fabricId||(d.fabricId="fabricId is required"),s.colorId||(d.colorId="colorId is required"),s.vendorId||(d.vendorId="vendorId is required"),s.componentId||(d.componentId="componentId is required"),s.thaanQty||(d.thaanQty="thaanQty is required"),s.workingHeadId||(d.workingHeadId="workingHeadId is required"),s.rate||(d.rate="rate is required"),s.operatingMachineId||(d.operatingMachineId="operatingMachineId is required"),s.noOfStichesPerYard||(d.noOfStichesPerYard="noOfStichesPerYard is required"),s.noOfItemPerThaan||(d.noOfItemPerThaan="noOfItemPerThaan is required"),d};console.log("formData",s);const[Pe,Ce]=o.useState(0),[ie,v]=o.useState(0),[L,ee]=o.useState(0);o.useEffect(()=>{const d=F.reduce((P,A)=>P+(A.totalAmount??0),0).toFixed(2),j=F.reduce((P,A)=>P+(A.totalEmbroidry??0),0).toFixed(2),H=F.reduce((P,A)=>P+(A.totalPcs??0),0).toFixed(2);Ce(parseFloat(d).toLocaleString()),v(parseFloat(j).toLocaleString()),ee(parseFloat(H).toLocaleString())},[F]);const r={id:"TOTAL_SUMMARY",componentName:"Total Summary",totalAmount:Pe,totalEmbroidry:ie,totalPcs:L},N=[...F,r],l=[{field:"componentName",headerName:"Component",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?"Total Summary":d.value},{field:"fabricName",headerName:"Fabric"},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"totalAmount",headerName:"Total Amount",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:lt,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:q,onChange:Q,size:"small",InputLabelProps:{sx:{color:"black"}},children:Z.map(d=>e.jsx(k,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:Q,size:"small",InputLabelProps:{sx:{color:"black"}},children:Y.map(d=>e.jsx(k,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:Q,size:"small",InputLabelProps:{sx:{color:"black"}},children:ne.map(d=>e.jsx(k,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:d=>({...s.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx($e,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ke,{onClick:w,sx:{mt:"-18px"},children:e.jsx(ze,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(et,{expanded:u,onChange:w,sx:{},children:[e.jsx(tt,{expandIcon:e.jsx(ze,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(at,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:Q,size:"small",required:!0,error:!!B.componentId,helperText:B.componentId,InputLabelProps:{sx:{color:"black"}},children:W.map(d=>e.jsx(k,{value:d.componentId,children:d.componentName},d.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:Q,required:!0,error:!!B.fabricId,helperText:B.fabricId,InputLabelProps:{sx:{color:"black"}},children:se.map(d=>e.jsx(k,{value:d.fabricId,children:d.fabric},d.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:s.vendorId,onChange:Q,required:!0,error:!!B.vendorId,helperText:B.vendorId,InputLabelProps:{sx:{color:"black"}},children:C.map(d=>e.jsx(k,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:Q,required:!0,error:!!B.colorId,helperText:B.colorId,InputLabelProps:{sx:{color:"black"}},children:$.map(d=>e.jsx(k,{value:d.colorId,children:d.color},d.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,disabled:!0,onChange:Q,sx:d=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:s.availableQty,onChange:Q,sx:d=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:s.thaanQty,onChange:Q,required:!0,error:!!B.thaanQty,helperText:B.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:s.operatingMachineId,onChange:Q,required:!0,error:!!B.operatingMachineId,helperText:B.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:K.map(d=>e.jsx(k,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:s.workingHeadId,onChange:Q,required:!0,error:!!B.workingHeadId,helperText:B.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:Ie.map(d=>e.jsx(k,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:s.cuttingSize,onChange:Q,sx:d=>({...s.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:s.rate,onChange:Q,required:!0,error:!!B.rate,helperText:B.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:s.noOfStichesPerYard,onChange:Q,required:!0,error:!!B.noOfStichesPerYard,helperText:B.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:s.noOfItemPerThaan,onChange:Q,required:!0,error:!!B.noOfItemPerThaan,helperText:B.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:s.totalEmbroidry,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:s.amountPerYard,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:s.totalPcs,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:s.costPerComponent,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:s.totalAmount,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(st,{control:e.jsx(nt,{checked:s.laserCut,onChange:Me,name:"laserCut"}),label:"Laser Cut"})}),s.laserCut?e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:s.laserCutRate,onChange:Q,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:s.pcsForLaserCut,onChange:Q,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(de,{variant:"contained",size:"small",onClick:xe,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ne,{iColumns:l,initialRows:N,setInitialData:f,deleteApi:"https://gecxc.com:4041/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:G,setAccordionExpanded:i,fileName:"Schffili List",isLoading:U})})})]})]})},qt=Ut,Et=({additionalProcessData:c,setAdditionalProcessData:_,refetchAdditionalProcessList:U,handleClickOpen:m})=>{const{user:t}=Oe(),[f,s]=o.useState([]),{enqueueSnackbar:h}=Le(),u=f.reduce((x,g)=>x+(g.quantity??0),0).toFixed(2);console.log("Quantity",u);const[i,w]=o.useState({additionalProcessDetId:0,additionalProcessId:c.additionalProcessId||0,designId:c.designNo||"",planningHeaderId:c.planningHeaderId||0,batchNo:c.batchNo||"",componentName:c.componentName||"",componentId:c.componentId||"",colorName:c.colorName||"",colorId:c.colorId||"",fabricName:c.fabricName||"",fabricId:c.fabricId||"",uomId:c.uomId||"",uom:c.uom||"",vendorId:"",pcsPerComponent:c.pcsPerComponent||"",remainingPcsPerComponent:c.pcsPerComponent-u||"",processTypeName:c.processTypeName||"",processTypeId:c.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});o.useEffect(()=>{w({...i,remainingPcsPerComponent:c.pcsPerComponent-u||""})},[f]);const{data:E}=Se(),{data:p,refetch:y}=ft(i.additionalProcessId,{skip:!i.additionalProcessId}),[q,X]=o.useState([]);o.useEffect(()=>{if(E){const x=E.result[0];X(x.vendorList)}},[E]),o.useEffect(()=>{p&&s(p.result.map((x,g)=>({id:g,...x})))},[p,y]),console.log("initialRows",f);const M=x=>{const{name:g,value:S}=x.target;w({...i,[g]:S})};o.useEffect(()=>{const x=()=>{const S=parseFloat(i.quantity)||0,T=parseFloat(i.ratePerPcs)||0;return(S*T).toFixed(2)};w(S=>({...S,totalAmount:x()}));const g=()=>{const S=parseFloat(i.totalAmount)||0,T=parseFloat(i.poPcs)||0;return(S/T).toFixed(2)};w(S=>({...S,costPerComponent:g()}))},[i.quantity,i.ratePerPcs,i.totalAmount]);const te=async()=>{console.log(i);try{const x=await ge.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcessDetails",i);console.log("Save response:",x.data),x.data.success?h("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(h(`${x.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",x.data.message)),y(),w(g=>({...g,vendorId:"",pcsPerComponent:c.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),U()}catch(x){console.error("Error saving data:",x),h("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},V=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:1},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(je,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Select Design",name:"designId",value:i.designId,onChange:M,size:"small",disabled:!0,sx:x=>({...i.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:i.batchNo,onChange:M,size:"small",disabled:!0,sx:x=>({...i.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,label:"Components",name:"componentName",value:i.componentName,onChange:M,size:"small",disabled:!0,sx:x=>({...i.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:i.fabricName,onChange:M,disabled:!0,sx:x=>({...i.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:i.colorName,onChange:M,disabled:!0,sx:x=>({...i.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:i.processTypeName,onChange:M,disabled:!0,sx:x=>({...i.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:i.pcsPerComponent,onChange:M,disabled:!0,sx:x=>({...i.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:i.remainingPcsPerComponent,onChange:M,disabled:!0,sx:x=>({...i.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:i.vendorId,onChange:M,InputLabelProps:{sx:{color:"black"}},children:q.map(x=>e.jsx(k,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:i.quantity,onChange:M,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:i.ratePerPcs,onChange:M,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:i.totalAmount,onChange:M,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:i.uom,onChange:M,disabled:!0,sx:x=>({...i.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(de,{variant:"contained",size:"small",onClick:te,children:"Save"})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ne,{iColumns:V,initialRows:f,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:y,disableEdit:!0})})})]})},Gt=()=>{const{user:c}=Oe(),{enqueueSnackbar:_}=Le(),[U,m]=o.useState(!0),[t,f]=o.useState([]),[s,h]=o.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId});console.log("initialData",t),o.useEffect(()=>{h({additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId})},[t]);const[u,i]=o.useState(!1),{data:w}=Be(),[E,p]=o.useState(""),{data:y}=Se(),{data:q,refetch:X}=Te(E,{skip:!E}),{data:M,refetch:te}=We(s.designId,{skip:!s.designId}),{data:V}=Ue({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:J}=qe({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:x,refetch:g}=yt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:S}=Ee(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("lookupData",y),console.log("collectionData",w),console.log("colorData",J);const[T,G]=o.useState([]),[b,Y]=o.useState([]),[oe,ne]=o.useState([]),[re,se]=o.useState([]),[be,C]=o.useState([]),[z,K]=o.useState([]),[le,Ie]=o.useState([]),[fe,$]=o.useState([]),[ue,F]=o.useState([]),[D,W]=o.useState([]),[O,Z]=o.useState([]);console.log("batchData",M);const[Me,Q]=o.useState([]);o.useEffect(()=>{w&&Q(w.result)},[w]),o.useEffect(()=>{q&&G(q.result)},[q]),o.useEffect(()=>{M&&Y(M.result)},[M]),o.useEffect(()=>{V&&ne(V.result)},[V]),o.useEffect(()=>{J&&F(J.result)},[J]),o.useEffect(()=>{S&&Z(S.result)},[S]),o.useEffect(()=>{if(y){const r=y.result[0];C(r.uomList),K(r.processList)}},[y]),o.useEffect(()=>{x&&(m(!1),W(x.result.map((r,N)=>({id:N,...r}))))},[x,g]),o.useEffect(()=>{if(y){const r=y.result[0];se(r.vendorList),Ie(r.operatingMachineList),$(r.workingHeadList)}},[y]),console.log("initialRows",D);const B=r=>{const{name:N,value:l}=r.target;if(N==="collectionId")Me.find(I=>I.collectionId===parseInt(l)),p(l),W([]),m(!0),h({...s,collectionId:l,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId});else if(N==="designId"){const I=T.find(d=>d.designId===parseInt(l));W([]),m(!0),h({...s,designId:l,baseColorId:I?I.colorId:"",baseColorName:I?I.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId})}else if(N==="batchNo"){const I=b.find(d=>d.batchNo===l);h({...s,batchNo:l,planningHeaderId:I?I.planningHeaderId:"",poPcs:I?I.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId}),i(!0)}else h({...s,[N]:l})};console.log("colors",ue);const ve=async()=>{console.log("formData",s);try{const r=await ge.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcess",s);console.log("Save response:",r.data),r.data.success?_("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(_(`${r.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",r.data.message)),h(N=>({additionalProcessId:0,designId:N.designId,planningHeaderId:N.planningHeaderId,batchNo:N.batchNo,baseColorName:N.baseColorName,poPcs:N.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId})),g()}catch(r){console.error("Error saving data:",r),_("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",s),o.forwardRef(function(N,l){return e.jsx(Ct,{direction:"up",ref:l,...N})});const[xe,ye]=o.useState({}),[Pe,Ce]=o.useState(!1),ie=r=>{ye(r),Ce(!0)},v=()=>{Ce(!1),ye({}),g()},L=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component"},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"AddVendor",headerName:"Add Vendor",renderCell:r=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(ke,{color:"primary",onClick:()=>ie(r.row),children:e.jsx(Je,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:lt,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:E,onChange:B,size:"small",InputLabelProps:{sx:{color:"black"}},children:Me.map(r=>e.jsx(k,{value:r.collectionId,children:r.collectionName},r.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:B,size:"small",InputLabelProps:{sx:{color:"black"}},children:T.map(r=>e.jsx(k,{value:r.designId,children:r.designNo},r.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:B,size:"small",InputLabelProps:{sx:{color:"black"}},children:b.map(r=>e.jsx(k,{value:r.batchNo,children:r.batchNo},r.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:B,disabled:!0,sx:r=>({...s.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:B,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(r=>e.jsx(k,{value:r.componentId,children:r.componentName},r.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:B,InputLabelProps:{sx:{color:"black"}},children:oe.map(r=>e.jsx(k,{value:r.fabricId,children:r.fabric},r.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:B,InputLabelProps:{sx:{color:"black"}},children:ue.map(r=>e.jsx(k,{value:r.colorId,children:r.color},r.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,onChange:B,disabled:!0,sx:r=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:s.pcsPerComponent,onChange:B,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:s.uomId,onChange:B,InputLabelProps:{sx:{color:"black"}},children:be.map(r=>e.jsx(k,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:s.processTypeId,onChange:B,InputLabelProps:{sx:{color:"black"}},children:z.map(r=>e.jsx(k,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(de,{variant:"contained",size:"small",onClick:ve,children:"Save"})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(Ne,{iColumns:L,initialRows:D,setInitialData:f,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:g,setAccordionExpanded:i,fileName:"AdditionalProcess",isLoading:U}),e.jsxs(Ge,{open:Pe,onClose:v,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(Ye,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(pe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(ke,{onClick:v,sx:{color:"#ffffff"},children:e.jsx(De,{})})]}),e.jsxs(Xe,{children:[e.jsx(Ve,{id:"alert-dialog-slide-description"}),e.jsx(Et,{additionalProcessData:xe,setAdditionalProcessData:ye,refetchAdditionalProcessList:g,handleClickOpen:ie})]})]})]})})]})]})},Yt=Gt;function Xt({}){const[c,_]=o.useState(!0),{data:U}=Se(),[m,t]=o.useState([]),[f,s]=o.useState([]),[h,u]=o.useState([]),[i,w]=o.useState([]),[E,p]=o.useState([]);Oe(),o.useEffect(()=>{U&&(u(U.result[0].vendorList),s(U.result[0].serviceList),t(U.result[0].serviceTypeList),p(U.result[0].uomList))},[U]);const[y,q]=o.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()}),X=async g=>{const{name:S,value:T}=g.target;if(console.log(`Updating ${S} to ${T}`),q({...y,[S]:T}),S==="collectionId"){const G=i.find(b=>b.collectionId===T);G&&q(b=>({...b,poPcs:G.poPcs}))}};o.useEffect(()=>{const g=()=>{const T=parseFloat(y.qty)||0,G=parseFloat(y.rate)||0;return(T*G).toFixed(2)};q(T=>({...T,totalAmount:g()}));const S=()=>{const T=parseFloat(y.poPcs)||0,G=parseFloat(y.totalAmount)||0;return(T/G).toFixed(2)};q(T=>({...T,costperPiece:S()}))},[y.qty,y.rate,y.totalAmount,y.costperPiece]);const M=async()=>{try{const g=await ge.post("https://gecxc.com:4041/api/AdditionalServices/SaveAdditionalServices",y);console.log("Form data saved:",g.data),q({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(g){console.error("Error saving data:",g)}};o.useEffect(()=>{(async()=>{try{const S=await ge.get("https://gecxc.com:4041/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",S),w(S.data.result)}catch(S){console.error("Error fetching design options:",S)}})()},[]);const[te,V]=o.useState([]),J=o.useCallback(async()=>{try{const g=await ge.get(`https://gecxc.com:4041/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${y.collectionId}`);Array.isArray(g.data.result)?(_(!1),V(g.data.result.map((S,T)=>({id:T,...S})))):(console.error("API returned unexpected data format:",g.data.result),V([]))}catch(g){console.error("Error fetching data:",g),V([])}},[y.collectionId]);o.useEffect(()=>{J()},[J]);const x=[{field:"collectionName",headerName:"Collection Name",flex:1},{field:"serviceType",headerName:"Service Type",flex:1},{field:"serviceListName",headerName:"Service List Name",flex:1},{field:"vendor",headerName:"Vendor",flex:1},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount"},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:y.collectionId,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:i.length>0?i.map(g=>e.jsx(k,{id:"collectionId",value:g.collectionId,children:g.collectionName},g.collectionId)):e.jsx(k,{disabled:!0,children:"No Collections Available"})})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:y.serviceTypeId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:m.map(g=>e.jsx(k,{value:g.lookUpId,children:g.lookUpName},g.lookUpId))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:y.serviceListId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:f.map(g=>e.jsx(k,{value:g.lookUpId,children:g.lookUpName},g.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:y.vendorId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:h.map(g=>e.jsx(k,{value:g.lookUpId,children:g.lookUpName},g.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:y.poPcs,onChange:X,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:g=>({...y.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-required",label:"Qty",name:"qty",value:y.qty,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(n,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:y.uomId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:E.map(g=>e.jsx(k,{value:g.lookUpId,children:g.lookUpName},g.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-required",label:"Rate",name:"rate",value:y.rate,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:y.totalAmount,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(n,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:y.costperPiece,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(de,{variant:"contained",color:"primary",size:"small",onClick:M,children:"Save"})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Ne,{iColumns:x,initialRows:te,isLoading:c})]})]})}const Fe=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function sa(){const[c,_]=o.useState(0),[U,m]=o.useState(new Set),[t,f]=o.useState(null),[s,h]=o.useState([]),{enqueueSnackbar:u}=Le(),{data:i,refetch:w}=Se(),E=b=>{f(b.currentTarget)},p=()=>{f(null)},y=!!t,q=y?"simple-popover":void 0,X=b=>b===1,M=b=>U.has(b),te=()=>{let b=U;M(c)&&(b=new Set(b.values()),b.delete(c)),_(Y=>Y+1),m(b)},V=()=>{_(b=>b-1)},J=()=>{if(!X(c))throw new Error("You can't skip a step that isn't optional.");_(b=>b+1),m(b=>{const Y=new Set(b.values());return Y.add(c),Y})},x=()=>{_(0)},[g,S]=o.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),T=async()=>{if(!g.lookUpDomain||!g.lookUpName){u("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const b=await ge.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${g.lookUpDomain}&LookUpName=${g.lookUpName}&appId=1`);return console.log("Form data saved:",b.data),u("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),S({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),w(),b.data}catch(b){throw console.error("Error saving data:",b),u("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),b}},G=b=>{S({...g,[b.target.name]:b.target.value})};return o.useEffect(()=>{(async()=>{try{const Y=await ge.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",Y),h(Y.data.result)}catch(Y){console.error("Error fetching design options:",Y)}})()},[]),e.jsxs(je,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(pe,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(de,{"aria-describedby":q,variant:"outlined",size:"small",onClick:E,children:"+Lookup"}),e.jsx(kt,{id:"mouse-over-popover",open:y,anchorEl:t,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(n,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:g.lookUpDomain,name:"lookUpDomain",onChange:G,children:s.map(b=>e.jsx(k,{value:b.lookUpDomain,children:b.lookUpDomain},b.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(n,{fullWidth:!0,label:"Add Lookup Description",value:g.lookUpName,onChange:G,name:"lookUpName",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(de,{variant:"contained",size:"small",onClick:T,children:"Save"})})]})})]})]}),e.jsx(vt,{activeStep:c,children:Fe.map((b,Y)=>{const oe={},ne={};return X(Y)&&(ne.optional=e.jsx(pe,{variant:"caption",children:"Optional"})),M(Y)&&(oe.completed=!1),e.jsx(Pt,{...oe,children:e.jsxs(Mt,{...ne,onClick:()=>_(Y),style:{cursor:"pointer"},children:[" ",b]})},b)})}),e.jsxs(je,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(de,{color:"inherit",disabled:c===0,onClick:V,sx:{mr:1},children:"Back"}),e.jsx(je,{sx:{flex:"1 1 auto"}}),X(c)&&e.jsx(de,{color:"inherit",onClick:J,sx:{mr:1},children:"Skip"}),e.jsx(de,{onClick:te,children:c===Fe.length-1?"Finish":"Next"})]}),c===Fe.length?e.jsxs(o.Fragment,{children:[e.jsx(pe,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(je,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(je,{sx:{flex:"1 1 auto"}}),e.jsx(de,{onClick:x,children:"Reset"})]})]}):e.jsxs(o.Fragment,{children:[c===0&&e.jsx(Wt,{}),c===1&&e.jsx(jt,{}),c===2&&e.jsx(Qt,{}),c===3&&e.jsx(wt,{}),c===4&&e.jsx(qt,{}),c===5&&e.jsx(Yt,{}),c===6&&e.jsx(Xt,{}),e.jsxs(je,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(de,{color:"inherit",disabled:c===0,onClick:V,sx:{mr:1},children:"Back"}),e.jsx(je,{sx:{flex:"1 1 auto"}}),X(c)&&e.jsx(de,{color:"inherit",onClick:J,sx:{mr:1},children:"Skip"}),e.jsx(de,{onClick:te,children:c===Fe.length-1?"Finish":"Next"})]})]})]})}export{sa as default};
