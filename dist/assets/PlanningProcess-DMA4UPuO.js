import{r,j as e,_ as fe,e as se,a as de,f as ne,g as ue,h as pe,i as xe,k as me,l as ge,M as oe,F as re,G as a,T as E,D as ie,m as be,n as Ie,B as ee}from"./index-C1wApDVi.js";import{a as Z}from"./axios-DN9HXa7T.js";import{S as ve,a as je,b as Se,F as Ce}from"./Fabrication-BFYOOD-W.js";import{A as Pe,C as ye,F as ce}from"./EditAbleDataGrid-BFou745y.js";import{B as H,T as n,P as Ne}from"./TextField-j9p05hMe.js";import{M as v}from"./Skeleton-og7K__Pb.js";let he=!1;const Fe=r.forwardRef(function(u,k){return he||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),he=!0),e.jsx(Pe,fe({ref:k},u))}),ke=()=>{const[t,u]=r.useState({designId:"",batchNo:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHeads:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStitches:"",threadRate:"",threadAmount:"",tillaStitches:"",tillaRate:"",tillaAmount:"",sequenceStitches:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:"",solvingInMeters:"",solvingRate:"",solvingAmount:"",additional:"",costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:k}=se(),[z,M]=r.useState(""),{data:N}=de(),{data:W,refetch:_}=ne(z,{skip:!z}),{data:U,refetch:te}=ue(t.designId,{skip:!t.designId}),{data:F}=pe({batchNo:t.batchNo,componentId:t.componentId},{skip:!t.batchNo||!t.componentId}),{data:R}=xe({batchNo:t.batchNo,componentId:t.componentId,fabricId:t.fabricId},{skip:!t.batchNo||!t.componentId||!t.fabricId}),{data:D,refetch:$}=me(t.batchNo,{skip:!t.batchNo}),{data:T}=ge(t.batchNo,{skip:!t.batchNo});console.log("colorData",R);const[B,q]=r.useState([]),[L,b]=r.useState([]),[y,V]=r.useState([]),[w,i]=r.useState([]),[G,C]=r.useState([]),[Y,J]=r.useState([]),[K,O]=r.useState([]),[c,j]=r.useState([]);r.useEffect(()=>{W&&q(W.result)},[W]),r.useEffect(()=>{U&&b(U.result)},[U]),r.useEffect(()=>{F&&V(F.result)},[F]),r.useEffect(()=>{R&&J(F.result)},[R]),r.useEffect(()=>{T&&j(T.result)},[T]),r.useEffect(()=>{D&&O(D.result.map((l,d)=>({id:d,...l})))},[D]),r.useEffect(()=>{if(N){const l=N.result[0];i(l.vendorList),C(l.noOfHeadsList)}},[N]);const f=(k==null?void 0:k.result)||[];r.useEffect(()=>{const l=()=>{const h=parseFloat(t.repeats)||0,S=parseFloat(t.itemsPerRepeat)||0;return h*S};u(h=>({...h,totalPcs:l()}));const d=()=>{const h=parseFloat(t.threadStitches)||0,S=parseFloat(t.threadRate)||0,A=parseFloat(t.noOfHeads)||0,X=parseFloat(t.repeats)||0;return h/1e3*(S*X*A)};u(h=>({...h,threadAmount:d()}));const p=()=>{const h=parseFloat(t.tillaStitches)||0,S=parseFloat(t.tillaRate)||0,A=parseFloat(t.noOfHeads)||0,X=parseFloat(t.repeats)||0;return h/1e3*(S*X*A)};u(h=>({...h,tillaAmount:p()}));const x=()=>{const h=parseFloat(t.sequenceStitches)||0,S=parseFloat(t.sequenceRate)||0,A=parseFloat(t.noOfHeads)||0,X=parseFloat(t.repeats)||0;return h/1e3*(S*X*A)};u(h=>({...h,sequenceAmount:x()}));const P=()=>{const h=parseFloat(t.repeats)||0,S=parseFloat(t.noOfHeads)||0,A=parseFloat(t.solvingLayers)||0;return h*S*13/39.37*A};u(h=>({...h,solvingInMeters:P()}));const ae=()=>{const h=parseFloat(t.solvingInMeters)||0,S=parseFloat(t.solvingRate)||0;return parseFloat(t.solvingLayers),h*S};u(h=>({...h,solvingAmount:ae()}));const Q=()=>{const h=parseFloat(t.threadAmount)||0,S=parseFloat(t.tillaAmount)||0,A=parseFloat(t.sequenceAmount)||0,X=parseFloat(t.solvingAmount)||0;return h+S+A+X};u(h=>({...h,totalAmount:Q()}));const g=()=>{const h=parseFloat(t.totalAmount)||0,S=parseFloat(t.totalPcs)||0;return h/S};u(h=>({...h,costPerComponent:g()}))},[t.threadAmount,t.totalAmount,t.sequenceAmount,t.solvingAmount,t.repeats,t.tillaAmount,t.itemsPerRepeat,t.threadRate,t.threadStitches,t.noOfHeads,t.tillaRate,t.tillaStitches,t.sequenceRate,t.sequenceStitches,t.solvingLayers,t.solvingInMeters,t.solvingRate]);const m=l=>{const{name:d,checked:p}=l.target;u(x=>({...x,[d]:p}))},s=l=>{const{name:d,value:p}=l.target;if(d==="collectionId"){const x=f.find(P=>P.collectionId===parseInt(p));M(p),u({...t,collectionId:p,poPcs:x?x.poPcs:""})}else if(d==="designId"){const x=B.find(P=>P.designId===parseInt(p));u({...t,designId:p,baseColorId:x?x.colorId:"",baseColorName:x?x.colorName:""})}else if(d==="batchNo"){const x=L.find(P=>P.batchNo===p);u({...t,batchNo:p,planningHeaderId:x?x.planningHeaderId:""})}else if(d==="fabricId"){const x=y.find(P=>P.fabricId===p);u({...t,fabricId:p,quantity:x?x.total:""})}else u({...t,[d]:p})},I=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:B.map(l=>({value:l.designId,label:l.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"vendorId",headerName:"Vendor",editable:!0,flex:1,type:"singleSelect",valueOptions:w.map(l=>({value:l.lookUpId,label:l.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(l,d)=>{const p=d.quantity??0,x=d.rate??0,P=p*x;return console.log("total",P),{...d,total:P}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(l,d)=>{const p=d.total??0,x=d.poPcs??0,P=p/x;return console.log("unitPrice",P),{...d,unitPrice:P}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(l,d)=>{const p=d.total??0,x=d.gst??0,P=p*(1+x/100);return console.log("totalInclGst",P),{...d,totalInclGst:P}}}],o=async()=>{try{const l=await Z.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",t);console.log("Save response:",l.data),u({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(l){console.error("Error saving data:",l)}};return console.log("formData",t),e.jsxs(oe,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(re,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(E,{variant:"h3",gutterBottom:!0,children:"Embroidery"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(H,{variant:"contained",size:"small",onClick:o,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:z,onChange:s,size:"small",children:f.map(l=>e.jsx(v,{value:l.collectionId,children:l.collectionName},l.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:s,size:"small",children:B.map(l=>e.jsx(v,{value:l.designId,children:l.designNo},l.designId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:s,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:s,size:"small",children:L.map(l=>e.jsx(v,{value:l.batchNo,children:l.batchNo},l.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:t.componentId,onChange:s,size:"small",children:c.map(l=>e.jsx(v,{value:l.componentId,children:l.componentName},l.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ie,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:s,children:y.map(l=>e.jsx(v,{value:l.fabricId,children:l.fabric},l.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:t.vendorId,onChange:s,children:w.map(l=>e.jsx(v,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:t.colorId,onChange:s,children:Y.map(l=>e.jsx(v,{value:l.colorId,children:l.color},l.colorId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:t.availableQty,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:t.repeats,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHeads",value:t.noOfHeads,onChange:s,children:G.map(l=>e.jsx(v,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:t.cuttingSize,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"itemsPerRepeat",fullWidth:!0,size:"small",name:"itemsPerRepeat",value:t.itemsPerRepeat,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"total Pcs.",fullWidth:!0,size:"small",name:"totalPcs",value:t.totalPcs,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total Amount",fullWidth:!0,size:"small",name:"totalAmount",value:t.totalAmount,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:t.costPerComponent,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(be,{control:e.jsx(ye,{checked:t.isSolving,onChange:m,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(E,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Stitches",fullWidth:!0,size:"small",name:"threadStitches",value:t.threadStitches,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Rate",fullWidth:!0,size:"small",name:"threadRate",value:t.threadRate,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",name:"threadAmount",value:t.threadAmount,onChange:s})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(E,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Stitches",fullWidth:!0,size:"small",name:"tillaStitches",value:t.tillaStitches,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Rate",fullWidth:!0,size:"small",name:"tillaRate",value:t.tillaRate,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",name:"tillaAmount",value:t.tillaAmount,onChange:s})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(E,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Stitches",fullWidth:!0,size:"small",name:"sequenceStitches",value:t.sequenceStitches,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Rate",fullWidth:!0,size:"small",name:"sequenceRate",value:t.sequenceRate,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:t.sequenceAmount,onChange:s})})]})}),t.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(E,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Layers",fullWidth:!0,size:"small",name:"solvingLayers",value:t.solvingLayers,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Meters",fullWidth:!0,size:"small",name:"solvingInMeters",value:t.solvingInMeters,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Rate",fullWidth:!0,size:"small",name:"solvingRate",value:t.solvingRate,onChange:s})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Amount",fullWidth:!0,size:"small",name:"solvingAmount",value:t.solvingAmount,onChange:s})})]})}):null]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ce,{ncolumns:I,initialRows:K,formData:t,disableAddRecord:!0})})})]})},ze=ke,Oe=()=>{const{data:t}=se(),[u,k]=r.useState(""),{data:z,refetch:M}=ne(u,{skip:!u}),[N,W]=r.useState([]);r.useEffect(()=>{z&&(W(z.result),M())},[z]),console.log("designList",N),console.log("collectionData",t);const _=(t==null?void 0:t.result)||[],[U,te]=r.useState([]),[F,R]=r.useState([]),[D,$]=r.useState([]),[T,B]=r.useState([]),[q,L]=r.useState([]),[b,y]=r.useState([]),[V,w]=r.useState([]),[i,G]=r.useState({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()});r.useEffect(()=>{(async()=>{try{const f=(await Z.get("https://gecxc.com:4041/API/Common/GetPrePlanningLookUp?appID=1")).data.result[0];te(f.componentList),$(f.colorList),R(f.fabricList),L(f.noOfHeadsList),B(f.uom)}catch(j){console.error("Error fetching pre-planning lookup data:",j)}})()},[]),r.useEffect(()=>{const c=async f=>{try{const m=await Z.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${f}`);console.log(m.data),y(m.data.result)}catch(m){console.error("Error fetching pre-planning lookup data:",m)}},j=async f=>{try{const m=await Z.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningByPlanningHeaderId?planningHeaderId=${f}`);console.log("GetPrePlanningByPlanningHeaderI",m.data.result),w(m.data.result.map((s,I)=>({...s,id:I})))}catch(m){console.error("Error fetching pre-planning lookup data:",m)}};i.designId&&c(i.designId),i.designId&&j(i.planningHeaderId)},[i.designId,i.planningHeaderId]),r.useEffect(()=>{const c=()=>{const f=parseFloat(i.repeats)||0,m=parseFloat(i.repeatSize)||0;return f*m};G(f=>({...f,totalFabric:c()}));const j=()=>{const f=parseFloat(i.totalFabric)||0,m=parseFloat(i.shrinkage)||0,s=parseFloat(i.wastage)||0;return f*(100+(m+s))/100};G(f=>({...f,total:j()}))},[i.repeats,i.repeatSize,i.totalFabric,i.shrinkage,i.wastage]);const C=c=>{const{name:j,value:f}=c.target;if(j==="collectionId"){const m=_.find(s=>s.collectionId===parseInt(f));k(f),G({...i,collectionId:f,noOfDesigns:m?m.noOfDesigns:"",noOfColors:m?m.noOfColors:""})}else if(j==="designId"){const m=N.find(s=>s.designId===parseInt(f));G({...i,designId:f,baseColorId:m?m.colorId:"",baseColorName:m?m.colorName:""})}else if(j==="batchNo"){const m=b.find(s=>s.batchNo===f);G({...i,batchNo:f,planningHeaderId:m?m.planningHeaderId:""})}else G({...i,[j]:f})},Y=async()=>{try{const c=await Z.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",{designId:parseInt(i.designId),planningHeaderId:parseInt(i.planningHeaderId),componentId:parseInt(i.componentId),colorId:parseInt(i.colorId),batchNo:i.batchNo,baseColorId:parseInt(i.baseColorId),cuttingSize:parseFloat(i.cuttingSize),fabricId:parseInt(i.fabricId),noOfHeads:parseInt(i.noOfHeads),repeats:parseFloat(i.repeats),repeatSize:parseFloat(i.repeatSize),uomId:parseInt(i.uomId),totalFabric:parseFloat(i.totalFabric),shrinkage:parseFloat(i.shrinkage),wastage:parseFloat(i.wastage),total:parseFloat(i.total),appId:i.appId,createdOn:i.createdOn,createdBy:i.createdBy,lastUpdatedBy:i.lastUpdatedBy,lastUpdatedOn:i.lastUpdatedOn});console.log("Data saved successfully:",c.data),G({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()}),w([])}catch(c){console.error("Error saving data:",c)}},J=[{field:"componentId",headerName:"Component",editable:!0,flex:1,type:"singleSelect",valueOptions:U.map(c=>({value:c.lookUpId,label:c.lookUpName}))},{field:"colorId",headerName:"Color",editable:!0,flex:1,type:"singleSelect",valueOptions:D.map(c=>({value:c.lookUpId,label:c.lookUpName}))},{field:"cuttingSize",headerName:"Cutting Size",flex:1,editable:!0},{field:"fabricId",headerName:"Fabrication",editable:!0,flex:1,type:"singleSelect",valueOptions:F.map(c=>({value:c.lookUpId,label:c.lookUpName}))},{field:"noOfHeads",headerName:"No. Of Heads",editable:!0,flex:1,type:"singleSelect",valueOptions:q.map(c=>({value:c.lookUpId,label:c.lookUpName}))},{field:"repeats",headerName:"Repeats",flex:1,editable:!0},{field:"repeatSize",headerName:"Repeat Size",flex:1,editable:!0},{field:"totalFabric",headerName:"Total Fabric",flex:1,editable:!0,valueSetter:(c,j)=>{const f=j.repeats??0,m=j.repeatSize??0,s=f*m;return console.log("totalFabric",s),{...j,totalFabric:s}}},{field:"uomId",headerName:"UOM",editable:!0,flex:1,type:"singleSelect",valueOptions:T.map(c=>({value:c.lookUpId,label:c.lookUpName}))},{field:"shrinkage",headerName:"Shrinkage",flex:1,editable:!0},{field:"wastage",headerName:"Wastage",flex:1,editable:!0},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(c,j)=>{const f=j.shrinkage??0,m=j.wastage??0,s=j.totalFabric??0,I=s*(100-(f+m))/100;return console.log("totalFabric",s),{...j,total:I}}}];return console.log("batchList:",b),e.jsxs(oe,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(re,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(E,{variant:"h3",gutterBottom:!0,children:"Pre Planning"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(H,{variant:"contained",size:"small",onClick:Y,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:4,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:i.collectionId,onChange:C,size:"small",children:_.map(c=>e.jsx(v,{value:c.collectionId,children:c.collectionName},c.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"No of Design",fullWidth:!0,size:"small",name:"noOfDesigns",value:i.noOfDesigns,onChange:C,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"No of Color",fullWidth:!0,size:"small",name:"noOfColors",value:i.noOfColors,onChange:C,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:i.designId,onChange:C,size:"small",children:N.map(c=>e.jsx(v,{value:c.designId,children:c.designNo},c.designId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:i.baseColorName,onChange:C,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:4,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:i.batchNo,onChange:C,size:"small",children:b.map(c=>e.jsx(v,{value:c.batchNo,children:c.batchNo},c.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ie,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Component",defaultValue:"",size:"small",name:"componentId",value:i.componentId,onChange:C,children:U.map(c=>e.jsx(v,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Color",fullWidth:!0,select:!0,size:"small",name:"colorId",value:i.colorId,onChange:C,children:D.map(c=>e.jsx(v,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:i.cuttingSize,onChange:C})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Fabrication",defaultValue:"",size:"small",name:"fabricId",value:i.fabricId,onChange:C,children:F.map(c=>e.jsx(v,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"No of Heads",defaultValue:"",size:"small",name:"noOfHeads",value:i.noOfHeads,onChange:C,children:q.map(c=>e.jsx(v,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:i.repeats,onChange:C})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Repeat Size",fullWidth:!0,size:"small",name:"repeatSize",value:i.repeatSize,onChange:C})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:i.totalFabric,onChange:C})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:i.uomId,onChange:C,children:T.map(c=>e.jsx(v,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Shrinkage %",fullWidth:!0,size:"small",name:"shrinkage",value:i.shrinkage,onChange:C})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Wastage %",fullWidth:!0,size:"small",name:"wastage",value:i.wastage,onChange:C})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total",fullWidth:!0,size:"small",name:"total",value:i.total,onChange:C})})]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ce,{ncolumns:J,initialRows:V,formData:i,editAPi:"https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",deleteApi:"https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",deleteBy:"planningId",disableAddRecord:!0})})})]})},Ae=Oe,Ue=()=>{const[t,u]=r.useState({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:""});console.log("Dyeing form data to send",t);const{data:k}=se(),[z,M]=r.useState(""),{data:N}=de(),{data:W,refetch:_}=ne(z,{skip:!z}),{data:U,refetch:te}=ue(t.designId,{skip:!t.designId}),{data:F}=Ie(t.batchNo,{skip:!t.batchNo}),{data:R,refetch:D}=me(t.batchNo,{skip:!t.batchNo}),[$,T]=r.useState([]),[B,q]=r.useState([]),[L,b]=r.useState([]),[y,V]=r.useState([]),[w,i]=r.useState([]),[G,C]=r.useState([]),[Y,J]=r.useState([]);r.useEffect(()=>{W&&T(W.result)},[W]),r.useEffect(()=>{U&&q(U.result)},[U]),r.useEffect(()=>{F&&b(F.result)},[F]),r.useEffect(()=>{N&&J(N.result[0].vendorList)},[F]),console.log(Y),r.useEffect(()=>{R&&i(R.result.map((s,I)=>({id:I,...s})))},[R]),r.useEffect(()=>{if(N){const s=N.result[0];V(s.uomList)}},[N]);const K=(k==null?void 0:k.result)||[],O=s=>{const{name:I,value:o}=s.target;if(I==="collectionId"){const l=K.find(d=>d.collectionId===parseInt(o));M(o),u({...t,collectionId:o,poPcs:l?l.poPcs:""})}else if(I==="designId"){const l=$.find(d=>d.designId===parseInt(o));u({...t,designId:o,baseColorId:l?l.colorId:"",baseColorName:l?l.colorName:""})}else if(I==="batchNo"){const l=B.find(d=>d.batchNo===o);u({...t,batchNo:o,planningHeaderId:l?l.planningHeaderId:""})}else if(I==="fabricId"){const l=L.find(d=>d.fabricId===o);console.log("Selected Fabric:",L),u({...t,fabricId:o,OutputQty:l?l.total:""}),c(o)}else u(I==="processType"?{...t,processType:o}:I==="vendorId"?{...t,vendorId:o}:{...t,[I]:o})},c=async s=>{try{const o=(await Z.get(`https://gecxc.com:4041/api/DyeingPrinting/GetFabricColorFromPrePlanningByFabricId?fabricId=${s}`)).data.result;if(console.log("Dyeing Color Data",o),o.length>0){const d=o[0];u(p=>({...p,Shrinkage:d.shrinkage.toFixed(2),Wastage:d.wastage.toFixed(2),UOM:d.uom,AvailableQty:d.total.toString()}))}const l=o.map(d=>({label:d.color,value:d.colorId}));if(C(l),l.length>0){const d=l[0];u(p=>({...p,ColorId:d.value,color:d.label}))}}catch(I){console.error("Error fetching fabric color data:",I)}};r.useEffect(()=>{const s=()=>{const Q=parseFloat(t.AvailableQty)||0,g=parseFloat(t.Shrinkage)||0,h=parseFloat(t.Wastage)||0;return Q*(100-(g+h))/100},I=()=>{const Q=parseFloat(t.AvailableQty)||0,g=parseFloat(t.RatePerUOM)||0;return Q*g},o=(Q,g)=>Q*(1+g/100),l=s(),d=I(),p=parseFloat(t.GST)||0,x=o(d,p),P=parseFloat(t.poPcs)||0,ae=P?x/P:0;u(Q=>({...Q,OutputQty:l,TotalExclGst:d.toFixed(2),TotalIncludingGst:x.toFixed(2),UnitRatePerPo:ae.toFixed(2)}))},[t.AvailableQty,t.Shrinkage,t.Wastage,t.RatePerUOM,t.GST,t.poPcs,t.UnitRatePerPo]);const j=async()=>{console.log("Form Data:",t);const s={dpId:parseInt(t.DPId)||0,designId:parseInt(t.designId),batchNo:t.batchNo,fabricId:parseInt(t.fabricId),colorId:parseInt(t.ColorId)||0,vendorId:t.vendorId||0,processType:t.processType,availableQty:parseFloat(t.AvailableQty)||0,shrinkage:parseFloat(t.Shrinkage)||0,wastage:parseFloat(t.Wastage)||0,outputQty:parseFloat(t.OutputQty)||0,uomId:parseInt(t.UOM)||0,ratePerUOM:parseFloat(t.RatePerUOM)||0,unitRatePerPo:parseFloat(t.UnitRatePerPo)||0,totalExclGst:parseFloat(t.TotalExclGst)||0,gst:parseFloat(t.GST)||0,gstAmount:parseFloat(t.GSTAmount)||0,totalIncludingGst:parseFloat(t.TotalIncludingGst)||0,createdBy:t.createdBy};console.log("Payload:",s);try{const I=await Z.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",s);I.status===200?(console.log("Data saved successfully:",I.data),u({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:""})):console.error("Failed to save data:",I.data)}catch(I){console.error("Error saving data:",I)}},f=[{field:"name",headerName:"Order Number",editable:!0,flex:2},{field:"DesignId",headerName:"Design",type:"number",flex:1,align:"left",headerAlign:"left",editable:!0},{field:"FabricId",headerName:"Fabric",type:"date",flex:1,editable:!0},{field:"ProcessType",headerName:"Process",flex:1,editable:!0},{field:"ColorId",headerName:"Color",flex:1,editable:!0},{field:"role",headerName:"Po Pcs",flex:1,editable:!0},{field:"AvailableQty",headerName:"Qty",flex:1,editable:!0},{field:"UOM",headerName:"UOM",flex:1,editable:!0},{field:"RatePerUOM",headerName:"Rate",flex:1,editable:!0},{field:"UnitRatePerPo",headerName:"Unit Price",flex:1,editable:!0},{field:"TotalIncludingGst",headerName:"Total W/ GST",flex:1,editable:!0}],m=[{value:"D",label:"Dyeing"},{value:"P",label:"Printing"}];return e.jsx(oe,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(re,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(E,{variant:"h3",gutterBottom:!0,children:"Dyeing/Printing"})}),e.jsx(a,{item:!0,xs:3,md:3,textAlign:"right",children:e.jsx(H,{variant:"contained",color:"primary",size:"small",onClick:j,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:z,onChange:O,size:"small",children:K.map(s=>e.jsx(v,{value:s.collectionId,children:s.collectionName},s.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:O,size:"small",children:$.map(s=>e.jsx(v,{value:s.designId,children:s.designNo},s.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:O,size:"small",children:B.map(s=>e.jsx(v,{value:s.batchNo,children:s.batchNo},s.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:O,children:L.map(s=>e.jsx(v,{value:s.fabricId,children:s.fabric},s.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(Fe,{fullWidth:!0,options:G,getOptionLabel:s=>s.label||"",renderInput:s=>e.jsx(n,{...s,label:"Color",name:"ColorId",size:"small"}),value:G.find(s=>s.value===t.ColorId)||null,onChange:(s,I)=>{u(o=>({...o,ColorId:I?I.value:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:t.vendorId,onChange:O,children:Y.map(s=>e.jsx(v,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:O,disabled:!0,focused:!0})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:t.processType,onChange:O,children:m.map(s=>e.jsx(v,{value:s.value,children:s.label},s.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:O})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:t.UOM})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"AvailableQty",fullWidth:!0,size:"small",name:"AvailableQty",value:t.AvailableQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Shrinkage%",fullWidth:!0,size:"small",name:"Shrinkage",value:t.Shrinkage})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Wastage%",fullWidth:!0,size:"small",name:"Wastage",value:t.Wastage})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",value:t.OutputQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Rate",fullWidth:!0,size:"small",name:"RatePerUOM",value:t.RatePerUOM,onChange:O})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total Excluding GST",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalExclGst,onChange:O})}),e.jsxs(a,{item:!0,xs:12,md:1.5,children:[e.jsx(n,{label:"GST",fullWidth:!0,size:"small",name:"GST",value:t.GST,onChange:O})," "]}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalIncludingGst,onChange:O})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(n,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:t.UnitRatePerPo,onChange:O})}),e.jsx(ie,{color:"#cc8587",sx:{height:2,width:"100%",mt:2}}),e.jsx(a,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(ce,{initialRows:w,ncolumns:f})})]})})})},De=Ue,We=()=>{const[t,u]=r.useState({designId:"",batchNo:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHeads:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStitches:"",threadRate:"",threadAmount:"",tillaStitches:"",tillaRate:"",tillaAmount:"",sequenceStitches:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:"",solvingInMeters:"",solvingRate:"",solvingAmount:"",additional:"",costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:k}=se(),[z,M]=r.useState(""),{data:N}=de(),{data:W,refetch:_}=ne(z,{skip:!z}),{data:U,refetch:te}=ue(t.designId,{skip:!t.designId}),{data:F}=pe({batchNo:t.batchNo,componentId:t.componentId},{skip:!t.batchNo||!t.componentId}),{data:R}=xe({batchNo:t.batchNo,componentId:t.componentId,fabricId:t.fabricId},{skip:!t.batchNo||!t.componentId||!t.fabricId}),{data:D,refetch:$}=me(t.batchNo,{skip:!t.batchNo}),{data:T}=ge(t.batchNo,{skip:!t.batchNo});console.log("colorData",R);const[B,q]=r.useState([]),[L,b]=r.useState([]),[y,V]=r.useState([]),[w,i]=r.useState([]),[G,C]=r.useState([]),[Y,J]=r.useState([]),[K,O]=r.useState([]),[c,j]=r.useState([]);r.useEffect(()=>{W&&q(W.result)},[W]),r.useEffect(()=>{U&&b(U.result)},[U]),r.useEffect(()=>{F&&V(F.result)},[F]),r.useEffect(()=>{R&&J(F.result)},[R]),r.useEffect(()=>{T&&j(T.result)},[T]),r.useEffect(()=>{D&&O(D.result.map((o,l)=>({id:l,...o})))},[D]),r.useEffect(()=>{if(N){const o=N.result[0];i(o.vendorList),C(o.noOfHeadsList)}},[N]);const f=(k==null?void 0:k.result)||[];r.useEffect(()=>{const o=()=>{const g=parseFloat(t.repeats)||0,h=parseFloat(t.itemsPerRepeat)||0;return g*h};u(g=>({...g,totalPcs:o()}));const l=()=>{const g=parseFloat(t.threadStitches)||0,h=parseFloat(t.threadRate)||0,S=parseFloat(t.noOfHeads)||0,A=parseFloat(t.repeats)||0;return g/1e3*(h*A*S)};u(g=>({...g,threadAmount:l()}));const d=()=>{const g=parseFloat(t.tillaStitches)||0,h=parseFloat(t.tillaRate)||0,S=parseFloat(t.noOfHeads)||0,A=parseFloat(t.repeats)||0;return g/1e3*(h*A*S)};u(g=>({...g,tillaAmount:d()}));const p=()=>{const g=parseFloat(t.sequenceStitches)||0,h=parseFloat(t.sequenceRate)||0,S=parseFloat(t.noOfHeads)||0,A=parseFloat(t.repeats)||0;return g/1e3*(h*A*S)};u(g=>({...g,sequenceAmount:p()}));const x=()=>{const g=parseFloat(t.repeats)||0,h=parseFloat(t.noOfHeads)||0,S=parseFloat(t.solvingLayers)||0;return g*h*13/39.37*S};u(g=>({...g,solvingInMeters:x()}));const P=()=>{const g=parseFloat(t.solvingInMeters)||0,h=parseFloat(t.solvingRate)||0;return parseFloat(t.solvingLayers),g*h};u(g=>({...g,solvingAmount:P()}));const ae=()=>{const g=parseFloat(t.threadAmount)||0,h=parseFloat(t.tillaAmount)||0,S=parseFloat(t.sequenceAmount)||0,A=parseFloat(t.solvingAmount)||0;return g+h+S+A};u(g=>({...g,totalAmount:ae()}));const Q=()=>{const g=parseFloat(t.totalAmount)||0,h=parseFloat(t.totalPcs)||0;return g/h};u(g=>({...g,costPerComponent:Q()}))},[t.threadAmount,t.totalAmount,t.sequenceAmount,t.solvingAmount,t.repeats,t.tillaAmount,t.itemsPerRepeat,t.threadRate,t.threadStitches,t.noOfHeads,t.tillaRate,t.tillaStitches,t.sequenceRate,t.sequenceStitches,t.solvingLayers,t.solvingInMeters,t.solvingRate]);const m=o=>{const{name:l,value:d}=o.target;if(l==="collectionId"){const p=f.find(x=>x.collectionId===parseInt(d));M(d),u({...t,collectionId:d,poPcs:p?p.poPcs:""})}else if(l==="designId"){const p=B.find(x=>x.designId===parseInt(d));u({...t,designId:d,baseColorId:p?p.colorId:"",baseColorName:p?p.colorName:""})}else if(l==="batchNo"){const p=L.find(x=>x.batchNo===d);u({...t,batchNo:d,planningHeaderId:p?p.planningHeaderId:""})}else if(l==="fabricId"){const p=y.find(x=>x.fabricId===d);u({...t,fabricId:d,quantity:p?p.total:""})}else u({...t,[l]:d})},s=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:B.map(o=>({value:o.designId,label:o.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"vendorId",headerName:"Vendor",editable:!0,flex:1,type:"singleSelect",valueOptions:w.map(o=>({value:o.lookUpId,label:o.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(o,l)=>{const d=l.quantity??0,p=l.rate??0,x=d*p;return console.log("total",x),{...l,total:x}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(o,l)=>{const d=l.total??0,p=l.poPcs??0,x=d/p;return console.log("unitPrice",x),{...l,unitPrice:x}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(o,l)=>{const d=l.total??0,p=l.gst??0,x=d*(1+p/100);return console.log("totalInclGst",x),{...l,totalInclGst:x}}}],I=async()=>{try{const o=await Z.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",t);console.log("Save response:",o.data),u({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(o){console.error("Error saving data:",o)}};return console.log("formData",t),e.jsxs(oe,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(re,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(E,{variant:"h3",gutterBottom:!0,children:"Schiffli"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(H,{variant:"contained",size:"small",onClick:I,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:z,onChange:m,size:"small",children:f.map(o=>e.jsx(v,{value:o.collectionId,children:o.collectionName},o.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:m,size:"small",children:B.map(o=>e.jsx(v,{value:o.designId,children:o.designNo},o.designId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:m,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:m,size:"small",children:L.map(o=>e.jsx(v,{value:o.batchNo,children:o.batchNo},o.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(n,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:t.componentId,onChange:m,size:"small",children:c.map(o=>e.jsx(v,{value:o.componentId,children:o.componentName},o.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ie,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:m,children:y.map(o=>e.jsx(v,{value:o.fabricId,children:o.fabric},o.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:t.vendorId,onChange:m,children:w.map(o=>e.jsx(v,{value:o.lookUpId,children:o.lookUpName},o.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:t.colorId,onChange:m,children:Y.map(o=>e.jsx(v,{value:o.colorId,children:o.color},o.colorId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:t.availableQty,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:t.repeats,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHeads",value:t.noOfHeads,onChange:m,children:G.map(o=>e.jsx(v,{value:o.lookUpId,children:o.lookUpName},o.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:t.cuttingSize,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"itemsPerRepeat",fullWidth:!0,size:"small",name:"itemsPerRepeat",value:t.itemsPerRepeat,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"total Pcs.",fullWidth:!0,size:"small",name:"totalPcs",value:t.totalPcs,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Total Amount",fullWidth:!0,size:"small",name:"totalAmount",value:t.totalAmount,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(n,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:t.costPerComponent,onChange:m})})]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ce,{ncolumns:s,initialRows:K,formData:t,disableAddRecord:!0})})})]})},Re=We,le=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","name6","name7","name8"];function Ee(){const[t,u]=r.useState(0),[k,z]=r.useState(new Set),[M,N]=r.useState(null),[W,_]=r.useState([]),U=b=>{N(b.currentTarget)},te=()=>{N(null)},F=!!M,R=F?"simple-popover":void 0,D=b=>b===1,$=b=>k.has(b),T=()=>{let b=k;$(t)&&(b=new Set(b.values()),b.delete(t)),u(y=>y+1),z(b)},B=()=>{u(b=>b-1)},q=()=>{if(!D(t))throw new Error("You can't skip a step that isn't optional.");u(b=>b+1),z(b=>{const y=new Set(b.values());return y.add(t),y})},L=()=>{u(0)};return r.useEffect(()=>{(async()=>{try{const y=await Z.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",y),_(y.data.result)}catch(y){console.error("Error fetching design options:",y)}console.log("LookupData",response)})()},[]),e.jsxs(ee,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(E,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(H,{"aria-describedby":R,variant:"outlined",size:"small",onClick:U,children:"+Lookup"}),e.jsx(Ne,{id:"mouse-over-popover",open:F,anchorEl:M,onClose:te,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(n,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Design",size:"small",children:W.map(b=>e.jsx(v,{value:b.lookUpDomain,children:b.lookUpDomain},b.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(n,{fullWidth:!0,label:"Add Lookup Description",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(H,{variant:"contained",size:"small",children:"Save"})})]})})]})]}),e.jsx(ve,{activeStep:t,children:le.map((b,y)=>{const V={},w={};return D(y)&&(w.optional=e.jsx(E,{variant:"caption",children:"Optional"})),$(y)&&(V.completed=!1),e.jsx(je,{...V,children:e.jsx(Se,{...w,children:b})},b)})}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(H,{color:"inherit",disabled:t===0,onClick:B,sx:{mr:1},children:"Back"}),e.jsx(ee,{sx:{flex:"1 1 auto"}}),D(t)&&e.jsx(H,{color:"inherit",onClick:q,sx:{mr:1},children:"Skip"}),e.jsx(H,{onClick:T,children:t===le.length-1?"Finish":"Next"})]}),t===le.length?e.jsxs(r.Fragment,{children:[e.jsx(E,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ee,{sx:{flex:"1 1 auto"}}),e.jsx(H,{onClick:L,children:"Reset"})]})]}):e.jsxs(r.Fragment,{children:[e.jsxs(E,{sx:{mt:2,mb:1},children:["Step ",t+1]}),t===0&&e.jsx(Ae,{}),t===1&&e.jsx(Ce,{}),t===2&&e.jsx(De,{}),t===3&&e.jsx(ze,{}),t===4&&e.jsx(Re,{}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(H,{color:"inherit",disabled:t===0,onClick:B,sx:{mr:1},children:"Back"}),e.jsx(ee,{sx:{flex:"1 1 auto"}}),D(t)&&e.jsx(H,{color:"inherit",onClick:q,sx:{mr:1},children:"Skip"}),e.jsx(H,{onClick:T,children:t===le.length-1?"Finish":"Next"})]})]})]})}export{Ee as default};
