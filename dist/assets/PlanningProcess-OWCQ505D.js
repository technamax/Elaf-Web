import{j as e,_ as Ta,y as Ba,z as Fa,u as Qe,c as We,b as _e,b5 as Ra,B as Re,G as a,T as ve,D as me,ar as ct,b6 as za,aJ as $e,aK as Xe,aL as rt,b7 as ut,b8 as pt,b9 as Qa,ba as mt,C as Pe,d as Ce,aO as ot,e as Ye,bb as Wa,aM as _a,bc as Ua,bd as Ha,be as qa,bf as Ea,bg as Ga,bh as Ya,b3 as Va,M as $a,bi as Ka,bj as Xa}from"./index-CZjWfJ9S.js";import{r,g as Da}from"./vendor-BXCbSo2_.js";import{B as ge,a as Me,I as ze}from"./axios--CKk_8iX.js";import{d as Bt,c as et,A as Ft,e as Rt,f as zt,S as Ja,a as Za,b as er,F as tr}from"./Fabrication-BwoEAgo2.js";import{d as Ve}from"./VisibilityOutlined-BPW8ryPe.js";import{A as Ze,R as qe,F as Qt,C as Wt,a as nt,b as ht,c as st,d as gt,B as bt,u as ar,D as Ge,g as Mt,h as rr}from"./ReuseableDataGrid-D1pMcJDs.js";import{d as ft}from"./Close-BtpqQMIF.js";import{d as It}from"./PersonAddAlt1Outlined-R5pu5MDn.js";import{T as c,P as Pt}from"./TextField-C0yoPlRE.js";import{M as Q}from"./MenuItem-EYddAVor.js";import"./dayjs.min-DO4_1a-m.js";import"./Skeleton-B3PPDIKO.js";let St=!1;const or=r.forwardRef(function(i,C){return St||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),St=!0),e.jsx(Ze,Ta({ref:C},i))});var xt={},nr=Fa;Object.defineProperty(xt,"__esModule",{value:!0});var _t=xt.default=void 0,sr=nr(Ba()),lr=e;_t=xt.default=(0,sr.default)((0,lr.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const ir="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",dr=({initialFormData:o,setAdditionalProcessData:i,refetchDyeingPrintingData:C,handleClickOpen:j,showUpperDiv:b})=>{const{user:t}=Qe(),[I,n]=r.useState([]),[f,l]=r.useState([]),{enqueueSnackbar:P}=We(),[W,g]=r.useState({}),S=I.reduce((x,H)=>x+(H.assignedQty??0),0).toFixed(2);console.log("Quantity",S);const[p,T]=r.useState({dpIdDet:0,dpId:o.dpId||0,designId:o.designId||"",batchNo:o.batchNo||"",planningHeaderId:o.planningHeaderId||0,fabricId:o.fabricId||"",fabricName:o.fabricName||"",colorId:o.colorId||"",colorName:o.colorName||"",uomId:o.uomId||"",uom:o.uom||"",poPcs:o.poPcs||"",vendorId:"",processType:o.processType||"",availableQty:o.availableQty||"",remainingQty:o.availableQty-S||"",shrinkage:o.allowedWastage||"",wastage:o.allowedWastage||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});r.useEffect(()=>{T(x=>({...p,dpIdDet:f.dpIdDet||0,dpId:f.dpId||0,designId:(f==null?void 0:f.designId)||"",planningHeaderId:(f==null?void 0:f.planningHeaderId)||0,batchNo:(f==null?void 0:f.batchNo)||"",vendorId:(f==null?void 0:f.vendorId)||"",shrinkage:(f==null?void 0:f.shrinkage)||"",wastage:(f==null?void 0:f.wastage)||"",outputQty:(f==null?void 0:f.outputQty)||0,remainingQty:x.remainingQty+(f==null?void 0:f.assignedQty)||"",assignedQty:(f==null?void 0:f.assignedQty)||"",rate:(f==null?void 0:f.rate)||0,unitRatePerPo:(f==null?void 0:f.unitRatePerPo)||"",totalExcGst:(f==null?void 0:f.totalExcGst)||"",gst:(f==null?void 0:f.gst)||0,TotalIncludingGst:(f==null?void 0:f.totalIncludingGst)||"",createdOn:(f==null?void 0:f.createdOn)||new Date().toISOString(),createdBy:(f==null?void 0:f.createdBy)||t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId}))},[f]),r.useEffect(()=>{T({...p,remainingQty:o.availableQty-S>=0?o.availableQty-S:""})},[I,o.availableQty,S]);const{data:m}=_e(),{data:O,refetch:ee}=Ra(p.dpId,{skip:!p.dpId}),[X,G]=r.useState([]);r.useEffect(()=>{if(m){const x=m.result[0];G(x.vendorList)}},[m]),r.useEffect(()=>{O&&n(O.result.map((x,H)=>({id:H+1,...x})))},[O,ee]),console.log("initialRows",I);const z=x=>{const{name:H,value:te}=x.target;T({...p,[H]:te}),T(pe=>{const h={...pe,[H]:te};if(H==="assignedQty"||H==="remainingQty"){const _=h.assignedQty,E=h.remainingQty;_>E?g(ae=>({...ae,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):g(ae=>({...ae,assignedQty:""}))}return h})};r.useEffect(()=>{const x=()=>{const se=parseFloat(p.assignedQty)||0,N=parseFloat(p.shrinkage)||0,Z=parseFloat(p.wastage)||0,k=N+Z;return(se*100/(100+k)).toFixed(2)},H=()=>{const se=parseFloat(p.assignedQty)||0,N=parseFloat(p.rate)||0;return(se*N).toFixed(2)},te=(se,N)=>(se*(1+N/100)).toFixed(2),pe=x(),h=H(),_=parseFloat(p.gst)||0,E=te(h,_),ae=parseFloat(p.poPcs)||0,be=ae?E/ae:0;T(se=>({...se,outputQty:pe,totalExcGst:h,TotalIncludingGst:E,unitRatePerPo:be.toFixed(2)}))},[p.availableQty,p.assignedQty,p.shrinkage,p.wastage,p.rate,p.gst,p.poPcs,p.unitRatePerPo]),console.log("formData",p);const Y=async()=>{console.log(p);try{if(p.assignedQty>p.remainingQty){P("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}const x=await Me.post("http://100.42.177.77:83/api/DyeingPrinting/SaveDyeingPrintingDetails",p);console.log("Save response:",x.data),T(H=>({...H,dpIdDet:0,vendorId:"",availableQty:o.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",remainingQty:o.availableQty-S||"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),ee(),C()}catch(x){console.error("Error saving data:",x)}},re=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:x=>x.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:x=>x.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:x=>x.toLocaleString()},{field:"outputQty",headerName:"Output Qty",flex:1}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!b,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Fabric",name:"fabricName",value:p.fabricName,onChange:z,size:"small",disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Process Type",name:"processType",value:p.processType,onChange:z,size:"small",disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Color",name:"colorName",value:p.colorName,onChange:z,size:"small",disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"UOM",name:"uom",value:p.uom,onChange:z,size:"small",disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:p.poPcs,onChange:z,disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:p.availableQty,onChange:z,disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:p.remainingQty,onChange:z,disabled:!0,sx:x=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:p.vendorId,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}},children:X.map(x=>e.jsx(Q,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:p.assignedQty,onChange:z,disabled:!p.remainingQty,error:!!W.assignedQty,helperText:W.assignedQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:p.rate,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:p.shrinkage,onChange:z,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:p.wastage,onChange:z,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:p.outputQty,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:p.totalExcGst,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:p.gst,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:p.TotalIncludingGst,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:p.unitRatePerPo,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:Y,children:"Save"})})]})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:re,initialRows:I,setInitialData:l,deleteApi:"http://100.42.177.77:83/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:ee})})]})]})},cr=({initialFormData:o,setAdditionalProcessData:i,refetchDyeingPrintingData:C,handleClickOpen:j,showUpperDiv:b})=>{const t=ct(),{enqueueSnackbar:I}=We(),[n,f]=r.useState({}),{user:l}=Qe(),[P,W]=r.useState([]),[g,S]=r.useState([]),p=P.reduce((k,q)=>k+(q.assignedQty??0),0).toFixed(2);console.log("Quantity",p);const T=P.reduce((k,q)=>k+(q.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",T);const[m,O]=r.useState({embroideryIdDet:0,embroideryId:o.embroideryId||0,designId:o.designId||"",batchNo:o.batchNo||"",planningHeaderId:o.planningHeaderId||0,componentId:o.componentId||"",componentName:o.componentName||"",fabricId:o.fabricId||"",fabricName:o.fabricName||"",vendorId:"",colorId:o.colorId||"",colourName:o.colourName||"",availableQty:o.availableQty||"",assignedQty:0,remainingQty:(o.availableQty-p).toFixed(2)||0,remainingRepeats:o.repeats-T||"",noOfHead:o.noOfHead||"",noOfHeadsName:o.noOfHeadsName||"",repeats:o.repeats||"",assignedRepeats:"",cuttingSize:o.cuttingSize||"",itemsPerRepeat:o.itemsPerRepeat||"",poPcs:o.poPcs||"",totalPcs:o.totalPcs||"",remainingPcs:(o.totalPcs-T).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:l.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:l.empId});r.useEffect(()=>{O(k=>({...m,embroideryIdDet:g.embroideryIdDet||0,embroideryId:g.embroideryId||0,vendorId:(g==null?void 0:g.vendorId)||"",assignedQty:(g==null?void 0:g.assignedQty)||0,requiredPcs:(g==null?void 0:g.requiredPcs)||0,remainingQty:k.remainingQty+(g==null?void 0:g.assignedQty)||0,remainingPcs:k.remainingPcs+(g==null?void 0:g.requiredPcs)||0,totalAmount:(g==null?void 0:g.totalAmount)||0,threadStiches:(g==null?void 0:g.threadStiches)||0,threadRate:(g==null?void 0:g.threadRate)||0,threadAmount:(g==null?void 0:g.threadAmount)||0,tillaStiches:(g==null?void 0:g.tillaStiches)||0,tilaRate:(g==null?void 0:g.tilaRate)||0,tilaAmount:(g==null?void 0:g.tilaAmount)||0,sequence:(g==null?void 0:g.sequence)||0,sequenceRate:(g==null?void 0:g.sequenceRate)||0,sequenceAmount:(g==null?void 0:g.sequenceAmount)||0,isSolving:(g==null?void 0:g.isSolving)||!1,solvingLayers:(g==null?void 0:g.solvingLayers)||0,solvingInMeters:(g==null?void 0:g.solvingInMeters)||0,solvingRate:(g==null?void 0:g.solvingRate)||0,solvingAmount:(g==null?void 0:g.solvingAmount)||0,additional:(g==null?void 0:g.additional)||0,costPerComponent:(g==null?void 0:g.costPerComponent)||0,createdOn:(g==null?void 0:g.createdOn)||new Date().toISOString(),createdBy:(g==null?void 0:g.createdBy)||l.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:l.empId}))},[g]);const ee=["Boring","Pooni","Laser","Doori","Dissolving"];function X(k,q,F){return{fontWeight:q.indexOf(k)===-1?F.typography.fontWeightRegular:F.typography.fontWeightMedium}}r.useEffect(()=>{O({...m,remainingQty:(o.availableQty-p).toFixed(2)||0,remainingPcs:o.totalPcs-T||0})},[P]);const{data:G}=_e(),{data:z,refetch:Y}=za(m.embroideryId,{skip:!m.embroideryId}),[re,B]=r.useState([]);r.useEffect(()=>{if(G){const k=G.result[0];B(k.vendorList)}},[G]),r.useEffect(()=>{z&&W(z.result.map((k,q)=>({id:q+1,...k})))},[z,Y]),console.log("initialRows",P);const x=k=>{const{name:q,value:F}=k.target;O({...m,[q]:F})},H=k=>{const{name:q,checked:F}=k.target;O(D=>({...D,[q]:F}))};console.log("formData",m);const[te,pe]=r.useState(null),[h,_]=r.useState(m);r.useEffect(()=>{const k=setTimeout(()=>{_(m)},10);return()=>{clearTimeout(k)}},[m]);const E=k=>new Intl.NumberFormat("en-US").format(k);r.useEffect(()=>{const k=()=>{const R=parseFloat(h.repeats)||0,L=parseFloat(h.itemsPerRepeat)||0;return(R*L).toFixed(2)},q=()=>{const R=parseFloat(h.threadStiches)||0,L=parseFloat(h.threadRate)||0,ce=parseFloat(h.noOfHeadsName)||0,he=parseFloat(h.repeats)||0;return(R/1e3*(L*he*ce)).toFixed(2)},F=()=>{const R=parseFloat(h.tillaStiches)||0,L=parseFloat(h.tilaRate)||0,ce=parseFloat(h.noOfHeadsName)||0,he=parseFloat(h.repeats)||0;return(R/1e3*(L*he*ce)).toFixed(2)},D=()=>{const R=parseFloat(h.sequence)||0,L=parseFloat(h.sequenceRate)||0,ce=parseFloat(h.noOfHeadsName)||0,he=parseFloat(h.repeats)||0;return(R/1e3*(L*he*ce)).toFixed(2)},de=()=>{const R=parseFloat(h.repeats)||0,L=parseFloat(h.noOfHeadsName)||0,ce=parseFloat(h.solvingLayers)||0;return(R*L*13/39.37*ce).toFixed(2)},ne=()=>{const R=parseFloat(h.solvingInMeters)||0,L=parseFloat(h.solvingRate)||0;return(R*L).toFixed(2)},fe=()=>{const R=parseFloat(h.threadAmount)||0,L=parseFloat(h.tilaAmount)||0,ce=parseFloat(h.sequenceAmount)||0,he=parseFloat(h.solvingAmount)||0;return(R+L+ce+he).toFixed(2)},J=()=>{const R=parseFloat(String(h.totalAmount).replace(/,/g,""))||0,L=parseFloat(h.requiredPcs)||0;return(R/L).toFixed(2)},V=fe(),le=J();q(),O(R=>({...R,totalPcs:k(),threadAmount:q(),tilaAmount:F(),sequenceAmount:D(),solvingInMeters:de(),solvingAmount:ne(),totalAmount:E(V),costPerComponent:E(le)}))},[h.threadAmount,h.totalAmount,h.sequenceAmount,h.solvingAmount,h.repeats,h.tilaAmount,h.itemsPerRepeat,h.threadRate,h.threadStiches,h.noOfHeadsName,h.tilaRate,h.tillaStiches,h.sequenceRate,h.sequence,h.solvingLayers,h.solvingInMeters,h.solvingRate,h.requiredPcs]),r.useEffect(()=>{if(te==="assignedQty"){const k=()=>{const q=parseFloat(h.assignedQty)||0,F=parseFloat(h.availableQty)||0,D=parseFloat(h.totalPcs)||0;return Math.round(q*(D/F))};O(q=>({...q,requiredPcs:k()}))}else if(te==="requiredPcs"){const k=()=>{const q=parseFloat(h.requiredPcs)||0,F=parseFloat(h.availableQty)||0,D=parseFloat(h.totalPcs)||0;return(q*F/D).toFixed(2)};O(q=>({...q,assignedQty:k()}))}},[h.assignedQty,h.requiredPcs,te]);const ae=k=>{const q=k.target.value,F=k.target.name;pe("assignedQty"),O(D=>({...D,assignedQty:q})),O(D=>{const de={...D,[F]:q};if(F==="assignedQty"||F==="remainingQty"){const ne=parseFloat(de.assignedQty),fe=parseFloat(de.remainingQty);ne>fe?f(J=>({...J,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):f(J=>({...J,assignedQty:""}))}return de})},be=k=>{const q=k.target.value,F=k.target.name;pe("requiredPcs"),O(D=>({...D,requiredPcs:q})),O(D=>{const de={...D,[F]:q};if(F==="requiredPcs"||F==="remainingPcs"){const ne=parseFloat(de.requiredPcs),fe=parseFloat(de.remainingPcs);ne>fe?(console.log(),f(J=>({...J,requiredPcs:"Required Pcs cannot be greater than Remaining Pcs"}))):f(J=>({...J,requiredPcs:""}))}return de})},se=async()=>{if(console.log(m),m.totalAmount==0||m.costPerComponent==0){I("Please Enter Thread, Tilla or Sequnce values , Total Amount cannot be zero",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(m.assignedQty)>parseFloat(m.remainingQty)){I("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(m.requiredPcs)>parseFloat(m.remainingPcs)){I("Required Pcs can not be greater then Remaining Pcs !",{variant:"error",autoHideDuration:5e3});return}try{const k=await Me.post("http://100.42.177.77:83/api/Embroidery/SaveEmbroideryDetails",{...m,additional:m.additional.join(", ")});k.data.success?I("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(I(`${k.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",k.data.message)),console.log("Save response:",k.data),O(q=>({...q,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,remainingQty:(o.availableQty-p).toFixed(2)||0,remainingRepeats:o.repeats-T||"",costPerComponent:0,createdOn:new Date().toISOString(),createdBy:l.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:l.empId})),Y(),C()}catch(k){console.error("Error saving data:",k),I("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},N=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"Additional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!b,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Fabric",name:"fabricName",value:m.fabricName,onChange:x,size:"small",disabled:!0,sx:k=>({...m.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Component",name:"componentName",value:m.componentName,onChange:x,size:"small",disabled:!0,sx:k=>({...m.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Color",name:"colourName",value:m.colourName,onChange:x,size:"small",disabled:!0,sx:k=>({...m.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:m.poPcs,onChange:x,size:"small",disabled:!0,sx:k=>({...m.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Heads",size:"small",name:"noOfHeadsName",value:m.noOfHeadsName,onChange:x,disabled:!0,sx:k=>({...m.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:m.cuttingSize,onChange:x,disabled:!0,sx:k=>({...m.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:m.itemsPerRepeat,onChange:x,disabled:!0,sx:k=>({...m.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Available Qty",fullWidth:!0,size:"small",name:"availableQty",value:m.availableQty,onChange:x,disabled:!0,sx:k=>({...m.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:m.remainingQty,type:"number",error:!!n.remainingQty,helperText:n.remainingQty,onChange:x,disabled:!0,sx:k=>({...m.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:m.repeats,onChange:x,disabled:!0,sx:k=>({...m.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:m.totalPcs,onChange:x,disabled:!0,sx:k=>({...m.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Pcs",fullWidth:!0,size:"small",name:"remainingPcs",value:m.remainingPcs,onChange:x,disabled:!0,sx:k=>({...m.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:m.vendorId,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}},children:re.map(k=>e.jsx(Q,{value:k.lookUpId,children:k.lookUpName},k.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:m.assignedQty,onChange:ae,error:!!n.assignedQty,helperText:n.assignedQty,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Required Pcs",fullWidth:!0,disabled:!m.remainingPcs&&!m.remainingQty,size:"small",type:"number",name:"requiredPcs",value:m.requiredPcs,error:!!n.requiredPcs,helperText:n.requiredPcs,onChange:be,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{select:!0,label:"Additional",value:m.additional,name:"additional",size:"small",onChange:x,fullWidth:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:ee.map(k=>e.jsx(Q,{value:k,style:X(k,m.additional,t),children:k},k))})}),e.jsx(a,{item:!0,xs:12,md:1,children:e.jsx(Qt,{control:e.jsx(Wt,{checked:m.isSolving,onChange:H,disabled:!m.remainingPcs&&!m.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:m.threadStiches,onChange:x,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:m.threadRate,onChange:x,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:m.threadAmount,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:m.tillaStiches,onChange:x,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:m.tilaRate,onChange:x,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:m.tilaAmount,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(a,{item:!0,xs:12,md:6,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:m.sequence,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:m.sequenceRate,onChange:x,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:m.sequenceAmount,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),m.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:m.solvingLayers,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:m.solvingInMeters,disabled:!m.remainingPcs&&!m.remainingQty,onChange:x,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:m.solvingRate,onChange:x,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:m.solvingAmount,disabled:!m.remainingPcs&&!m.remainingQty,onChange:x,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(c,{label:"Total Amount",fullWidth:!0,size:"small",disabled:!m.remainingPcs&&!m.remainingQty,name:"totalAmount",value:m.totalAmount,onChange:x,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(c,{label:"Cost Per Component",fullWidth:!0,type:"number",size:"small",name:"costPerComponent",value:m.costPerComponent,onChange:x,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:se,children:"Save"})})]})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:N,initialRows:P,setInitialData:S,deleteApi:"http://100.42.177.77:83/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:Y})})]})})]})},ur=({initialValues:o})=>{ct();const{user:i}=Qe(),[C,j]=r.useState(!0),{enqueueSnackbar:b}=We(),[t,I]=r.useState([]),[n,f]=r.useState(!1),[l,P]=r.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:i.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId});r.useEffect(()=>{P({...l,embroideryId:(t==null?void 0:t.embroideryId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})},[t]);const{data:W}=$e(),[g,S]=r.useState("");r.useEffect(()=>{S(o.collectionId)},[]);const{data:p}=_e(),{data:T,refetch:m}=Xe(g,{skip:!g}),{data:O,refetch:ee}=rt(l.designId,{skip:!l.designId}),{data:X,refetch:G}=ut({batchNo:l.planningHeaderId,componentId:l.componentId},{skip:!l.planningHeaderId||!l.componentId}),{data:z}=pt({batchNo:l.planningHeaderId,componentId:l.componentId,fabricId:l.fabricId},{skip:!l.planningHeaderId||!l.componentId||!l.fabricId}),{data:Y,refetch:re}=Qa(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:B}=mt(l.planningHeaderId,{skip:!l.planningHeaderId});console.log("formData.planningHeaderId",l.planningHeaderId),console.log("collectionData",W);const[x,H]=r.useState(!1),[te,pe]=r.useState([]),[h,_]=r.useState([]),[E,ae]=r.useState([]),[be,se]=r.useState([]),[N,Z]=r.useState([]),[k,q]=r.useState([]),[F,D]=r.useState([]),[de,ne]=r.useState([]);console.log("batchList",h),console.log("formData",l),r.useEffect(()=>{T&&pe(T.result)},[T]),r.useEffect(()=>{O&&_(O.result)},[O]),r.useEffect(()=>{X&&(G(),ae(X.result))},[X,G]),r.useEffect(()=>{z&&q(X.result)},[z]),r.useEffect(()=>{B&&ne(B.result)},[B]),r.useEffect(()=>{Y&&(j(!1),D(Y.result.map((y,$)=>({id:$+1,...y}))))},[Y,re]),console.log("embroideryList",Y),console.log("initialRows",F),r.useEffect(()=>{if(p){const y=p.result[0];se(y.vendorList),Z(y.noOfHeadsList)}},[p]);const fe=(W==null?void 0:W.result)||[];r.useEffect(()=>{const y=()=>{const ie=parseFloat(l.repeats)||0,Le=parseFloat(l.itemsPerRepeat)||0;return(ie*Le).toFixed(2)};P(ie=>({...ie,totalPcs:y()}));const $=()=>{const ie=parseFloat(l.threadStiches)||0,Le=parseFloat(l.threadRate)||0,Ue=parseFloat(l.noOfHead)||0,Ee=parseFloat(l.repeats)||0;return(ie/1e3*(Le*Ee*Ue)).toFixed(2)};P(ie=>({...ie,threadAmount:$()}));const xe=()=>{const ie=parseFloat(l.tillaStiches)||0,Le=parseFloat(l.tilaRate)||0,Ue=parseFloat(l.noOfHead)||0,Ee=parseFloat(l.repeats)||0;return(ie/1e3*(Le*Ee*Ue)).toFixed(2)};P(ie=>({...ie,tilaAmount:xe()}));const oe=()=>{const ie=parseFloat(l.sequence)||0,Le=parseFloat(l.sequenceRate)||0,Ue=parseFloat(l.noOfHead)||0,Ee=parseFloat(l.repeats)||0;return(ie/1e3*(Le*Ee*Ue)).toFixed(2)};P(ie=>({...ie,sequenceAmount:oe()}));const ye=()=>{const ie=parseFloat(l.repeats)||0,Le=parseFloat(l.noOfHead)||0,Ue=parseFloat(l.solvingLayers)||0;return(ie*Le*13/39.37*Ue).toFixed(2)};P(ie=>({...ie,solvingInMeters:ye()}));const Fe=()=>{const ie=parseFloat(l.solvingInMeters)||0,Le=parseFloat(l.solvingRate)||0;return parseFloat(l.solvingLayers),(ie*Le).toFixed(2)};P(ie=>({...ie,solvingAmount:Fe()}));const La=()=>{const ie=parseFloat(l.threadAmount)||0,Le=parseFloat(l.tilaAmount)||0,Ue=parseFloat(l.sequenceAmount)||0,Ee=parseFloat(l.solvingAmount)||0;return(ie+Le+Ue+Ee).toFixed(2)};P(ie=>({...ie,totalAmount:La()||0}))},[l.threadAmount,l.totalAmount,l.sequenceAmount,l.solvingAmount,l.repeats,l.tilaAmount,l.itemsPerRepeat,l.threadRate,l.threadStiches,l.noOfHead,l.tilaRate,l.tillaStiches,l.sequenceRate,l.sequence,l.solvingLayers,l.solvingInMeters,l.solvingRate]);const J=y=>{const{name:$,value:xe}=y.target;if($==="collectionId")fe.find(oe=>oe.collectionId===parseInt(xe)),S(xe),f(!0),D([]),j(!0),P({...l,collectionId:xe,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]});else if($==="designId"){const oe=te.find(ye=>ye.designId===parseInt(xe));D([]),j(!0),P({...l,designId:xe,baseColorId:oe?oe.colorId:"",baseColorName:oe?oe.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if($==="colorId"){const oe=k.find(ye=>ye.colorId===xe);P({...l,colorId:xe,availableQty:oe?oe.total:"",cuttingSize:oe?oe.cuttingSize:"",repeats:oe?oe.repeats:"",noOfHead:oe?oe.noOfHeads:""})}else if($==="batchNo"){const oe=h.find(ye=>ye.batchNo===xe);P({...l,batchNo:xe,planningHeaderId:oe?oe.planningHeaderId:"",poPcs:oe?oe.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),H(!0),f(!1)}else P({...l,[$]:xe}),le(oe=>({...oe,[$]:""}))},[V,le]=r.useState({}),R=async()=>{try{const y=await Me.post("http://100.42.177.77:83/api/Embroidery/SaveEmbroidery",{...l,threadAdditional:l.threadAdditional.join(", ")});console.log("Save response:",y.data),y.data.success?b("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(b(`${y.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",y.data.message)),P($=>({embroideryId:0,designId:$.designId,batchNo:$.batchNo,planningHeaderId:$.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:$.poPcs,baseColorId:$.baseColorId,baseColorName:$.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})),re()}catch(y){console.error("Error saving data:",y),b("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",F);const[L,ce]=r.useState({}),[he,Se]=r.useState(!1),ke=y=>{ce(y),Se(!0)},[Oe,je]=r.useState(!0),Ae=y=>{ce(y),Se(!0),je(!1)},Ne=()=>{je(!0),Se(!1),ce({}),refetchDyeingPrintingData()};console.log("show div",Oe);const[we,M]=r.useState(0),[K,Ie]=r.useState(0),[u,d]=r.useState(0),[A,s]=r.useState(0);r.useEffect(()=>{const y=F.reduce((ye,Fe)=>ye+(Fe.availableQty??0),0).toFixed(2),$=F.reduce((ye,Fe)=>ye+(Fe.assignedQty??0),0).toFixed(2),xe=F.reduce((ye,Fe)=>ye+(Fe.totalPcs??0),0).toFixed(2),oe=F.reduce((ye,Fe)=>ye+(Fe.requiredPcs??0),0).toFixed(2);M(parseFloat(y).toLocaleString()),Ie(parseFloat($).toLocaleString()),d(parseFloat(xe).toLocaleString()),s(parseFloat(oe).toLocaleString())},[F]);const v=[...F,{id:"TOTAL_SUMMARY",availableQty:we,assignedQty:K,totalPcs:u,requiredPcs:A}],U={sortable:!1,pinnable:!1,hideable:!1},w=[{field:"id",headerName:"Sr#",...U,colSpan:(y,$)=>$.id==="TOTAL_SUMMARY"?4:void 0,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):y.value},{field:"designNo",headerName:"Design",...U,colSpan:(y,$)=>$.id==="TOTAL_SUMMARY"?3:void 0,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):y.value},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component ",renderCell:y=>e.jsx(Ye,{label:y.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric "},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty",...U,valueGetter:y=>y.toLocaleString(),renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"assignedQty",headerName:"Assigned Qty",...U,valueGetter:y=>y,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"totalPcs",headerName:"Total Pcs",renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"requiredPcs",headerName:"Assigned Pcs",colSpan:(y,$)=>$.id==="TOTAL_SUMMARY"?4:void 0,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:y=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(bt,{variant:"text",size:"small",children:[e.jsx(ze,{color:"primary",onClick:()=>ke(y.row),children:e.jsx(It,{})}),e.jsx(ze,{color:"primary",onClick:()=>Ae(y.row),children:e.jsx(Ve,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(ot,{src:ir,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g,onChange:J,size:"small",InputLabelProps:{sx:{color:"black"}},children:fe.map(y=>e.jsx(Q,{value:y.collectionId,children:y.collectionName},y.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:J,size:"small",InputLabelProps:{sx:{color:"black"}},children:te.map(y=>e.jsx(Q,{value:y.designId,children:y.designNo},y.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:J,size:"small",InputLabelProps:{sx:{color:"black"}},children:h.map(y=>e.jsx(Q,{value:y.batchNo,children:y.batchNo},y.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,onChange:J,disabled:!0,sx:y=>({...l.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:l.componentId,onChange:J,size:"small",required:!0,error:!!V.componentId,helperText:V.componentId,InputLabelProps:{sx:{color:"black"}},children:de.map(y=>e.jsx(Q,{value:y.componentId,children:y.componentName},y.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:l.fabricId,onChange:J,required:!0,error:!!V.fabricId,helperText:V.fabricId,InputLabelProps:{sx:{color:"black"}},children:E.map(y=>e.jsx(Q,{value:y.fabricId,children:y.fabric},y.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:l.colorId,onChange:J,required:!0,error:!!V.colorId,helperText:V.colorId,InputLabelProps:{sx:{color:"black"}},children:k.map(y=>e.jsx(Q,{value:y.colorId,children:y.color},y.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:J,disabled:!0,sx:y=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:l.availableQty,onChange:J,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:l.repeats,onChange:J,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:l.noOfHead,onChange:J,required:!0,error:!!V.noOfHead,helperText:V.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:N.map(y=>e.jsx(Q,{value:y.lookUpId,children:y.lookUpName},y.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:l.cuttingSize,onChange:J,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:l.itemsPerRepeat,onChange:J,required:!0,error:!!V.itemsPerRepeat,helperText:V.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:l.totalPcs,onChange:J})}),e.jsx(a,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:R,children:"Save"})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(qe,{iColumns:w,initialRows:v,setInitialData:I,deleteApi:"http://100.42.177.77:83/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:re,setAccordionExpanded:H,fileName:"Embroidery List",isLoading:C}),e.jsxs(nt,{open:he,onClose:Ne,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(ve,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Embroidery > Assign Vendors "}),e.jsx(ze,{onClick:Ne,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(cr,{initialFormData:L,setInitialFormData:ce,refetchDyeingPrintingData:re,handleClickOpen:ke,showUpperDiv:Oe})]})]})]})})]})]})},pr=ur,mr=({setInitialValues:o,initialValues:i})=>{const{user:C}=Qe();console.log("user",C);const[j,b]=r.useState(!0),[t,I]=r.useState([]),[n,f]=r.useState([]),[l,P]=r.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:C.empId,lastUpdatedBy:C.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",l),r.useEffect(()=>{P({...l,processType:(t==null?void 0:t.processType)||"MultiHead",planningId:(t==null?void 0:t.planningId)||0,baseColorId:(t==null?void 0:t.baseColorId)||"",componentId:(t==null?void 0:t.componentId)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",colorId:(t==null?void 0:t.colorId)||"",fabricId:(t==null?void 0:t.fabricId)||"",noOfHeads:(t==null?void 0:t.noOfHeads)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,repeats:(t==null?void 0:t.repeats)||0,repeatSize:(t==null?void 0:t.repeatSize)||0,uomId:(t==null?void 0:t.uomId)||"",totalFabric:(t==null?void 0:t.totalFabric)||"",shrinkage:(t==null?void 0:t.shrinkage)||"",wastage:(t==null?void 0:t.wastage)||"",total:(t==null?void 0:t.total)||"",appId:1,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||C.empId,lastUpdatedBy:C.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(t==null?void 0:t.repeatsInMtr)||""})},[t]);const{data:W}=$e(),[g,S]=r.useState(""),{data:p,refetch:T}=Xe(g,{skip:!g}),{data:m,refetch:O}=Wa(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:ee}=_e(),[X,G]=r.useState([]),{enqueueSnackbar:z}=We();console.log("lookupData",ee);const[Y,re]=r.useState([]);r.useEffect(()=>{W&&re(W.result)},[W]),r.useEffect(()=>{p&&(G(p.result),T())},[p]),r.useEffect(()=>{m&&(b(!1),f(m.result.map((s,v)=>({id:v+1,...s}))))},[m,O]),console.log("designList",X),console.log("collectionData",W);const[B,x]=r.useState(!1),[H,te]=r.useState([]),[pe,h]=r.useState([]),[_,E]=r.useState([]),[ae,be]=r.useState([]),[se,N]=r.useState([]),[Z,k]=r.useState([]),[q,F]=r.useState([]),[D,de]=r.useState([]);console.log("components:",_),console.log("Fabrications:",ae),console.log("colors:",se),console.log("uoms:",Z),console.log("heads:",q),console.log("lookupData",ee),r.useEffect(()=>{if(ee){const s=ee.result[0];E(s.componentList),N(s.colorList),be(s.fabricList),F(s.noOfHeadsList),k(s.uomList),te(s.planningTypeProcessList),h(s.operatingMachineList)}},[ee]),r.useEffect(()=>{const s=async v=>{try{const U=await Me.get(`http://100.42.177.77:83/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${v}`);console.log(U.data),de(U.data.result)}catch(U){console.error("Error fetching pre-planning lookup data:",U)}};l.designId&&s(l.designId)},[l.designId,l.planningHeaderId]);const ne=l.planningProcessTypeId===212||l.planningProcessTypeId===1219;console.log("initialValues",i),console.log("selectedCollectionId",g),r.useEffect(()=>{S((i==null?void 0:i.collectionId)||""),P({...l,designId:(i==null?void 0:i.designId)||"",planningHeaderId:(i==null?void 0:i.planningHeaderId)||"",batchNo:(i==null?void 0:i.batchNo)||""})},[i]),r.useEffect(()=>{const s=()=>{const $=parseFloat(l.poPcs)||0,xe=parseFloat(l.cuttingSize)||0,oe=($*xe).toFixed(2);return parseFloat(oe).toLocaleString()},v=()=>{const $=parseFloat(l.repeats)||0,xe=parseFloat(l.repeatSize)||0,oe=($*xe).toFixed(2);return parseFloat(oe).toLocaleString()},U=$=>{const xe=$||0,oe=parseFloat(l.shrinkage)||0,ye=parseFloat(l.wastage)||0,Fe=(xe*(100+(oe+ye))/100).toFixed(2);return parseFloat(Fe).toLocaleString()},w=()=>(.9144*(parseFloat(l.repeatSize)||0)).toFixed(2),ue=()=>{const $=parseFloat(l.repeats)||0;return((parseFloat(l.repeatsInMtr)||0)*$).toFixed(2)};let y=0;ne?y=parseFloat(s().replace(/,/g,""))||0:y=parseFloat(v().replace(/,/g,""))||0,P($=>({...$,totalFabric:y.toLocaleString(),total:U(y),repeatsInMtr:w()})),!ne&&l.isSchiffili&&P($=>({...$,totalFabric:ue()}))},[l.poPcs,l.cuttingSize,l.repeats,l.repeatSize,l.totalFabric,l.shrinkage,l.wastage,l.repeatsInMtr,l.isSchiffili,ne]);const[fe,J]=r.useState(!1);r.useState(!1);const V=s=>{const{name:v,value:U}=s.target;if(v==="collectionId"){const w=Y.find(ue=>ue.collectionId===parseInt(U));x(!0),f([]),b(!0),S(U),P({...l,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:U,noOfDesigns:w?w.noOfDesigns:"",noOfColors:w?w.noOfColors:""})}else if(v==="designId"){const w=X.find(ue=>ue.designId===parseInt(U));f([]),b(!0),P({...l,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:U,baseColorId:w?w.colorId:"",baseColorName:w?w.colorName:""})}else if(v==="batchNo"){const w=D.find(ue=>ue.batchNo===U);P({...l,componentId:"",processType:"MultiHead",poPcs:w?w.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:U,planningHeaderId:w?w.planningHeaderId:""}),J(!0),x(!1)}else if(v==="planningProcessTypeId"){const w=H.find(ue=>ue.lookUpId===U);console.log("selectedProcess",w),P({...l,planningProcessTypeId:U,planningProcessTypeName:w?w.lookUpName:"",noOfHeads:0,operatingMachineId:0}),J(!0),x(!1)}else P({...l,[v]:U})},[le,R]=r.useState({}),[L,ce]=r.useState(!1),he=()=>{ce(!L)},Se=async()=>{const s=ke();if(Object.keys(s).length>0){R(s);return}try{const v={...l,totalFabric:parseFloat(l.totalFabric.replace(/,/g,"")),total:parseFloat(l.total.replace(/,/g,""))},U=await Me.post("http://100.42.177.77:83/api/PrePlanning/SavePrePlanning",v);console.log("Data saved successfully:",U.data),console.log("Save response:",U.data),U.data.success?U.data.success&&z("PrePlanning saved successfully!",{variant:"success",autoHideDuration:5e3}):(z(`${U.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",U.data.message)),P(w=>({processType:"MultiHead",planningId:0,collectionId:w.collectionId,designId:w.designId,batchNo:w.batchNo,planningHeaderId:w.planningHeaderId,baseColorId:w.baseColorId,baseColorName:w.baseColorName,noOfDesigns:w.noOfDesigns,noOfColors:w.noOfColors,poPcs:w.poPcs,fabricId:w.fabricId,shrinkage:w.shrinkage,wastage:w.wastage,componentId:"",cuttingSize:"",colorId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:C.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:C.empId,isSchiffili:!1,repeatsInMtr:""})),O()}catch(v){console.error("Error saving data:",v),z("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ke=()=>{const s={};return l.componentId||(s.componentId="componentId is required"),l.colorId||(s.colorId="colorId is required"),l.fabricId||(s.fabricId="fabricId is required"),l.cuttingSize||(s.cuttingSize="cuttingSize is required"),l.uomId||(s.uomId="uomId is required"),l.shrinkage||(s.shrinkage="shrinkage is required"),l.wastage||(s.wastage="wastage is required"),s};console.log("initialRows",n);const Oe=n.reduce((s,v)=>s+(v.totalFabric??0),0).toFixed(2),je=parseFloat(Oe).toLocaleString();console.log("localizedTotalFabric",je);const Ae=n.reduce((s,v)=>s+(v.total??0),0).toFixed(2),Ne=parseFloat(Ae).toLocaleString(),we=[...n,{id:"TOTAL_SUMMARY",label:"Total Fabric",totalFabric:je,total:Ne}],M={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",we);const K=[{field:"id",headerName:"Sr#",...M,colSpan:(s,v)=>{if(v.id==="TOTAL_SUMMARY")return 10},valueGetter:(s,v)=>v.id==="TOTAL_SUMMARY"?v.label:s,renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value})},{field:"componentName",headerName:"Component",...M},{field:"planningProcessTypeName",headerName:"Process Type",...M,renderCell:s=>{const v=s.value==="MultiHead"?"primary.dark":s.value==="Schiffili"?theme.palette.grey[900]:s.value==="Dyeing"?"success.dark":"default";return e.jsx(Ye,{label:s.value,sx:{backgroundColor:v==="primary"||v==="default"?void 0:v,color:v==="primary"||v==="default"?void 0:"white"},color:v==="primary"?"primary":v==="default"?"default":void 0})}},{field:"color",headerName:"Color",...M},{field:"cuttingSize",headerName:"Cutting Size",...M},{field:"fabric",headerName:"Fabrication",...M},{field:"noOfHeadName",headerName:"No. Of Heads",...M},{field:"operatingMachineName",headerName:"Operating Machine",...M},{field:"repeats",headerName:"Repeats",valueGetter:s=>s.toLocaleString(),...M},{field:"repeatSize",headerName:"Repeat Size",valueGetter:s=>s.toLocaleString(),...M},{field:"totalFabric",headerName:"Total Fabric",valueGetter:s=>s.toLocaleString(),renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value}),...M},{field:"uom",headerName:"UOM",colSpan:(s,v)=>v.id==="TOTAL_SUMMARY"?2:void 0,valueGetter:(s,v)=>v.id==="TOTAL_SUMMARY"?"OverAll Total":s,renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value}),...M},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:s=>s.toLocaleString(),colSpan:(s,v)=>v.id==="TOTAL_SUMMARY"?2:void 0,renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value}),...M}],Ie=l.planningProcessTypeId===198;r.useEffect(()=>{Ie&&P({...l,uomId:139})},[Ie]),console.log("formData",l);const u=({row:s,field:v})=>s.id==="TOTAL_SUMMARY"&&(v==="componentName"||v==="uom")?"bold":"";console.log("batchList:",D);const d="http://100.42.177.77:83/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",A=(s,v)=>{J(!fe)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(_t,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:Y.map(s=>e.jsx(Q,{value:s.collectionId,children:s.collectionName},s.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:X.map(s=>e.jsx(Q,{value:s.designId,children:s.designNo},s.designId))})}),e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:D.map(s=>e.jsx(Q,{value:s.batchNo,children:s.batchNo},s.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:V,disabled:!0,sx:s=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,onChange:V,disabled:!0,sx:s=>({...l.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"MainCard",avatar:e.jsx(Bt,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ze,{onClick:A,sx:{mt:"-18px"},children:e.jsx(et,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(Ft,{expanded:fe,onChange:A,sx:{},children:[e.jsx(Rt,{expandIcon:e.jsx(et,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(zt,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(Ze,{fullWidth:!0,options:ae,getOptionLabel:s=>s.lookUpName,value:ae.find(s=>s.lookUpId===l.fabricId)||null,onChange:(s,v)=>{V({target:{name:"fabricId",value:v?v.lookUpId:""}})},renderInput:s=>e.jsx(c,{...s,label:"Fabrication",size:"small",name:"fabricId",value:l.fabricId,required:!0,error:!!le.fabricId,helperText:le.fabricId,disabled:L,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:s})=>e.jsx("div",{style:{backgroundColor:"white"},children:s})})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:l.shrinkage,onChange:V,error:!!le.shrinkage,helperText:le.shrinkage,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:l.wastage,onChange:V,error:!!le.wastage,helperText:le.wastage,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(ge,{variant:"contained",size:"small",onClick:he,children:L||L?"Unlock":"Lock"})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:l.planningProcessTypeId,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:H.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(Ze,{fullWidth:!0,options:_,getOptionLabel:s=>s.lookUpName,value:_.find(s=>s.lookUpId===l.componentId)||null,onChange:(s,v)=>{V({target:{name:"componentId",value:v?v.lookUpId:""}})},renderOption:(s,v)=>{const{lookUpName:U}=v;return e.jsx("span",{...s,children:U})},renderInput:s=>e.jsx(c,{...s,label:"Select Component",size:"small",name:"componentId",value:l.componentId,required:!0,error:!!le.componentId,helperText:le.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:s})=>e.jsx("div",{style:{backgroundColor:"white"},children:s})})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[" ",e.jsx(Ze,{fullWidth:!0,options:se,getOptionLabel:s=>s.lookUpName,value:se.find(s=>s.lookUpId===l.colorId)||null,onChange:(s,v)=>{V({target:{name:"colorId",value:v?v.lookUpId:""}})},renderInput:s=>e.jsx(c,{...s,label:"Color",size:"small",value:l.colorId,name:"colorId",required:!0,error:!!le.colorId,helperText:le.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:s})=>e.jsx("div",{style:{backgroundColor:"white"},children:s})})]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:l.cuttingSize,onChange:V,required:!0,error:!!le.cuttingSize,helperText:le.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:Ie?e.jsx(c,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:l.operatingMachineId,onChange:V,required:!0,disabled:ne,InputLabelProps:{sx:{color:"black"}},children:pe.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))}):e.jsx(c,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:l.noOfHeads,onChange:V,required:!0,disabled:ne,InputLabelProps:{sx:{color:"black"}},children:q.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:l.repeatSize,onChange:V,disabled:ne,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"No. of Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:l.repeats,onChange:V,required:!0,disabled:ne,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:l.totalFabric,onChange:V,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:l.uomId,onChange:V,error:!!le.uomId,helperText:le.uomId,required:!0,disabled:Ie,InputLabelProps:{sx:{color:"black"}},children:Z.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Repeats in Meter",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:l.repeatsInMtr,onChange:V,sx:s=>({...l.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Total",fullWidth:!0,size:"small",name:"total",value:l.total,onChange:V,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(a,{container:!0,spacing:1,width:"Inherit"})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",children:e.jsx(ge,{variant:"contained",size:"small",onClick:Se,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"MainCard",avatar:e.jsx(Ve,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{sx:{paddingY:1,paddingX:1},children:e.jsx(a,{sx:{},item:!0,xs:12,children:e.jsx(qe,{iColumns:K,initialRows:we,setInitialData:I,deleteApi:d,deleteBy:"planningId",refetch:O,getCellClassName:u,setAccordionExpanded:J,fileName:"PrePlanningList",isLoading:j})})})]})]})},hr=mr,gr="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",br=({initialValues:o})=>{const{user:i}=Qe();console.log("user",i);const[C,j]=r.useState(!0),[b,t]=r.useState([]),[I,n]=r.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:i.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId});r.useEffect(()=>{n({...I,dpId:b.dpId||0,fabricId:(b==null?void 0:b.fabricId)||"",colorId:(b==null?void 0:b.colorId)||"",color:(b==null?void 0:b.color)||"",processType:(b==null?void 0:b.processType)||"",availableQty:(b==null?void 0:b.availableQty)||"",Shrinkage:(b==null?void 0:b.shrinkage)||"",Wastage:(b==null?void 0:b.wastage)||"",outputQty:(b==null?void 0:b.outputQty)||0,UOM:(b==null?void 0:b.uom)||0,uomId:(b==null?void 0:b.uomId)||"",poPcs:(b==null?void 0:b.poPcs)||0,createdOn:(b==null?void 0:b.createdOn)||new Date().toISOString(),createdBy:(b==null?void 0:b.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})},[b]);const{enqueueSnackbar:f}=We(),[l,P]=r.useState(!1);console.log("Dyeing form data to send",I);const{data:W}=$e(),[g,S]=r.useState("");r.useEffect(()=>{S(o.collectionId)},[]);const{data:p}=_e(),{data:T,refetch:m}=Xe(g,{skip:!g}),{data:O,refetch:ee}=rt(I.designId,{skip:!I.designId}),{data:X}=_a({batchNo:I.planningHeaderId,processType:"Fabrication"},{skip:!I.planningHeaderId}),{data:G}=Ua({fabricId:I.fabricId,planningHeaderId:I.planningHeaderId},{skip:!I.fabricId||!I.planningHeaderId}),{data:z,refetch:Y}=Ha(I.planningHeaderId,{skip:!I.planningHeaderId}),[re,B]=r.useState([]),[x,H]=r.useState([]),[te,pe]=r.useState([]),[h,_]=r.useState([]),[E,ae]=r.useState([]),[be,se]=r.useState([]);r.useState([]);const[N,Z]=r.useState(!1);console.log("batchList",x),console.log("formData",I),r.useEffect(()=>{T&&B(T.result)},[T]),r.useEffect(()=>{O&&H(O.result)},[O]),r.useEffect(()=>{X&&pe(X.result)},[X]),r.useEffect(()=>{G&&se(G.result)},[G]),r.useEffect(()=>{z&&(j(!1),ae(z.result.map((u,d)=>({id:d+1,...u}))))},[z,Y]),r.useEffect(()=>{if(p){const u=p.result[0];_(u.uomList)}},[p]);const[k,q]=r.useState([]);r.useEffect(()=>{W&&q(W.result)},[W]);const F=u=>{const{name:d,value:A}=u.target;if(d==="collectionId")k.find(s=>s.collectionId===parseInt(A)),S(A),P(!0),ae([]),j(!0),n({...I,collectionId:A,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:""});else if(d==="designId"){const s=re.find(v=>v.designId===parseInt(A));ae([]),j(!0),n({...I,designId:A,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(d==="batchNo"){const s=x.find(v=>v.batchNo===A);n({...I,batchNo:A,planningHeaderId:s?s.planningHeaderId:"",poPcs:s?s.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),Z(!0),P(!1)}else if(d==="fabricId")te.find(s=>s.fabricId===A),console.log("Selected Fabric:",te),n({...I,fabricId:A});else if(d==="ColorId"){const s=be.find(v=>v.colorId===A.colorId);n({...I,ColorId:A.colorId,color:s.color,availableQty:s.total,UOM:s.uom,Shrinkage:s.shrinkage,Wastage:s.wastage})}else d==="processType"?n({...I,processType:A}):d==="vendorId"?n({...I,vendorId:A}):(n({...I,[d]:A}),de(s=>({...s,[d]:""})))};r.useEffect(()=>{const u=()=>{const w=parseFloat(I.availableQty)||0,ue=parseFloat(I.Shrinkage)||0,y=parseFloat(I.Wastage)||0;return(w*(100-(ue+y))/100).toFixed(2)},d=()=>{const w=parseFloat(I.availableQty)||0,ue=parseFloat(I.RatePerUOM)||0;return(w*ue).toFixed(2)},A=(w,ue)=>(w*(1+ue/100)).toFixed(2),s=u(),v=d(),U=parseFloat(I.GST)||0;A(v,U),parseFloat(I.poPcs),n(w=>({...w,outputQty:s}))},[I.availableQty,I.Shrinkage,I.Wastage,I.RatePerUOM,I.GST,I.poPcs,I.UnitRatePerPo]);const[D,de]=r.useState({}),ne=async()=>{try{const u=await Me.post("http://100.42.177.77:83/api/DyeingPrinting/SaveDyeingPrinting",I);console.log("Save response:",u.data),u.data.success?f("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(f(`${u.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",u.data.message)),n(d=>({designId:d.designId,planningHeaderId:d.planningHeaderId,batchNo:d.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:d.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})),Y()}catch(u){console.error("Error saving data:",u),f("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},fe=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[J,V]=r.useState(!0),[le,R]=r.useState({}),[L,ce]=r.useState(!1),he=u=>{R(u),ce(!0)},Se=u=>{R(u),ce(!0),V(!1)},ke=()=>{V(!0),ce(!1),R({}),Y()},[Oe,je]=r.useState(0),[Ae,Ne]=r.useState(0);r.useEffect(()=>{const u=E.reduce((A,s)=>A+(s.availableQty??0),0).toFixed(2),d=E.reduce((A,s)=>A+(s.assignedQty??0),0).toFixed(2);je(parseFloat(u).toLocaleString()),Ne(parseFloat(d).toLocaleString())},[E]);const we=[...E,{id:"TOTAL_SUMMARY",componentName:"Total Summary",availableQty:Oe,assignedQty:Ae}],M={sortable:!1,pinnable:!1,hideable:!1},K=[{field:"id",headerName:"Sr#",...M,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):u.value},{field:"fabricName",headerName:"Fabric",...M},{field:"colorName",headerName:"Color",...M,colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?2:void 0},{field:"processType",headerName:"Process Type",...M,renderCell:u=>{const d=u.value==="Dyeing"?"primary.dark":u.value==="Printing"?"success.dark":"default";return e.jsx(Ye,{label:u.value,sx:{backgroundColor:d==="primary"||d==="default"?void 0:d,color:d==="primary"||d==="default"?void 0:"white"},color:d==="primary"?"primary":d==="default"?"default":void 0})}},{field:"uom",headerName:" UOM",...M},{field:"poPcs",headerName:" PO PCS.",...M},{field:"availableQty",headerName:"Available Quantitity",...M,valueGetter:u=>u.toLocaleString(),renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"assignedQty",headerName:"Assigned Qty",...M,valueGetter:u=>u.toLocaleString(),colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?4:void 0,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"AddVendor",headerName:"Add Vendor",...M,renderCell:u=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(bt,{variant:"text",size:"small",children:[e.jsx(ze,{color:"primary",onClick:()=>he(u.row),children:e.jsx(It,{})}),e.jsx(ze,{color:"primary",onClick:()=>Se(u.row),children:e.jsx(Ve,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(ot,{src:gr,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g,onChange:F,size:"small",InputLabelProps:{sx:{color:"black"}},children:k.map(u=>e.jsx(Q,{value:u.collectionId,children:u.collectionName},u.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:I.designId,onChange:F,size:"small",InputLabelProps:{sx:{color:"black"}},children:re.map(u=>e.jsx(Q,{value:u.designId,children:u.designNo},u.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:I.batchNo,onChange:F,size:"small",InputLabelProps:{sx:{color:"black"}},children:x.map(u=>e.jsx(Q,{value:u.batchNo,children:u.batchNo},u.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:I.baseColorName,onChange:F,disabled:!0,sx:u=>({...I.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:I.fabricId,onChange:F,error:!!D.fabricId,helperText:D.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:te.map(u=>e.jsx(Q,{value:u.fabricId,children:u.fabric},u.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(or,{fullWidth:!0,options:be,getOptionLabel:u=>u.color||"",renderInput:u=>e.jsx(c,{...u,label:"Color",name:"colorId",size:"small",error:!!D.colorId,helperText:D.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:u})=>e.jsx("div",{style:{backgroundColor:"white",boxShadow:"0 3px 5px rgba(0, 0, 0, 0.2)"},children:u}),value:be.find(u=>u.colorId===I.colorId)||null,onChange:(u,d)=>{n(A=>({...A,colorId:d?d.colorId:"",color:d?d.color:"",availableQty:d?d.total:"",UOM:d?d.uom:"",uomId:d?d.uomId:"",Shrinkage:d?d.shrinkage:"",Wastage:d?d.wastage:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:I.processType,onChange:F,error:!!D.processType,helperText:D.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:fe.map(u=>e.jsx(Q,{value:u.value,children:u.label},u.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:I.poPcs,onChange:F,disabled:!0,sx:u=>({...I.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:I.UOM,onChange:F,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Available Qty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:I.availableQty,onChange:F,disabled:!0,sx:u=>({...I.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(ge,{variant:"contained",color:"primary",size:"small",onClick:ne,children:"Save"})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(qe,{iColumns:K,initialRows:we,setInitialData:t,deleteApi:"http://100.42.177.77:83/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:Y,setAccordionExpanded:Z,fileName:"Dyeing&PrintingList",isLoading:C}),e.jsxs(nt,{open:L,onClose:ke,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(ve,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Dyeing and Printing > Assign Vendors "}),e.jsx(ze,{onClick:ke,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(dr,{initialFormData:le,setInitialFormData:R,refetchDyeingPrintingData:Y,handleClickOpen:he,showUpperDiv:J})]})]})]})})]})]})},fr=br,Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",Ir=({initialValues:o})=>{const{user:i}=Qe(),{enqueueSnackbar:C}=We(),[j,b]=r.useState(!0),[t,I]=r.useState([]),[n,f]=r.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:i.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId});r.useEffect(()=>{f({...n,schiffiliId:t.schiffiliId||0,componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})},[t]);const[l,P]=r.useState(!1),W=(d,A)=>{P(!l)},[g,S]=r.useState(!1),{data:p}=$e(),[T,m]=r.useState("");r.useEffect(()=>{m(o.collectionId)},[]);const{data:O}=_e(),{data:ee,refetch:X}=Xe(T,{skip:!T}),{data:G,refetch:z}=rt(n.designId,{skip:!n.designId}),{data:Y}=ut({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:re}=pt({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:B,refetch:x}=qa(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:H}=mt(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("formData.planningHeaderId",n.planningHeaderId),console.log("collectionData",p),console.log("schiffliList",B);const[te,pe]=r.useState([]),[h,_]=r.useState([]),[E,ae]=r.useState([]),[be,se]=r.useState([]),[N,Z]=r.useState([]),[k,q]=r.useState([]),[F,D]=r.useState([]),[de,ne]=r.useState([]),[fe,J]=r.useState([]);r.useEffect(()=>{ee&&pe(ee.result)},[ee]),r.useEffect(()=>{G&&_(G.result)},[G]),r.useEffect(()=>{Y&&ae(Y.result)},[Y]),r.useEffect(()=>{re&&D(Y.result)},[re]),r.useEffect(()=>{H&&J(H.result)},[H]),r.useEffect(()=>{B&&(b(!1),ne(B.result.map((d,A)=>({id:A+1,...d}))))},[B,x]),r.useEffect(()=>{if(O){const d=O.result[0];se(d.vendorList),Z(d.operatingMachineList),q(d.workingHeadList)}},[O]),console.log("initialRows",de);const V=(p==null?void 0:p.result)||[];r.useEffect(()=>{const d=()=>{const w=parseFloat(n.thaanQty)||0,ue=parseFloat(n.operatingMachine)||0;return(w*ue).toFixed(2)};f(w=>({...w,totalEmbroidry:d()}));const A=()=>{const w=parseFloat(n.thaanQty)||0,ue=parseFloat(n.noOfItemPerThaan)||0;return(w*ue).toFixed(2)};f(w=>({...w,totalPcs:A()}));const s=()=>{const w=parseFloat(n.noOfStichesPerYard)||0,ue=parseFloat(n.rate)||0;return(w/1e3*ue).toFixed(2)};f(w=>({...w,amountPerYard:s()}));const v=()=>{const w=parseFloat(n.totalAmount)||0,ue=parseFloat(n.totalPcs)||0;return(w/ue).toFixed(2)};f(w=>({...w,costPerComponent:v()}));const U=()=>{const w=parseFloat(n.amountPerYard)||0,ue=parseFloat(n.totalEmbroidry)||0,y=parseFloat(n.laserCutRate)||0,$=parseFloat(n.pcsForLaserCut)||0;return(w*ue+$*y).toFixed(2)};f(w=>({...w,totalAmount:U()}))},[n.thaanQty,n.operatingMachine,n.noOfStichesPerYard,n.rate,n.totalAmount,n.totalPcs,n.amountPerYard,n.totalEmbroidry,n.laserCutRate,n.pcsForLaserCut]);const le=d=>{const{name:A,checked:s}=d.target;f(v=>({...v,[A]:s}))},R=d=>{const{name:A,value:s}=d.target;if(A==="collectionId")V.find(v=>v.collectionId===parseInt(s)),m(s),S(!0),ne([]),b(!0),f({...n,collectionId:s,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(A==="designId"){const v=te.find(U=>U.designId===parseInt(s));ne([]),b(!0),f({...n,designId:s,baseColorId:v?v.colorId:"",baseColorName:v?v.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(A==="batchNo"){const v=h.find(U=>U.batchNo===s);f({...n,batchNo:s,planningHeaderId:v?v.planningHeaderId:"",poPcs:v?v.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),P(!0),S(!1)}else if(A==="colorId"){const v=F.find(U=>U.colorId===s);f({...n,colorId:s,availableQty:v?v.total:"",cuttingSize:v?v.cuttingSize:"",repeats:v?v.repeats:""})}else if(A==="operatingMachineId"){const v=N.find(U=>U.lookUpId===s);f({...n,operatingMachineId:s,operatingMachine:v?v.lookUpName:""})}else f({...n,[A]:s})};console.log("colors",F);const[L,ce]=r.useState({}),he=async()=>{const d=Se();if(Object.keys(d).length>0){ce(d);return}try{const A=await Me.post("http://100.42.177.77:83/api/Schiffli/SaveSchiffili",n);console.log("Save response:",A.data),A.data.success?C("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(C(`${A.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",A.data.message)),f(s=>({designId:s.designId,planningHeaderId:s.planningHeaderId,batchNo:s.batchNo,baseColorName:s.baseColorName,schiffiliId:0,componentId:"",poPcs:s.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})),x()}catch(A){console.error("Error saving data:",A),C("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Se=()=>{const d={};return n.fabricId||(d.fabricId="fabricId is required"),n.colorId||(d.colorId="colorId is required"),n.vendorId||(d.vendorId="vendorId is required"),n.componentId||(d.componentId="componentId is required"),n.thaanQty||(d.thaanQty="thaanQty is required"),n.workingHeadId||(d.workingHeadId="workingHeadId is required"),n.rate||(d.rate="rate is required"),n.operatingMachineId||(d.operatingMachineId="operatingMachineId is required"),n.noOfStichesPerYard||(d.noOfStichesPerYard="noOfStichesPerYard is required"),n.noOfItemPerThaan||(d.noOfItemPerThaan="noOfItemPerThaan is required"),d};console.log("formData",n);const[ke,Oe]=r.useState(0),[je,Ae]=r.useState(0),[Ne,we]=r.useState(0);r.useEffect(()=>{const d=de.reduce((v,U)=>v+(U.totalAmount??0),0).toFixed(2),A=de.reduce((v,U)=>v+(U.totalEmbroidry??0),0).toFixed(2),s=de.reduce((v,U)=>v+(U.totalPcs??0),0).toFixed(2);Oe(parseFloat(d).toLocaleString()),Ae(parseFloat(A).toLocaleString()),we(parseFloat(s).toLocaleString())},[de]);const M={id:"TOTAL_SUMMARY",fabricName:"Total Summary",totalAmount:ke,totalEmbroidry:je,totalPcs:Ne},K=[...de,M],Ie=[{field:"id",headerName:"Sr#",colSpan:(d,A)=>A.id==="TOTAL_SUMMARY"?3:void 0,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):d.value},{field:"fabricName",headerName:"Fabric",colSpan:(d,A)=>A.id==="TOTAL_SUMMARY"?2:void 0,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):d.value},{field:"componentName",headerName:"Component",renderCell:d=>e.jsx(Ye,{label:d.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"totalAmount",headerName:"Total Amount",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(ot,{src:Ut,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:T,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:V.map(d=>e.jsx(Q,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:te.map(d=>e.jsx(Q,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:h.map(d=>e.jsx(Q,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:d=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Bt,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ze,{onClick:W,sx:{mt:"-18px"},children:e.jsx(et,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(Ft,{expanded:l,onChange:W,sx:{},children:[e.jsx(Rt,{expandIcon:e.jsx(et,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(zt,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:R,size:"small",required:!0,error:!!L.componentId,helperText:L.componentId,InputLabelProps:{sx:{color:"black"}},children:fe.map(d=>e.jsx(Q,{value:d.componentId,children:d.componentName},d.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:R,required:!0,error:!!L.fabricId,helperText:L.fabricId,InputLabelProps:{sx:{color:"black"}},children:E.map(d=>e.jsx(Q,{value:d.fabricId,children:d.fabric},d.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:n.vendorId,onChange:R,required:!0,error:!!L.vendorId,helperText:L.vendorId,InputLabelProps:{sx:{color:"black"}},children:be.map(d=>e.jsx(Q,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:R,required:!0,error:!!L.colorId,helperText:L.colorId,InputLabelProps:{sx:{color:"black"}},children:F.map(d=>e.jsx(Q,{value:d.colorId,children:d.color},d.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,disabled:!0,onChange:R,sx:d=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:n.availableQty,onChange:R,sx:d=>({...n.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:n.thaanQty,onChange:R,required:!0,error:!!L.thaanQty,helperText:L.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:n.operatingMachineId,onChange:R,required:!0,error:!!L.operatingMachineId,helperText:L.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:N.map(d=>e.jsx(Q,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:n.workingHeadId,onChange:R,required:!0,error:!!L.workingHeadId,helperText:L.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:k.map(d=>e.jsx(Q,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:n.cuttingSize,onChange:R,sx:d=>({...n.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:n.rate,onChange:R,required:!0,error:!!L.rate,helperText:L.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:n.noOfStichesPerYard,onChange:R,required:!0,error:!!L.noOfStichesPerYard,helperText:L.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:n.noOfItemPerThaan,onChange:R,required:!0,error:!!L.noOfItemPerThaan,helperText:L.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:n.totalEmbroidry,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:n.amountPerYard,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:n.totalPcs,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:n.costPerComponent,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:n.totalAmount,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(Qt,{control:e.jsx(Wt,{checked:n.laserCut,onChange:le,name:"laserCut"}),label:"Laser Cut"})}),n.laserCut?e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(c,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:n.laserCutRate,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(c,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:n.pcsForLaserCut,onChange:R,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:he,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:Ie,initialRows:K,setInitialData:I,deleteApi:"http://100.42.177.77:83/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:x,setAccordionExpanded:P,fileName:"Schffili List",isLoading:j})})})]})]})},xr=Ir,vr=({additionalProcessData:o,setAdditionalProcessData:i,refetchAdditionalProcessList:C,handleClickOpen:j})=>{const{user:b}=Qe(),[t,I]=r.useState([]),{enqueueSnackbar:n}=We(),[f,l]=r.useState({}),[P,W]=r.useState([]),g=t.reduce((B,x)=>B+(x.quantity??0),0).toFixed(2);console.log("Quantity",g);const[S,p]=r.useState({additionalProcessDetId:0,additionalProcessId:o.additionalProcessId||0,designId:o.designNo||"",planningHeaderId:o.planningHeaderId||0,batchNo:o.batchNo||"",componentName:o.componentName||"",componentId:o.componentId||"",colorName:o.colorName||"",colorId:o.colorId||"",fabricName:o.fabricName||"",fabricId:o.fabricId||"",uomId:o.uomId||"",uom:o.uom||"",vendorId:"",pcsPerComponent:o.pcsPerComponent||"",remainingPcsPerComponent:o.pcsPerComponent-g||"",processTypeName:o.processTypeName||"",processTypeId:o.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:b.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:b.empId});r.useEffect(()=>{p(B=>({...B,additionalProcessDetId:P.additionalProcessDetId||0,vendorId:(P==null?void 0:P.vendorId)||"",quantity:(P==null?void 0:P.quantity)||"",ratePerPcs:(P==null?void 0:P.ratePerPcs)||"",remainingPcsPerComponent:B.remainingPcsPerComponent+(P==null?void 0:P.quantity)||"",totalAmount:(P==null?void 0:P.totalAmount)||"",costPerComponent:(P==null?void 0:P.costPerComponent)||0,createdOn:(P==null?void 0:P.createdOn)||new Date().toISOString(),createdBy:(P==null?void 0:P.createdBy)||b.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:b.empId}))},[P]),r.useEffect(()=>{p({...S,remainingPcsPerComponent:o.pcsPerComponent-g>=0?o.pcsPerComponent-g:""})},[t,o.pcsPerComponent,g]);const{data:T}=_e(),{data:m,refetch:O}=Ea(S.additionalProcessId,{skip:!S.additionalProcessId}),[ee,X]=r.useState([]);r.useEffect(()=>{if(T){const B=T.result[0];X(B.vendorList)}},[T]),r.useEffect(()=>{m&&I(m.result.map((B,x)=>({id:x+1,...B})))},[m,O]),console.log("initialRows",t);const G=B=>{const{name:x,value:H}=B.target;p({...S,[x]:H}),p(te=>{const pe={...te,[x]:H};if(x==="quantity"||x==="remainingPcsPerComponent"){const h=pe.quantity,_=pe.remainingPcsPerComponent;h>_?l(E=>({...E,quantity:"Assigned Quantity cannot be greater than Remaining Quantity"})):l(E=>({...E,quantity:""}))}return pe})};r.useEffect(()=>{const B=()=>{const H=parseFloat(S.quantity)||0,te=parseFloat(S.ratePerPcs)||0;return(H*te).toFixed(2)};p(H=>({...H,totalAmount:B()}));const x=()=>{const H=parseFloat(S.totalAmount)||0,te=parseFloat(S.poPcs)||0;return(H/te).toFixed(2)};p(H=>({...H,costPerComponent:x()}))},[S.quantity,S.ratePerPcs,S.totalAmount]);const z=async()=>{if(console.log(S),S.quantity>S.remainingPcsPerComponent){n("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}try{const B=await Me.post("http://100.42.177.77:83/api/AdditionalProcess/SaveAdditionalProcessDetails",S);console.log("Save response:",B.data),B.data.success?n("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(n(`${B.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",B.data.message)),O(),p(x=>({...x,vendorId:"",pcsPerComponent:o.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",remainingPcsPerComponent:o.pcsPerComponent-g||"",createdOn:new Date().toISOString(),createdBy:b.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:b.empId})),C()}catch(B){console.error("Error saving data:",B),n("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Y=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:2},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Select Design",name:"designId",value:S.designId,onChange:G,size:"small",disabled:!0,sx:B=>({...S.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:S.batchNo,onChange:G,size:"small",disabled:!0,sx:B=>({...S.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Components",name:"componentName",value:S.componentName,onChange:G,size:"small",disabled:!0,sx:B=>({...S.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:S.fabricName,onChange:G,disabled:!0,sx:B=>({...S.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:S.colorName,onChange:G,disabled:!0,sx:B=>({...S.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:S.processTypeName,onChange:G,disabled:!0,sx:B=>({...S.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:S.pcsPerComponent,onChange:G,disabled:!0,sx:B=>({...S.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:S.remainingPcsPerComponent,onChange:G,disabled:!0,sx:B=>({...S.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:S.uom,onChange:G,disabled:!0,sx:B=>({...S.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:S.vendorId,onChange:G,disabled:!S.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}},children:ee.map(B=>e.jsx(Q,{value:B.lookUpId,children:B.lookUpName},B.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:S.quantity,onChange:G,disabled:!S.remainingPcsPerComponent,error:!!f.quantity,helperText:f.quantity,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:S.ratePerPcs,onChange:G,disabled:!S.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:S.totalAmount,onChange:G,disabled:!S.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:z,disabled:!S.remainingPcsPerComponent,children:"Save"})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:Y,initialRows:t,setInitialData:W,deleteApi:"http://100.42.177.77:83/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:O})})})]})},yr=({initialValues:o})=>{const{user:i}=Qe(),{enqueueSnackbar:C}=We(),[j,b]=r.useState(!0),[t,I]=r.useState([]),[n,f]=r.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId});console.log("initialData",t),r.useEffect(()=>{f({...n,additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})},[t]);const[l,P]=r.useState(!1),{data:W}=$e(),[g,S]=r.useState("");r.useEffect(()=>{S(o.collectionId)},[]);const{data:p}=_e(),{data:T,refetch:m}=Xe(g,{skip:!g}),{data:O,refetch:ee}=rt(n.designId,{skip:!n.designId}),{data:X}=ut({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:G}=pt({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:z,refetch:Y}=Ga(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:re}=mt(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("lookupData",p),console.log("collectionData",W),console.log("colorData",G);const[B,x]=r.useState([]),[H,te]=r.useState([]),[pe,h]=r.useState([]),[_,E]=r.useState([]),[ae,be]=r.useState([]),[se,N]=r.useState([]),[Z,k]=r.useState([]),[q,F]=r.useState([]),[D,de]=r.useState([]),[ne,fe]=r.useState([]),[J,V]=r.useState([]);console.log("batchData",O);const[le,R]=r.useState([]);r.useEffect(()=>{W&&R(W.result)},[W]),r.useEffect(()=>{T&&x(T.result)},[T]),r.useEffect(()=>{O&&te(O.result)},[O]),r.useEffect(()=>{X&&h(X.result)},[X]),r.useEffect(()=>{G&&de(G.result)},[G]),r.useEffect(()=>{re&&V(re.result)},[re]),r.useEffect(()=>{if(p){const u=p.result[0];be(u.uomList),N(u.processList)}},[p]),r.useEffect(()=>{z&&(b(!1),fe(z.result.map((u,d)=>({id:d+1,...u}))))},[z,Y]),r.useEffect(()=>{if(p){const u=p.result[0];E(u.vendorList),k(u.operatingMachineList),F(u.workingHeadList)}},[p]),console.log("initialRows",ne);const L=u=>{const{name:d,value:A}=u.target;if(d==="collectionId")le.find(s=>s.collectionId===parseInt(A)),S(A),fe([]),b(!0),f({...n,collectionId:A,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId});else if(d==="designId"){const s=B.find(v=>v.designId===parseInt(A));fe([]),b(!0),f({...n,designId:A,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})}else if(d==="batchNo"){const s=H.find(v=>v.batchNo===A);f({...n,batchNo:A,planningHeaderId:s?s.planningHeaderId:"",poPcs:s?s.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId}),P(!0)}else f({...n,[d]:A})};console.log("colors",D);const ce=async()=>{console.log("formData",n);try{const u=await Me.post("http://100.42.177.77:83/api/AdditionalProcess/SaveAdditionalProcess",n);console.log("Save response:",u.data),u.data.success?C("Process saved successfully!",{variant:"success",autoHideDuration:5e3}):(C(`${u.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",u.data.message)),f(d=>({additionalProcessId:0,designId:d.designId,planningHeaderId:d.planningHeaderId,batchNo:d.batchNo,baseColorName:d.baseColorName,poPcs:d.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})),Y()}catch(u){console.error("Error saving data:",u),C("Process not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",n),r.forwardRef(function(d,A){return e.jsx(Ya,{direction:"up",ref:A,...d})});const[he,Se]=r.useState({}),[ke,Oe]=r.useState(!1),je=u=>{Se(u),Oe(!0)},Ae=()=>{Oe(!1),Se({}),Y()},[Ne,we]=r.useState(0);r.useEffect(()=>{const u=ne.reduce((d,A)=>d+(A.assignedQty??0),0).toFixed(2);we(parseFloat(u).toLocaleString())},[ne]);const M=[...ne,{id:"TOTAL_SUMMARY",assignedQty:Ne}],K=[{field:"id",headerName:"Sr#",colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?4:void 0,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):u.value},{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component",renderCell:u=>e.jsx(Ye,{label:u.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity",colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?3:void 0,valueGetter:u=>u,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:u=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(ze,{color:"primary",onClick:()=>je(u.row),children:e.jsx(It,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(ot,{src:Ut,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:le.map(u=>e.jsx(Q,{value:u.collectionId,children:u.collectionName},u.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:B.map(u=>e.jsx(Q,{value:u.designId,children:u.designNo},u.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:H.map(u=>e.jsx(Q,{value:u.batchNo,children:u.batchNo},u.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:L,disabled:!0,sx:u=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:J.map(u=>e.jsx(Q,{value:u.componentId,children:u.componentName},u.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:pe.map(u=>e.jsx(Q,{value:u.fabricId,children:u.fabric},u.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:D.map(u=>e.jsx(Q,{value:u.colorId,children:u.color},u.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:L,disabled:!0,sx:u=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:n.pcsPerComponent,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:n.uomId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:ae.map(u=>e.jsx(Q,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:n.processTypeId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:se.map(u=>e.jsx(Q,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(ge,{variant:"contained",size:"small",onClick:ce,children:"Save"})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(qe,{iColumns:K,initialRows:M,setInitialData:I,deleteApi:"http://100.42.177.77:83/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:Y,setAccordionExpanded:P,fileName:"AdditionalProcess",isLoading:j}),e.jsxs(nt,{open:ke,onClose:Ae,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(ve,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Additional Process > Assign Vendors "}),e.jsx(ze,{onClick:Ae,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(vr,{additionalProcessData:he,setAdditionalProcessData:Se,refetchAdditionalProcessList:Y,handleClickOpen:je})]})]})]})})]})]})},Cr=yr;function Mr({initialValues:o}){const[i,C]=r.useState(!0),{data:j}=_e(),[b,t]=r.useState([]),[I,n]=r.useState([]),[f,l]=r.useState([]),[P,W]=r.useState([]),[g,S]=r.useState([]),[p,T]=r.useState([]),{user:m}=Qe();r.useEffect(()=>{j&&(l(j.result[0].vendorList),n(j.result[0].serviceList),t(j.result[0].serviceTypeList),S(j.result[0].uomList))},[j]);const[O,ee]=r.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()});r.useEffect(()=>{ee({...O,additionalServiceId:p.additionalServiceId||0,collectionId:(p==null?void 0:p.collectionId)||"",serviceTypeId:(p==null?void 0:p.serviceTypeId)||"",serviceListId:(p==null?void 0:p.serviceListId)||"",vendorId:(p==null?void 0:p.vendorId)||"",qty:(p==null?void 0:p.qty)||"",uomId:(p==null?void 0:p.uomId)||"",rate:(p==null?void 0:p.rate)||"",totalAmount:(p==null?void 0:p.totalAmount)||0,UOM:(p==null?void 0:p.uom)||0,uom:(p==null?void 0:p.uom)||"",createdOn:(p==null?void 0:p.createdOn)||new Date().toISOString(),createdBy:(p==null?void 0:p.createdBy)||m.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:m.empId})},[p]),r.useEffect(()=>{ee({...O,collectionId:(o==null?void 0:o.collectionId)||""})},[ee]);const X=async h=>{const{name:_,value:E}=h.target;if(console.log(`Updating ${_} to ${E}`),ee({...O,[_]:E}),_==="collectionId"){const ae=P.find(be=>be.collectionId===E);ae&&ee(be=>({...be,poPcs:ae.poPcs}))}};r.useEffect(()=>{const h=()=>{const E=parseFloat(O.qty)||0,ae=parseFloat(O.rate)||0;return(E*ae).toFixed(2)};ee(E=>({...E,totalAmount:h()}));const _=()=>{const E=parseFloat(O.poPcs)||0,ae=parseFloat(O.totalAmount)||0;return(E/ae).toFixed(2)};ee(E=>({...E,costperPiece:_()}))},[O.qty,O.rate,O.totalAmount,O.costperPiece]);const G=async()=>{try{const h=await Me.post("http://100.42.177.77:83/api/AdditionalServices/SaveAdditionalServices",O);console.log("Form data saved:",h.data),ee({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(h){console.error("Error saving data:",h)}};r.useEffect(()=>{(async()=>{try{const _=await Me.get("http://100.42.177.77:83/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",_),W(_.data.result)}catch(_){console.error("Error fetching design options:",_)}})()},[]);const[z,Y]=r.useState([]),re=r.useCallback(async()=>{try{const h=await Me.get(`http://100.42.177.77:83/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${O.collectionId}`);Array.isArray(h.data.result)?(C(!1),Y(h.data.result.map((_,E)=>({id:E+1,..._})))):(console.error("API returned unexpected data format:",h.data.result),Y([]))}catch(h){console.error("Error fetching data:",h),Y([])}},[O.collectionId]);r.useEffect(()=>{re()},[re]);const[B,x]=r.useState(0);r.useEffect(()=>{const h=z.reduce((_,E)=>_+(E.totalAmount??0),0).toFixed(2);x(parseFloat(h).toLocaleString())},[z]);const H=[...z,{id:"TOTAL_SUMMARY",totalAmount:B}],te=[{field:"id",headerName:"Sr#",colSpan:(h,_)=>_.id==="TOTAL_SUMMARY"?4:void 0,renderCell:h=>h.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):h.value},{field:"collectionName",headerName:"Collection Name"},{field:"serviceType",headerName:"Service Type",renderCell:h=>e.jsx(Ye,{label:h.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"serviceListName",headerName:"Service List Name",renderCell:h=>e.jsx(Ye,{label:h.value,sx:{backgroundColor:"success.dark",color:"white"},color:void 0})},{field:"vendor",headerName:"Vendor"},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount",colSpan:(h,_)=>_.id==="TOTAL_SUMMARY"?3:void 0,renderCell:h=>h.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:h.value}):h.value},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:O.collectionId,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:P.length>0?P.map(h=>e.jsx(Q,{id:"collectionId",value:h.collectionId,children:h.collectionName},h.collectionId)):e.jsx(Q,{disabled:!0,children:"No Collections Available"})})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:O.serviceTypeId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:b.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:O.serviceListId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:I.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:O.vendorId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:f.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:O.poPcs,onChange:X,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:h=>({...O.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Qty",name:"qty",value:O.qty,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:O.uomId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:g.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Rate",name:"rate",value:O.rate,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:O.totalAmount,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:O.costperPiece,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(ge,{variant:"contained",color:"primary",size:"small",onClick:G,children:"Save"})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(qe,{iColumns:te,initialRows:H,isLoading:i,setInitialData:T,deleteApi:"http://100.42.177.77:83/api/AdditionalServices/DeleteAdditionalProcess?servicesId=",refetch:re,deleteBy:"additionalServiceId"})]})]})}Va($a)(({theme:o})=>({backgroundColor:o.palette.primary.main,color:o.palette.primary.light,overflow:"hidden",position:"relative","&:after":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(210.04deg, ${o.palette.grey[400]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,borderRadius:"50%",top:-30,right:-180},"&:before":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(140.9deg, ${o.palette.grey[400]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,borderRadius:"50%",top:-160,right:-130}}));const Pr=({initialValues:o,setActiveStep:i,collectionId:C,setInitialValues:j})=>{var ke,Oe,je,Ae,Ne,we;const{user:b}=Qe(),{enqueueSnackbar:t}=We();r.useState([]);const{data:I}=$e(),[n,f]=r.useState(null),[l,P]=r.useState(!1);ct();const[W,g]=r.useState(!1),[S,p]=r.useState(C||""),[T,m]=r.useState({designId:"",planningHeaderId:"",batchNo:"",distinctId:"",collectionBatchId:"",collectionId:S||""}),O=M=>{he.current&&he.current.autosizeColumns&&he.current.autosizeColumns({includeOutliers:!0,includeHeaders:!0})},[ee,X]=r.useState([]),G=M=>{X(M),console.log("New Selection:",M)},{data:z,refetch:Y}=Ka(S,{skip:!S}),[re,B]=r.useState([]),[x,H]=r.useState([]),[te,pe]=r.useState([]);console.log("distinctData",z),r.useEffect(()=>{I&&pe(I.result)},[I]),r.useEffect(()=>{z&&(console.log("Distinct Data:",z.result),H(z||[]))},[z]);const h=M=>{const{name:K,value:Ie}=M.target;if(console.log(`handleChange called with name: ${K}, value: ${Ie}`),K==="collectionId")p(Ie),m({...T,collectionId:Ie,collectionBatchId:""}),Y(C);else if(K==="collectionBatchId")m({...T,collectionBatchId:Ie,planningHeaderId:T.planningHeaderId});else{const u={...T,[K]:Ie};m(u)}},{data:_,refetch:E}=Xa({collectionId:T.collectionId,collectionBatchId:T.collectionBatchId},{skip:!T.collectionId||!T.collectionBatchId});r.useEffect(()=>{_&&_.length>0&&B(_)},[_]),console.log("Selected collection ID:",S),console.log("distinctCollectionList data:",x);const ae=async M=>{P(!0);try{console.log("Fetching Summary Data for ID:",M);const K=await Me.get(`http://100.42.177.77:83/api/PrePlanning/GetPrePlanningSummaryByBatchId?planningHeaderId=${M}`);K.data.success?f(K.data.result):console.error(K.data.message)}catch(K){console.error("Failed to fetch summary data",K)}finally{P(!1)}};console.log("formData",T);const be=M=>{console.log("Selected PlanningHeaderId:",M),ae(M),g(!0)},se=()=>{g(!1)},N=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"planningProcessTypeName",headerName:"Process Type"},{field:"componentsCount",headerName:"Components Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalFabricSum",headerName:"Total Fabric Sum",valueGetter:M=>M.toLocaleString()},{field:"totalFabricRequiredSum",headerName:"Total Fabric Required Sum",valueGetter:M=>M.toLocaleString()}],Z=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalExcGst",headerName:"Total Excluding GST",valueGetter:M=>M.toLocaleString()},{field:"totalIncGst",headerName:"Total Including GST",valueGetter:M=>M.toLocaleString()}],k=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"processType",headerName:"Process Type"},{field:"assignedQtySum",headerName:"Assigned Qty Sum"},{field:"availableQtySum",headerName:"Available Qty Sum",valueGetter:M=>M.toLocaleString()},{field:"colorCount",headerName:"Color Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"outputQtySum",headerName:"Output Qty Sum"},{field:"totalIncGst",headerName:"Total Including GST",valueGetter:M=>M.toLocaleString()}],q=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150},{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150},{field:"requiredPcsSum",headerName:"Required Pcs Sum",width:150},{field:"totalAmountSum",headerName:"Total Amount Sum",valueGetter:M=>M.toLocaleString(),width:150}],F=[{field:"availableQtySum",headerName:"Available Qty Sum",valueGetter:M=>M.toLocaleString(),width:150},{field:"totalPcsSum",headerName:"Total Pcs Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150}],D=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"pcsPerComponent",headerName:"Pcs Per Component",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150}],de=[{field:"collectionName",headerName:"Collection Name"},{field:"batchNo",headerName:"Batch No"},{field:"designNo",headerName:"Design No"},{field:"orderNumber",headerName:"Order Number"},{field:"designerName",headerName:"Designer Name"},{field:"colorName",headerName:"Color Name"},{field:"poPcs",headerName:"PO Pieces"},{field:"batchStatusName",headerName:"Batch Status"},{field:"planningDate",headerName:"Planning Date",valueGetter:M=>new Date(M).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"action",headerName:"Action",renderCell:M=>e.jsx(bt,{variant:"outlined",size:"small","aria-label":"outlined primary button group",children:e.jsx(ge,{onClick:()=>be(M.row.planningHeaderId),children:"View"})}),sortable:!1,filterable:!1}],[ne,fe]=r.useState([]);r.useEffect(()=>{const M=(re==null?void 0:re.map((K,Ie)=>({id:K.planningHeaderId||Ie,...K})))||[];fe(M)},[re]);const J=((ke=n==null?void 0:n.prePlanningList)==null?void 0:ke.map((M,K)=>({id:K,...M})))||[],V=((Oe=n==null?void 0:n.fabricationList)==null?void 0:Oe.map((M,K)=>({id:K,...M})))||[],le=((je=n==null?void 0:n.dyeingPrintingList)==null?void 0:je.map((M,K)=>({id:K,...M})))||[],R=((Ae=n==null?void 0:n.embroideryList)==null?void 0:Ae.map((M,K)=>({id:K,...M})))||[],L=((Ne=n==null?void 0:n.schiffiliList)==null?void 0:Ne.map((M,K)=>({id:K,...M})))||[],ce=((we=n==null?void 0:n.additionalProcessList)==null?void 0:we.map((M,K)=>({id:K,...M})))||[],he=ar(),Se=async()=>{if(ee.length===0){t("No rows selected",{variant:"warning"});return}const M=ee,K={planningHeaderId:M,collectionBatchId:T.collectionBatchId,createdBy:b.empId,batchStatus:3};try{(await Me.post("http://100.42.177.77:83/api/PrePlanning/FinalizePrePlanningBatch",K)).data===!0?(t("Pre Planning Finalized successfully",{variant:"success"}),console.log("requestbody",K),fe(u=>u.filter(d=>!M.includes(d.id)))):t("Failed to save data",{variant:"error"})}catch(Ie){console.error("Failed to save data",Ie),t("Failed to save data",{variant:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:T.collectionId,onChange:h,size:"small",InputLabelProps:{sx:{color:"black"}},children:te.map(M=>e.jsx(Q,{value:M.collectionId,children:M.collectionName},M.collectionId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection Batch",name:"collectionBatchId",value:T.collectionBatchId,onChange:h,size:"small",InputLabelProps:{sx:{color:"black"}},children:x.length>0?x.map(M=>e.jsx(Q,{value:M.collectionBatchId,children:M.distinctId},M.collectionBatchId)):e.jsx(Q,{disabled:!0,children:"No batches available"})})}),e.jsx(a,{item:!0,xs:4,textAlign:"right",sx:{mt:1},children:e.jsx(ge,{variant:"contained",size:"small",onClick:Se,color:"success",children:"Finalize"})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,mb:1}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"inherit",sx:{paddingY:1,paddingX:1},children:[e.jsx(a,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(Ge,{rows:ne,columns:de,checkboxSelection:!0,getRowId:M=>M.id,disableRowSelectionOnClick:!0,autosizeOnMount:!0,apiRef:he,onStateChange:O,onRowSelectionModelChange:M=>G(M)})}),e.jsxs(nt,{open:W,onClose:se,maxWidth:"lg",fullWidth:!0,children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsx(st,{children:l?e.jsx(Re,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(Mt,{})}):n?e.jsxs(e.Fragment,{children:[e.jsx(ve,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(0),children:"Pre Planning"}),e.jsx(Ge,{rows:J,columns:N,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,onStateChange:O,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:3,width:"100%",mb:1}}),e.jsx(ve,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(1),children:"Fabrication"}),e.jsx(Ge,{rows:V,columns:Z,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mt:1,mb:1}}),e.jsx(ve,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(2),children:"Dyeing"}),e.jsx(Ge,{rows:le,columns:k,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(ve,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(3),children:"Embroidery"}),e.jsx(Ge,{rows:R,columns:q,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(ve,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(4),children:"Schiffli"}),e.jsx(Ge,{rows:L,columns:F,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(ve,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(5),children:"Additional Process"}),e.jsx(Ge,{rows:ce,columns:D,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}})]}):e.jsx(Mt,{})}),e.jsx(rr,{children:e.jsx(ge,{onClick:se,children:"Close"})})]})]})]})]})},jt=Pr;var Sr={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},vt=Sr,jr=vt;function kr(o){return!!(o&&jr[typeof o])}var lt=kr,Or=Object.prototype,Ar=Or.toString,Nr=RegExp("^"+String(Ar).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),it=Nr,wr=vt,Lr=Object.prototype,Tr=Lr.hasOwnProperty,Br=function(o){var i,C=o,j=[];if(!C||!wr[typeof o])return j;for(i in C)Tr.call(C,i)&&j.push(i);return j},Fr=Br,Rr=lt,zr=it,Qr=Fr,tt=zr.test(tt=Object.keys)&&tt,Wr=tt?function(o){return Rr(o)?tt(o):[]}:Qr,Ht=Wr;function _r(){}var Ur=_r,qt=lt,Hr=it,at=Hr.test(at=Object.create)&&at;function Et(o,i){return qt(o)?at(o):{}}at||(Et=function(){function o(){}return function(i){if(qt(i)){o.prototype=i;var C=new o;o.prototype=null}return C||window.Object()}}());var Gt=Et,qr=Ur,Er=it,kt={configurable:!1,enumerable:!1,value:null,writable:!1},Ot=function(){try{var o={},i=Er.test(i=Object.defineProperty)&&i,C=i(o,o,o)&&i}catch{}return C}(),Gr=Ot?function(o,i){kt.value=i,Ot(o,"__bindData__",kt)}:qr,yt=Gr,Yr=Gt,Vr=lt,$r=yt,Kr=[],Xr=Kr.push;function Dr(o){var i=o[0],C=o[2],j=o[4];function b(){if(C){var t=C.slice();Xr.apply(t,arguments)}if(this instanceof b){var I=Yr(i.prototype),n=i.apply(I,t||arguments);return Vr(n)?n:I}return i.apply(j,t||arguments)}return $r(b,o),b}var Jr=Dr;function Zr(o,i,C){i||(i=0),typeof C>"u"&&(C=o?o.length:0);for(var j=-1,b=C-i||0,t=Array(b<0?0:b);++j<b;)t[j]=o[i+j];return t}var Yt=Zr,eo=Gt,to=lt,ao=yt,ro=Yt,oo=[],At=oo.push;function Vt(o){var i=o[0],C=o[1],j=o[2],b=o[3],t=o[4],I=o[5],n=C&1,f=C&2,l=C&4,P=C&8,W=i;function g(){var S=n?t:this;if(j){var p=j.slice();At.apply(p,arguments)}if((b||l)&&(p||(p=ro(arguments)),b&&At.apply(p,b),l&&p.length<I))return C|=16,Vt([i,P?C:C&-4,p,null,t,I]);if(p||(p=arguments),f&&(i=S[W]),this instanceof g){S=eo(i.prototype);var T=i.apply(S,p);return to(T)?T:S}return i.apply(S,p)}return ao(g,o),g}var no=Vt;function so(o){return typeof o=="function"}var lo=so,io=Jr,co=no,uo=lo,po=[],Nt=po.push;function $t(o,i,C,j,b,t){var I=i&1,n=i&2,f=i&4,l=i&16,P=i&32;if(!n&&!uo(o))throw new TypeError;l&&!C.length&&(i&=-17,l=C=!1),P&&!j.length&&(i&=-33,P=j=!1);var W=o&&o.__bindData__;if(W&&W!==!0)return W=W.slice(),I&&!(W[1]&1)&&(W[4]=b),!I&&W[1]&1&&(i|=8),f&&!(W[1]&4)&&(W[5]=t),l&&Nt.apply(W[2]||(W[2]=[]),C),P&&Nt.apply(W[3]||(W[3]=[]),j),W[1]|=i,$t.apply(null,W);var g=i==1||i===17?io:co;return g([o,i,C,j,b,t])}var mo=$t,wt=mo,ho=Yt;function go(o,i){return arguments.length>2?wt(o,17,ho(arguments,2),null,i):wt(o,1,null,null,i)}var bo=go;function fo(o){return o}var Io=fo,xo=it,vo=/\bthis\b/,Ct={};Ct.funcDecomp=!xo.test(window.WinRTError)&&vo.test(function(){return this});Ct.funcNames=typeof Function.name=="string";var yo=Ct,Co=bo,Mo=Io,Po=yt,dt=yo,So=/^\s*function[ \n\r\t]+\w/,jo=/\bthis\b/,ko=Function.prototype.toString;function Oo(o,i,C){if(typeof o!="function")return Mo;if(typeof i>"u"||!("prototype"in o))return o;var j=o.__bindData__;if(typeof j>"u"&&(dt.funcNames&&(j=!o.name),j=j||!dt.funcDecomp,!j)){var b=ko.call(o);dt.funcNames||(j=!So.test(b)),j||(j=jo.test(b),Po(o,j))}if(j===!1||j!==!0&&j[1]&1)return o;switch(C){case 1:return function(t){return o.call(i,t)};case 2:return function(t,I){return o.call(i,t,I)};case 3:return function(t,I,n){return o.call(i,t,I,n)};case 4:return function(t,I,n,f){return o.call(i,t,I,n,f)}}return Co(o,i)}var Kt=Oo,Ao=Kt,No=Ht,Lt=vt,wo=function(o,i,C){var j,b=o,t=b;if(!b||!Lt[typeof b])return t;i=i&&typeof C>"u"?i:Ao(i,C,3);for(var I=-1,n=Lt[typeof b]&&No(b),f=n?n.length:0;++I<f;)if(j=n[I],i(b[j],j,o)===!1)return t;return t},Lo=wo,To=Kt,Bo=Lo;function Fo(o,i,C){var j=-1,b=o?o.length:0;if(i=i&&typeof C>"u"?i:To(i,C,3),typeof b=="number")for(;++j<b&&i(o[j],j,o)!==!1;);else Bo(o,i);return o}var Ro=Fo,Xt,Dt;Xt={mm:{name:{singular:"Millimeter",plural:"Millimeters"},to_anchor:1/1e3},cm:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1/100},m:{name:{singular:"Meter",plural:"Meters"},to_anchor:1},km:{name:{singular:"Kilometer",plural:"Kilometers"},to_anchor:1e3}};Dt={in:{name:{singular:"Inch",plural:"Inches"},to_anchor:1/12},yd:{name:{singular:"Yard",plural:"Yards"},to_anchor:3},"ft-us":{name:{singular:"US Survey Foot",plural:"US Survey Feet"},to_anchor:1.000002},ft:{name:{singular:"Foot",plural:"Feet"},to_anchor:1},mi:{name:{singular:"Mile",plural:"Miles"},to_anchor:5280}};var zo={metric:Xt,imperial:Dt,_anchors:{metric:{unit:"m",ratio:3.28084},imperial:{unit:"ft",ratio:1/3.28084}}},Jt,Zt;Jt={mm2:{name:{singular:"Square Millimeter",plural:"Square Millimeters"},to_anchor:1/1e6},cm2:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1/1e4},m2:{name:{singular:"Square Meter",plural:"Square Meters"},to_anchor:1},ha:{name:{singular:"Hectare",plural:"Hectares"},to_anchor:1e4},km2:{name:{singular:"Square Kilometer",plural:"Square Kilometers"},to_anchor:1e6}};Zt={in2:{name:{singular:"Square Inch",plural:"Square Inches"},to_anchor:1/144},yd2:{name:{singular:"Square Yard",plural:"Square Yards"},to_anchor:9},ft2:{name:{singular:"Square Foot",plural:"Square Feet"},to_anchor:1},ac:{name:{singular:"Acre",plural:"Acres"},to_anchor:43560},mi2:{name:{singular:"Square Mile",plural:"Square Miles"},to_anchor:27878400}};var Qo={metric:Jt,imperial:Zt,_anchors:{metric:{unit:"m2",ratio:10.7639},imperial:{unit:"ft2",ratio:1/10.7639}}},ea,ta;ea={mcg:{name:{singular:"Microgram",plural:"Micrograms"},to_anchor:1/1e6},mg:{name:{singular:"Milligram",plural:"Milligrams"},to_anchor:1/1e3},g:{name:{singular:"Gram",plural:"Grams"},to_anchor:1},kg:{name:{singular:"Kilogram",plural:"Kilograms"},to_anchor:1e3},mt:{name:{singular:"Metric Tonne",plural:"Metric Tonnes"},to_anchor:1e6}};ta={oz:{name:{singular:"Ounce",plural:"Ounces"},to_anchor:1/16},lb:{name:{singular:"Pound",plural:"Pounds"},to_anchor:1},t:{name:{singular:"Ton",plural:"Tons"},to_anchor:2e3}};var Wo={metric:ea,imperial:ta,_anchors:{metric:{unit:"g",ratio:1/453.592},imperial:{unit:"lb",ratio:453.592}}},aa,ra;aa={mm3:{name:{singular:"Cubic Millimeter",plural:"Cubic Millimeters"},to_anchor:1/1e6},cm3:{name:{singular:"Cubic Centimeter",plural:"Cubic Centimeters"},to_anchor:1/1e3},ml:{name:{singular:"Millilitre",plural:"Millilitres"},to_anchor:1/1e3},cl:{name:{singular:"Centilitre",plural:"Centilitres"},to_anchor:1/100},dl:{name:{singular:"Decilitre",plural:"Decilitres"},to_anchor:1/10},l:{name:{singular:"Litre",plural:"Litres"},to_anchor:1},kl:{name:{singular:"Kilolitre",plural:"Kilolitres"},to_anchor:1e3},m3:{name:{singular:"Cubic meter",plural:"Cubic meters"},to_anchor:1e3},km3:{name:{singular:"Cubic kilometer",plural:"Cubic kilometers"},to_anchor:1e12},krm:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:1/1e3},tsk:{name:{singular:"Tesked",plural:"Teskedar"},to_anchor:5/1e3},msk:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:15/1e3},kkp:{name:{singular:"Kaffekopp",plural:"Kaffekoppar"},to_anchor:150/1e3},glas:{name:{singular:"Glas",plural:"Glas"},to_anchor:200/1e3},kanna:{name:{singular:"Kanna",plural:"Kannor"},to_anchor:2.617}};ra={tsp:{name:{singular:"Teaspoon",plural:"Teaspoons"},to_anchor:1/6},Tbs:{name:{singular:"Tablespoon",plural:"Tablespoons"},to_anchor:1/2},in3:{name:{singular:"Cubic inch",plural:"Cubic inches"},to_anchor:.55411},"fl-oz":{name:{singular:"Fluid Ounce",plural:"Fluid Ounces"},to_anchor:1},cup:{name:{singular:"Cup",plural:"Cups"},to_anchor:8},pnt:{name:{singular:"Pint",plural:"Pints"},to_anchor:16},qt:{name:{singular:"Quart",plural:"Quarts"},to_anchor:32},gal:{name:{singular:"Gallon",plural:"Gallons"},to_anchor:128},ft3:{name:{singular:"Cubic foot",plural:"Cubic feet"},to_anchor:957.506},yd3:{name:{singular:"Cubic yard",plural:"Cubic yards"},to_anchor:25852.7}};var _o={metric:aa,imperial:ra,_anchors:{metric:{unit:"l",ratio:33.8140226},imperial:{unit:"fl-oz",ratio:1/33.8140226}}},oa;oa={ea:{name:{singular:"Each",plural:"Each"},to_anchor:1},dz:{name:{singular:"Dozen",plural:"Dozens"},to_anchor:12}};var Uo={metric:oa,imperial:{},_anchors:{metric:{unit:"ea",ratio:1}}},na,sa;na={C:{name:{singular:"degree Celsius",plural:"degrees Celsius"},to_anchor:1,anchor_shift:0},K:{name:{singular:"degree Kelvin",plural:"degrees Kelvin"},to_anchor:1,anchor_shift:273.15}};sa={F:{name:{singular:"degree Fahrenheit",plural:"degrees Fahrenheit"},to_anchor:1},R:{name:{singular:"degree Rankine",plural:"degrees Rankine"},to_anchor:1,anchor_shift:459.67}};var Ho={metric:na,imperial:sa,_anchors:{metric:{unit:"C",transform:function(o){return o/(5/9)+32}},imperial:{unit:"F",transform:function(o){return(o-32)*(5/9)}}}},la,Tt=365.25;la={ns:{name:{singular:"Nanosecond",plural:"Nanoseconds"},to_anchor:1/1e9},mu:{name:{singular:"Microsecond",plural:"Microseconds"},to_anchor:1/1e6},ms:{name:{singular:"Millisecond",plural:"Milliseconds"},to_anchor:1/1e3},s:{name:{singular:"Second",plural:"Seconds"},to_anchor:1},min:{name:{singular:"Minute",plural:"Minutes"},to_anchor:60},h:{name:{singular:"Hour",plural:"Hours"},to_anchor:60*60},d:{name:{singular:"Day",plural:"Days"},to_anchor:60*60*24},week:{name:{singular:"Week",plural:"Weeks"},to_anchor:60*60*24*7},month:{name:{singular:"Month",plural:"Months"},to_anchor:60*60*24*Tt/12},year:{name:{singular:"Year",plural:"Years"},to_anchor:60*60*24*Tt}};var qo={metric:la,_anchors:{metric:{unit:"s",ratio:1}}},ia,da;ia={b:{name:{singular:"Bit",plural:"Bits"},to_anchor:1},Kb:{name:{singular:"Kilobit",plural:"Kilobits"},to_anchor:1024},Mb:{name:{singular:"Megabit",plural:"Megabits"},to_anchor:1048576},Gb:{name:{singular:"Gigabit",plural:"Gigabits"},to_anchor:1073741824},Tb:{name:{singular:"Terabit",plural:"Terabits"},to_anchor:1099511627776}};da={B:{name:{singular:"Byte",plural:"Bytes"},to_anchor:1},KB:{name:{singular:"Kilobyte",plural:"Kilobytes"},to_anchor:1024},MB:{name:{singular:"Megabyte",plural:"Megabytes"},to_anchor:1048576},GB:{name:{singular:"Gigabyte",plural:"Gigabytes"},to_anchor:1073741824},TB:{name:{singular:"Terabyte",plural:"Terabytes"},to_anchor:1099511627776}};var Eo={bits:ia,bytes:da,_anchors:{bits:{unit:"b",ratio:1/8},bytes:{unit:"B",ratio:8}}},ca;ca={ppm:{name:{singular:"Part-per Million",plural:"Parts-per Million"},to_anchor:1},ppb:{name:{singular:"Part-per Billion",plural:"Parts-per Billion"},to_anchor:.001},ppt:{name:{singular:"Part-per Trillion",plural:"Parts-per Trillion"},to_anchor:1e-6},ppq:{name:{singular:"Part-per Quadrillion",plural:"Parts-per Quadrillion"},to_anchor:1e-9}};var Go={metric:ca,imperial:{},_anchors:{metric:{unit:"ppm",ratio:1e-6}}},ua,pa;ua={"m/s":{name:{singular:"Metre per second",plural:"Metres per second"},to_anchor:3.6},"km/h":{name:{singular:"Kilometre per hour",plural:"Kilometres per hour"},to_anchor:1}};pa={"m/h":{name:{singular:"Mile per hour",plural:"Miles per hour"},to_anchor:1},knot:{name:{singular:"Knot",plural:"Knots"},to_anchor:1.150779},"ft/s":{name:{singular:"Foot per second",plural:"Feet per second"},to_anchor:.681818}};var Yo={metric:ua,imperial:pa,_anchors:{metric:{unit:"km/h",ratio:1/1.609344},imperial:{unit:"m/h",ratio:1.609344}}},ma,ha;ma={"min/km":{name:{singular:"Minute per kilometre",plural:"Minutes per kilometre"},to_anchor:.06},"s/m":{name:{singular:"Second per metre",plural:"Seconds per metre"},to_anchor:1}};ha={"min/mi":{name:{singular:"Minute per mile",plural:"Minutes per mile"},to_anchor:.0113636},"s/ft":{name:{singular:"Second per foot",plural:"Seconds per foot"},to_anchor:1}};var Vo={metric:ma,imperial:ha,_anchors:{metric:{unit:"s/m",ratio:.3048},imperial:{unit:"s/ft",ratio:1/.3048}}},ga,ba;ga={Pa:{name:{singular:"pascal",plural:"pascals"},to_anchor:1/1e3},kPa:{name:{singular:"kilopascal",plural:"kilopascals"},to_anchor:1},MPa:{name:{singular:"megapascal",plural:"megapascals"},to_anchor:1e3},hPa:{name:{singular:"hectopascal",plural:"hectopascals"},to_anchor:1/10},bar:{name:{singular:"bar",plural:"bar"},to_anchor:100},torr:{name:{singular:"torr",plural:"torr"},to_anchor:101325/76e4}};ba={psi:{name:{singular:"pound per square inch",plural:"pounds per square inch"},to_anchor:1/1e3},ksi:{name:{singular:"kilopound per square inch",plural:"kilopound per square inch"},to_anchor:1}};var $o={metric:ga,imperial:ba,_anchors:{metric:{unit:"kPa",ratio:.00014503768078},imperial:{unit:"psi",ratio:1/.00014503768078}}},fa;fa={A:{name:{singular:"Ampere",plural:"Amperes"},to_anchor:1},mA:{name:{singular:"Milliampere",plural:"Milliamperes"},to_anchor:.001},kA:{name:{singular:"Kiloampere",plural:"Kiloamperes"},to_anchor:1e3}};var Ko={metric:fa,_anchors:{metric:{unit:"A",ratio:1}}},Ia;Ia={V:{name:{singular:"Volt",plural:"Volts"},to_anchor:1},mV:{name:{singular:"Millivolt",plural:"Millivolts"},to_anchor:.001},kV:{name:{singular:"Kilovolt",plural:"Kilovolts"},to_anchor:1e3}};var Xo={metric:Ia,_anchors:{metric:{unit:"V",ratio:1}}},xa;xa={W:{name:{singular:"Watt",plural:"Watts"},to_anchor:1},mW:{name:{singular:"Milliwatt",plural:"Milliwatts"},to_anchor:.001},kW:{name:{singular:"Kilowatt",plural:"Kilowatts"},to_anchor:1e3},MW:{name:{singular:"Megawatt",plural:"Megawatts"},to_anchor:1e6},GW:{name:{singular:"Gigawatt",plural:"Gigawatts"},to_anchor:1e9}};var Do={metric:xa,_anchors:{metric:{unit:"W",ratio:1}}},va;va={VAR:{name:{singular:"Volt-Ampere Reactive",plural:"Volt-Amperes Reactive"},to_anchor:1},mVAR:{name:{singular:"Millivolt-Ampere Reactive",plural:"Millivolt-Amperes Reactive"},to_anchor:.001},kVAR:{name:{singular:"Kilovolt-Ampere Reactive",plural:"Kilovolt-Amperes Reactive"},to_anchor:1e3},MVAR:{name:{singular:"Megavolt-Ampere Reactive",plural:"Megavolt-Amperes Reactive"},to_anchor:1e6},GVAR:{name:{singular:"Gigavolt-Ampere Reactive",plural:"Gigavolt-Amperes Reactive"},to_anchor:1e9}};var Jo={metric:va,_anchors:{metric:{unit:"VAR",ratio:1}}},ya;ya={VA:{name:{singular:"Volt-Ampere",plural:"Volt-Amperes"},to_anchor:1},mVA:{name:{singular:"Millivolt-Ampere",plural:"Millivolt-Amperes"},to_anchor:.001},kVA:{name:{singular:"Kilovolt-Ampere",plural:"Kilovolt-Amperes"},to_anchor:1e3},MVA:{name:{singular:"Megavolt-Ampere",plural:"Megavolt-Amperes"},to_anchor:1e6},GVA:{name:{singular:"Gigavolt-Ampere",plural:"Gigavolt-Amperes"},to_anchor:1e9}};var Zo={metric:ya,_anchors:{metric:{unit:"VA",ratio:1}}},Ca;Ca={Wh:{name:{singular:"Watt-hour",plural:"Watt-hours"},to_anchor:3600},mWh:{name:{singular:"Milliwatt-hour",plural:"Milliwatt-hours"},to_anchor:3.6},kWh:{name:{singular:"Kilowatt-hour",plural:"Kilowatt-hours"},to_anchor:36e5},MWh:{name:{singular:"Megawatt-hour",plural:"Megawatt-hours"},to_anchor:36e8},GWh:{name:{singular:"Gigawatt-hour",plural:"Gigawatt-hours"},to_anchor:36e11},J:{name:{singular:"Joule",plural:"Joules"},to_anchor:1},kJ:{name:{singular:"Kilojoule",plural:"Kilojoules"},to_anchor:1e3}};var en={metric:Ca,_anchors:{metric:{unit:"J",ratio:1}}},Ma;Ma={VARh:{name:{singular:"Volt-Ampere Reactive Hour",plural:"Volt-Amperes Reactive Hour"},to_anchor:1},mVARh:{name:{singular:"Millivolt-Ampere Reactive Hour",plural:"Millivolt-Amperes Reactive Hour"},to_anchor:.001},kVARh:{name:{singular:"Kilovolt-Ampere Reactive Hour",plural:"Kilovolt-Amperes Reactive Hour"},to_anchor:1e3},MVARh:{name:{singular:"Megavolt-Ampere Reactive Hour",plural:"Megavolt-Amperes Reactive Hour"},to_anchor:1e6},GVARh:{name:{singular:"Gigavolt-Ampere Reactive Hour",plural:"Gigavolt-Amperes Reactive Hour"},to_anchor:1e9}};var tn={metric:Ma,_anchors:{metric:{unit:"VARh",ratio:1}}},Pa,Sa;Pa={"mm3/s":{name:{singular:"Cubic Millimeter per second",plural:"Cubic Millimeters per second"},to_anchor:1/1e6},"cm3/s":{name:{singular:"Cubic Centimeter per second",plural:"Cubic Centimeters per second"},to_anchor:1/1e3},"ml/s":{name:{singular:"Millilitre per second",plural:"Millilitres per second"},to_anchor:1/1e3},"cl/s":{name:{singular:"Centilitre per second",plural:"Centilitres per second"},to_anchor:1/100},"dl/s":{name:{singular:"Decilitre per second",plural:"Decilitres per second"},to_anchor:1/10},"l/s":{name:{singular:"Litre per second",plural:"Litres per second"},to_anchor:1},"l/min":{name:{singular:"Litre per minute",plural:"Litres per minute"},to_anchor:1/60},"l/h":{name:{singular:"Litre per hour",plural:"Litres per hour"},to_anchor:1/3600},"kl/s":{name:{singular:"Kilolitre per second",plural:"Kilolitres per second"},to_anchor:1e3},"kl/min":{name:{singular:"Kilolitre per minute",plural:"Kilolitres per minute"},to_anchor:50/3},"kl/h":{name:{singular:"Kilolitre per hour",plural:"Kilolitres per hour"},to_anchor:5/18},"m3/s":{name:{singular:"Cubic meter per second",plural:"Cubic meters per second"},to_anchor:1e3},"m3/min":{name:{singular:"Cubic meter per minute",plural:"Cubic meters per minute"},to_anchor:50/3},"m3/h":{name:{singular:"Cubic meter per hour",plural:"Cubic meters per hour"},to_anchor:5/18},"km3/s":{name:{singular:"Cubic kilometer per second",plural:"Cubic kilometers per second"},to_anchor:1e12}};Sa={"tsp/s":{name:{singular:"Teaspoon per second",plural:"Teaspoons per second"},to_anchor:1/6},"Tbs/s":{name:{singular:"Tablespoon per second",plural:"Tablespoons per second"},to_anchor:1/2},"in3/s":{name:{singular:"Cubic inch per second",plural:"Cubic inches per second"},to_anchor:.55411},"in3/min":{name:{singular:"Cubic inch per minute",plural:"Cubic inches per minute"},to_anchor:.55411/60},"in3/h":{name:{singular:"Cubic inch per hour",plural:"Cubic inches per hour"},to_anchor:.55411/3600},"fl-oz/s":{name:{singular:"Fluid Ounce per second",plural:"Fluid Ounces per second"},to_anchor:1},"fl-oz/min":{name:{singular:"Fluid Ounce per minute",plural:"Fluid Ounces per minute"},to_anchor:1/60},"fl-oz/h":{name:{singular:"Fluid Ounce per hour",plural:"Fluid Ounces per hour"},to_anchor:1/3600},"cup/s":{name:{singular:"Cup per second",plural:"Cups per second"},to_anchor:8},"pnt/s":{name:{singular:"Pint per second",plural:"Pints per second"},to_anchor:16},"pnt/min":{name:{singular:"Pint per minute",plural:"Pints per minute"},to_anchor:4/15},"pnt/h":{name:{singular:"Pint per hour",plural:"Pints per hour"},to_anchor:1/225},"qt/s":{name:{singular:"Quart per second",plural:"Quarts per second"},to_anchor:32},"gal/s":{name:{singular:"Gallon per second",plural:"Gallons per second"},to_anchor:128},"gal/min":{name:{singular:"Gallon per minute",plural:"Gallons per minute"},to_anchor:32/15},"gal/h":{name:{singular:"Gallon per hour",plural:"Gallons per hour"},to_anchor:8/225},"ft3/s":{name:{singular:"Cubic foot per second",plural:"Cubic feet per second"},to_anchor:957.506},"ft3/min":{name:{singular:"Cubic foot per minute",plural:"Cubic feet per minute"},to_anchor:957.506/60},"ft3/h":{name:{singular:"Cubic foot per hour",plural:"Cubic feet per hour"},to_anchor:957.506/3600},"yd3/s":{name:{singular:"Cubic yard per second",plural:"Cubic yards per second"},to_anchor:25852.7},"yd3/min":{name:{singular:"Cubic yard per minute",plural:"Cubic yards per minute"},to_anchor:25852.7/60},"yd3/h":{name:{singular:"Cubic yard per hour",plural:"Cubic yards per hour"},to_anchor:25852.7/3600}};var an={metric:Pa,imperial:Sa,_anchors:{metric:{unit:"l/s",ratio:33.8140227},imperial:{unit:"fl-oz/s",ratio:1/33.8140227}}},ja,ka;ja={lx:{name:{singular:"Lux",plural:"Lux"},to_anchor:1}};ka={"ft-cd":{name:{singular:"Foot-candle",plural:"Foot-candles"},to_anchor:1}};var rn={metric:ja,imperial:ka,_anchors:{metric:{unit:"lx",ratio:1/10.76391},imperial:{unit:"ft-cd",ratio:10.76391}}},Oa;Oa={mHz:{name:{singular:"millihertz",plural:"millihertz"},to_anchor:1/1e3},Hz:{name:{singular:"hertz",plural:"hertz"},to_anchor:1},kHz:{name:{singular:"kilohertz",plural:"kilohertz"},to_anchor:1e3},MHz:{name:{singular:"megahertz",plural:"megahertz"},to_anchor:1e3*1e3},GHz:{name:{singular:"gigahertz",plural:"gigahertz"},to_anchor:1e3*1e3*1e3},THz:{name:{singular:"terahertz",plural:"terahertz"},to_anchor:1e3*1e3*1e3*1e3},rpm:{name:{singular:"rotation per minute",plural:"rotations per minute"},to_anchor:1/60},"deg/s":{name:{singular:"degree per second",plural:"degrees per second"},to_anchor:1/360},"rad/s":{name:{singular:"radian per second",plural:"radians per second"},to_anchor:1/(Math.PI*2)}};var on={metric:Oa,_anchors:{frequency:{unit:"hz",ratio:1}}},Aa;Aa={rad:{name:{singular:"radian",plural:"radians"},to_anchor:180/Math.PI},deg:{name:{singular:"degree",plural:"degrees"},to_anchor:1},grad:{name:{singular:"gradian",plural:"gradians"},to_anchor:9/10},arcmin:{name:{singular:"arcminute",plural:"arcminutes"},to_anchor:1/60},arcsec:{name:{singular:"arcsecond",plural:"arcseconds"},to_anchor:1/3600}};var nn={metric:Aa,_anchors:{metric:{unit:"deg",ratio:1}}},Na,Ke=Ht,Te=Ro,He={length:zo,area:Qo,mass:Wo,volume:_o,each:Uo,temperature:Ho,time:qo,digital:Eo,partsPer:Go,speed:Yo,pace:Vo,pressure:$o,current:Ko,voltage:Xo,power:Do,reactivePower:Jo,apparentPower:Zo,energy:en,reactiveEnergy:tn,volumeFlowRate:an,illuminance:rn,frequency:on,angle:nn},Be;Be=function(o,i){i?this.val=o/i:this.val=o};Be.prototype.from=function(o){if(this.destination)throw new Error(".from must be called before .to");return this.origin=this.getUnit(o),this.origin||this.throwUnsupportedUnitError(o),this};Be.prototype.to=function(o){if(!this.origin)throw new Error(".to must be called after .from");this.destination=this.getUnit(o);var i,C;if(this.destination||this.throwUnsupportedUnitError(o),this.origin.abbr===this.destination.abbr)return this.val;if(this.destination.measure!=this.origin.measure)throw new Error("Cannot convert incompatible measures of "+this.destination.measure+" and "+this.origin.measure);return i=this.val*this.origin.unit.to_anchor,this.origin.unit.anchor_shift&&(i-=this.origin.unit.anchor_shift),this.origin.system!=this.destination.system&&(C=He[this.origin.measure]._anchors[this.origin.system].transform,typeof C=="function"?i=C(i):i*=He[this.origin.measure]._anchors[this.origin.system].ratio),this.destination.unit.anchor_shift&&(i+=this.destination.unit.anchor_shift),i/this.destination.unit.to_anchor};Be.prototype.toBest=function(i){if(!this.origin)throw new Error(".toBest must be called after .from");var i=Object.assign({exclude:[],cutOffNumber:1},i),C;return Te(this.possibilities(),(function(j){var b=this.describe(j),t=i.exclude.indexOf(j)===-1;if(t&&b.system===this.origin.system){var I=this.to(j);(!C||I>=i.cutOffNumber&&I<C.val)&&(C={val:I,unit:j,singular:b.singular,plural:b.plural})}}).bind(this)),C};Be.prototype.getUnit=function(o){var i;return Te(He,function(C,j){if(Te(C,function(b,t){if(t=="_anchors"||(Te(b,function(I,n){if(n==o)return i={abbr:o,measure:j,system:t,unit:I},!1}),i))return!1}),i)return!1}),i};var wa=function(o){return{abbr:o.abbr,measure:o.measure,system:o.system,singular:o.unit.name.singular,plural:o.unit.name.plural}};Be.prototype.describe=function(o){var i=Be.prototype.getUnit(o),C=null;try{C=wa(i)}catch{this.throwUnsupportedUnitError(o)}return C};Be.prototype.list=function(o){var i=[];return Te(He,function(C,j){o&&o!==j||Te(C,function(b,t){if(t=="_anchors")return!1;Te(b,function(I,n){i=i.concat(wa({abbr:n,measure:j,system:t,unit:I}))})})}),i};Be.prototype.throwUnsupportedUnitError=function(o){var i=[];throw Te(He,function(C,j){Te(C,function(b,t){if(t=="_anchors")return!1;i=i.concat(Ke(b))})}),new Error("Unsupported unit "+o+", use one of: "+i.join(", "))};Be.prototype.possibilities=function(o){var i=[];return!this.origin&&!o?Te(Ke(He),function(C){Te(He[C],function(j,b){if(b=="_anchors")return!1;i=i.concat(Ke(j))})}):(o=o||this.origin.measure,Te(He[o],function(C,j){if(j=="_anchors")return!1;i=i.concat(Ke(C))})),i};Be.prototype.measures=function(){return Ke(He)};Na=function(o){return new Be(o)};var sn=Na;const De=Da(sn),Je=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services","Summary"];function vn(){const[o,i]=r.useState(0),[C,j]=r.useState(new Set),[b,t]=r.useState(null),[I,n]=r.useState(null),[f,l]=r.useState([]),{enqueueSnackbar:P}=We(),{data:W,refetch:g}=_e(),[S,p]=r.useState({}),[T,m]=r.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),[O,ee]=r.useState({fromUnit:"m",toUnit:"cm",inputValue:"",outputValue:""}),X=N=>{t(N.currentTarget)},G=N=>{n(N.currentTarget)},z=()=>{t(null),n(null),ee({fromUnit:"m",toUnit:"cm",inputValue:"",outputValue:""})},Y=N=>N===1,re=N=>C.has(N),B=()=>{let N=C;re(o)&&(N=new Set(N.values()),N.delete(o)),i(Z=>Z+1),j(N)},x=()=>{i(N=>N-1)},H=()=>{if(!Y(o))throw new Error("You can't skip a step that isn't optional.");i(N=>N+1),j(N=>{const Z=new Set(N.values());return Z.add(o),Z})},te=()=>{i(0)};r.useEffect(()=>{(async()=>{try{const Z=await Me.get("http://100.42.177.77:83/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",Z),l(Z.data.result)}catch(Z){console.error("Error fetching design options:",Z)}})()},[]);const pe=async()=>{if(!T.lookUpDomain||!T.lookUpName){P("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const N=await Me.get(`http://100.42.177.77:83/api/Common/SaveLookUp?lookupDomain=${T.lookUpDomain}&LookUpName=${T.lookUpName}&appId=1`);return P("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),m({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),g(),N.data}catch(N){throw P("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),N}},h=N=>{m({...T,[N.target.name]:N.target.value})},_=N=>{const{name:Z,value:k}=N.target;ee(q=>{const F={...q,[Z]:k};return(Z==="inputValue"?"L2R":"R2L")==="L2R"?F.outputValue=De(k).from(F.fromUnit).to(F.toUnit):F.inputValue=De(k).from(F.toUnit).to(F.fromUnit),F})};r.useEffect(()=>{(async()=>{try{const Z=await Me.get("http://100.42.177.77:83/api/Common/GetLookUpDomains?appId=1");l(Z.data.result)}catch(Z){console.error("Error fetching design options:",Z)}})()},[]);const E=!!b,ae=!!I,be=E?"simple-popover":void 0,se=ae?"convert-popover":void 0;return e.jsxs(Re,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(ve,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(ge,{"aria-describedby":be,variant:"outlined",size:"small",onClick:X,sx:{marginRight:"8px"},children:"+Lookup"}),e.jsx(ge,{"aria-describedby":se,variant:"outlined",size:"small",onClick:G,children:"Convertor"}),e.jsx(Pt,{id:se,open:ae,anchorEl:I,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(c,{fullWidth:!0,select:!0,label:"From",size:"small",name:"fromUnit",value:O.fromUnit,onChange:_,children:De().possibilities("length").map(N=>e.jsx(Q,{value:N,children:N},N))})}),e.jsx(a,{item:!0,sm:6,children:e.jsx(c,{fullWidth:!0,select:!0,label:"To",size:"small",name:"toUnit",value:O.toUnit,onChange:_,children:De().possibilities("length").map(N=>e.jsx(Q,{value:N,children:N},N))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,label:O.fromUnit,size:"small",name:"inputValue",value:O.inputValue,onChange:_,type:"number"})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,label:O.toUnit,size:"small",name:"outputValue",value:O.outputValue,onChange:_,type:"number"})})]})}),e.jsx(Pt,{id:"mouse-over-popover",open:E,anchorEl:b,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Lookup",size:"small",value:T.lookUpDomain,name:"lookUpDomain",onChange:h,children:f.map(N=>e.jsx(Q,{value:N.lookUpDomain,children:N.lookUpDomain},N.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,label:"Add Lookup Description",value:T.lookUpName,onChange:h,name:"lookUpName",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(ge,{variant:"contained",size:"small",onClick:pe,children:"Save"})})]})})]})]}),e.jsx(Ja,{activeStep:o,children:Je.map((N,Z)=>{const k={},q={};return Y(Z)&&(q.optional=e.jsx(ve,{variant:"caption"})),re(Z)&&(k.completed=!1),e.jsx(Za,{...k,children:e.jsxs(er,{...q,onClick:()=>i(Z),style:{cursor:"pointer"},children:[" ",N]})},N)})}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ge,{color:"inherit",disabled:o===0,onClick:x,sx:{mr:1},children:"Back"}),e.jsx(Re,{sx:{flex:"1 1 auto"}}),Y(o)&&e.jsx(ge,{color:"inherit",onClick:H,sx:{mr:1},children:"Skip"}),e.jsx(ge,{onClick:B,children:o===Je.length-1?"Finish":"Next"})]}),o===Je.length?e.jsxs(r.Fragment,{children:[e.jsx(jt,{setActiveStep:i}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Re,{sx:{flex:"1 1 auto"}}),e.jsx(ge,{onClick:te,children:"Reset"})]})]}):e.jsxs(r.Fragment,{children:[o===0&&e.jsx(hr,{setInitialValues:p,initialValues:S}),o===1&&e.jsx(tr,{setInitialValues:p,initialValues:S}),o===2&&e.jsx(fr,{initialValues:S}),o===3&&e.jsx(pr,{initialValues:S}),o===4&&e.jsx(xr,{initialValues:S}),o===5&&e.jsx(Cr,{initialValues:S}),o===6&&e.jsx(Mr,{initialValues:S}),o===7&&e.jsx(jt,{setActiveStep:i,setInitialValues:p,initialValues:S}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ge,{color:"inherit",disabled:o===0,onClick:x,sx:{mr:1},children:"Back"}),e.jsx(Re,{sx:{flex:"1 1 auto"}}),Y(o)&&e.jsx(ge,{color:"inherit",onClick:H,sx:{mr:1},children:"Skip"}),e.jsx(ge,{onClick:B,children:o===Je.length-1?"Finish":"Next"})]})]})]})}export{vn as default};
