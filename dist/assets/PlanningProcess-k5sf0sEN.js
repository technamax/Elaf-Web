import{j as e,_ as vt,r as Mt,k as Pt,u as Fe,c as Qe,b as Re,a5 as St,B as Ae,G as o,T as be,D as de,S as $e,a6 as jt,a7 as Ye,a8 as Xe,a9 as _e,aa as De,ab as et,ac as kt,ad as tt,C as xe,d as ye,ae as Ke,e as qe,af as Ot,ag as At,ah as Nt,ai as Lt,aj as wt,ak as Tt,al as Bt,am as Ft,an as Qt,M as Rt}from"./index-CwCCKSJg.js";import{r as a}from"./vendor-BXCbSo2_.js";import{B as ge,a as ve,I as Be}from"./axios-CS8VLUs2.js";import{d as pt,c as Ze,A as mt,e as ht,f as gt,S as Wt,a as zt,b as Ut,F as Ht}from"./Fabrication-B57LM7l1.js";import{d as Ee}from"./VisibilityOutlined-gJaDEU8e.js";import{A as Je,R as Ue,F as bt,C as It,D as ot,a as at,b as nt,c as rt,B as ft,e as qt,f as dt,g as Ge}from"./ReuseableDataGrid-kxcfk9Og.js";import{d as st,a as lt}from"./PersonAddAlt1Outlined-Bca7zf0t.js";import{T as i,P as Et}from"./TextField-DEuSgGb8.js";import{M as B}from"./Skeleton-B9UzLEaK.js";import"./dayjs.min-DO4_1a-m.js";let ct=!1;const Gt=a.forwardRef(function(S,D){return ct||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),ct=!0),e.jsx(Je,vt({ref:D},S))});var it={},Yt=Pt;Object.defineProperty(it,"__esModule",{value:!0});var xt=it.default=void 0,Xt=Yt(Mt()),_t=e;xt=it.default=(0,Xt.default)((0,_t.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const Vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",Jt=({initialFormData:h,setAdditionalProcessData:S,refetchDyeingPrintingData:D,handleClickOpen:ne,showUpperDiv:y})=>{const{user:t}=Fe(),[C,l]=a.useState([]),[g,r]=a.useState([]),{enqueueSnackbar:x}=Qe(),[q,u]=a.useState({}),M=C.reduce((f,W)=>f+(W.assignedQty??0),0).toFixed(2);console.log("Quantity",M);const[c,Y]=a.useState({dpIdDet:0,dpId:h.dpId||0,designId:h.designId||"",batchNo:h.batchNo||"",planningHeaderId:h.planningHeaderId||0,fabricId:h.fabricId||"",fabricName:h.fabricName||"",colorId:h.colorId||"",colorName:h.colorName||"",uomId:h.uomId||"",uom:h.uom||"",poPcs:h.poPcs||"",vendorId:"",processType:h.processType||"",availableQty:h.availableQty||"",remainingQty:h.availableQty-M||"",shrinkage:h.allowedWastage||"",wastage:h.allowedWastage||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});a.useEffect(()=>{Y(f=>({...c,dpIdDet:g.dpIdDet||0,dpId:g.dpId||0,designId:(g==null?void 0:g.designId)||"",planningHeaderId:(g==null?void 0:g.planningHeaderId)||0,batchNo:(g==null?void 0:g.batchNo)||"",vendorId:(g==null?void 0:g.vendorId)||"",shrinkage:(g==null?void 0:g.shrinkage)||"",wastage:(g==null?void 0:g.wastage)||"",outputQty:(g==null?void 0:g.outputQty)||0,remainingQty:f.remainingQty+(g==null?void 0:g.assignedQty)||"",assignedQty:(g==null?void 0:g.assignedQty)||"",rate:(g==null?void 0:g.rate)||0,unitRatePerPo:(g==null?void 0:g.unitRatePerPo)||"",totalExcGst:(g==null?void 0:g.totalExcGst)||"",gst:(g==null?void 0:g.gst)||0,TotalIncludingGst:(g==null?void 0:g.totalIncludingGst)||"",createdOn:(g==null?void 0:g.createdOn)||new Date().toISOString(),createdBy:(g==null?void 0:g.createdBy)||t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId}))},[g]),a.useEffect(()=>{Y({...c,remainingQty:h.availableQty-M>=0?h.availableQty-M:""})},[C,h.availableQty,M]);const{data:p}=Re(),{data:P,refetch:K}=St(c.dpId,{skip:!c.dpId}),[_,z]=a.useState([]);a.useEffect(()=>{if(p){const f=p.result[0];z(f.vendorList)}},[p]),a.useEffect(()=>{P&&l(P.result.map((f,W)=>({id:W+1,...f})))},[P,K]),console.log("initialRows",C);const R=f=>{const{name:W,value:O}=f.target;Y({...c,[W]:O}),Y(Z=>{const m={...Z,[W]:O};if(W==="assignedQty"||W==="remainingQty"){const U=m.assignedQty,E=m.remainingQty;U>E?u(te=>({...te,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):u(te=>({...te,assignedQty:""}))}return m})};a.useEffect(()=>{const f=()=>{const ce=parseFloat(c.assignedQty)||0,he=parseFloat(c.shrinkage)||0,Ce=parseFloat(c.wastage)||0,v=he+Ce;return(ce*100/(100+v)).toFixed(2)},W=()=>{const ce=parseFloat(c.assignedQty)||0,he=parseFloat(c.rate)||0;return(ce*he).toFixed(2)},O=(ce,he)=>(ce*(1+he/100)).toFixed(2),Z=f(),m=W(),U=parseFloat(c.gst)||0,E=O(m,U),te=parseFloat(c.poPcs)||0,me=te?E/te:0;Y(ce=>({...ce,outputQty:Z,totalExcGst:m,TotalIncludingGst:E,unitRatePerPo:me.toFixed(2)}))},[c.availableQty,c.assignedQty,c.shrinkage,c.wastage,c.rate,c.gst,c.poPcs,c.unitRatePerPo]),console.log("formData",c);const X=async()=>{console.log(c);try{if(c.assignedQty>c.remainingQty){x("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}const f=await ve.post("http://100.42.177.77:81/api/DyeingPrinting/SaveDyeingPrintingDetails",c);console.log("Save response:",f.data),Y(W=>({...W,dpIdDet:0,vendorId:"",availableQty:h.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",remainingQty:h.availableQty-M||"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),K(),D()}catch(f){console.error("Error saving data:",f)}},$=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:f=>f.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:f=>f.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:f=>f.toLocaleString()},{field:"outputQty",headerName:"Output Qty",flex:1}];return e.jsxs(Ae,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!y,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"Fabric",name:"fabricName",value:c.fabricName,onChange:R,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Process Type",name:"processType",value:c.processType,onChange:R,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"Color",name:"colorName",value:c.colorName,onChange:R,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"UOM",name:"uom",value:c.uom,onChange:R,size:"small",disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:c.poPcs,onChange:R,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:c.availableQty,onChange:R,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:c.remainingQty,onChange:R,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:c.vendorId,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}},children:_.map(f=>e.jsx(B,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:c.assignedQty,onChange:R,disabled:!c.remainingQty,error:!!q.assignedQty,helperText:q.assignedQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:c.rate,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:c.shrinkage,onChange:R,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:c.wastage,onChange:R,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:c.outputQty,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:c.totalExcGst,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:c.gst,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:c.TotalIncludingGst,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:c.unitRatePerPo,onChange:R,disabled:!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:X,children:"Save"})})]})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:$,initialRows:C,setInitialData:r,deleteApi:"http://100.42.177.77:81/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:K})})]})]})},Zt=({initialFormData:h,setAdditionalProcessData:S,refetchDyeingPrintingData:D,handleClickOpen:ne,showUpperDiv:y})=>{const t=$e(),{enqueueSnackbar:C}=Qe(),[l,g]=a.useState({}),{user:r}=Fe(),[x,q]=a.useState([]),[u,M]=a.useState([]),c=x.reduce((v,H)=>v+(H.assignedQty??0),0).toFixed(2);console.log("Quantity",c);const Y=x.reduce((v,H)=>v+(H.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",Y);const[p,P]=a.useState({embroideryIdDet:0,embroideryId:h.embroideryId||0,designId:h.designId||"",batchNo:h.batchNo||"",planningHeaderId:h.planningHeaderId||0,componentId:h.componentId||"",componentName:h.componentName||"",fabricId:h.fabricId||"",fabricName:h.fabricName||"",vendorId:"",colorId:h.colorId||"",colourName:h.colourName||"",availableQty:h.availableQty||"",assignedQty:0,remainingQty:(h.availableQty-c).toFixed(2)||0,remainingRepeats:h.repeats-Y||"",noOfHead:h.noOfHead||"",noOfHeadsName:h.noOfHeadsName||"",repeats:h.repeats||"",assignedRepeats:"",cuttingSize:h.cuttingSize||"",itemsPerRepeat:h.itemsPerRepeat||"",poPcs:h.poPcs||"",totalPcs:h.totalPcs||"",remainingPcs:(h.totalPcs-Y).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:r.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:r.empId});a.useEffect(()=>{P(v=>({...p,embroideryIdDet:u.embroideryIdDet||0,embroideryId:u.embroideryId||0,vendorId:(u==null?void 0:u.vendorId)||"",assignedQty:(u==null?void 0:u.assignedQty)||0,requiredPcs:(u==null?void 0:u.requiredPcs)||0,remainingQty:v.remainingQty+(u==null?void 0:u.assignedQty)||0,remainingPcs:v.remainingPcs+(u==null?void 0:u.requiredPcs)||0,totalAmount:(u==null?void 0:u.totalAmount)||0,threadStiches:(u==null?void 0:u.threadStiches)||0,threadRate:(u==null?void 0:u.threadRate)||0,threadAmount:(u==null?void 0:u.threadAmount)||0,tillaStiches:(u==null?void 0:u.tillaStiches)||0,tilaRate:(u==null?void 0:u.tilaRate)||0,tilaAmount:(u==null?void 0:u.tilaAmount)||0,sequence:(u==null?void 0:u.sequence)||0,sequenceRate:(u==null?void 0:u.sequenceRate)||0,sequenceAmount:(u==null?void 0:u.sequenceAmount)||0,isSolving:(u==null?void 0:u.isSolving)||!1,solvingLayers:(u==null?void 0:u.solvingLayers)||0,solvingInMeters:(u==null?void 0:u.solvingInMeters)||0,solvingRate:(u==null?void 0:u.solvingRate)||0,solvingAmount:(u==null?void 0:u.solvingAmount)||0,additional:(u==null?void 0:u.additional)||0,costPerComponent:(u==null?void 0:u.costPerComponent)||0,createdOn:(u==null?void 0:u.createdOn)||new Date().toISOString(),createdBy:(u==null?void 0:u.createdBy)||r.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:r.empId}))},[u]);const K=["Boring","Pooni","Laser","Doori","Dissolving"];function _(v,H,T){return{fontWeight:H.indexOf(v)===-1?T.typography.fontWeightRegular:T.typography.fontWeightMedium}}a.useEffect(()=>{P({...p,remainingQty:(h.availableQty-c).toFixed(2)||0,remainingPcs:h.totalPcs-Y||0})},[x]);const{data:z}=Re(),{data:R,refetch:X}=jt(p.embroideryId,{skip:!p.embroideryId}),[$,w]=a.useState([]);a.useEffect(()=>{if(z){const v=z.result[0];w(v.vendorList)}},[z]),a.useEffect(()=>{R&&q(R.result.map((v,H)=>({id:H+1,...v})))},[R,X]),console.log("initialRows",x);const f=v=>{const{name:H,value:T}=v.target;P({...p,[H]:T})},W=v=>{const{name:H,checked:T}=v.target;P(V=>({...V,[H]:T}))};console.log("formData",p);const[O,Z]=a.useState(null),[m,U]=a.useState(p);a.useEffect(()=>{const v=setTimeout(()=>{U(p)},10);return()=>{clearTimeout(v)}},[p]);const E=v=>new Intl.NumberFormat("en-US").format(v);a.useEffect(()=>{const v=()=>{const L=parseFloat(m.repeats)||0,A=parseFloat(m.itemsPerRepeat)||0;return(L*A).toFixed(2)},H=()=>{const L=parseFloat(m.threadStiches)||0,A=parseFloat(m.threadRate)||0,le=parseFloat(m.noOfHeadsName)||0,Ie=parseFloat(m.repeats)||0;return(L/1e3*(A*Ie*le)).toFixed(2)},T=()=>{const L=parseFloat(m.tillaStiches)||0,A=parseFloat(m.tilaRate)||0,le=parseFloat(m.noOfHeadsName)||0,Ie=parseFloat(m.repeats)||0;return(L/1e3*(A*Ie*le)).toFixed(2)},V=()=>{const L=parseFloat(m.sequence)||0,A=parseFloat(m.sequenceRate)||0,le=parseFloat(m.noOfHeadsName)||0,Ie=parseFloat(m.repeats)||0;return(L/1e3*(A*Ie*le)).toFixed(2)},re=()=>{const L=parseFloat(m.repeats)||0,A=parseFloat(m.noOfHeadsName)||0,le=parseFloat(m.solvingLayers)||0;return(L*A*13/39.37*le).toFixed(2)},oe=()=>{const L=parseFloat(m.solvingInMeters)||0,A=parseFloat(m.solvingRate)||0;return(L*A).toFixed(2)},ue=()=>{const L=parseFloat(m.threadAmount)||0,A=parseFloat(m.tilaAmount)||0,le=parseFloat(m.sequenceAmount)||0,Ie=parseFloat(m.solvingAmount)||0;return(L+A+le+Ie).toFixed(2)},J=()=>{const L=parseFloat(String(m.totalAmount).replace(/,/g,""))||0,A=parseFloat(m.requiredPcs)||0;return(L/A).toFixed(2)},j=ue(),F=J();H(),P(L=>({...L,totalPcs:v(),threadAmount:H(),tilaAmount:T(),sequenceAmount:V(),solvingInMeters:re(),solvingAmount:oe(),totalAmount:E(j),costPerComponent:E(F)}))},[m.threadAmount,m.totalAmount,m.sequenceAmount,m.solvingAmount,m.repeats,m.tilaAmount,m.itemsPerRepeat,m.threadRate,m.threadStiches,m.noOfHeadsName,m.tilaRate,m.tillaStiches,m.sequenceRate,m.sequence,m.solvingLayers,m.solvingInMeters,m.solvingRate,m.requiredPcs]),a.useEffect(()=>{if(O==="assignedQty"){const v=()=>{const H=parseFloat(m.assignedQty)||0,T=parseFloat(m.availableQty)||0,V=parseFloat(m.totalPcs)||0;return Math.round(H*(V/T))};P(H=>({...H,requiredPcs:v()}))}else if(O==="requiredPcs"){const v=()=>{const H=parseFloat(m.requiredPcs)||0,T=parseFloat(m.availableQty)||0,V=parseFloat(m.totalPcs)||0;return(H*T/V).toFixed(2)};P(H=>({...H,assignedQty:v()}))}},[m.assignedQty,m.requiredPcs,O]);const te=v=>{const H=v.target.value,T=v.target.name;Z("assignedQty"),P(V=>({...V,assignedQty:H})),P(V=>{const re={...V,[T]:H};if(T==="assignedQty"||T==="remainingQty"){const oe=parseFloat(re.assignedQty),ue=parseFloat(re.remainingQty);oe>ue?g(J=>({...J,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):g(J=>({...J,assignedQty:""}))}return re})},me=v=>{const H=v.target.value,T=v.target.name;Z("requiredPcs"),P(V=>({...V,requiredPcs:H})),P(V=>{const re={...V,[T]:H};if(T==="requiredPcs"||T==="remainingPcs"){const oe=parseFloat(re.requiredPcs),ue=parseFloat(re.remainingPcs);oe>ue?(console.log(),g(J=>({...J,requiredPcs:"Required Pcs cannot be greater than Remaining Pcs"}))):g(J=>({...J,requiredPcs:""}))}return re})},ce=async()=>{if(console.log(p),p.totalAmount==0||p.costPerComponent==0){C("Please Enter Thread, Tilla or Sequnce values , Total Amount cannot be zero",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(p.assignedQty)>parseFloat(p.remainingQty)){C("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(p.requiredPcs)>parseFloat(p.remainingPcs)){C("Required Pcs can not be greater then Remaining Pcs !",{variant:"error",autoHideDuration:5e3});return}try{const v=await ve.post("http://100.42.177.77:81/api/Embroidery/SaveEmbroideryDetails",{...p,additional:p.additional.join(", ")});v.data.success?C("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(C(`${v.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",v.data.message)),console.log("Save response:",v.data),P(H=>({...H,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,remainingQty:(h.availableQty-c).toFixed(2)||0,remainingRepeats:h.repeats-Y||"",costPerComponent:0,createdOn:new Date().toISOString(),createdBy:r.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:r.empId})),X(),D()}catch(v){console.error("Error saving data:",v),C("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},he=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"Additional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Ae,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!y,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"Fabric",name:"fabricName",value:p.fabricName,onChange:f,size:"small",disabled:!0,sx:v=>({...p.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Component",name:"componentName",value:p.componentName,onChange:f,size:"small",disabled:!0,sx:v=>({...p.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"Color",name:"colourName",value:p.colourName,onChange:f,size:"small",disabled:!0,sx:v=>({...p.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:p.poPcs,onChange:f,size:"small",disabled:!0,sx:v=>({...p.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Heads",size:"small",name:"noOfHeadsName",value:p.noOfHeadsName,onChange:f,disabled:!0,sx:v=>({...p.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:p.cuttingSize,onChange:f,disabled:!0,sx:v=>({...p.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:p.itemsPerRepeat,onChange:f,disabled:!0,sx:v=>({...p.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total Available Qty",fullWidth:!0,size:"small",name:"availableQty",value:p.availableQty,onChange:f,disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:p.remainingQty,type:"number",error:!!l.remainingQty,helperText:l.remainingQty,onChange:f,disabled:!0,sx:v=>({...p.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:p.repeats,onChange:f,disabled:!0,sx:v=>({...p.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:p.totalPcs,onChange:f,disabled:!0,sx:v=>({...p.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Remaining Pcs",fullWidth:!0,size:"small",name:"remainingPcs",value:p.remainingPcs,onChange:f,disabled:!0,sx:v=>({...p.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:p.vendorId,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}},children:$.map(v=>e.jsx(B,{value:v.lookUpId,children:v.lookUpName},v.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:p.assignedQty,onChange:te,error:!!l.assignedQty,helperText:l.assignedQty,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Required Pcs",fullWidth:!0,disabled:!p.remainingPcs&&!p.remainingQty,size:"small",type:"number",name:"requiredPcs",value:p.requiredPcs,error:!!l.requiredPcs,helperText:l.requiredPcs,onChange:me,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{select:!0,label:"Additional",value:p.additional,name:"additional",size:"small",onChange:f,fullWidth:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:K.map(v=>e.jsx(B,{value:v,style:_(v,p.additional,t),children:v},v))})}),e.jsx(o,{item:!0,xs:12,md:1,children:e.jsx(bt,{control:e.jsx(It,{checked:p.isSolving,onChange:W,disabled:!p.remainingPcs&&!p.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:p.threadStiches,onChange:f,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:p.threadRate,onChange:f,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:p.threadAmount,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:p.tillaStiches,onChange:f,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:p.tilaRate,onChange:f,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:p.tilaAmount,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:p.sequence,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:p.sequenceRate,onChange:f,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:p.sequenceAmount,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),p.isSolving?e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:p.solvingLayers,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:p.solvingInMeters,disabled:!p.remainingPcs&&!p.remainingQty,onChange:f,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:p.solvingRate,onChange:f,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:p.solvingAmount,disabled:!p.remainingPcs&&!p.remainingQty,onChange:f,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(i,{label:"Total Amount",fullWidth:!0,size:"small",disabled:!p.remainingPcs&&!p.remainingQty,name:"totalAmount",value:p.totalAmount,onChange:f,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(i,{label:"Cost Per Component",fullWidth:!0,type:"number",size:"small",name:"costPerComponent",value:p.costPerComponent,onChange:f,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:ce,children:"Save"})})]})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(be,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:he,initialRows:x,setInitialData:M,deleteApi:"http://100.42.177.77:81/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:X})})]})})]})},Kt=({initialValues:h})=>{$e();const{user:S}=Fe(),[D,ne]=a.useState(!0),{enqueueSnackbar:y}=Qe(),[t,C]=a.useState([]),[l,g]=a.useState(!1),[r,x]=a.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:S.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId});a.useEffect(()=>{x({...r,embroideryId:(t==null?void 0:t.embroideryId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})},[t]);const{data:q}=Ye(),[u,M]=a.useState("");a.useEffect(()=>{M(h.collectionId)},[]);const{data:c}=Re(),{data:Y,refetch:p}=Xe(u,{skip:!u}),{data:P,refetch:K}=_e(r.designId,{skip:!r.designId}),{data:_,refetch:z}=De({batchNo:r.planningHeaderId,componentId:r.componentId},{skip:!r.planningHeaderId||!r.componentId}),{data:R}=et({batchNo:r.planningHeaderId,componentId:r.componentId,fabricId:r.fabricId},{skip:!r.planningHeaderId||!r.componentId||!r.fabricId}),{data:X,refetch:$}=kt(r.planningHeaderId,{skip:!r.planningHeaderId}),{data:w}=tt(r.planningHeaderId,{skip:!r.planningHeaderId});console.log("formData.planningHeaderId",r.planningHeaderId),console.log("collectionData",q);const[f,W]=a.useState(!1),[O,Z]=a.useState([]),[m,U]=a.useState([]),[E,te]=a.useState([]),[me,ce]=a.useState([]),[he,Ce]=a.useState([]),[v,H]=a.useState([]),[T,V]=a.useState([]),[re,oe]=a.useState([]);console.log("batchList",m),console.log("formData",r),a.useEffect(()=>{Y&&Z(Y.result)},[Y]),a.useEffect(()=>{P&&U(P.result)},[P]),a.useEffect(()=>{_&&(z(),te(_.result))},[_,z]),a.useEffect(()=>{R&&H(_.result)},[R]),a.useEffect(()=>{w&&oe(w.result)},[w]),a.useEffect(()=>{X&&(ne(!1),V(X.result.map((I,G)=>({id:G+1,...I}))))},[X,$]),console.log("embroideryList",X),console.log("initialRows",T),a.useEffect(()=>{if(c){const I=c.result[0];ce(I.vendorList),Ce(I.noOfHeadsList)}},[c]);const ue=(q==null?void 0:q.result)||[];a.useEffect(()=>{const I=()=>{const se=parseFloat(r.repeats)||0,Pe=parseFloat(r.itemsPerRepeat)||0;return(se*Pe).toFixed(2)};x(se=>({...se,totalPcs:I()}));const G=()=>{const se=parseFloat(r.threadStiches)||0,Pe=parseFloat(r.threadRate)||0,ze=parseFloat(r.noOfHead)||0,He=parseFloat(r.repeats)||0;return(se/1e3*(Pe*He*ze)).toFixed(2)};x(se=>({...se,threadAmount:G()}));const pe=()=>{const se=parseFloat(r.tillaStiches)||0,Pe=parseFloat(r.tilaRate)||0,ze=parseFloat(r.noOfHead)||0,He=parseFloat(r.repeats)||0;return(se/1e3*(Pe*He*ze)).toFixed(2)};x(se=>({...se,tilaAmount:pe()}));const ee=()=>{const se=parseFloat(r.sequence)||0,Pe=parseFloat(r.sequenceRate)||0,ze=parseFloat(r.noOfHead)||0,He=parseFloat(r.repeats)||0;return(se/1e3*(Pe*He*ze)).toFixed(2)};x(se=>({...se,sequenceAmount:ee()}));const fe=()=>{const se=parseFloat(r.repeats)||0,Pe=parseFloat(r.noOfHead)||0,ze=parseFloat(r.solvingLayers)||0;return(se*Pe*13/39.37*ze).toFixed(2)};x(se=>({...se,solvingInMeters:fe()}));const Oe=()=>{const se=parseFloat(r.solvingInMeters)||0,Pe=parseFloat(r.solvingRate)||0;return parseFloat(r.solvingLayers),(se*Pe).toFixed(2)};x(se=>({...se,solvingAmount:Oe()}));const Ct=()=>{const se=parseFloat(r.threadAmount)||0,Pe=parseFloat(r.tilaAmount)||0,ze=parseFloat(r.sequenceAmount)||0,He=parseFloat(r.solvingAmount)||0;return(se+Pe+ze+He).toFixed(2)};x(se=>({...se,totalAmount:Ct()||0}))},[r.threadAmount,r.totalAmount,r.sequenceAmount,r.solvingAmount,r.repeats,r.tilaAmount,r.itemsPerRepeat,r.threadRate,r.threadStiches,r.noOfHead,r.tilaRate,r.tillaStiches,r.sequenceRate,r.sequence,r.solvingLayers,r.solvingInMeters,r.solvingRate]);const J=I=>{const{name:G,value:pe}=I.target;if(G==="collectionId")ue.find(ee=>ee.collectionId===parseInt(pe)),M(pe),g(!0),V([]),ne(!0),x({...r,collectionId:pe,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]});else if(G==="designId"){const ee=O.find(fe=>fe.designId===parseInt(pe));V([]),ne(!0),x({...r,designId:pe,baseColorId:ee?ee.colorId:"",baseColorName:ee?ee.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(G==="colorId"){const ee=v.find(fe=>fe.colorId===pe);x({...r,colorId:pe,availableQty:ee?ee.total:"",cuttingSize:ee?ee.cuttingSize:"",repeats:ee?ee.repeats:"",noOfHead:ee?ee.noOfHeads:""})}else if(G==="batchNo"){const ee=m.find(fe=>fe.batchNo===pe);x({...r,batchNo:pe,planningHeaderId:ee?ee.planningHeaderId:"",poPcs:ee?ee.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),W(!0),g(!1)}else x({...r,[G]:pe}),F(ee=>({...ee,[G]:""}))},[j,F]=a.useState({}),L=async()=>{try{const I=await ve.post("http://100.42.177.77:81/api/Embroidery/SaveEmbroidery",{...r,threadAdditional:r.threadAdditional.join(", ")});console.log("Save response:",I.data),I.data.success?y("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(y(`${I.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",I.data.message)),x(G=>({embroideryId:0,designId:G.designId,batchNo:G.batchNo,planningHeaderId:G.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:G.poPcs,baseColorId:G.baseColorId,baseColorName:G.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})),$()}catch(I){console.error("Error saving data:",I),y("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",T);const[A,le]=a.useState({}),[Ie,Me]=a.useState(!1),je=I=>{le(I),Me(!0)},[ke,Se]=a.useState(!0),Ne=I=>{le(I),Me(!0),Se(!1)},Le=()=>{Se(!0),Me(!1),le({}),refetchDyeingPrintingData()};console.log("show div",ke);const[we,ae]=a.useState(0),[We,Te]=a.useState(0),[d,s]=a.useState(0),[k,n]=a.useState(0);a.useEffect(()=>{const I=T.reduce((fe,Oe)=>fe+(Oe.availableQty??0),0).toFixed(2),G=T.reduce((fe,Oe)=>fe+(Oe.assignedQty??0),0).toFixed(2),pe=T.reduce((fe,Oe)=>fe+(Oe.totalPcs??0),0).toFixed(2),ee=T.reduce((fe,Oe)=>fe+(Oe.requiredPcs??0),0).toFixed(2);ae(parseFloat(I).toLocaleString()),Te(parseFloat(G).toLocaleString()),s(parseFloat(pe).toLocaleString()),n(parseFloat(ee).toLocaleString())},[T]);const b=[...T,{id:"TOTAL_SUMMARY",availableQty:we,assignedQty:We,totalPcs:d,requiredPcs:k}],Q={sortable:!1,pinnable:!1,hideable:!1},N=[{field:"id",headerName:"Sr#",...Q,colSpan:(I,G)=>G.id==="TOTAL_SUMMARY"?4:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):I.value},{field:"designNo",headerName:"Design",...Q,colSpan:(I,G)=>G.id==="TOTAL_SUMMARY"?3:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):I.value},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component ",renderCell:I=>e.jsx(qe,{label:I.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric "},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty",...Q,valueGetter:I=>I.toLocaleString(),renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"assignedQty",headerName:"Assigned Qty",...Q,valueGetter:I=>I,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"totalPcs",headerName:"Total Pcs",renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"requiredPcs",headerName:"Assigned Pcs",colSpan:(I,G)=>G.id==="TOTAL_SUMMARY"?4:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:I=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(ft,{variant:"text",size:"small",children:[e.jsx(Be,{color:"primary",onClick:()=>je(I.row),children:e.jsx(lt,{})}),e.jsx(Be,{color:"primary",onClick:()=>Ne(I.row),children:e.jsx(Ee,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ke,{src:Vt,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:u,onChange:J,size:"small",InputLabelProps:{sx:{color:"black"}},children:ue.map(I=>e.jsx(B,{value:I.collectionId,children:I.collectionName},I.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:r.designId,onChange:J,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(I=>e.jsx(B,{value:I.designId,children:I.designNo},I.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:r.batchNo,onChange:J,size:"small",InputLabelProps:{sx:{color:"black"}},children:m.map(I=>e.jsx(B,{value:I.batchNo,children:I.batchNo},I.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:r.baseColorName,onChange:J,disabled:!0,sx:I=>({...r.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:r.componentId,onChange:J,size:"small",required:!0,error:!!j.componentId,helperText:j.componentId,InputLabelProps:{sx:{color:"black"}},children:re.map(I=>e.jsx(B,{value:I.componentId,children:I.componentName},I.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:r.fabricId,onChange:J,required:!0,error:!!j.fabricId,helperText:j.fabricId,InputLabelProps:{sx:{color:"black"}},children:E.map(I=>e.jsx(B,{value:I.fabricId,children:I.fabric},I.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:r.colorId,onChange:J,required:!0,error:!!j.colorId,helperText:j.colorId,InputLabelProps:{sx:{color:"black"}},children:v.map(I=>e.jsx(B,{value:I.colorId,children:I.color},I.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:r.poPcs,onChange:J,disabled:!0,sx:I=>({...r.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:r.availableQty,onChange:J,InputLabelProps:{sx:{color:"black"}},sx:I=>({...r.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:r.repeats,onChange:J,InputLabelProps:{sx:{color:"black"}},sx:I=>({...r.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:r.noOfHead,onChange:J,required:!0,error:!!j.noOfHead,helperText:j.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:I=>({...r.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:he.map(I=>e.jsx(B,{value:I.lookUpId,children:I.lookUpName},I.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:r.cuttingSize,onChange:J,InputLabelProps:{sx:{color:"black"}},sx:I=>({...r.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:r.itemsPerRepeat,onChange:J,required:!0,error:!!j.itemsPerRepeat,helperText:j.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:I=>({...r.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:r.totalPcs,onChange:J})}),e.jsx(o,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:L,children:"Save"})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ee,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(Ue,{iColumns:N,initialRows:b,setInitialData:C,deleteApi:"http://100.42.177.77:81/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:$,setAccordionExpanded:W,fileName:"Embroidery List",isLoading:D}),e.jsxs(ot,{open:Ie,onClose:Le,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(at,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(be,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Embroidery > Assign Vendors "}),e.jsx(Be,{onClick:Le,sx:{color:"#ffffff"},children:e.jsx(st,{})})]}),e.jsxs(nt,{children:[e.jsx(rt,{id:"alert-dialog-slide-description"}),e.jsx(Zt,{initialFormData:A,setInitialFormData:le,refetchDyeingPrintingData:$,handleClickOpen:je,showUpperDiv:ke})]})]})]})})]})]})},$t=Kt,Dt=({setInitialValues:h,initialValues:S})=>{const{user:D}=Fe();console.log("user",D);const[ne,y]=a.useState(!0),[t,C]=a.useState([]),[l,g]=a.useState([]),[r,x]=a.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:D.empId,lastUpdatedBy:D.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",r),a.useEffect(()=>{x({...r,processType:(t==null?void 0:t.processType)||"MultiHead",planningId:(t==null?void 0:t.planningId)||0,baseColorId:(t==null?void 0:t.baseColorId)||"",componentId:(t==null?void 0:t.componentId)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",colorId:(t==null?void 0:t.colorId)||"",fabricId:(t==null?void 0:t.fabricId)||"",noOfHeads:(t==null?void 0:t.noOfHeads)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,repeats:(t==null?void 0:t.repeats)||0,repeatSize:(t==null?void 0:t.repeatSize)||0,uomId:(t==null?void 0:t.uomId)||"",totalFabric:(t==null?void 0:t.totalFabric)||"",shrinkage:(t==null?void 0:t.shrinkage)||"",wastage:(t==null?void 0:t.wastage)||"",total:(t==null?void 0:t.total)||"",appId:1,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||D.empId,lastUpdatedBy:D.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(t==null?void 0:t.repeatsInMtr)||""})},[t]);const{data:q}=Ye(),[u,M]=a.useState(""),{data:c,refetch:Y}=Xe(u,{skip:!u}),{data:p,refetch:P}=Ot(r.planningHeaderId,{skip:!r.planningHeaderId}),{data:K}=Re(),[_,z]=a.useState([]),{enqueueSnackbar:R}=Qe();console.log("lookupData",K);const[X,$]=a.useState([]);a.useEffect(()=>{q&&$(q.result)},[q]),a.useEffect(()=>{c&&(z(c.result),Y())},[c]),a.useEffect(()=>{p&&(y(!1),g(p.result.map((n,b)=>({id:b+1,...n}))))},[p,P]),console.log("designList",_),console.log("collectionData",q);const[w,f]=a.useState(!1),[W,O]=a.useState([]),[Z,m]=a.useState([]),[U,E]=a.useState([]),[te,me]=a.useState([]),[ce,he]=a.useState([]),[Ce,v]=a.useState([]),[H,T]=a.useState([]),[V,re]=a.useState([]);console.log("components:",U),console.log("Fabrications:",te),console.log("colors:",ce),console.log("uoms:",Ce),console.log("heads:",H),console.log("lookupData",K),a.useEffect(()=>{if(K){const n=K.result[0];E(n.componentList),he(n.colorList),me(n.fabricList),T(n.noOfHeadsList),v(n.uomList),O(n.planningTypeProcessList),m(n.operatingMachineList)}},[K]),a.useEffect(()=>{const n=async b=>{try{const Q=await ve.get(`http://100.42.177.77:81/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${b}`);console.log(Q.data),re(Q.data.result)}catch(Q){console.error("Error fetching pre-planning lookup data:",Q)}};r.designId&&n(r.designId)},[r.designId,r.planningHeaderId]);const oe=r.planningProcessTypeId===212||r.planningProcessTypeId===1219;console.log("initialValues",S),console.log("selectedCollectionId",u),a.useEffect(()=>{M((S==null?void 0:S.collectionId)||""),x({...r,designId:(S==null?void 0:S.designId)||"",planningHeaderId:(S==null?void 0:S.planningHeaderId)||"",batchNo:(S==null?void 0:S.batchNo)||""})},[S]),a.useEffect(()=>{const n=()=>{const G=parseFloat(r.poPcs)||0,pe=parseFloat(r.cuttingSize)||0,ee=(G*pe).toFixed(2);return parseFloat(ee).toLocaleString()},b=()=>{const G=parseFloat(r.repeats)||0,pe=parseFloat(r.repeatSize)||0,ee=(G*pe).toFixed(2);return parseFloat(ee).toLocaleString()},Q=G=>{const pe=G||0,ee=parseFloat(r.shrinkage)||0,fe=parseFloat(r.wastage)||0,Oe=(pe*(100+(ee+fe))/100).toFixed(2);return parseFloat(Oe).toLocaleString()},N=()=>(.9144*(parseFloat(r.repeatSize)||0)).toFixed(2),ie=()=>{const G=parseFloat(r.repeats)||0;return((parseFloat(r.repeatsInMtr)||0)*G).toFixed(2)};let I=0;oe?I=parseFloat(n().replace(/,/g,""))||0:I=parseFloat(b().replace(/,/g,""))||0,x(G=>({...G,totalFabric:I.toLocaleString(),total:Q(I),repeatsInMtr:N()})),!oe&&r.isSchiffili&&x(G=>({...G,totalFabric:ie()}))},[r.poPcs,r.cuttingSize,r.repeats,r.repeatSize,r.totalFabric,r.shrinkage,r.wastage,r.repeatsInMtr,r.isSchiffili,oe]);const[ue,J]=a.useState(!1);a.useState(!1);const j=n=>{const{name:b,value:Q}=n.target;if(b==="collectionId"){const N=X.find(ie=>ie.collectionId===parseInt(Q));f(!0),g([]),y(!0),M(Q),x({...r,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:Q,noOfDesigns:N?N.noOfDesigns:"",noOfColors:N?N.noOfColors:""})}else if(b==="designId"){const N=_.find(ie=>ie.designId===parseInt(Q));g([]),y(!0),x({...r,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:Q,baseColorId:N?N.colorId:"",baseColorName:N?N.colorName:""})}else if(b==="batchNo"){const N=V.find(ie=>ie.batchNo===Q);x({...r,componentId:"",processType:"MultiHead",poPcs:N?N.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:Q,planningHeaderId:N?N.planningHeaderId:""}),J(!0),f(!1)}else if(b==="planningProcessTypeId"){const N=W.find(ie=>ie.lookUpId===Q);console.log("selectedProcess",N),x({...r,planningProcessTypeId:Q,planningProcessTypeName:N?N.lookUpName:"",noOfHeads:0,operatingMachineId:0}),J(!0),f(!1)}else x({...r,[b]:Q})},[F,L]=a.useState({}),[A,le]=a.useState(!1),Ie=()=>{le(!A)},Me=async()=>{const n=je();if(Object.keys(n).length>0){L(n);return}try{const b={...r,totalFabric:parseFloat(r.totalFabric.replace(/,/g,"")),total:parseFloat(r.total.replace(/,/g,""))},Q=await ve.post("http://100.42.177.77:81/api/PrePlanning/SavePrePlanning",b);console.log("Data saved successfully:",Q.data),console.log("Save response:",Q.data),Q.data.success?Q.data.success&&R("PrePlanning saved successfully!",{variant:"success",autoHideDuration:5e3}):(R(`${Q.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",Q.data.message)),x(N=>({processType:"MultiHead",planningId:0,collectionId:N.collectionId,designId:N.designId,batchNo:N.batchNo,planningHeaderId:N.planningHeaderId,baseColorId:N.baseColorId,baseColorName:N.baseColorName,noOfDesigns:N.noOfDesigns,noOfColors:N.noOfColors,poPcs:N.poPcs,fabricId:N.fabricId,shrinkage:N.shrinkage,wastage:N.wastage,componentId:"",cuttingSize:"",colorId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:D.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:D.empId,isSchiffili:!1,repeatsInMtr:""})),P()}catch(b){console.error("Error saving data:",b),R("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},je=()=>{const n={};return r.componentId||(n.componentId="componentId is required"),r.colorId||(n.colorId="colorId is required"),r.fabricId||(n.fabricId="fabricId is required"),r.cuttingSize||(n.cuttingSize="cuttingSize is required"),r.uomId||(n.uomId="uomId is required"),r.shrinkage||(n.shrinkage="shrinkage is required"),r.wastage||(n.wastage="wastage is required"),n};console.log("initialRows",l);const ke=l.reduce((n,b)=>n+(b.totalFabric??0),0).toFixed(2),Se=parseFloat(ke).toLocaleString();console.log("localizedTotalFabric",Se);const Ne=l.reduce((n,b)=>n+(b.total??0),0).toFixed(2),Le=parseFloat(Ne).toLocaleString(),we=[...l,{id:"TOTAL_SUMMARY",label:"Total Fabric",totalFabric:Se,total:Le}],ae={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",we);const We=[{field:"id",headerName:"Sr#",...ae,colSpan:(n,b)=>{if(b.id==="TOTAL_SUMMARY")return 10},valueGetter:(n,b)=>b.id==="TOTAL_SUMMARY"?b.label:n,renderCell:n=>e.jsx("div",{style:{color:n.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:n.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:n.value})},{field:"componentName",headerName:"Component",...ae},{field:"planningProcessTypeName",headerName:"Process Type",...ae,renderCell:n=>{const b=n.value==="MultiHead"?"primary.dark":n.value==="Schiffili"?theme.palette.grey[900]:n.value==="Dyeing"?"success.dark":"default";return e.jsx(qe,{label:n.value,sx:{backgroundColor:b==="primary"||b==="default"?void 0:b,color:b==="primary"||b==="default"?void 0:"white"},color:b==="primary"?"primary":b==="default"?"default":void 0})}},{field:"color",headerName:"Color",...ae},{field:"cuttingSize",headerName:"Cutting Size",...ae},{field:"fabric",headerName:"Fabrication",...ae},{field:"noOfHeadName",headerName:"No. Of Heads",...ae},{field:"operatingMachineName",headerName:"Operating Machine",...ae},{field:"repeats",headerName:"Repeats",valueGetter:n=>n.toLocaleString(),...ae},{field:"repeatSize",headerName:"Repeat Size",valueGetter:n=>n.toLocaleString(),...ae},{field:"totalFabric",headerName:"Total Fabric",valueGetter:n=>n.toLocaleString(),renderCell:n=>e.jsx("div",{style:{color:n.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:n.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:n.value}),...ae},{field:"uom",headerName:"UOM",colSpan:(n,b)=>b.id==="TOTAL_SUMMARY"?2:void 0,valueGetter:(n,b)=>b.id==="TOTAL_SUMMARY"?"OverAll Total":n,renderCell:n=>e.jsx("div",{style:{color:n.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:n.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:n.value}),...ae},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:n=>n.toLocaleString(),colSpan:(n,b)=>b.id==="TOTAL_SUMMARY"?2:void 0,renderCell:n=>e.jsx("div",{style:{color:n.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:n.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:n.value}),...ae}],Te=r.planningProcessTypeId===198;a.useEffect(()=>{Te&&x({...r,uomId:139})},[Te]),console.log("formData",r);const d=({row:n,field:b})=>n.id==="TOTAL_SUMMARY"&&(b==="componentName"||b==="uom")?"bold":"";console.log("batchList:",V);const s="http://100.42.177.77:81/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",k=(n,b)=>{J(!ue)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(xt,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:2.4,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:u,onChange:j,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:X.map(n=>e.jsx(B,{value:n.collectionId,children:n.collectionName},n.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:r.designId,onChange:j,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:_.map(n=>e.jsx(B,{value:n.designId,children:n.designNo},n.designId))})}),e.jsxs(o,{item:!0,xs:12,md:2.4,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:r.batchNo,onChange:j,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:V.map(n=>e.jsx(B,{value:n.batchNo,children:n.batchNo},n.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(i,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:r.poPcs,onChange:j,disabled:!0,sx:n=>({...r.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(i,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:r.baseColorName,onChange:j,disabled:!0,sx:n=>({...r.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"MainCard",avatar:e.jsx(pt,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Be,{onClick:k,sx:{mt:"-18px"},children:e.jsx(Ze,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(mt,{expanded:ue,onChange:k,sx:{},children:[e.jsx(ht,{expandIcon:e.jsx(Ze,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(gt,{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(Je,{fullWidth:!0,options:te,getOptionLabel:n=>n.lookUpName,value:te.find(n=>n.lookUpId===r.fabricId)||null,onChange:(n,b)=>{j({target:{name:"fabricId",value:b?b.lookUpId:""}})},renderInput:n=>e.jsx(i,{...n,label:"Fabrication",size:"small",name:"fabricId",value:r.fabricId,required:!0,error:!!F.fabricId,helperText:F.fabricId,disabled:A,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:n})=>e.jsx("div",{style:{backgroundColor:"white"},children:n})})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:r.shrinkage,onChange:j,error:!!F.shrinkage,helperText:F.shrinkage,required:!0,disabled:A,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:r.wastage,onChange:j,error:!!F.wastage,helperText:F.wastage,required:!0,disabled:A,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(ge,{variant:"contained",size:"small",onClick:Ie,children:A||A?"Unlock":"Lock"})}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsxs(o,{item:!0,xs:12,md:2,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:r.planningProcessTypeId,onChange:j,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:W.map(n=>e.jsx(B,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})," "]}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(Je,{fullWidth:!0,options:U,getOptionLabel:n=>n.lookUpName,value:U.find(n=>n.lookUpId===r.componentId)||null,onChange:(n,b)=>{j({target:{name:"componentId",value:b?b.lookUpId:""}})},renderOption:(n,b)=>{const{lookUpName:Q}=b;return e.jsx("span",{...n,children:Q})},renderInput:n=>e.jsx(i,{...n,label:"Select Component",size:"small",name:"componentId",value:r.componentId,required:!0,error:!!F.componentId,helperText:F.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:n})=>e.jsx("div",{style:{backgroundColor:"white"},children:n})})}),e.jsxs(o,{item:!0,xs:12,md:2,children:[" ",e.jsx(Je,{fullWidth:!0,options:ce,getOptionLabel:n=>n.lookUpName,value:ce.find(n=>n.lookUpId===r.colorId)||null,onChange:(n,b)=>{j({target:{name:"colorId",value:b?b.lookUpId:""}})},renderInput:n=>e.jsx(i,{...n,label:"Color",size:"small",value:r.colorId,name:"colorId",required:!0,error:!!F.colorId,helperText:F.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:n})=>e.jsx("div",{style:{backgroundColor:"white"},children:n})})]}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:r.cuttingSize,onChange:j,required:!0,error:!!F.cuttingSize,helperText:F.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:Te?e.jsx(i,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:r.operatingMachineId,onChange:j,required:!0,disabled:oe,InputLabelProps:{sx:{color:"black"}},children:Z.map(n=>e.jsx(B,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))}):e.jsx(i,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:r.noOfHeads,onChange:j,required:!0,disabled:oe,InputLabelProps:{sx:{color:"black"}},children:H.map(n=>e.jsx(B,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:r.repeatSize,onChange:j,disabled:oe,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"No. of Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:r.repeats,onChange:j,required:!0,disabled:oe,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:r.totalFabric,onChange:j,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:r.uomId,onChange:j,error:!!F.uomId,helperText:F.uomId,required:!0,disabled:Te,InputLabelProps:{sx:{color:"black"}},children:Ce.map(n=>e.jsx(B,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Repeats in Meter",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:r.repeatsInMtr,onChange:j,sx:n=>({...r.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(i,{label:"Total",fullWidth:!0,size:"small",name:"total",value:r.total,onChange:j,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(o,{container:!0,spacing:1,width:"Inherit"})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",children:e.jsx(ge,{variant:"contained",size:"small",onClick:Me,children:"Save"})})]})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"MainCard",avatar:e.jsx(Ee,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{sx:{paddingY:1,paddingX:1},children:e.jsx(o,{sx:{},item:!0,xs:12,children:e.jsx(Ue,{iColumns:We,initialRows:we,setInitialData:C,deleteApi:s,deleteBy:"planningId",refetch:P,getCellClassName:d,setAccordionExpanded:J,fileName:"PrePlanningList",isLoading:ne})})})]})]})},eo=Dt,to="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",oo=({initialValues:h})=>{const{user:S}=Fe();console.log("user",S);const[D,ne]=a.useState(!0),[y,t]=a.useState([]),[C,l]=a.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:S.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId});a.useEffect(()=>{l({...C,dpId:y.dpId||0,fabricId:(y==null?void 0:y.fabricId)||"",colorId:(y==null?void 0:y.colorId)||"",color:(y==null?void 0:y.color)||"",processType:(y==null?void 0:y.processType)||"",availableQty:(y==null?void 0:y.availableQty)||"",Shrinkage:(y==null?void 0:y.shrinkage)||"",Wastage:(y==null?void 0:y.wastage)||"",outputQty:(y==null?void 0:y.outputQty)||0,UOM:(y==null?void 0:y.uom)||0,uomId:(y==null?void 0:y.uomId)||"",poPcs:(y==null?void 0:y.poPcs)||0,createdOn:(y==null?void 0:y.createdOn)||new Date().toISOString(),createdBy:(y==null?void 0:y.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})},[y]);const{enqueueSnackbar:g}=Qe(),[r,x]=a.useState(!1);console.log("Dyeing form data to send",C);const{data:q}=Ye(),[u,M]=a.useState("");a.useEffect(()=>{M(h.collectionId)},[]);const{data:c}=Re(),{data:Y,refetch:p}=Xe(u,{skip:!u}),{data:P,refetch:K}=_e(C.designId,{skip:!C.designId}),{data:_}=At({batchNo:C.planningHeaderId,processType:"Fabrication"},{skip:!C.planningHeaderId}),{data:z}=Nt({fabricId:C.fabricId,planningHeaderId:C.planningHeaderId},{skip:!C.fabricId||!C.planningHeaderId}),{data:R,refetch:X}=Lt(C.planningHeaderId,{skip:!C.planningHeaderId}),[$,w]=a.useState([]),[f,W]=a.useState([]),[O,Z]=a.useState([]),[m,U]=a.useState([]),[E,te]=a.useState([]),[me,ce]=a.useState([]);a.useState([]);const[he,Ce]=a.useState(!1);console.log("batchList",f),console.log("formData",C),a.useEffect(()=>{Y&&w(Y.result)},[Y]),a.useEffect(()=>{P&&W(P.result)},[P]),a.useEffect(()=>{_&&Z(_.result)},[_]),a.useEffect(()=>{z&&ce(z.result)},[z]),a.useEffect(()=>{R&&(ne(!1),te(R.result.map((d,s)=>({id:s+1,...d}))))},[R,X]),a.useEffect(()=>{if(c){const d=c.result[0];U(d.uomList)}},[c]);const[v,H]=a.useState([]);a.useEffect(()=>{q&&H(q.result)},[q]);const T=d=>{const{name:s,value:k}=d.target;if(s==="collectionId")v.find(n=>n.collectionId===parseInt(k)),M(k),x(!0),te([]),ne(!0),l({...C,collectionId:k,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:""});else if(s==="designId"){const n=$.find(b=>b.designId===parseInt(k));te([]),ne(!0),l({...C,designId:k,baseColorId:n?n.colorId:"",baseColorName:n?n.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(s==="batchNo"){const n=f.find(b=>b.batchNo===k);l({...C,batchNo:k,planningHeaderId:n?n.planningHeaderId:"",poPcs:n?n.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),Ce(!0),x(!1)}else if(s==="fabricId")O.find(n=>n.fabricId===k),console.log("Selected Fabric:",O),l({...C,fabricId:k});else if(s==="ColorId"){const n=me.find(b=>b.colorId===k.colorId);l({...C,ColorId:k.colorId,color:n.color,availableQty:n.total,UOM:n.uom,Shrinkage:n.shrinkage,Wastage:n.wastage})}else s==="processType"?l({...C,processType:k}):s==="vendorId"?l({...C,vendorId:k}):(l({...C,[s]:k}),re(n=>({...n,[s]:""})))};a.useEffect(()=>{const d=()=>{const N=parseFloat(C.availableQty)||0,ie=parseFloat(C.Shrinkage)||0,I=parseFloat(C.Wastage)||0;return(N*(100-(ie+I))/100).toFixed(2)},s=()=>{const N=parseFloat(C.availableQty)||0,ie=parseFloat(C.RatePerUOM)||0;return(N*ie).toFixed(2)},k=(N,ie)=>(N*(1+ie/100)).toFixed(2),n=d(),b=s(),Q=parseFloat(C.GST)||0;k(b,Q),parseFloat(C.poPcs),l(N=>({...N,outputQty:n}))},[C.availableQty,C.Shrinkage,C.Wastage,C.RatePerUOM,C.GST,C.poPcs,C.UnitRatePerPo]);const[V,re]=a.useState({}),oe=async()=>{try{const d=await ve.post("http://100.42.177.77:81/api/DyeingPrinting/SaveDyeingPrinting",C);console.log("Save response:",d.data),d.data.success?g("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(g(`${d.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",d.data.message)),l(s=>({designId:s.designId,planningHeaderId:s.planningHeaderId,batchNo:s.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:s.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})),X()}catch(d){console.error("Error saving data:",d),g("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ue=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[J,j]=a.useState(!0),[F,L]=a.useState({}),[A,le]=a.useState(!1),Ie=d=>{L(d),le(!0)},Me=d=>{L(d),le(!0),j(!1)},je=()=>{j(!0),le(!1),L({}),X()},[ke,Se]=a.useState(0),[Ne,Le]=a.useState(0);a.useEffect(()=>{const d=E.reduce((k,n)=>k+(n.availableQty??0),0).toFixed(2),s=E.reduce((k,n)=>k+(n.assignedQty??0),0).toFixed(2);Se(parseFloat(d).toLocaleString()),Le(parseFloat(s).toLocaleString())},[E]);const we=[...E,{id:"TOTAL_SUMMARY",componentName:"Total Summary",availableQty:ke,assignedQty:Ne}],ae={sortable:!1,pinnable:!1,hideable:!1},We=[{field:"id",headerName:"Sr#",...ae,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):d.value},{field:"fabricName",headerName:"Fabric",...ae},{field:"colorName",headerName:"Color",...ae,colSpan:(d,s)=>s.id==="TOTAL_SUMMARY"?2:void 0},{field:"processType",headerName:"Process Type",...ae,renderCell:d=>{const s=d.value==="Dyeing"?"primary.dark":d.value==="Printing"?"success.dark":"default";return e.jsx(qe,{label:d.value,sx:{backgroundColor:s==="primary"||s==="default"?void 0:s,color:s==="primary"||s==="default"?void 0:"white"},color:s==="primary"?"primary":s==="default"?"default":void 0})}},{field:"uom",headerName:" UOM",...ae},{field:"poPcs",headerName:" PO PCS.",...ae},{field:"availableQty",headerName:"Available Quantitity",...ae,valueGetter:d=>d.toLocaleString(),renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"assignedQty",headerName:"Assigned Qty",...ae,valueGetter:d=>d.toLocaleString(),colSpan:(d,s)=>s.id==="TOTAL_SUMMARY"?4:void 0,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"AddVendor",headerName:"Add Vendor",...ae,renderCell:d=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(ft,{variant:"text",size:"small",children:[e.jsx(Be,{color:"primary",onClick:()=>Ie(d.row),children:e.jsx(lt,{})}),e.jsx(Be,{color:"primary",onClick:()=>Me(d.row),children:e.jsx(Ee,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ke,{src:to,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:u,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:v.map(d=>e.jsx(B,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:C.designId,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:$.map(d=>e.jsx(B,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:C.batchNo,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:f.map(d=>e.jsx(B,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:C.baseColorName,onChange:T,disabled:!0,sx:d=>({...C.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:C.fabricId,onChange:T,error:!!V.fabricId,helperText:V.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:O.map(d=>e.jsx(B,{value:d.fabricId,children:d.fabric},d.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(Gt,{fullWidth:!0,options:me,getOptionLabel:d=>d.color||"",renderInput:d=>e.jsx(i,{...d,label:"Color",name:"colorId",size:"small",error:!!V.colorId,helperText:V.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:d})=>e.jsx("div",{style:{backgroundColor:"white",boxShadow:"0 3px 5px rgba(0, 0, 0, 0.2)"},children:d}),value:me.find(d=>d.colorId===C.colorId)||null,onChange:(d,s)=>{l(k=>({...k,colorId:s?s.colorId:"",color:s?s.color:"",availableQty:s?s.total:"",UOM:s?s.uom:"",uomId:s?s.uomId:"",Shrinkage:s?s.shrinkage:"",Wastage:s?s.wastage:""}))}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:C.processType,onChange:T,error:!!V.processType,helperText:V.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:ue.map(d=>e.jsx(B,{value:d.value,children:d.label},d.value))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:C.poPcs,onChange:T,disabled:!0,sx:d=>({...C.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:C.UOM,onChange:T,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Available Qty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:C.availableQty,onChange:T,disabled:!0,sx:d=>({...C.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(ge,{variant:"contained",color:"primary",size:"small",onClick:oe,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ee,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(Ue,{iColumns:We,initialRows:we,setInitialData:t,deleteApi:"http://100.42.177.77:81/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:X,setAccordionExpanded:Ce,fileName:"Dyeing&PrintingList",isLoading:D}),e.jsxs(ot,{open:A,onClose:je,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(at,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(be,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Dyeing and Printing > Assign Vendors "}),e.jsx(Be,{onClick:je,sx:{color:"#ffffff"},children:e.jsx(st,{})})]}),e.jsxs(nt,{children:[e.jsx(rt,{id:"alert-dialog-slide-description"}),e.jsx(Jt,{initialFormData:F,setInitialFormData:L,refetchDyeingPrintingData:X,handleClickOpen:Ie,showUpperDiv:J})]})]})]})})]})]})},ao=oo,yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",no=({initialValues:h})=>{const{user:S}=Fe(),{enqueueSnackbar:D}=Qe(),[ne,y]=a.useState(!0),[t,C]=a.useState([]),[l,g]=a.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:S.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId});a.useEffect(()=>{g({...l,schiffiliId:t.schiffiliId||0,componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})},[t]);const[r,x]=a.useState(!1),q=(s,k)=>{x(!r)},[u,M]=a.useState(!1),{data:c}=Ye(),[Y,p]=a.useState("");a.useEffect(()=>{p(h.collectionId)},[]);const{data:P}=Re(),{data:K,refetch:_}=Xe(Y,{skip:!Y}),{data:z,refetch:R}=_e(l.designId,{skip:!l.designId}),{data:X}=De({batchNo:l.planningHeaderId,componentId:l.componentId},{skip:!l.planningHeaderId||!l.componentId}),{data:$}=et({batchNo:l.planningHeaderId,componentId:l.componentId,fabricId:l.fabricId},{skip:!l.planningHeaderId||!l.componentId||!l.fabricId}),{data:w,refetch:f}=wt(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:W}=tt(l.planningHeaderId,{skip:!l.planningHeaderId});console.log("formData.planningHeaderId",l.planningHeaderId),console.log("collectionData",c),console.log("schiffliList",w);const[O,Z]=a.useState([]),[m,U]=a.useState([]),[E,te]=a.useState([]),[me,ce]=a.useState([]),[he,Ce]=a.useState([]),[v,H]=a.useState([]),[T,V]=a.useState([]),[re,oe]=a.useState([]),[ue,J]=a.useState([]);a.useEffect(()=>{K&&Z(K.result)},[K]),a.useEffect(()=>{z&&U(z.result)},[z]),a.useEffect(()=>{X&&te(X.result)},[X]),a.useEffect(()=>{$&&V(X.result)},[$]),a.useEffect(()=>{W&&J(W.result)},[W]),a.useEffect(()=>{w&&(y(!1),oe(w.result.map((s,k)=>({id:k+1,...s}))))},[w,f]),a.useEffect(()=>{if(P){const s=P.result[0];ce(s.vendorList),Ce(s.operatingMachineList),H(s.workingHeadList)}},[P]),console.log("initialRows",re);const j=(c==null?void 0:c.result)||[];a.useEffect(()=>{const s=()=>{const N=parseFloat(l.thaanQty)||0,ie=parseFloat(l.operatingMachine)||0;return(N*ie).toFixed(2)};g(N=>({...N,totalEmbroidry:s()}));const k=()=>{const N=parseFloat(l.thaanQty)||0,ie=parseFloat(l.noOfItemPerThaan)||0;return(N*ie).toFixed(2)};g(N=>({...N,totalPcs:k()}));const n=()=>{const N=parseFloat(l.noOfStichesPerYard)||0,ie=parseFloat(l.rate)||0;return(N/1e3*ie).toFixed(2)};g(N=>({...N,amountPerYard:n()}));const b=()=>{const N=parseFloat(l.totalAmount)||0,ie=parseFloat(l.totalPcs)||0;return(N/ie).toFixed(2)};g(N=>({...N,costPerComponent:b()}));const Q=()=>{const N=parseFloat(l.amountPerYard)||0,ie=parseFloat(l.totalEmbroidry)||0,I=parseFloat(l.laserCutRate)||0,G=parseFloat(l.pcsForLaserCut)||0;return(N*ie+G*I).toFixed(2)};g(N=>({...N,totalAmount:Q()}))},[l.thaanQty,l.operatingMachine,l.noOfStichesPerYard,l.rate,l.totalAmount,l.totalPcs,l.amountPerYard,l.totalEmbroidry,l.laserCutRate,l.pcsForLaserCut]);const F=s=>{const{name:k,checked:n}=s.target;g(b=>({...b,[k]:n}))},L=s=>{const{name:k,value:n}=s.target;if(k==="collectionId")j.find(b=>b.collectionId===parseInt(n)),p(n),M(!0),oe([]),y(!0),g({...l,collectionId:n,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(k==="designId"){const b=O.find(Q=>Q.designId===parseInt(n));oe([]),y(!0),g({...l,designId:n,baseColorId:b?b.colorId:"",baseColorName:b?b.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(k==="batchNo"){const b=m.find(Q=>Q.batchNo===n);g({...l,batchNo:n,planningHeaderId:b?b.planningHeaderId:"",poPcs:b?b.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),x(!0),M(!1)}else if(k==="colorId"){const b=T.find(Q=>Q.colorId===n);g({...l,colorId:n,availableQty:b?b.total:"",cuttingSize:b?b.cuttingSize:"",repeats:b?b.repeats:""})}else if(k==="operatingMachineId"){const b=he.find(Q=>Q.lookUpId===n);g({...l,operatingMachineId:n,operatingMachine:b?b.lookUpName:""})}else g({...l,[k]:n})};console.log("colors",T);const[A,le]=a.useState({}),Ie=async()=>{const s=Me();if(Object.keys(s).length>0){le(s);return}try{const k=await ve.post("http://100.42.177.77:81/api/Schiffli/SaveSchiffili",l);console.log("Save response:",k.data),k.data.success?D("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(D(`${k.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",k.data.message)),g(n=>({designId:n.designId,planningHeaderId:n.planningHeaderId,batchNo:n.batchNo,baseColorName:n.baseColorName,schiffiliId:0,componentId:"",poPcs:n.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:S.empId})),f()}catch(k){console.error("Error saving data:",k),D("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Me=()=>{const s={};return l.fabricId||(s.fabricId="fabricId is required"),l.colorId||(s.colorId="colorId is required"),l.vendorId||(s.vendorId="vendorId is required"),l.componentId||(s.componentId="componentId is required"),l.thaanQty||(s.thaanQty="thaanQty is required"),l.workingHeadId||(s.workingHeadId="workingHeadId is required"),l.rate||(s.rate="rate is required"),l.operatingMachineId||(s.operatingMachineId="operatingMachineId is required"),l.noOfStichesPerYard||(s.noOfStichesPerYard="noOfStichesPerYard is required"),l.noOfItemPerThaan||(s.noOfItemPerThaan="noOfItemPerThaan is required"),s};console.log("formData",l);const[je,ke]=a.useState(0),[Se,Ne]=a.useState(0),[Le,we]=a.useState(0);a.useEffect(()=>{const s=re.reduce((b,Q)=>b+(Q.totalAmount??0),0).toFixed(2),k=re.reduce((b,Q)=>b+(Q.totalEmbroidry??0),0).toFixed(2),n=re.reduce((b,Q)=>b+(Q.totalPcs??0),0).toFixed(2);ke(parseFloat(s).toLocaleString()),Ne(parseFloat(k).toLocaleString()),we(parseFloat(n).toLocaleString())},[re]);const ae={id:"TOTAL_SUMMARY",fabricName:"Total Summary",totalAmount:je,totalEmbroidry:Se,totalPcs:Le},We=[...re,ae],Te=[{field:"id",headerName:"Sr#",colSpan:(s,k)=>k.id==="TOTAL_SUMMARY"?3:void 0,renderCell:s=>s.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):s.value},{field:"fabricName",headerName:"Fabric",colSpan:(s,k)=>k.id==="TOTAL_SUMMARY"?2:void 0,renderCell:s=>s.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):s.value},{field:"componentName",headerName:"Component",renderCell:s=>e.jsx(qe,{label:s.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:s=>s.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:s.value}):s.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:s=>s.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:s.value}):s.value},{field:"totalAmount",headerName:"Total Amount",renderCell:s=>s.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:s.value}):s.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ke,{src:yt,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:Y,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:j.map(s=>e.jsx(B,{value:s.collectionId,children:s.collectionName},s.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(s=>e.jsx(B,{value:s.designId,children:s.designNo},s.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:m.map(s=>e.jsx(B,{value:s.batchNo,children:s.batchNo},s.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:s=>({...l.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(pt,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Be,{onClick:q,sx:{mt:"-18px"},children:e.jsx(Ze,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(mt,{expanded:r,onChange:q,sx:{},children:[e.jsx(ht,{expandIcon:e.jsx(Ze,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(gt,{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:l.componentId,onChange:L,size:"small",required:!0,error:!!A.componentId,helperText:A.componentId,InputLabelProps:{sx:{color:"black"}},children:ue.map(s=>e.jsx(B,{value:s.componentId,children:s.componentName},s.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:l.fabricId,onChange:L,required:!0,error:!!A.fabricId,helperText:A.fabricId,InputLabelProps:{sx:{color:"black"}},children:E.map(s=>e.jsx(B,{value:s.fabricId,children:s.fabric},s.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:l.vendorId,onChange:L,required:!0,error:!!A.vendorId,helperText:A.vendorId,InputLabelProps:{sx:{color:"black"}},children:me.map(s=>e.jsx(B,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:l.colorId,onChange:L,required:!0,error:!!A.colorId,helperText:A.colorId,InputLabelProps:{sx:{color:"black"}},children:T.map(s=>e.jsx(B,{value:s.colorId,children:s.color},s.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,disabled:!0,onChange:L,sx:s=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:l.availableQty,onChange:L,sx:s=>({...l.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:l.thaanQty,onChange:L,required:!0,error:!!A.thaanQty,helperText:A.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:l.operatingMachineId,onChange:L,required:!0,error:!!A.operatingMachineId,helperText:A.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:he.map(s=>e.jsx(B,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:l.workingHeadId,onChange:L,required:!0,error:!!A.workingHeadId,helperText:A.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:v.map(s=>e.jsx(B,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:l.cuttingSize,onChange:L,sx:s=>({...l.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:l.rate,onChange:L,required:!0,error:!!A.rate,helperText:A.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:l.noOfStichesPerYard,onChange:L,required:!0,error:!!A.noOfStichesPerYard,helperText:A.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:l.noOfItemPerThaan,onChange:L,required:!0,error:!!A.noOfItemPerThaan,helperText:A.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:l.totalEmbroidry,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:l.amountPerYard,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:l.totalPcs,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:l.costPerComponent,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:l.totalAmount,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(bt,{control:e.jsx(It,{checked:l.laserCut,onChange:F,name:"laserCut"}),label:"Laser Cut"})}),l.laserCut?e.jsx(o,{item:!0,xs:12,md:4.5,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(i,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:l.laserCutRate,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(i,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:l.pcsForLaserCut,onChange:L,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:Ie,children:"Save"})})]})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ee,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:Te,initialRows:We,setInitialData:C,deleteApi:"http://100.42.177.77:81/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:f,setAccordionExpanded:x,fileName:"Schffili List",isLoading:ne})})})]})]})},ro=no,so=({additionalProcessData:h,setAdditionalProcessData:S,refetchAdditionalProcessList:D,handleClickOpen:ne})=>{const{user:y}=Fe(),[t,C]=a.useState([]),{enqueueSnackbar:l}=Qe(),[g,r]=a.useState({}),[x,q]=a.useState([]),u=t.reduce((w,f)=>w+(f.quantity??0),0).toFixed(2);console.log("Quantity",u);const[M,c]=a.useState({additionalProcessDetId:0,additionalProcessId:h.additionalProcessId||0,designId:h.designNo||"",planningHeaderId:h.planningHeaderId||0,batchNo:h.batchNo||"",componentName:h.componentName||"",componentId:h.componentId||"",colorName:h.colorName||"",colorId:h.colorId||"",fabricName:h.fabricName||"",fabricId:h.fabricId||"",uomId:h.uomId||"",uom:h.uom||"",vendorId:"",pcsPerComponent:h.pcsPerComponent||"",remainingPcsPerComponent:h.pcsPerComponent-u||"",processTypeName:h.processTypeName||"",processTypeId:h.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:y.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:y.empId});a.useEffect(()=>{c(w=>({...w,additionalProcessDetId:x.additionalProcessDetId||0,vendorId:(x==null?void 0:x.vendorId)||"",quantity:(x==null?void 0:x.quantity)||"",ratePerPcs:(x==null?void 0:x.ratePerPcs)||"",remainingPcsPerComponent:w.remainingPcsPerComponent+(x==null?void 0:x.quantity)||"",totalAmount:(x==null?void 0:x.totalAmount)||"",costPerComponent:(x==null?void 0:x.costPerComponent)||0,createdOn:(x==null?void 0:x.createdOn)||new Date().toISOString(),createdBy:(x==null?void 0:x.createdBy)||y.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:y.empId}))},[x]),a.useEffect(()=>{c({...M,remainingPcsPerComponent:h.pcsPerComponent-u>=0?h.pcsPerComponent-u:""})},[t,h.pcsPerComponent,u]);const{data:Y}=Re(),{data:p,refetch:P}=Tt(M.additionalProcessId,{skip:!M.additionalProcessId}),[K,_]=a.useState([]);a.useEffect(()=>{if(Y){const w=Y.result[0];_(w.vendorList)}},[Y]),a.useEffect(()=>{p&&C(p.result.map((w,f)=>({id:f+1,...w})))},[p,P]),console.log("initialRows",t);const z=w=>{const{name:f,value:W}=w.target;c({...M,[f]:W}),c(O=>{const Z={...O,[f]:W};if(f==="quantity"||f==="remainingPcsPerComponent"){const m=Z.quantity,U=Z.remainingPcsPerComponent;m>U?r(E=>({...E,quantity:"Assigned Quantity cannot be greater than Remaining Quantity"})):r(E=>({...E,quantity:""}))}return Z})};a.useEffect(()=>{const w=()=>{const W=parseFloat(M.quantity)||0,O=parseFloat(M.ratePerPcs)||0;return(W*O).toFixed(2)};c(W=>({...W,totalAmount:w()}));const f=()=>{const W=parseFloat(M.totalAmount)||0,O=parseFloat(M.poPcs)||0;return(W/O).toFixed(2)};c(W=>({...W,costPerComponent:f()}))},[M.quantity,M.ratePerPcs,M.totalAmount]);const R=async()=>{if(console.log(M),M.quantity>M.remainingPcsPerComponent){l("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}try{const w=await ve.post("http://100.42.177.77:81/api/AdditionalProcess/SaveAdditionalProcessDetails",M);console.log("Save response:",w.data),w.data.success?l("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(l(`${w.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",w.data.message)),P(),c(f=>({...f,vendorId:"",pcsPerComponent:h.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",remainingPcsPerComponent:h.pcsPerComponent-u||"",createdOn:new Date().toISOString(),createdBy:y.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:y.empId})),D()}catch(w){console.error("Error saving data:",w),l("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},X=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:2},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Ae,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Select Design",name:"designId",value:M.designId,onChange:z,size:"small",disabled:!0,sx:w=>({...M.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:M.batchNo,onChange:z,size:"small",disabled:!0,sx:w=>({...M.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,label:"Components",name:"componentName",value:M.componentName,onChange:z,size:"small",disabled:!0,sx:w=>({...M.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:M.fabricName,onChange:z,disabled:!0,sx:w=>({...M.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:M.colorName,onChange:z,disabled:!0,sx:w=>({...M.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:M.processTypeName,onChange:z,disabled:!0,sx:w=>({...M.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:M.pcsPerComponent,onChange:z,disabled:!0,sx:w=>({...M.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:M.remainingPcsPerComponent,onChange:z,disabled:!0,sx:w=>({...M.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:M.uom,onChange:z,disabled:!0,sx:w=>({...M.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:M.vendorId,onChange:z,disabled:!M.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}},children:K.map(w=>e.jsx(B,{value:w.lookUpId,children:w.lookUpName},w.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:M.quantity,onChange:z,disabled:!M.remainingPcsPerComponent,error:!!g.quantity,helperText:g.quantity,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:M.ratePerPcs,onChange:z,disabled:!M.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:M.totalAmount,onChange:z,disabled:!M.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:R,disabled:!M.remainingPcsPerComponent,children:"Save"})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Ue,{iColumns:X,initialRows:t,setInitialData:q,deleteApi:"http://100.42.177.77:81/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:P})})})]})},lo=({initialValues:h})=>{const{user:S}=Fe(),{enqueueSnackbar:D}=Qe(),[ne,y]=a.useState(!0),[t,C]=a.useState([]),[l,g]=a.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId});console.log("initialData",t),a.useEffect(()=>{g({...l,additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId})},[t]);const[r,x]=a.useState(!1),{data:q}=Ye(),[u,M]=a.useState("");a.useEffect(()=>{M(h.collectionId)},[]);const{data:c}=Re(),{data:Y,refetch:p}=Xe(u,{skip:!u}),{data:P,refetch:K}=_e(l.designId,{skip:!l.designId}),{data:_}=De({batchNo:l.planningHeaderId,componentId:l.componentId},{skip:!l.planningHeaderId||!l.componentId}),{data:z}=et({batchNo:l.planningHeaderId,componentId:l.componentId,fabricId:l.fabricId},{skip:!l.planningHeaderId||!l.componentId||!l.fabricId}),{data:R,refetch:X}=Bt(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:$}=tt(l.planningHeaderId,{skip:!l.planningHeaderId});console.log("lookupData",c),console.log("collectionData",q),console.log("colorData",z);const[w,f]=a.useState([]),[W,O]=a.useState([]),[Z,m]=a.useState([]),[U,E]=a.useState([]),[te,me]=a.useState([]),[ce,he]=a.useState([]),[Ce,v]=a.useState([]),[H,T]=a.useState([]),[V,re]=a.useState([]),[oe,ue]=a.useState([]),[J,j]=a.useState([]);console.log("batchData",P);const[F,L]=a.useState([]);a.useEffect(()=>{q&&L(q.result)},[q]),a.useEffect(()=>{Y&&f(Y.result)},[Y]),a.useEffect(()=>{P&&O(P.result)},[P]),a.useEffect(()=>{_&&m(_.result)},[_]),a.useEffect(()=>{z&&re(z.result)},[z]),a.useEffect(()=>{$&&j($.result)},[$]),a.useEffect(()=>{if(c){const d=c.result[0];me(d.uomList),he(d.processList)}},[c]),a.useEffect(()=>{R&&(y(!1),ue(R.result.map((d,s)=>({id:s+1,...d}))))},[R,X]),a.useEffect(()=>{if(c){const d=c.result[0];E(d.vendorList),v(d.operatingMachineList),T(d.workingHeadList)}},[c]),console.log("initialRows",oe);const A=d=>{const{name:s,value:k}=d.target;if(s==="collectionId")F.find(n=>n.collectionId===parseInt(k)),M(k),ue([]),y(!0),g({...l,collectionId:k,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId});else if(s==="designId"){const n=w.find(b=>b.designId===parseInt(k));ue([]),y(!0),g({...l,designId:k,baseColorId:n?n.colorId:"",baseColorName:n?n.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId})}else if(s==="batchNo"){const n=W.find(b=>b.batchNo===k);g({...l,batchNo:k,planningHeaderId:n?n.planningHeaderId:"",poPcs:n?n.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId}),x(!0)}else g({...l,[s]:k})};console.log("colors",V);const le=async()=>{console.log("formData",l);try{const d=await ve.post("http://100.42.177.77:81/api/AdditionalProcess/SaveAdditionalProcess",l);console.log("Save response:",d.data),d.data.success?D("Process saved successfully!",{variant:"success",autoHideDuration:5e3}):(D(`${d.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",d.data.message)),g(s=>({additionalProcessId:0,designId:s.designId,planningHeaderId:s.planningHeaderId,batchNo:s.batchNo,baseColorName:s.baseColorName,poPcs:s.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:S.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:S.empId})),X()}catch(d){console.error("Error saving data:",d),D("Process not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",l),a.forwardRef(function(s,k){return e.jsx(Ft,{direction:"up",ref:k,...s})});const[Ie,Me]=a.useState({}),[je,ke]=a.useState(!1),Se=d=>{Me(d),ke(!0)},Ne=()=>{ke(!1),Me({}),X()},[Le,we]=a.useState(0);a.useEffect(()=>{const d=oe.reduce((s,k)=>s+(k.assignedQty??0),0).toFixed(2);we(parseFloat(d).toLocaleString())},[oe]);const ae=[...oe,{id:"TOTAL_SUMMARY",assignedQty:Le}],We=[{field:"id",headerName:"Sr#",colSpan:(d,s)=>s.id==="TOTAL_SUMMARY"?4:void 0,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):d.value},{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component",renderCell:d=>e.jsx(qe,{label:d.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity",colSpan:(d,s)=>s.id==="TOTAL_SUMMARY"?3:void 0,valueGetter:d=>d,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:d=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(Be,{color:"primary",onClick:()=>Se(d.row),children:e.jsx(lt,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ke,{src:yt,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:u,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:F.map(d=>e.jsx(B,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:w.map(d=>e.jsx(B,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:W.map(d=>e.jsx(B,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,onChange:A,disabled:!0,sx:d=>({...l.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(i,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:l.componentId,onChange:A,size:"small",InputLabelProps:{sx:{color:"black"}},children:J.map(d=>e.jsx(B,{value:d.componentId,children:d.componentName},d.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:l.fabricId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:Z.map(d=>e.jsx(B,{value:d.fabricId,children:d.fabric},d.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:l.colorId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:V.map(d=>e.jsx(B,{value:d.colorId,children:d.color},d.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:A,disabled:!0,sx:d=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(i,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:l.pcsPerComponent,onChange:A,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:l.uomId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:te.map(d=>e.jsx(B,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:l.processTypeId,onChange:A,InputLabelProps:{sx:{color:"black"}},children:ce.map(d=>e.jsx(B,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(ge,{variant:"contained",size:"small",onClick:le,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ee,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(Ue,{iColumns:We,initialRows:ae,setInitialData:C,deleteApi:"http://100.42.177.77:81/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:X,setAccordionExpanded:x,fileName:"AdditionalProcess",isLoading:ne}),e.jsxs(ot,{open:je,onClose:Ne,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(at,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(be,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Additional Process > Assign Vendors "}),e.jsx(Be,{onClick:Ne,sx:{color:"#ffffff"},children:e.jsx(st,{})})]}),e.jsxs(nt,{children:[e.jsx(rt,{id:"alert-dialog-slide-description"}),e.jsx(so,{additionalProcessData:Ie,setAdditionalProcessData:Me,refetchAdditionalProcessList:X,handleClickOpen:Se})]})]})]})})]})]})},io=lo;function co({initialValues:h}){const[S,D]=a.useState(!0),{data:ne}=Re(),[y,t]=a.useState([]),[C,l]=a.useState([]),[g,r]=a.useState([]),[x,q]=a.useState([]),[u,M]=a.useState([]),[c,Y]=a.useState([]),{user:p}=Fe();a.useEffect(()=>{ne&&(r(ne.result[0].vendorList),l(ne.result[0].serviceList),t(ne.result[0].serviceTypeList),M(ne.result[0].uomList))},[ne]);const[P,K]=a.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()});a.useEffect(()=>{K({...P,additionalServiceId:c.additionalServiceId||0,collectionId:(c==null?void 0:c.collectionId)||"",serviceTypeId:(c==null?void 0:c.serviceTypeId)||"",serviceListId:(c==null?void 0:c.serviceListId)||"",vendorId:(c==null?void 0:c.vendorId)||"",qty:(c==null?void 0:c.qty)||"",uomId:(c==null?void 0:c.uomId)||"",rate:(c==null?void 0:c.rate)||"",totalAmount:(c==null?void 0:c.totalAmount)||0,UOM:(c==null?void 0:c.uom)||0,uom:(c==null?void 0:c.uom)||"",createdOn:(c==null?void 0:c.createdOn)||new Date().toISOString(),createdBy:(c==null?void 0:c.createdBy)||p.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:p.empId})},[c]),a.useEffect(()=>{K({...P,collectionId:(h==null?void 0:h.collectionId)||""})},[K]);const _=async m=>{const{name:U,value:E}=m.target;if(console.log(`Updating ${U} to ${E}`),K({...P,[U]:E}),U==="collectionId"){const te=x.find(me=>me.collectionId===E);te&&K(me=>({...me,poPcs:te.poPcs}))}};a.useEffect(()=>{const m=()=>{const E=parseFloat(P.qty)||0,te=parseFloat(P.rate)||0;return(E*te).toFixed(2)};K(E=>({...E,totalAmount:m()}));const U=()=>{const E=parseFloat(P.poPcs)||0,te=parseFloat(P.totalAmount)||0;return(E/te).toFixed(2)};K(E=>({...E,costperPiece:U()}))},[P.qty,P.rate,P.totalAmount,P.costperPiece]);const z=async()=>{try{const m=await ve.post("http://100.42.177.77:81/api/AdditionalServices/SaveAdditionalServices",P);console.log("Form data saved:",m.data),K({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(m){console.error("Error saving data:",m)}};a.useEffect(()=>{(async()=>{try{const U=await ve.get("http://100.42.177.77:81/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",U),q(U.data.result)}catch(U){console.error("Error fetching design options:",U)}})()},[]);const[R,X]=a.useState([]),$=a.useCallback(async()=>{try{const m=await ve.get(`http://100.42.177.77:81/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${P.collectionId}`);Array.isArray(m.data.result)?(D(!1),X(m.data.result.map((U,E)=>({id:E+1,...U})))):(console.error("API returned unexpected data format:",m.data.result),X([]))}catch(m){console.error("Error fetching data:",m),X([])}},[P.collectionId]);a.useEffect(()=>{$()},[$]);const[w,f]=a.useState(0);a.useEffect(()=>{const m=R.reduce((U,E)=>U+(E.totalAmount??0),0).toFixed(2);f(parseFloat(m).toLocaleString())},[R]);const W=[...R,{id:"TOTAL_SUMMARY",totalAmount:w}],O=[{field:"id",headerName:"Sr#",colSpan:(m,U)=>U.id==="TOTAL_SUMMARY"?4:void 0,renderCell:m=>m.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):m.value},{field:"collectionName",headerName:"Collection Name"},{field:"serviceType",headerName:"Service Type",renderCell:m=>e.jsx(qe,{label:m.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"serviceListName",headerName:"Service List Name",renderCell:m=>e.jsx(qe,{label:m.value,sx:{backgroundColor:"success.dark",color:"white"},color:void 0})},{field:"vendor",headerName:"Vendor"},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount",colSpan:(m,U)=>U.id==="TOTAL_SUMMARY"?3:void 0,renderCell:m=>m.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:m.value}):m.value},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:P.collectionId,onChange:_,size:"small",InputLabelProps:{sx:{color:"black"}},children:x.length>0?x.map(m=>e.jsx(B,{id:"collectionId",value:m.collectionId,children:m.collectionName},m.collectionId)):e.jsx(B,{disabled:!0,children:"No Collections Available"})})}),e.jsx(o,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:P.serviceTypeId,onChange:_,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:y.map(m=>e.jsx(B,{value:m.lookUpId,children:m.lookUpName},m.lookUpId))})}),e.jsx(o,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:P.serviceListId,onChange:_,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:C.map(m=>e.jsx(B,{value:m.lookUpId,children:m.lookUpName},m.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:P.vendorId,onChange:_,InputLabelProps:{sx:{color:"black"}},children:g.map(m=>e.jsx(B,{value:m.lookUpId,children:m.lookUpName},m.lookUpId))})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:P.poPcs,onChange:_,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:m=>({...P.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-required",label:"Qty",name:"qty",value:P.qty,onChange:_,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(i,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:P.uomId,onChange:_,InputLabelProps:{sx:{color:"black"}},children:u.map(m=>e.jsx(B,{value:m.lookUpId,children:m.lookUpName},m.lookUpId))})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-required",label:"Rate",name:"rate",value:P.rate,onChange:_,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:P.totalAmount,onChange:_,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(i,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:P.costperPiece,onChange:_,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(ge,{variant:"contained",color:"primary",size:"small",onClick:z,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Ue,{iColumns:O,initialRows:W,isLoading:S,setInitialData:Y,deleteApi:"http://100.42.177.77:81/api/AdditionalServices/DeleteAdditionalProcess?servicesId=",refetch:$,deleteBy:"additionalServiceId"})]})]})}Qt(Rt)(({theme:h})=>({backgroundColor:h.palette.primary.main,color:h.palette.primary.light,overflow:"hidden",position:"relative","&:after":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(210.04deg, ${h.palette.grey[400]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,borderRadius:"50%",top:-30,right:-180},"&:before":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(140.9deg, ${h.palette.grey[400]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,borderRadius:"50%",top:-160,right:-130}}));const uo=({initialValues:h,setActiveStep:S,collectionId:D,setInitialValues:ne})=>{var T,V,re,oe,ue,J;Fe(),Qe(),a.useState([]);const{data:y}=Ye(),[t,C]=a.useState(null),[l,g]=a.useState(!1);$e();const[r,x]=a.useState(D||""),q=j=>{H.current&&H.current.autosizeColumns&&H.current.autosizeColumns({includeOutliers:!0,includeHeaders:!0})},[u,M]=a.useState({designId:"",planningHeaderId:0,batchNo:""});a.useEffect(()=>{ne({collectionId:(u==null?void 0:u.collectionId)||"",designId:(u==null?void 0:u.designId)||"",planningHeaderId:(u==null?void 0:u.planningHeaderId)||"",batchNo:(u==null?void 0:u.batchNo)||""})},[u.collectionId,u.designId,u==null?void 0:u.batchNo]);const{data:c,refetch:Y}=Xe(r,{skip:!r}),{data:p,refetch:P}=_e(u.designId,{skip:!u.designId}),[K,_]=a.useState([]),[z,R]=a.useState([]),[X,$]=a.useState([]);a.useEffect(()=>{y&&$(y.result)},[y]),a.useEffect(()=>{c&&_(c.result)},[c]),a.useEffect(()=>{p&&R(p.result)},[p]);const w=j=>{const{name:F,value:L}=j.target;if(console.log(`handleChange called with name: ${F}, value: ${L}`),F==="collectionId")x(L),M({...u,collectionId:L,designId:"",planningHeaderId:0,batchNo:""});else if(F==="designId")M({...u,designId:L,planningHeaderId:0});else if(F==="batchNo"){const A=z.find(le=>le.batchNo===L);M({...u,batchNo:L,planningHeaderId:A?A.planningHeaderId:""}),A&&f(A.planningHeaderId)}else M({...u,[F]:L})};console.log("Selected collection ID:",r),console.log("Form data:",u),console.log("Design list:",K),console.log("Batch list:",z);const f=async j=>{g(!0);try{const F=await ve.get(`http://100.42.177.77:81/api/PrePlanning/GetPrePlanningSummaryByBatchId?planningHeaderId=${j}`);F.data.success?C(F.data.result):console.error(F.data.message)}catch(F){console.error("Failed to fetch summary data",F)}finally{g(!1)}};console.log(t);const W=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"planningProcessTypeName",headerName:"Process Type"},{field:"componentsCount",headerName:"Components Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalFabricSum",headerName:"Total Fabric Sum"},{field:"totalFabricRequiredSum",headerName:"Total Fabric Required Sum"}],O=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalExcGst",headerName:"Total Excluding GST"},{field:"totalIncGst",headerName:"Total Including GST"}],Z=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"processType",headerName:"Process Type"},{field:"assignedQtySum",headerName:"Assigned Qty Sum"},{field:"availableQtySum",headerName:"Available Qty Sum"},{field:"colorCount",headerName:"Color Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"outputQtySum",headerName:"Output Qty Sum"},{field:"totalIncGst",headerName:"Total Including GST"}],m=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150},{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150},{field:"requiredPcsSum",headerName:"Required Pcs Sum",width:150},{field:"totalAmountSum",headerName:"Total Amount Sum",width:150}],U=[{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"totalPcsSum",headerName:"Total Pcs Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150}],E=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"pcsPerComponent",headerName:"Pcs Per Component",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150}],te=((T=t==null?void 0:t.prePlanningList)==null?void 0:T.map((j,F)=>({id:F,...j})))||[],me=((V=t==null?void 0:t.fabricationList)==null?void 0:V.map((j,F)=>({id:F,...j})))||[],ce=((re=t==null?void 0:t.dyeingPrintingList)==null?void 0:re.map((j,F)=>({id:F,...j})))||[],he=((oe=t==null?void 0:t.embroideryList)==null?void 0:oe.map((j,F)=>({id:F,...j})))||[],Ce=((ue=t==null?void 0:t.schiffiliList)==null?void 0:ue.map((j,F)=>({id:F,...j})))||[],v=((J=t==null?void 0:t.additionalProcessList)==null?void 0:J.map((j,F)=>({id:F,...j})))||[],H=qt();return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:r,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:X.map(j=>e.jsx(B,{value:j.collectionId,children:j.collectionName},j.collectionId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:u.designId,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:K.map(j=>e.jsx(B,{value:j.designId,children:j.designNo},j.designId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:u.batchNo,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:z.map(j=>e.jsx(B,{value:j.batchNo,children:j.batchNo},j.batchNo))})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,mb:1}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(ye,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:1,width:"inherit",sx:{paddingY:1,paddingX:1},children:e.jsx(o,{item:!0,xs:12,md:12,paddingTop:1,children:l?e.jsx(Ae,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(dt,{})}):t?e.jsxs(e.Fragment,{children:[e.jsx(be,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(0),children:"Pre Planning"}),e.jsx(Ge,{rows:te,columns:W,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,onStateChange:q,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(de,{color:"#921e22",sx:{height:3,width:"100%",mb:1}}),e.jsx(be,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(1),children:"Fabrication"}),e.jsx(Ge,{rows:me,columns:O,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%",mt:1,mb:1}}),e.jsx(be,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(2),children:"Dyeing"}),e.jsx(Ge,{rows:ce,columns:Z,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(be,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(3),children:"Embroidery"}),e.jsx(Ge,{rows:he,columns:m,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(be,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(4),children:"Schiffli"}),e.jsx(Ge,{rows:Ce,columns:U,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(be,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>S(5),children:"Additional Process"}),e.jsx(Ge,{rows:v,columns:E,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}})]}):e.jsx(dt,{})})})]})]})},ut=uo,Ve=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services","Summary"];function vo(){const[h,S]=a.useState(0),[D,ne]=a.useState(new Set),[y,t]=a.useState(null),[C,l]=a.useState([]),{enqueueSnackbar:g}=Qe(),{data:r,refetch:x}=Re(),[q,u]=a.useState({});console.log("initialValues",q);const M=O=>{t(O.currentTarget)},c=()=>{t(null)},Y=!!y,p=Y?"simple-popover":void 0,P=O=>O===1,K=O=>D.has(O),_=()=>{let O=D;K(h)&&(O=new Set(O.values()),O.delete(h)),S(Z=>Z+1),ne(O)},z=()=>{S(O=>O-1)},R=()=>{if(!P(h))throw new Error("You can't skip a step that isn't optional.");S(O=>O+1),ne(O=>{const Z=new Set(O.values());return Z.add(h),Z})},X=()=>{S(0)},[$,w]=a.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),f=async()=>{if(!$.lookUpDomain||!$.lookUpName){g("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const O=await ve.get(`http://100.42.177.77:81/api/Common/SaveLookUp?lookupDomain=${$.lookUpDomain}&LookUpName=${$.lookUpName}&appId=1`);return console.log("Form data saved:",O.data),g("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),w({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),x(),O.data}catch(O){throw console.error("Error saving data:",O),g("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),O}},W=O=>{w({...$,[O.target.name]:O.target.value})};return a.useEffect(()=>{(async()=>{try{const Z=await ve.get("http://100.42.177.77:81/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",Z),l(Z.data.result)}catch(Z){console.error("Error fetching design options:",Z)}})()},[]),e.jsxs(Ae,{sx:{width:"100%"},children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,sm:6,children:e.jsx(be,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(o,{item:!0,sm:6,textAlign:"right",children:[e.jsx(ge,{"aria-describedby":p,variant:"outlined",size:"small",onClick:M,children:"+Lookup"}),e.jsx(Et,{id:"mouse-over-popover",open:Y,anchorEl:y,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(o,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(o,{item:!0,sm:12,children:e.jsx(i,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:$.lookUpDomain,name:"lookUpDomain",onChange:W,children:C.map(O=>e.jsx(B,{value:O.lookUpDomain,children:O.lookUpDomain},O.lookUpDomain))})}),e.jsx(o,{item:!0,sm:12,children:e.jsx(i,{fullWidth:!0,label:"Add Lookup Description",value:$.lookUpName,onChange:W,name:"lookUpName",size:"small"})}),e.jsx(o,{item:!0,sm:3,textAlign:"right",children:e.jsx(ge,{variant:"contained",size:"small",onClick:f,children:"Save"})})]})})]})]}),e.jsx(Wt,{activeStep:h,children:Ve.map((O,Z)=>{const m={},U={};return P(Z)&&(U.optional=e.jsx(be,{variant:"caption"})),K(Z)&&(m.completed=!1),e.jsx(zt,{...m,children:e.jsxs(Ut,{...U,onClick:()=>S(Z),style:{cursor:"pointer"},children:[" ",O]})},O)})}),e.jsxs(Ae,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ge,{color:"inherit",disabled:h===0,onClick:z,sx:{mr:1},children:"Back"}),e.jsx(Ae,{sx:{flex:"1 1 auto"}}),P(h)&&e.jsx(ge,{color:"inherit",onClick:R,sx:{mr:1},children:"Skip"}),e.jsx(ge,{onClick:_,children:h===Ve.length-1?"Finish":"Next"})]}),h===Ve.length?e.jsxs(a.Fragment,{children:[e.jsx(ut,{setActiveStep:S}),e.jsxs(Ae,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Ae,{sx:{flex:"1 1 auto"}}),e.jsx(ge,{onClick:X,children:"Reset"})]})]}):e.jsxs(a.Fragment,{children:[h===0&&e.jsx(eo,{setInitialValues:u,initialValues:q}),h===1&&e.jsx(Ht,{setInitialValues:u,initialValues:q}),h===2&&e.jsx(ao,{initialValues:q}),h===3&&e.jsx($t,{initialValues:q}),h===4&&e.jsx(ro,{initialValues:q}),h===5&&e.jsx(io,{initialValues:q}),h===6&&e.jsx(co,{initialValues:q}),h===7&&e.jsx(ut,{setActiveStep:S,setInitialValues:u,initialValues:q}),e.jsxs(Ae,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ge,{color:"inherit",disabled:h===0,onClick:z,sx:{mr:1},children:"Back"}),e.jsx(Ae,{sx:{flex:"1 1 auto"}}),P(h)&&e.jsx(ge,{color:"inherit",onClick:R,sx:{mr:1},children:"Skip"}),e.jsx(ge,{onClick:_,children:h===Ve.length-1?"Finish":"Next"})]})]})]})}export{vo as default};
