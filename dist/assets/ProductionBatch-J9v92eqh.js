import{I as K,J as Z,j as t,u as _,af as F,ag as ee,B as T,C as A,d as $,G as n,T as te,D as Q,c as ae,ah as re,ai as se,M as oe}from"./index-k9GWQJOu.js";import{r as a}from"./vendor-BXCbSo2_.js";import{I as W,B as ne,a as de}from"./axios-CaswPiu6.js";import{d as le}from"./AddCircleOutlineOutlined-DpKzaeF_.js";import{R as q,a as ce,b as ie,c as ue,d as me,u as he,D as pe}from"./ReuseableDataGrid-D6KGNruf.js";import{d as fe}from"./VisibilityOutlined-6VCp2fDn.js";import{S as xe}from"./StatusChip-DQNIzaKK.js";import{d as ge}from"./Close-CwC_dym4.js";import{T as m}from"./TextField-Bw61L3Ab.js";import{T as Ie,a as be,b as V,c as U}from"./TabPanel-CYIvsX5V.js";import{M as Ne}from"./MenuItem-BJ2KxKJk.js";import"./Skeleton-C1-xTFDk.js";var H={},je=Z;Object.defineProperty(H,"__esModule",{value:!0});var X=H.default=void 0,Se=je(K()),De=t;X=H.default=(0,Se.default)((0,De.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2m0 16H5V7h14zm-7-8.5c1.84 0 3.48.96 4.34 2.5-.86 1.54-2.5 2.5-4.34 2.5s-3.48-.96-4.34-2.5c.86-1.54 2.5-2.5 4.34-2.5M12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 5.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"PreviewOutlined");const ve=({handleChangeTabs:c})=>{_(),a.useState([]);const[e,y]=a.useState({});console.log("initialFormData",e);const[R,M]=a.useState(!1),[l,b]=a.useState({fromDate:"",toDate:"",productionId:(e==null?void 0:e.productionId)||0,collectionId:(e==null?void 0:e.collectionName)||"",orderNumber:(e==null?void 0:e.orderNumber)||"",launchDate:(e==null?void 0:e.launchDate)||"",status:(e==null?void 0:e.statusName)||"",remarks:(e==null?void 0:e.remarks)||""});a.useEffect(()=>{b({productionId:(e==null?void 0:e.productionId)||0,collectionId:(e==null?void 0:e.collectionName)||"",orderNumber:(e==null?void 0:e.orderNumber)||"",launchDate:new Date(e==null?void 0:e.launchDate).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})||"",status:(e==null?void 0:e.statusName)||"",remarks:(e==null?void 0:e.remarks)||""})},[e,y]);const[N,L]=a.useState([]),[j,w]=a.useState([]),{data:u,refetch:g}=F(),{data:o,refetch:x}=ee(l.productionId,{skip:!l.productionId}),[E,z]=a.useState([]);a.useEffect(()=>{g(),u&&L(u.result.map((s,i)=>({id:i+1,...s})))},[u,g,c]),a.useEffect(()=>{o&&w(o.result.map((s,i)=>({id:i+1,...s})))},[o,x]),console.log("initialRows",N),console.log("batchDetailsRows",j);const h=s=>{const{name:i,value:p}=s.target;if(i==="collectionId"){const O=E.find(G=>G.collectionId===parseInt(p));b({...l,collectionId:p,orderNumber:O?O.orderNumber:""})}else b({...l,[i]:p})};console.log("formData",l);const[P,S]=a.useState(!1),D=s=>{y(s),S(!0)},k=()=>{S(!1),y({})},v=[{field:"id",headerName:"Sr#"},{field:"productionId",headerName:"Production Id"},{field:"collectionName",headerName:"Collection Name"},{field:"brandName",headerName:"Brand Name"},{field:"seasonName",headerName:"Season Name"},{field:"launchDate",headerName:"Launch Date",valueGetter:s=>new Date(s).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"remarks",headerName:"Remarks"},{field:"statusName",headerName:"Status"},{field:"View",headerName:"View Details",renderCell:s=>t.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:t.jsx(W,{color:"primary",onClick:()=>D(s.row),children:t.jsx(fe,{})})})}],B=[{field:"id",headerName:"Sr#"},{field:"designNo",headerName:"Design"},{field:"designerName",headerName:"Designer Name"},{field:"poPcs",headerName:"POPcs"},{field:"colorName",headerName:"Color"},{field:"planningDate",headerName:"Planning Date",valueGetter:s=>new Date(s).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"launchDate",headerName:"Launch Date",valueGetter:s=>new Date(s).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"remarks",headerName:"Remarks"},{field:"statusName",headerName:"Status Name",renderCell:s=>t.jsx(xe,{label:s.row.statusName,status:"In Process"})},{field:"designCount",headerName:"Design Count"},{field:"brandName",headerName:"Brand Name"},{field:"seasonName",headerName:"Season Name"},{field:"volume",headerName:"Volume"}];return t.jsxs(T,{sx:{width:"100%",typography:"body1"},children:[t.jsxs(A,{variant:"outlined",children:[t.jsx($,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Production Batches",titleTypographyProps:{style:{color:"white"}}}),t.jsx(n,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:t.jsxs(n,{item:!0,xs:12,children:[t.jsx(q,{initialRows:N,iColumns:v,setIsEdit:M,hideAction:!0}),t.jsxs(ce,{open:P,onClose:k,fullWidth:!0,maxWidth:"xl",children:[t.jsxs(ie,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[t.jsx(te,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Details"}),t.jsx(W,{onClick:k,sx:{color:"#ffffff"},children:t.jsx(ge,{})})]}),t.jsxs(ue,{children:[t.jsx(me,{id:"alert-dialog-slide-description"}),t.jsxs(n,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{label:"Collection",fullWidth:!0,size:"small",name:"collectionId",onChange:h,value:l.collectionId,required:!0,disabled:!0})}),t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{label:"Order Number",fullWidth:!0,size:"small",name:"orderNumber",onChange:h,value:l.orderNumber,required:!0,disabled:!0})}),t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{size:"small",label:"Launch Date",name:"launchDate",value:l.launchDate,onChange:h,fullWidth:!0,disabled:!0,InputLabelProps:{shrink:!0,sx:{color:"black"}}})}),t.jsx(n,{item:!0,xs:12,md:8,children:t.jsx(m,{label:"Remarks",fullWidth:!0,size:"small",name:"remarks",onChange:h,value:l.remarks,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{label:"Status",fullWidth:!0,size:"small",name:"status",onChange:h,value:l.status,required:!0,disabled:!0})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(q,{initialRows:j,iColumns:B,hideAction:!0})})]})," "]})]})]})})," "]}),t.jsx(Q,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})]})},He=()=>{const{user:c}=_(),[e,y]=a.useState([]),[R,M]=a.useState(!1),[l,b]=a.useState([]),[N,L]=a.useState({}),[j,w]=a.useState([]),u=he(),{enqueueSnackbar:g}=ae(),[o,x]=a.useState({productionId:0,collectionId:"",orderNumber:"",launchDate:"",remarks:"",productionBatchDetails:[l],appId:c.appId,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});console.log("formData",o);const[E,z]=a.useState("1"),h=(r,d)=>{z(d)};a.useEffect(()=>{x({productionId:(e==null?void 0:e.productionId)||0,collectionId:(e==null?void 0:e.collectionId)||"",orderNumber:(e==null?void 0:e.orderNumber)||"",launchDate:(e==null?void 0:e.launchDate)||"",remarks:(e==null?void 0:e.remarks)||"",appId:(e==null?void 0:e.appId)||c.appId,createdOn:(e==null?void 0:e.createdOn)||new Date().toISOString(),createdBy:(e==null?void 0:e.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[e]);const[P,S]=a.useState([]);a.useState(!1);const{data:D,refetch:k}=re(),{data:v,refetch:B}=se(o.collectionId,{skip:!o.collectionId}),[s,i]=a.useState([]);a.useEffect(()=>{D&&i(D.result.map((r,d)=>({id:d+1,...r})))},[D,k]),a.useEffect(()=>{v&&S(v.result.map((r,d)=>({id:d+1,...r})))},[v,B]),console.log("initialRows",P);const p=r=>{const{name:d,value:I}=r.target;if(d==="collectionId"){const f=s.find(C=>C.collectionId===parseInt(I));x({...o,collectionId:I,orderNumber:f?f.orderNumber:""})}else x({...o,[d]:I})},O=()=>{const r={};return o.launchDate||(r.launchDate="Launch Date is required"),r},G=async()=>{const r=O();if(Object.keys(r).length>0){L(r);return}if(j.length===0){g("Please select at least one row before saving!",{variant:"warning",autoHideDuration:5e3});return}try{const d=await de.post("http://100.42.177.77:8091/api/Production/SaveProductionBatchHeader",o);g("Production Header saved successfully!",{variant:"success",autoHideDuration:5e3}),console.log("Save response:",d.data),x(I=>({productionId:0,collectionId:"",orderNumber:"",launchDate:"",remarks:"",appId:c.appId,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),w([]),S([]),B()}catch(d){console.error("Error saving data:",d),g("Production Header not saved !",{variant:"error",autoHideDuration:5e3})}};console.log("formData",o);const Y=[{field:"id",headerName:"Sr#"},{field:"orderNumber",headerName:"Order Number"},{field:"designNo",headerName:"Design No."},{field:"designerName",headerName:"DesignerName"},{field:"poPcs",headerName:"PO Pcs.."},{field:"planningDate",headerName:"Date Of Planning",valueGetter:r=>new Date(r).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"colorName",headerName:"Color"}],J=a.useCallback(r=>{w(r);const d=r.map(f=>{const C=u.current.getRow(f);return console.log("rowData",C),C?C.planningHeaderId:null}).filter(f=>f!==null);console.log("planningHeaderIds",d);const I=d.map(f=>({prodctionDetId:0,productionId:0,planningHeaderId:f,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedBy:c.empId,lastUpdatedOn:new Date().toISOString()}));b(I)},[u]);return a.useEffect(()=>{x({...o,productionBatchDetails:l})},[l]),a.useEffect(()=>{u.current&&console.log("API ref is ready:",u.current)},[u]),console.log("selectedDesigns:",l),t.jsx(oe,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:t.jsx(T,{sx:{width:"100%",typography:"body1"},children:t.jsxs(Ie,{value:E,children:[t.jsx(T,{sx:{borderBottom:1,borderColor:"divider"},children:t.jsxs(be,{onChange:h,"aria-label":"lab API tabs example",children:[t.jsx(V,{icon:t.jsx(le,{}),label:"Production Initialization",value:"1",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),t.jsx(V,{icon:t.jsx(X,{}),label:"View Production Batches",value:"2",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})})]})}),t.jsxs(U,{value:"1",children:[t.jsxs(A,{variant:"outlined",children:[t.jsx($,{className:"css-4rfrnx-MuiCardHeader-root",title:"Production Batch",titleTypographyProps:{style:{color:"white"}}}),t.jsxs(n,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{label:"Collection",fullWidth:!0,select:!0,size:"small",name:"collectionId",onChange:p,value:o.collectionId,required:!0,disabled:R,children:s.map(r=>t.jsx(Ne,{value:r.collectionId,children:r.collectionName},r.collectionId))})}),t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{label:"Order Number",fullWidth:!0,size:"small",name:"orderNumber",onChange:p,value:o.orderNumber,required:!0,disabled:R})}),t.jsx(n,{item:!0,xs:12,md:4,children:t.jsx(m,{size:"small",type:"date",label:"Launch Date",name:"launchDate",value:o.launchDate,onChange:p,fullWidth:!0,error:!!N.launchDate,helperText:N.launchDate,InputLabelProps:{shrink:!0,sx:{color:"black"}}})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(m,{label:"Remarks",fullWidth:!0,size:"small",name:"remarks",onChange:p,value:o.remarks,InputLabelProps:{sx:{color:"black"}}})}),t.jsx(n,{item:!0,xs:12,children:t.jsx("div",{style:{height:400,width:"100%"},children:t.jsx(pe,{rows:P,columns:Y,apiRef:u,checkboxSelection:!0,onRowSelectionModelChange:J,rowSelectionModel:j})})}),t.jsx(n,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:t.jsx(ne,{variant:"contained",size:"small",onClick:G,children:"Save"})})]})," "]}),t.jsx(Q,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),t.jsx(n,{container:!0,spacing:2,width:"Inherit"})]}),t.jsx(U,{value:"2",children:t.jsx(ve,{handleChangeTabs:h})})]})})})};export{He as default};
