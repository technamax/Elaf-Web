import{j as e,_ as Ze,r as Ke,l as $e,R as _e,u as Se,c as Ae,a5 as ke,b as Ne,a6 as Oe,a7 as Le,a8 as Ee,a9 as Be,aa as De,ab as Me,C as V,d as J,ac as We,G as a,D as de,T as je,ad as et,ae as tt,af as st,ag as rt,ah as at,ai as ot,B as ve,aj as nt,ak as lt}from"./index-DnIh2Wd7.js";import{r as o}from"./vendor-BXCbSo2_.js";import{I as Ce,B as $,a as se}from"./axios-DRu-V1sv.js";import{d as Te,c as he,A as we,e as ze,f as Fe,S as dt,a as it,b as ct,F as ut}from"./Fabrication-BENAr0Bp.js";import{d as Re}from"./VisibilityOutlined-zghBNVnL.js";import{l as qe,R as Pe,D as mt,a as ht,b as pt,c as gt}from"./ReuseableDataGrid-DFNlQ0al.js";import{T as l,P as ft}from"./TextField-NjIbNAS4.js";import{M as N}from"./Skeleton-CxEcuNdD.js";import{A as Ue,F as Ye,C as Xe}from"./ExcelExport-DdhRZJhP.js";import"./dayjs.min-DO4_1a-m.js";import{d as xt}from"./Close-ec_L8JKK.js";import{d as It}from"./PersonAddAlt1Outlined-BXHiAKM4.js";let Ge=!1;const bt=o.forwardRef(function(t,c){return Ge||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),Ge=!0),e.jsx(Ue,Ze({ref:c},t))});var Qe={},vt=$e;Object.defineProperty(Qe,"__esModule",{value:!0});var Ve=Qe.default=void 0,jt=vt(Ke()),yt=e;Ve=Qe.default=(0,jt.default)((0,yt.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",St=()=>{const g=_e(),{user:t}=Se(),{enqueueSnackbar:c}=Ae(),[s,d]=o.useState([]),[u,W]=o.useState(!1),[n,I]=o.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],costPerComponent:"",createdBy:t.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId});o.useEffect(()=>{I({embroideryId:(s==null?void 0:s.embroideryId)||0,designId:(s==null?void 0:s.designId)||"",batchNo:(s==null?void 0:s.batchNo)||"",planningHeaderId:(s==null?void 0:s.planningHeaderId)||"",componentId:(s==null?void 0:s.componentId)||"",fabricId:(s==null?void 0:s.fabricId)||"",vendorId:(s==null?void 0:s.vendorId)||"",poPcs:(s==null?void 0:s.poPcs)||"",baseColorId:(s==null?void 0:s.baseColorId)||"",baseColorName:(s==null?void 0:s.baseColorName)||"",colorId:(s==null?void 0:s.colorId)||"",availableQty:(s==null?void 0:s.availableQty)||"",noOfHead:(s==null?void 0:s.noOfHead)||"",repeats:(s==null?void 0:s.repeats)||"",cuttingSize:(s==null?void 0:s.cuttingSize)||"",itemsPerRepeat:(s==null?void 0:s.itemsPerRepeat)||"",totalPcs:(s==null?void 0:s.totalPcs)||"",totalAmount:(s==null?void 0:s.totalAmount)||"",threadStiches:(s==null?void 0:s.threadStiches)||"",threadRate:(s==null?void 0:s.threadRate)||"",threadAmount:(s==null?void 0:s.threadAmount)||"",tillaStiches:(s==null?void 0:s.tillaStiches)||"",tilaRate:(s==null?void 0:s.tilaRate)||"",tilaAmount:(s==null?void 0:s.tilaAmount)||"",sequence:(s==null?void 0:s.sequence)||"",sequenceRate:(s==null?void 0:s.sequenceRate)||"",sequenceAmount:(s==null?void 0:s.sequenceAmount)||"",isSolving:(s==null?void 0:s.isSolving)||!1,solvingLayers:(s==null?void 0:s.solvingLayers)||0,solvingInMeters:(s==null?void 0:s.solvingInMeters)||"",solvingRate:(s==null?void 0:s.solvingRate)||0,solvingAmount:(s==null?void 0:s.solvingAmount)||"",threadAdditional:(s==null?void 0:s.threadAdditional)||[],costPerComponent:(s==null?void 0:s.costPerComponent)||"",createdOn:(s==null?void 0:s.createdOn)||new Date().toISOString(),createdBy:(s==null?void 0:s.createdBy)||t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId})},[s]);const Q=["Boring","Pooni","Laser","Doori","Dissolving"];function Y(m,y,r){return{fontWeight:y.indexOf(m)===-1?r.typography.fontWeightRegular:r.typography.fontWeightMedium}}const{data:v}=ke(),[R,E]=o.useState(""),{data:B}=Ne(),{data:H,refetch:G}=Oe(R,{skip:!R}),{data:M,refetch:Z}=Le(n.designId,{skip:!n.designId}),{data:h}=Ee({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:T}=Be({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:k,refetch:U}=De(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:j}=Me(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("formData.planningHeaderId",n.planningHeaderId),console.log("collectionData",v);const[q,_]=o.useState(!1),D=(m,y)=>{_(!q)},[pe,ie]=o.useState([]),[ae,oe]=o.useState([]),[ge,ne]=o.useState([]),[Ie,re]=o.useState([]),[ce,te]=o.useState([]),[ee,P]=o.useState([]),[O,ue]=o.useState([]),[fe,me]=o.useState([]);console.log("batchList",ae),console.log("formData",n),o.useEffect(()=>{H&&ie(H.result)},[H]),o.useEffect(()=>{M&&oe(M.result)},[M]),o.useEffect(()=>{h&&ne(h.result)},[h]),o.useEffect(()=>{T&&P(h.result)},[T]),o.useEffect(()=>{j&&me(j.result)},[j]),o.useEffect(()=>{k&&ue(k.result.map((m,y)=>({id:y,...m})))},[k,U]),console.log("embroideryList",k),console.log("initialRows",O),o.useEffect(()=>{if(B){const m=B.result[0];re(m.vendorList),te(m.noOfHeadsList)}},[B]);const le=(v==null?void 0:v.result)||[];o.useEffect(()=>{const m=()=>{const z=parseFloat(n.repeats)||0,X=parseFloat(n.itemsPerRepeat)||0;return(z*X).toFixed(2)};I(z=>({...z,totalPcs:m()}));const y=()=>{const z=parseFloat(n.threadStiches)||0,X=parseFloat(n.threadRate)||0,xe=parseFloat(n.noOfHead)||0,ye=parseFloat(n.repeats)||0;return(z/1e3*(X*ye*xe)).toFixed(2)};I(z=>({...z,threadAmount:y()}));const r=()=>{const z=parseFloat(n.tillaStiches)||0,X=parseFloat(n.tilaRate)||0,xe=parseFloat(n.noOfHead)||0,ye=parseFloat(n.repeats)||0;return(z/1e3*(X*ye*xe)).toFixed(2)};I(z=>({...z,tilaAmount:r()}));const i=()=>{const z=parseFloat(n.sequence)||0,X=parseFloat(n.sequenceRate)||0,xe=parseFloat(n.noOfHead)||0,ye=parseFloat(n.repeats)||0;return(z/1e3*(X*ye*xe)).toFixed(2)};I(z=>({...z,sequenceAmount:i()}));const f=()=>{const z=parseFloat(n.repeats)||0,X=parseFloat(n.noOfHead)||0,xe=parseFloat(n.solvingLayers)||0;return(z*X*13/39.37*xe).toFixed(2)};I(z=>({...z,solvingInMeters:f()}));const C=()=>{const z=parseFloat(n.solvingInMeters)||0,X=parseFloat(n.solvingRate)||0;return parseFloat(n.solvingLayers),(z*X).toFixed(2)};I(z=>({...z,solvingAmount:C()}));const L=()=>{const z=parseFloat(n.threadAmount)||0,X=parseFloat(n.tilaAmount)||0,xe=parseFloat(n.sequenceAmount)||0,ye=parseFloat(n.solvingAmount)||0;return(z+X+xe+ye).toFixed(2)};I(z=>({...z,totalAmount:L()}));const be=()=>{const z=parseFloat(n.totalAmount)||0,X=parseFloat(n.totalPcs)||0;return(z/X).toFixed(2)};I(z=>({...z,costPerComponent:be()}))},[n.threadAmount,n.totalAmount,n.sequenceAmount,n.solvingAmount,n.repeats,n.tilaAmount,n.itemsPerRepeat,n.threadRate,n.threadStiches,n.noOfHead,n.tilaRate,n.tillaStiches,n.sequenceRate,n.sequence,n.solvingLayers,n.solvingInMeters,n.solvingRate]);const A=m=>{const{name:y,checked:r}=m.target;I(i=>({...i,[y]:r}))},b=m=>{const{name:y,value:r}=m.target;if(y==="collectionId")le.find(i=>i.collectionId===parseInt(r)),E(r),W(!0),I({...n,collectionId:r,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],costPerComponent:""});else if(y==="designId"){const i=pe.find(f=>f.designId===parseInt(r));I({...n,designId:r,baseColorId:i?i.colorId:"",baseColorName:i?i.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],costPerComponent:""})}else if(y==="colorId"){const i=ee.find(f=>f.colorId===r);I({...n,colorId:r,availableQty:i?i.total:"",cuttingSize:i?i.cuttingSize:"",repeats:i?i.repeats:""})}else if(y==="batchNo"){const i=ae.find(f=>f.batchNo===r);I({...n,batchNo:r,planningHeaderId:i?i.planningHeaderId:"",poPcs:i?i.poPcs:"",componentId:"",fabricId:"",vendorId:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],costPerComponent:""}),_(!0),W(!1)}else I({...n,[y]:r}),S(i=>({...i,[y]:""}))},[p,S]=o.useState({}),w=async()=>{const m=F();if(Object.keys(m).length>0){S(m);return}try{const y=await se.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroidery",{...n,threadAdditional:n.threadAdditional.join(", ")});console.log("Save response:",y.data),y.data.success?c("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(c(`${y.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",y.data.message)),I(r=>({embroideryId:0,designId:r.designId,batchNo:r.batchNo,planningHeaderId:r.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:r.poPcs,baseColorId:r.baseColorId,baseColorName:r.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId})),U()}catch(y){console.error("Error saving data:",y),c("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},F=()=>{const m={};return n.fabricId||(m.fabricId="fabricId is required"),n.colorId||(m.colorId="colorId is required"),n.vendorId||(m.vendorId="vendorId is required"),n.componentId||(m.componentId="componentId is required"),n.noOfHead||(m.noOfHead="noOfHead is required"),n.itemsPerRepeat||(m.itemsPerRepeat="itemsPerRepeat is required"),n.threadStiches||(m.threadStiches="threadStiches is required"),n.threadRate||(m.threadRate="threadRate is required"),n.tillaStiches||(m.tillaStiches="tillaStiches is required"),n.tilaRate||(m.tilaRate="tilaRate is required"),n.sequence||(m.sequence="sequence is required"),n.sequenceRate||(m.sequenceRate="sequenceRate is required"),m};console.log("initialRows",O);const K=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component "},{field:"fabricName",headerName:"Fabric "},{field:"vendorId",headerName:"Vendor"},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"availableQty",headerName:"Available Qty"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"totalPcs",headerName:"Total Pcs"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"threadAdditional",headerName:"ThreadAdditional"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:Ct,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:R,onChange:b,size:"small",children:le.map(m=>e.jsx(N,{value:m.collectionId,children:m.collectionName},m.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:b,size:"small",children:pe.map(m=>e.jsx(N,{value:m.designId,children:m.designNo},m.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:b,size:"small",children:ae.map(m=>e.jsx(N,{value:m.batchNo,children:m.batchNo},m.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:b,disabled:!0})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"Add Embroidery",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Ce,{onClick:D,sx:{mt:"-18px"},children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(we,{expanded:q,onChange:D,sx:{},children:[e.jsx(ze,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsxs(Fe,{children:[e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:b,size:"small",required:!0,error:!!p.componentId,helperText:p.componentId,children:fe.map(m=>e.jsx(N,{value:m.componentId,children:m.componentName},m.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:b,required:!0,error:!!p.fabricId,helperText:p.fabricId,children:ge.map(m=>e.jsx(N,{value:m.fabricId,children:m.fabric},m.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:n.vendorId,onChange:b,required:!0,error:!!p.vendorId,helperText:p.vendorId,children:Ie.map(m=>e.jsx(N,{value:m.lookUpId,children:m.lookUpName},m.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:b,required:!0,error:!!p.colorId,helperText:p.colorId,children:ee.map(m=>e.jsx(N,{value:m.colorId,children:m.color},m.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:b,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:n.availableQty,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:n.repeats,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:n.noOfHead,onChange:b,required:!0,error:!!p.noOfHead,helperText:p.noOfHead,children:ce.map(m=>e.jsx(N,{value:m.lookUpId,children:m.lookUpName},m.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:n.cuttingSize,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"itemsPerRepeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:n.itemsPerRepeat,onChange:b,required:!0,error:!!p.itemsPerRepeat,helperText:p.itemsPerRepeat})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:n.totalPcs,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:n.totalAmount,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:n.costPerComponent,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{select:!0,label:"Additional",value:n.threadAdditional,name:"threadAdditional",size:"small",onChange:b,fullWidth:!0,SelectProps:{multiple:!0},children:Q.map(m=>e.jsx(N,{value:m,style:Y(m,n.threadAdditional,g),children:m},m))})}),e.jsx(a,{item:!0,xs:12,md:4}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(je,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:n.threadStiches,onChange:b,required:!0,error:!!p.threadStiches,helperText:p.threadStiches})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:n.threadRate,onChange:b,required:!0,error:!!p.threadRate,helperText:p.threadRate})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:n.threadAmount,onChange:b})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(je,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:n.tillaStiches,onChange:b,required:!0,error:!!p.tillaStiches,helperText:p.tillaStiches})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:n.tilaRate,onChange:b,required:!0,error:!!p.tilaRate,helperText:p.tilaRate})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:n.tilaAmount,onChange:b})})]})}),e.jsxs(a,{item:!0,xs:12,md:6,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(je,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:n.sequence,onChange:b,required:!0,error:!!p.sequence,helperText:p.sequence})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:n.sequenceRate,onChange:b,required:!0,error:!!p.sequenceRate,helperText:p.sequenceRate})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:n.sequenceAmount,onChange:b})})]})," "]}),n.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(je,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:n.solvingLayers,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:n.solvingInMeters,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:n.solvingRate,onChange:b})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:n.solvingAmount,onChange:b})})]})}):null,e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(Ye,{control:e.jsx(Xe,{checked:n.isSolving,onChange:A,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx($,{variant:"contained",size:"small",onClick:w,children:"Save"})})]})," "]})," "]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Re,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[" ",u?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(Pe,{iColumns:K,initialRows:O,setInitialData:d,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:U,setAccordionExpanded:_,fileName:"Embroidery List"})]})})]})]})},Pt=St,Nt=()=>{const{user:g}=Se();console.log("user",g);const[t,c]=o.useState([]),[s,d]=o.useState([]),[u,W]=o.useState({processType:"",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedBy:g.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",u),o.useEffect(()=>{W({processType:(t==null?void 0:t.processType)||"",planningId:(t==null?void 0:t.planningId)||0,collectionId:(t==null?void 0:t.collectionId)||"",baseColorId:(t==null?void 0:t.baseColorId)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",noOfDesigns:(t==null?void 0:t.noOfDesigns)||"",noOfColors:(t==null?void 0:t.noOfColors)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||"",designId:(t==null?void 0:t.designId)||"",batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",colorId:(t==null?void 0:t.colorId)||"",fabricId:(t==null?void 0:t.fabricId)||"",noOfHeads:(t==null?void 0:t.noOfHeads)||"",operatingMachineId:(t==null?void 0:t.operatingMachineId)||"",repeats:(t==null?void 0:t.repeats)||"",repeatSize:(t==null?void 0:t.repeatSize)||"",uomId:(t==null?void 0:t.uomId)||"",totalFabric:(t==null?void 0:t.totalFabric)||"",shrinkage:(t==null?void 0:t.shrinkage)||"",wastage:(t==null?void 0:t.wastage)||"",total:(t==null?void 0:t.total)||"",appId:1,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||g.empId,lastUpdatedBy:g.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:(t==null?void 0:t.isSchiffili)||!1,repeatsInMtr:(t==null?void 0:t.repeatsInMtr)||""})},[t]);const{data:n}=ke(),[I,Q]=o.useState(""),{data:Y,refetch:v}=Oe(I,{skip:!I}),{data:R,refetch:E}=et(u.planningHeaderId,{skip:!u.planningHeaderId}),[B,H]=o.useState([]),{enqueueSnackbar:G}=Ae();o.useEffect(()=>{Y&&(H(Y.result),v())},[Y]),o.useEffect(()=>{R&&d(R.result.map((r,i)=>({id:i,...r})))},[R,E]),console.log("designList",B),console.log("collectionData",n);const M=(n==null?void 0:n.result)||[],[Z,h]=o.useState(!1),[T,k]=o.useState([]),[U,j]=o.useState([]),[q,_]=o.useState([]),[D,pe]=o.useState([]),[ie,ae]=o.useState([]),[oe,ge]=o.useState([]),[ne,Ie]=o.useState([]),[re,ce]=o.useState([]);o.useEffect(()=>{(async()=>{try{const f=(await se.get("https://gecxc.com:4041/API/Common/GetPrePlanningLookUp?appID=1")).data.result[0];_(f.componentList),ae(f.colorList),pe(f.fabricList),Ie(f.noOfHeadsList),ge(f.uom),k(f.planningTypeProcessList),j(f.operatingMachineList)}catch(i){console.error("Error fetching pre-planning lookup data:",i)}})()},[]),o.useEffect(()=>{const r=async i=>{try{const f=await se.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${i}`);console.log(f.data),ce(f.data.result)}catch(f){console.error("Error fetching pre-planning lookup data:",f)}};u.designId&&r(u.designId)},[u.designId,u.planningHeaderId]),o.useEffect(()=>{const r=()=>{const L=parseFloat(u.repeats)||0,be=parseFloat(u.repeatSize)||0,z=(L*be).toFixed(2);return parseFloat(z).toLocaleString()};W(L=>({...L,totalFabric:r()}));const i=()=>{const L=parseFloat(u.totalFabric.replace(/,/g,""))||0,be=parseFloat(u.shrinkage)||0,z=parseFloat(u.wastage)||0,X=(L*(100+(be+z))/100).toFixed(2);return parseFloat(X).toLocaleString()};W(L=>({...L,total:i()}));const f=()=>(parseFloat(u.repeats),(.9144*(parseFloat(u.repeatSize)||0)).toFixed(2));W(L=>({...L,repeatsInMtr:f()}));const C=()=>{const L=parseFloat(u.repeats)||0;return((parseFloat(u.repeatsInMtr)||0)*L).toFixed(2)};W(L=>({...L,totalFabric:L.isSchiffili?C():r()}))},[u.repeats,u.repeatSize,u.totalFabric,u.shrinkage,u.wastage,u.repeatsInMtr,u.isSchiffili]);const[te,ee]=o.useState(!1);o.useState(!1);const P=r=>{const{name:i,value:f}=r.target;if(i==="collectionId"){const C=M.find(L=>L.collectionId===parseInt(f));h(!0),Q(f),W({...u,processType:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",operatingMachineId:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:f,noOfDesigns:C?C.noOfDesigns:"",noOfColors:C?C.noOfColors:""})}else if(i==="designId"){const C=B.find(L=>L.designId===parseInt(f));W({...u,processType:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",operatingMachineId:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:f,baseColorId:C?C.colorId:"",baseColorName:C?C.colorName:""})}else if(i==="batchNo"){const C=re.find(L=>L.batchNo===f);W({...u,componentId:"",processType:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",operatingMachineId:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:f,planningHeaderId:C?C.planningHeaderId:""}),ee(!0),h(!1)}else W({...u,[i]:f})},[O,ue]=o.useState({}),fe=async()=>{const r=me();if(Object.keys(r).length>0){ue(r);return}try{const i={...u,totalFabric:parseFloat(u.totalFabric.replace(/,/g,"")),total:parseFloat(u.total.replace(/,/g,""))},f=await se.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",i);console.log("Data saved successfully:",f.data),console.log("Save response:",f.data),f.data.success?G("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(G(`${f.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",f.data.message)),W(C=>({processType:"",planningId:0,collectionId:C.collectionId,designId:C.designId,batchNo:C.batchNo,planningHeaderId:C.planningHeaderId,baseColorId:C.baseColorId,baseColorName:C.baseColorName,noOfDesigns:C.noOfDesigns,noOfColors:C.noOfColors,componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",operatingMachineId:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId,isSchiffili:!1,repeatsInMtr:""})),E()}catch(i){console.error("Error saving data:",i),G("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},me=()=>{const r={};return u.componentId||(r.componentId="componentId is required"),u.colorId||(r.colorId="colorId is required"),u.fabricId||(r.fabricId="fabricId is required"),u.cuttingSize||(r.cuttingSize="cuttingSize is required"),u.noOfHeads||(r.noOfHeads="noOfHeads is required"),u.repeats||(r.repeats="repeats is required"),u.repeatSize||(r.repeatSize="repeatSize is required"),u.uomId||(r.uomId="uomId is required"),u.shrinkage||(r.shrinkage="shrinkage is required"),u.wastage||(r.wastage="wastage is required"),r};console.log("initialRows",s);const le=s.reduce((r,i)=>r+(i.totalFabric??0),0).toFixed(2),A=parseFloat(le).toLocaleString();console.log("localizedTotalFabric",A);const b=s.reduce((r,i)=>r+(i.total??0),0).toFixed(2),p=parseFloat(b).toLocaleString(),S=[...s,{id:"TOTAL_FABRIC",label:"Total Fabric",totalFabric:A,total:p}],w={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",S);const F=[{field:"componentName",headerName:"Component",...w,colSpan:(r,i)=>{if(i.id==="TOTAL_FABRIC")return 7},valueGetter:(r,i)=>i.id==="TOTAL_FABRIC"?i.label:r},{field:"color",headerName:"Color",...w},{field:"cuttingSize",headerName:"Cutting Size",...w},{field:"fabric",headerName:"Fabrication",...w},{field:"noOfHeadName",headerName:"No. Of Heads",...w},{field:"repeats",headerName:"Repeats",valueGetter:r=>r.toLocaleString(),...w},{field:"repeatSize",headerName:"Repeat Size",valueGetter:r=>r.toLocaleString(),...w},{field:"totalFabric",headerName:"Total Fabric",valueGetter:r=>r.toLocaleString(),...w},{field:"uom",headerName:"UOM",colSpan:(r,i)=>{if(i.id==="TOTAL_FABRIC")return 4},valueGetter:(r,i)=>i.id==="TOTAL_FABRIC"?"OverAll Total":r},{field:"isSchiffili",headerName:"Is Shiffili"},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:r=>r.toLocaleString(),colSpan:(r,i)=>{if(i.id==="TOTAL_FABRIC")return 2}}],K=u.processType==="Schiffili",x=({row:r,field:i})=>r.id==="TOTAL_FABRIC"&&(i==="componentName"||i==="uom")?"bold":"";console.log("batchList:",re);const m="https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",y=(r,i)=>{ee(!te)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:u.collectionId,onChange:P,size:"small",required:!0,children:M.map(r=>e.jsx(N,{value:r.collectionId,children:r.collectionName},r.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:u.designId,onChange:P,size:"small",required:!0,children:B.map(r=>e.jsx(N,{value:r.designId,children:r.designNo},r.designId))})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:u.batchNo,onChange:P,size:"small",required:!0,children:re.map(r=>e.jsx(N,{value:r.batchNo,children:r.batchNo},r.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"No of Design",fullWidth:!0,size:"small",name:"noOfDesigns",value:u.noOfDesigns,onChange:P,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"No of Color",fullWidth:!0,size:"small",name:"noOfColors",value:u.noOfColors,onChange:P,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:u.baseColorName,onChange:P,disabled:!0})})]})]})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"MainCard",avatar:e.jsx(Te,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Ce,{onClick:y,sx:{mt:"-18px"},children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(we,{expanded:te,onChange:y,sx:{},children:[e.jsx(ze,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Fe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",name:"processType",value:u.processType,onChange:P,size:"small",required:!0,children:T.map(r=>e.jsx(N,{value:r.lookUpName,children:r.lookUpName},r.lookUpId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(Ue,{fullWidth:!0,options:q,getOptionLabel:r=>r.lookUpName,value:q.find(r=>r.lookUpId===u.componentId)||null,onChange:(r,i)=>{P({target:{name:"componentId",value:i?i.lookUpId:""}})},renderOption:(r,i)=>{const{lookUpName:f}=i;return e.jsx("span",{...r,children:f})},renderInput:r=>e.jsx(l,{...r,label:"Select Component",size:"small",name:"componentId",value:u.componentId,required:!0,error:!!O.componentId,helperText:O.componentId,sx:{backgroundColor:"white","& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[" ",e.jsx(Ue,{fullWidth:!0,options:ie,getOptionLabel:r=>r.lookUpName,value:ie.find(r=>r.lookUpId===u.colorId)||null,onChange:(r,i)=>{P({target:{name:"colorId",value:i?i.lookUpId:""}})},renderInput:r=>e.jsx(l,{...r,label:"Color",size:"small",value:u.colorId,name:"colorId",required:!0,error:!!O.colorId,helperText:O.colorId,sx:{backgroundColor:"white","& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:u.cuttingSize,onChange:P,required:!0,error:!!O.cuttingSize,helperText:O.cuttingSize})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(Ue,{fullWidth:!0,options:D,getOptionLabel:r=>r.lookUpName,value:D.find(r=>r.lookUpId===u.fabricId)||null,onChange:(r,i)=>{P({target:{name:"fabricId",value:i?i.lookUpId:""}})},renderInput:r=>e.jsx(l,{...r,label:"Fabrication",size:"small",name:"fabricId",value:u.fabricId,required:!0,error:!!O.fabricId,helperText:O.fabricId,sx:{backgroundColor:"white","& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})}),e.jsx(a,{item:!0,xs:12,md:2,children:K?e.jsx(l,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:u.operatingMachineId,onChange:P,required:!0,children:U.map(r=>e.jsx(N,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))}):e.jsx(l,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:u.noOfHeads,onChange:P,required:!0,error:!!O.noOfHeads,helperText:O.noOfHeads,children:ne.map(r=>e.jsx(N,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:u.repeats,onChange:P,error:!!O.repeats,helperText:O.repeats,required:!0})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:u.repeatSize,onChange:P,error:!!O.repeatSize,helperText:O.repeatSize,required:!0})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:u.totalFabric,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:u.uomId,onChange:P,error:!!O.uomId,helperText:O.uomId,required:!0,disabled:u.isSchiffili,children:oe.map(r=>e.jsx(N,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:u.shrinkage,onChange:P,error:!!O.shrinkage,helperText:O.shrinkage,required:!0})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:u.wastage,onChange:P,error:!!O.wastage,helperText:O.wastage,required:!0})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Total",fullWidth:!0,size:"small",name:"total",value:u.total,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(a,{container:!0,spacing:1,width:"Inherit",children:e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"repeat in mtr",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:u.repeatsInMtr,onChange:P})})})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",children:e.jsx($,{variant:"contained",size:"small",onClick:fe,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"MainCard",avatar:e.jsx(Re,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{sx:{paddingY:1,paddingX:1},children:e.jsx(a,{sx:{},item:!0,xs:12,children:Z?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(Pe,{iColumns:F,initialRows:S,setInitialData:c,deleteApi:m,deleteBy:"planningId",refetch:E,getCellClassName:x,setAccordionExpanded:ee,fileName:"PrePlanningList"})})})]})]})},At=Nt,kt="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",Ot=()=>{const{user:g}=Se();console.log("user",g);const[t,c]=o.useState([]),[s,d]=o.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:"",poPcs:"",baseColorName:"",createdBy:g.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId});o.useEffect(()=>{d({dpId:t.dpId||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",color:(t==null?void 0:t.color)||"",vendorId:(t==null?void 0:t.vendorId)||"",processType:(t==null?void 0:t.processType)||"",AvailableQty:(t==null?void 0:t.availableQty)||"",Shrinkage:(t==null?void 0:t.shrinkage)||"",Wastage:(t==null?void 0:t.wastage)||"",OutputQty:(t==null?void 0:t.outputQty)||0,UOM:(t==null?void 0:t.uom)||0,uomId:(t==null?void 0:t.uomId)||"",RatePerUOM:(t==null?void 0:t.ratePerUOM)||0,UnitRatePerPo:(t==null?void 0:t.unitRatePerPo)||"",TotalExclGst:(t==null?void 0:t.totalExclGst)||"",GST:(t==null?void 0:t.gst)||"",TotalIncludingGst:(t==null?void 0:t.totalIncludingGst)||"",poPcs:(t==null?void 0:t.poPcs)||0,baseColorName:(t==null?void 0:t.baseColorName)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||g.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId})},[t]);const{enqueueSnackbar:u}=Ae(),[W,n]=o.useState(!1);console.log("Dyeing form data to send",s);const{data:I}=ke(),[Q,Y]=o.useState(""),{data:v}=Ne(),{data:R,refetch:E}=Oe(Q,{skip:!Q}),{data:B,refetch:H}=Le(s.designId,{skip:!s.designId}),{data:G}=tt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:M}=st({fabricId:s.fabricId,planningHeaderId:s.planningHeaderId},{skip:!s.fabricId||!s.planningHeaderId}),{data:Z,refetch:h}=rt(s.planningHeaderId,{skip:!s.planningHeaderId}),[T,k]=o.useState([]),[U,j]=o.useState([]),[q,_]=o.useState([]),[D,pe]=o.useState([]),[ie,ae]=o.useState([]),[oe,ge]=o.useState([]),[ne,Ie]=o.useState([]),[re,ce]=o.useState(!1);console.log("batchList",U),console.log("formData",s);const te=(p,S)=>{ce(!re)};o.useEffect(()=>{R&&k(R.result)},[R]),o.useEffect(()=>{B&&j(B.result)},[B]),o.useEffect(()=>{G&&_(G.result)},[G]),o.useEffect(()=>{M&&ge(M.result)},[M]),o.useEffect(()=>{v&&Ie(v.result[0].vendorList)},[G]),console.log(ne),o.useEffect(()=>{Z&&ae(Z.result.map((p,S)=>({id:S,...p})))},[Z,h]),o.useEffect(()=>{if(v){const p=v.result[0];pe(p.uomList)}},[v]);const ee=(I==null?void 0:I.result)||[],P=p=>{const{name:S,value:w}=p.target;if(S==="collectionId")ee.find(F=>F.collectionId===parseInt(w)),Y(w),n(!0),d({...s,collectionId:w,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:"",poPcs:"",baseColorName:""});else if(S==="designId"){const F=T.find(K=>K.designId===parseInt(w));d({...s,designId:w,baseColorId:F?F.colorId:"",baseColorName:F?F.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:"",poPcs:""})}else if(S==="batchNo"){const F=U.find(K=>K.batchNo===w);d({...s,batchNo:w,planningHeaderId:F?F.planningHeaderId:"",poPcs:F?F.poPcs:"",fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:""}),ce(!0),n(!1)}else if(S==="fabricId")q.find(F=>F.fabricId===w),console.log("Selected Fabric:",q),d({...s,fabricId:w});else if(S==="ColorId"){const F=oe.find(K=>K.colorId===w.colorId);d({...s,ColorId:w.colorId,color:F.color,AvailableQty:F.total,UOM:F.uom,Shrinkage:F.shrinkage,Wastage:F.wastage})}else S==="processType"?d({...s,processType:w}):S==="vendorId"?d({...s,vendorId:w}):(d({...s,[S]:w}),ue(F=>({...F,[S]:""})))};o.useEffect(()=>{const p=()=>{const i=parseFloat(s.AvailableQty)||0,f=parseFloat(s.Shrinkage)||0,C=parseFloat(s.Wastage)||0;return(i*(100-(f+C))/100).toFixed(2)},S=()=>{const i=parseFloat(s.AvailableQty)||0,f=parseFloat(s.RatePerUOM)||0;return(i*f).toFixed(2)},w=(i,f)=>(i*(1+f/100)).toFixed(2),F=p(),K=S(),x=parseFloat(s.GST)||0,m=w(K,x),y=parseFloat(s.poPcs)||0,r=y?m/y:0;d(i=>({...i,OutputQty:F,TotalExclGst:K,TotalIncludingGst:m,UnitRatePerPo:r.toFixed(2)}))},[s.AvailableQty,s.Shrinkage,s.Wastage,s.RatePerUOM,s.GST,s.poPcs,s.UnitRatePerPo]);const[O,ue]=o.useState({}),fe=async()=>{const p=me();if(Object.keys(p).length>0){ue(p);return}try{const S=await se.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",s);console.log("Save response:",S.data),S.data.success?u("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(u(`${S.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",S.data.message)),d(w=>({designId:w.designId,planningHeaderId:w.planningHeaderId,batchNo:w.batchNo,dpId:0,fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:"",poPcs:w.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId})),h()}catch(S){console.error("Error saving data:",S),u("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},me=()=>{const p={};return s.fabricId||(p.fabricId="fabricId is required"),s.colorId||(p.colorId="colorId is required"),s.vendorId||(p.vendorId="vendorId is required"),s.processType||(p.processType="processType is required"),s.GST||(p.GST="GST is required"),s.RatePerUOM||(p.RatePerUOM="RatePerUOM is required"),p},le=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],A=[{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"vendorName",headerName:"Vendor"},{field:"processType",headerName:"Process Type"},{field:"uom",headerName:"uom"},{field:"availableQty",headerName:"Available Quantitity"},{field:"shrinkage",headerName:"Shrinkage"},{field:"wastage",headerName:"Wastage"},{field:"outputQty",headerName:"Output Qty"},{field:"ratePerUOM",headerName:"Rate"},{field:"totalExclGst",headerName:"Total Excl. Gst"},{field:"gst",headerName:"GST"},{field:"totalIncludingGst",headerName:"Total Including GST"},{field:"unitRatePerPo",headerName:"UnitRate Per Po."}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:kt,sx:{background:"transparent"}}),title:"Dyeing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:Q,onChange:P,size:"small",children:ee.map(p=>e.jsx(N,{value:p.collectionId,children:p.collectionName},p.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:P,size:"small",children:T.map(p=>e.jsx(N,{value:p.designId,children:p.designNo},p.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:P,size:"small",children:U.map(p=>e.jsx(N,{value:p.batchNo,children:p.batchNo},p.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:P,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:P,error:!!O.fabricId,helperText:O.fabricId,required:!0,children:q.map(p=>e.jsx(N,{value:p.fabricId,children:p.fabric},p.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(bt,{fullWidth:!0,options:oe,getOptionLabel:p=>p.color||"",renderInput:p=>e.jsx(l,{...p,label:"Color",name:"colorId",size:"small",error:!!O.colorId,helperText:O.colorId,required:!0}),value:oe.find(p=>p.colorId===s.colorId)||null,onChange:(p,S)=>{d(w=>({...w,colorId:S?S.colorId:"",color:S?S.color:"",AvailableQty:S?S.total:"",UOM:S?S.uom:"",uomId:S?S.uomId:"",Shrinkage:S?S.shrinkage:"",Wastage:S?S.wastage:""}))}})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"Add Dyeing ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Ce,{onClick:te,sx:{mt:"-18px"},children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(we,{expanded:re,onChange:te,sx:{},children:[e.jsx(ze,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Fe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:s.vendorId,onChange:P,error:!!O.vendorId,helperText:O.vendorId,required:!0,children:ne.map(p=>e.jsx(N,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:s.processType,onChange:P,error:!!O.processType,helperText:O.processType,required:!0,children:le.map(p=>e.jsx(N,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,onChange:P,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:s.UOM,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"AvailableQty",fullWidth:!0,size:"small",type:"number",name:"AvailableQty",value:s.AvailableQty,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Shrinkage%",type:"number",fullWidth:!0,size:"small",name:"Shrinkage",value:s.Shrinkage,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Wastage%",fullWidth:!0,size:"small",type:"number",name:"Wastage",value:s.Wastage,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",type:"number",value:s.OutputQty,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"RatePerUOM",value:s.RatePerUOM,onChange:P,error:!!O.RatePerUOM,helperText:O.RatePerUOM,required:!0})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Excluding GST",type:"number",fullWidth:!0,size:"small",name:"TotalExclGst",value:s.TotalExclGst,onChange:P})}),e.jsxs(a,{item:!0,xs:12,md:1.5,children:[e.jsx(l,{label:"GST",fullWidth:!0,type:"number",size:"small",name:"GST",value:s.GST,onChange:P,error:!!O.GST,helperText:O.GST,required:!0})," "]}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:s.TotalIncludingGst,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:s.UnitRatePerPo,onChange:P})}),e.jsx(a,{item:!0,xs:12,md:12,textAlign:"right",children:e.jsx($,{variant:"contained",color:"primary",size:"small",onClick:fe,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Re,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{item:!0,xs:12,md:12,paddingTop:1,children:W?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(Pe,{iColumns:A,initialRows:ie,setInitialData:c,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:h,setAccordionExpanded:ce,fileName:"Dyeing&PrintingList"})})})]})]})},Tt=Ot,Je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",wt=()=>{const{user:g}=Se(),{enqueueSnackbar:t}=Ae(),[c,s]=o.useState([]),[d,u]=o.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:g.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId});o.useEffect(()=>{u({schiffiliId:c.schiffiliId||0,designId:(c==null?void 0:c.designId)||"",planningHeaderId:(c==null?void 0:c.planningHeaderId)||0,batchNo:(c==null?void 0:c.batchNo)||"",componentId:(c==null?void 0:c.componentId)||"",poPcs:(c==null?void 0:c.poPcs)||"",baseColorName:(c==null?void 0:c.baseColorName)||"",fabricId:(c==null?void 0:c.fabricId)||"",vendorId:(c==null?void 0:c.vendorId)||"",colorId:(c==null?void 0:c.colorId)||"",availableQty:(c==null?void 0:c.availableQty)||"",thaanQty:(c==null?void 0:c.thaanQty)||0,operatingMachineId:(c==null?void 0:c.operatingMachineId)||0,operatingMachine:(c==null?void 0:c.operatingMachine)||"",workingHeadId:(c==null?void 0:c.workingHeadId)||0,cuttingSize:(c==null?void 0:c.cuttingSize)||"",rate:(c==null?void 0:c.rate)||"",costPerComponent:(c==null?void 0:c.costPerComponent)||"",totalEmbroidry:(c==null?void 0:c.totalEmbroidry)||0,noOfItemPerThaan:(c==null?void 0:c.noOfItemPerThaan)||0,noOfStichesPerYard:(c==null?void 0:c.noOfStichesPerYard)||0,amountPerYard:(c==null?void 0:c.amountPerYard)||0,totalPcs:(c==null?void 0:c.totalPcs)||0,laserCut:(c==null?void 0:c.laserCut)||!1,laserCutRate:(c==null?void 0:c.laserCutRate)||0,pcsForLaserCut:(c==null?void 0:c.pcsForLaserCut)||0,totalAmount:(c==null?void 0:c.totalAmount)||0,createdOn:(c==null?void 0:c.createdOn)||new Date().toISOString(),createdBy:(c==null?void 0:c.createdBy)||g.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId})},[c]);const[W,n]=o.useState(!1),I=(x,m)=>{n(!W)},[Q,Y]=o.useState(!1),{data:v}=ke(),[R,E]=o.useState(""),{data:B}=Ne(),{data:H,refetch:G}=Oe(R,{skip:!R}),{data:M,refetch:Z}=Le(d.designId,{skip:!d.designId}),{data:h}=Ee({batchNo:d.planningHeaderId,componentId:d.componentId},{skip:!d.planningHeaderId||!d.componentId}),{data:T}=Be({batchNo:d.planningHeaderId,componentId:d.componentId,fabricId:d.fabricId},{skip:!d.planningHeaderId||!d.componentId||!d.fabricId}),{data:k,refetch:U}=at(d.planningHeaderId,{skip:!d.planningHeaderId}),{data:j}=Me(d.planningHeaderId,{skip:!d.planningHeaderId});console.log("formData.planningHeaderId",d.planningHeaderId),console.log("collectionData",v),console.log("schiffliList",k);const[q,_]=o.useState([]),[D,pe]=o.useState([]),[ie,ae]=o.useState([]),[oe,ge]=o.useState([]),[ne,Ie]=o.useState([]),[re,ce]=o.useState([]),[te,ee]=o.useState([]),[P,O]=o.useState([]),[ue,fe]=o.useState([]);o.useEffect(()=>{H&&_(H.result)},[H]),o.useEffect(()=>{M&&pe(M.result)},[M]),o.useEffect(()=>{h&&ae(h.result)},[h]),o.useEffect(()=>{T&&ee(h.result)},[T]),o.useEffect(()=>{j&&fe(j.result)},[j]),o.useEffect(()=>{k&&O(k.result.map((x,m)=>({id:m,...x})))},[k,U]),o.useEffect(()=>{if(B){const x=B.result[0];ge(x.vendorList),Ie(x.operatingMachineList),ce(x.workingHeadList)}},[B]),console.log("initialRows",P);const me=(v==null?void 0:v.result)||[];o.useEffect(()=>{const x=()=>{const f=parseFloat(d.thaanQty)||0,C=parseFloat(d.operatingMachine)||0;return(f*C).toFixed(2)};u(f=>({...f,totalEmbroidry:x()}));const m=()=>{const f=parseFloat(d.thaanQty)||0,C=parseFloat(d.noOfStichesPerYard)||0;return(f*C).toFixed(2)};u(f=>({...f,totalPcs:m()}));const y=()=>{const f=parseFloat(d.noOfStichesPerYard)||0,C=parseFloat(d.rate)||0;return(f/1e3*C).toFixed(2)};u(f=>({...f,amountPerYard:y()}));const r=()=>{const f=parseFloat(d.totalAmount)||0,C=parseFloat(d.totalPcs)||0;return(f/C).toFixed(2)};u(f=>({...f,costPerComponent:r()}));const i=()=>{const f=parseFloat(d.amountPerYard)||0,C=parseFloat(d.totalEmbroidry)||0,L=parseFloat(d.laserCutRate)||0,be=parseFloat(d.pcsForLaserCut)||0;return(f*C+be*L).toFixed(2)};u(f=>({...f,totalAmount:i()}))},[d.thaanQty,d.operatingMachine,d.noOfStichesPerYard,d.rate,d.totalAmount,d.totalPcs,d.amountPerYard,d.totalEmbroidry,d.laserCutRate,d.pcsForLaserCut]);const le=x=>{const{name:m,checked:y}=x.target;u(r=>({...r,[m]:y}))},A=x=>{const{name:m,value:y}=x.target;if(m==="collectionId")me.find(r=>r.collectionId===parseInt(y)),E(y),Y(!0),u({...d,collectionId:y,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(m==="designId"){const r=q.find(i=>i.designId===parseInt(y));u({...d,designId:y,baseColorId:r?r.colorId:"",baseColorName:r?r.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(m==="batchNo"){const r=D.find(i=>i.batchNo===y);u({...d,batchNo:y,planningHeaderId:r?r.planningHeaderId:"",poPcs:r?r.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),n(!0),Y(!1)}else if(m==="colorId"){const r=te.find(i=>i.colorId===y);u({...d,colorId:y,availableQty:r?r.total:"",cuttingSize:r?r.cuttingSize:"",repeats:r?r.repeats:""})}else if(m==="operatingMachineId"){const r=ne.find(i=>i.lookUpId===y);u({...d,operatingMachineId:y,operatingMachine:r?r.lookUpName:""})}else u({...d,[m]:y})};console.log("colors",te);const[b,p]=o.useState({}),S=async()=>{const x=w();if(Object.keys(x).length>0){p(x);return}try{const m=await se.post("https://gecxc.com:4041/api/Schiffli/SaveSchiffili",d);console.log("Save response:",m.data),m.data.success?t("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(t(`${m.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",m.data.message)),u(y=>({designId:y.designId,planningHeaderId:y.planningHeaderId,batchNo:y.batchNo,baseColorName:y.baseColorName,schiffiliId:0,componentId:"",poPcs:y.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId})),U()}catch(m){console.error("Error saving data:",m),t("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},w=()=>{const x={};return d.fabricId||(x.fabricId="fabricId is required"),d.colorId||(x.colorId="colorId is required"),d.vendorId||(x.vendorId="vendorId is required"),d.componentId||(x.componentId="componentId is required"),d.thaanQty||(x.thaanQty="thaanQty is required"),d.workingHeadId||(x.workingHeadId="workingHeadId is required"),d.rate||(x.rate="rate is required"),d.operatingMachineId||(x.operatingMachineId="operatingMachineId is required"),d.noOfStichesPerYard||(x.noOfStichesPerYard="noOfStichesPerYard is required"),d.noOfItemPerThaan||(x.noOfItemPerThaan="noOfItemPerThaan is required"),x};console.log("formData",d);const F=[{field:"componentName",headerName:"Component"},{field:"fabricName",headerName:"Fabric"},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"No. Of Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"No. Of Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry"},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Pcs.For Laser Cut"}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:Je,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:R,onChange:A,size:"small",children:me.map(x=>e.jsx(N,{value:x.collectionId,children:x.collectionName},x.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:d.designId,onChange:A,size:"small",children:q.map(x=>e.jsx(N,{value:x.designId,children:x.designNo},x.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:d.batchNo,onChange:A,size:"small",children:D.map(x=>e.jsx(N,{value:x.batchNo,children:x.batchNo},x.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:d.componentId,onChange:A,size:"small",required:!0,error:!!b.componentId,helperText:b.componentId,children:ue.map(x=>e.jsx(N,{value:x.componentId,children:x.componentName},x.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:d.baseColorName,onChange:A,disabled:!0})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Ce,{onClick:I,sx:{mt:"-18px"},children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(we,{expanded:W,onChange:I,sx:{},children:[e.jsx(ze,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Fe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:d.fabricId,onChange:A,required:!0,error:!!b.fabricId,helperText:b.fabricId,children:ie.map(x=>e.jsx(N,{value:x.fabricId,children:x.fabric},x.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:d.vendorId,onChange:A,required:!0,error:!!b.vendorId,helperText:b.vendorId,children:oe.map(x=>e.jsx(N,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:d.colorId,onChange:A,required:!0,error:!!b.colorId,helperText:b.colorId,children:te.map(x=>e.jsx(N,{value:x.colorId,children:x.color},x.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:d.poPcs,disabled:!0,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:d.availableQty,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:d.thaanQty,onChange:A,required:!0,error:!!b.thaanQty,helperText:b.thaanQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"operatingMachineId",defaultValue:"",size:"small",name:"operatingMachineId",value:d.operatingMachineId,onChange:A,required:!0,error:!!b.operatingMachineId,helperText:b.operatingMachineId,children:ne.map(x=>e.jsx(N,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"workingHeadId",defaultValue:"",size:"small",name:"workingHeadId",value:d.workingHeadId,onChange:A,required:!0,error:!!b.workingHeadId,helperText:b.workingHeadId,children:re.map(x=>e.jsx(N,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:d.cuttingSize,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:d.rate,onChange:A,required:!0,error:!!b.rate,helperText:b.rate})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"No. Of Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:d.noOfStichesPerYard,onChange:A,required:!0,error:!!b.noOfStichesPerYard,helperText:b.noOfStichesPerYard})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"No. Of Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:d.noOfItemPerThaan,onChange:A,required:!0,error:!!b.noOfItemPerThaan,helperText:b.noOfItemPerThaan})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:d.totalEmbroidry,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:d.amountPerYard,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:d.totalPcs,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:d.costPerComponent,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:d.totalAmount,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(Ye,{control:e.jsx(Xe,{checked:d.laserCut,onChange:le,name:"laserCut"}),label:"Laser Cut"})}),d.laserCut?e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(l,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:d.laserCutRate,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(l,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:d.pcsForLaserCut,onChange:A})})]})}):null,e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx($,{variant:"contained",size:"small",onClick:S,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Re,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:Q?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(Pe,{iColumns:F,initialRows:P,setInitialData:s,deleteApi:"https://gecxc.com:4041/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:U,setAccordionExpanded:n,fileName:"Schffili List"})})})]})]})},zt=wt,Ft=({additionalProcessData:g,setAdditionalProcessData:t,refetchAdditionalProcessList:c,handleClickOpen:s})=>{const{user:d}=Se(),[u,W]=o.useState([]),n=u.reduce((h,T)=>h+(T.quantity??0),0).toFixed(2);console.log("Quantity",n);const[I,Q]=o.useState({additionalProcessDetId:0,additionalProcessId:g.additionalProcessId||0,designId:g.designId||"",planningHeaderId:g.planningHeaderId||0,batchNo:g.batchNo||"",componentName:g.componentName||"",componentId:g.componentId||"",colorName:g.colorName||"",colorId:g.colorId||"",fabricName:g.fabricName||"",fabricId:g.fabricId||"",uomId:g.uomId||"",uom:g.uom||"",vendorId:"",pcsPerComponent:g.pcsPerComponent||"",remainingPcsPerComponent:g.pcsPerComponent-n||"",processTypeName:g.processTypeName||"",processTypeId:g.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId});o.useEffect(()=>{Q({...I,remainingPcsPerComponent:g.pcsPerComponent-n||""})},[u]);const{data:Y}=Ne(),{data:v,refetch:R}=ot(I.additionalProcessId,{skip:!I.additionalProcessId}),[E,B]=o.useState([]);o.useEffect(()=>{if(Y){const h=Y.result[0];B(h.vendorList)}},[Y]),o.useEffect(()=>{v&&W(v.result.map((h,T)=>({id:T,...h})))},[v,R]),console.log("initialRows",u);const H=h=>{const{name:T,value:k}=h.target;Q({...I,[T]:k})};o.useEffect(()=>{const h=()=>{const k=parseFloat(I.quantity)||0,U=parseFloat(I.ratePerPcs)||0;return(k*U).toFixed(2)};Q(k=>({...k,totalAmount:h()}));const T=()=>{const k=parseFloat(I.totalAmount)||0,U=parseFloat(I.poPcs)||0;return(k/U).toFixed(2)};Q(k=>({...k,costPerComponent:T()}))},[I.quantity,I.ratePerPcs,I.totalAmount]);const G=async()=>{console.log(I);try{const h=await se.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcessDetails",I);console.log("Save response:",h.data),R(),Q(T=>({...T,vendorId:"",pcsPerComponent:g.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})),c(),setAccordionExpanded(!1)}catch(h){console.error("Error saving data:",h)}},M=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:1},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(ve,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Select Collection",name:"collectionId",value:I.selectedCollectionId,onChange:H,size:"small",disabled:!0})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Select Design",name:"designId",value:I.designId,onChange:H,size:"small",disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:I.batchNo,onChange:H,size:"small",disabled:!0})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Components",name:"componentName",value:I.componentName,onChange:H,size:"small",disabled:!0})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:I.fabricName,onChange:H,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:I.colorName,onChange:H,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:I.processTypeName,onChange:H,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:I.pcsPerComponent,onChange:H,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:I.remainingPcsPerComponent,onChange:H,disabled:!0})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:I.vendorId,onChange:H,children:E.map(h=>e.jsx(N,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:I.quantity,onChange:H})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:I.ratePerPcs,onChange:H})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:I.totalAmount,onChange:H})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:I.uom,onChange:H,disabled:!0})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx($,{variant:"contained",size:"small",onClick:G,children:"Save"})})]}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Pe,{iColumns:M,initialRows:u,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:R,disableEdit:!0})})})]})},Rt=()=>{const{user:g}=Se(),[t,c]=o.useState([]),[s,d]=o.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId});console.log("initialData",t),o.useEffect(()=>{d({additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId})},[t]);const[u,W]=o.useState(!1),n=(r,i)=>{W(!u)},{data:I}=ke(),[Q,Y]=o.useState(""),{data:v}=Ne(),{data:R,refetch:E}=Oe(Q,{skip:!Q}),{data:B,refetch:H}=Le(s.designId,{skip:!s.designId}),{data:G}=Ee({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:M}=Be({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:Z,refetch:h}=nt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:T}=Me(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("lookupData",v),console.log("collectionData",I),console.log("colorData",M);const[k,U]=o.useState([]),[j,q]=o.useState([]),[_,D]=o.useState([]),[pe,ie]=o.useState([]),[ae,oe]=o.useState([]),[ge,ne]=o.useState([]),[Ie,re]=o.useState([]),[ce,te]=o.useState([]),[ee,P]=o.useState([]),[O,ue]=o.useState([]),[fe,me]=o.useState([]);console.log("batchData",B),o.useEffect(()=>{R&&U(R.result)},[R]),o.useEffect(()=>{B&&q(B.result)},[B]),o.useEffect(()=>{G&&D(G.result)},[G]),o.useEffect(()=>{M&&P(M.result)},[M]),o.useEffect(()=>{T&&me(T.result)},[T]),o.useEffect(()=>{if(v){const r=v.result[0];oe(r.uomList),ne(r.processList)}},[v]),o.useEffect(()=>{Z&&ue(Z.result.map((r,i)=>({id:i,...r})))},[Z,h]),o.useEffect(()=>{if(v){const r=v.result[0];ie(r.vendorList),re(r.operatingMachineList),te(r.workingHeadList)}},[v]),console.log("initialRows",O);const le=(I==null?void 0:I.result)||[],A=r=>{const{name:i,value:f}=r.target;if(i==="collectionId")le.find(C=>C.collectionId===parseInt(f)),Y(f),d({...s,collectionId:f});else if(i==="designId"){const C=k.find(L=>L.designId===parseInt(f));d({...s,designId:f,baseColorId:C?C.colorId:"",baseColorName:C?C.colorName:""})}else if(i==="batchNo"){const C=j.find(L=>L.batchNo===f);d({...s,batchNo:f,planningHeaderId:C?C.planningHeaderId:"",poPcs:C?C.poPcs:""}),W(!0)}else d({...s,[i]:f})};console.log("colors",ee);const b=async()=>{console.log("formData",s);try{const r=await se.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcess",s);console.log("Save response:",r.data),d(i=>({additionalProcessId:0,designId:i.designId,planningHeaderId:i.planningHeaderId,batchNo:i.batchNo,baseColorName:i.baseColorName,poPcs:i.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId})),h()}catch(r){console.error("Error saving data:",r)}};console.log("formData",s),o.forwardRef(function(i,f){return e.jsx(lt,{direction:"up",ref:f,...i})});const[p,S]=o.useState({}),[w,F]=o.useState(!1),K=r=>{S(r),F(!0)},x=()=>{F(!1),S({}),h()},m=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component"},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"AddVendor",headerName:"Add Vendor",renderCell:r=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(Ce,{color:"primary",onClick:()=>K(r.row),children:e.jsx(It,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:Je,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:Q,onChange:A,size:"small",children:le.map(r=>e.jsx(N,{value:r.collectionId,children:r.collectionName},r.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:A,size:"small",children:k.map(r=>e.jsx(N,{value:r.designId,children:r.designNo},r.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:A,size:"small",children:j.map(r=>e.jsx(N,{value:r.batchNo,children:r.batchNo},r.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:A,size:"small",children:fe.map(r=>e.jsx(N,{value:r.componentId,children:r.componentName},r.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:A,disabled:!0})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"Add Additional Process ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Ce,{onClick:n,sx:{mt:"-18px"},children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(we,{expanded:u,onChange:n,sx:{},children:[e.jsx(ze,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Fe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:A,children:_.map(r=>e.jsx(N,{value:r.fabricId,children:r.fabric},r.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:A,children:ee.map(r=>e.jsx(N,{value:r.colorId,children:r.color},r.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,onChange:A,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:s.pcsPerComponent,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:s.uomId,onChange:A,children:ae.map(r=>e.jsx(N,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:s.processTypeId,onChange:A,children:ge.map(r=>e.jsx(N,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx($,{variant:"contained",size:"small",onClick:b,children:"Save"})})]})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Re,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(Pe,{iColumns:m,initialRows:O,setInitialData:c,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:h,setAccordionExpanded:W,fileName:"AdditionalProcess"}),e.jsxs(mt,{open:w,onClose:x,fullWidth:!0,maxWidth:"lg",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(je,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(Ce,{onClick:x,sx:{color:"#ffffff"},children:e.jsx(xt,{})})]}),e.jsxs(pt,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(Ft,{additionalProcessData:p,setAdditionalProcessData:S,refetchAdditionalProcessList:h,handleClickOpen:K})]})]})]})})]})]})},Ht=Rt;function Ut({}){const{data:g}=Ne(),[t,c]=o.useState([]),[s,d]=o.useState([]),[u,W]=o.useState([]),[n,I]=o.useState([]),[Q,Y]=o.useState([]);Se(),o.useEffect(()=>{g&&(W(g.result[0].vendorList),d(g.result[0].serviceList),c(g.result[0].serviceTypeList),Y(g.result[0].uomList))},[g]);const[v,R]=o.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()}),E=async h=>{const{name:T,value:k}=h.target;if(console.log(`Updating ${T} to ${k}`),R({...v,[T]:k}),T==="collectionId"){const U=n.find(j=>j.collectionId===k);U&&R(j=>({...j,poPcs:U.poPcs}))}};o.useEffect(()=>{const h=()=>{const k=parseFloat(v.qty)||0,U=parseFloat(v.rate)||0;return(k*U).toFixed(2)};R(k=>({...k,totalAmount:h()}));const T=()=>{const k=parseFloat(v.poPcs)||0,U=parseFloat(v.totalAmount)||0;return(k/U).toFixed(2)};R(k=>({...k,costperPiece:T()}))},[v.qty,v.rate,v.totalAmount,v.costperPiece]);const B=async()=>{try{const h=await se.post("https://gecxc.com:4041/api/AdditionalServices/SaveAdditionalServices",v);console.log("Form data saved:",h.data),R({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(h){console.error("Error saving data:",h)}};o.useEffect(()=>{(async()=>{try{const T=await se.get("https://gecxc.com:4041/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",T),I(T.data.result)}catch(T){console.error("Error fetching design options:",T)}})()},[]);const[H,G]=o.useState([]),M=o.useCallback(async()=>{try{const h=await se.get(`https://gecxc.com:4041/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${v.collectionId}`);Array.isArray(h.data.result)?G(h.data.result.map((T,k)=>({id:k,...T}))):(console.error("API returned unexpected data format:",h.data.result),G([]))}catch(h){console.error("Error fetching data:",h),G([])}},[v.collectionId]);o.useEffect(()=>{M()},[M]);const Z=[{field:"collectionName",headerName:"Collection Name",flex:1},{field:"serviceType",headerName:"Service Type",flex:1},{field:"serviceListName",headerName:"Service List Name",flex:1},{field:"vendor",headerName:"Vendor",flex:1},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount"},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:v.collectionId,onChange:E,size:"small",children:n.length>0?n.map(h=>e.jsx(N,{id:"collectionId",value:h.collectionId,children:h.collectionName},h.collectionId)):e.jsx(N,{disabled:!0,children:"No Collections Available"})})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:v.serviceTypeId,onChange:E,variant:"outlined",size:"small",fullWidth:!0,children:t.map(h=>e.jsx(N,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:v.serviceListId,onChange:E,variant:"outlined",size:"small",fullWidth:!0,children:s.map(h=>e.jsx(N,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:v.vendorId,onChange:E,children:u.map(h=>e.jsx(N,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:v.poPcs,onChange:E,type:"number",size:"small",fullWidth:!0,disabled:!0})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Qty",name:"qty",value:v.qty,onChange:E,type:"number",size:"small",required:!0,fullWidth:!0})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:v.uomId,onChange:E,children:Q.map(h=>e.jsx(N,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"rate",value:v.rate,onChange:E,type:"number",size:"small",fullWidth:!0,required:!0})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:v.totalAmount,onChange:E,type:"number",size:"small",fullWidth:!0,required:!0})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:v.costperPiece,onChange:E,type:"number",size:"small",required:!0,fullWidth:!0})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx($,{variant:"contained",color:"primary",size:"small",onClick:B,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Pe,{iColumns:Z,initialRows:H})]})]})}const He=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function Zt(){const[g,t]=o.useState(0),[c,s]=o.useState(new Set),[d,u]=o.useState(null),[W,n]=o.useState([]),{enqueueSnackbar:I}=Ae(),Q=j=>{u(j.currentTarget)},Y=()=>{u(null)},v=!!d,R=v?"simple-popover":void 0,E=j=>j===1,B=j=>c.has(j),H=()=>{let j=c;B(g)&&(j=new Set(j.values()),j.delete(g)),t(q=>q+1),s(j)},G=()=>{t(j=>j-1)},M=()=>{if(!E(g))throw new Error("You can't skip a step that isn't optional.");t(j=>j+1),s(j=>{const q=new Set(j.values());return q.add(g),q})},Z=()=>{t(0)},[h,T]=o.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),k=async()=>{if(!h.lookUpDomain||!h.lookUpName){I("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const j=await se.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${h.lookUpDomain}&LookUpName=${h.lookUpName}&appId=1`);return console.log("Form data saved:",j.data),I("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),T({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),j.data}catch(j){throw console.error("Error saving data:",j),I("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),j}},U=j=>{T({...h,[j.target.name]:j.target.value})};return o.useEffect(()=>{(async()=>{try{const q=await se.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",q),n(q.data.result)}catch(q){console.error("Error fetching design options:",q)}})()},[]),e.jsxs(ve,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(je,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx($,{"aria-describedby":R,variant:"outlined",size:"small",onClick:Q,children:"+Lookup"}),e.jsx(ft,{id:"mouse-over-popover",open:v,anchorEl:d,onClose:Y,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:h.lookUpDomain,name:"lookUpDomain",onChange:U,children:W.map(j=>e.jsx(N,{value:j.lookUpDomain,children:j.lookUpDomain},j.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,label:"Add Lookup Description",value:h.lookUpName,onChange:U,name:"lookUpName",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx($,{variant:"contained",size:"small",onClick:k,children:"Save"})})]})})]})]}),e.jsx(dt,{activeStep:g,children:He.map((j,q)=>{const _={},D={};return E(q)&&(D.optional=e.jsx(je,{variant:"caption",children:"Optional"})),B(q)&&(_.completed=!1),e.jsx(it,{..._,children:e.jsxs(ct,{...D,onClick:()=>t(q),style:{cursor:"pointer"},children:[" ",j]})},j)})}),e.jsxs(ve,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx($,{color:"inherit",disabled:g===0,onClick:G,sx:{mr:1},children:"Back"}),e.jsx(ve,{sx:{flex:"1 1 auto"}}),E(g)&&e.jsx($,{color:"inherit",onClick:M,sx:{mr:1},children:"Skip"}),e.jsx($,{onClick:H,children:g===He.length-1?"Finish":"Next"})]}),g===He.length?e.jsxs(o.Fragment,{children:[e.jsx(je,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(ve,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ve,{sx:{flex:"1 1 auto"}}),e.jsx($,{onClick:Z,children:"Reset"})]})]}):e.jsxs(o.Fragment,{children:[g===0&&e.jsx(At,{}),g===1&&e.jsx(ut,{}),g===2&&e.jsx(Tt,{}),g===3&&e.jsx(Pt,{}),g===4&&e.jsx(zt,{}),g===5&&e.jsx(Ht,{}),g===6&&e.jsx(Ut,{}),e.jsxs(ve,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx($,{color:"inherit",disabled:g===0,onClick:G,sx:{mr:1},children:"Back"}),e.jsx(ve,{sx:{flex:"1 1 auto"}}),E(g)&&e.jsx($,{color:"inherit",onClick:M,sx:{mr:1},children:"Skip"}),e.jsx($,{onClick:H,children:g===He.length-1?"Finish":"Next"})]})]})]})}export{Zt as default};
