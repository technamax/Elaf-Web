import{r as i,j as e,_ as de,u as ce,c as ue,b as te,M as J,F as K,G as l,T as q,D as X,e as ae,a as le,f as se,g as ne,h as oe,i as re,B as R}from"./index-4q30TYyY.js";import{a as T}from"./axios-C5WTuVyO.js";import{S as me,a as he,b as ge,F as pe}from"./Fabrication-uqTi0IoE.js";import{A as _,F as Z}from"./EditAbleDataGrid-BM9QIaIC.js";import{B as k,T as r,P as fe}from"./TextField-D7MtEos9.js";import{M as I}from"./Skeleton-bPUoW8Jd.js";let ee=!1;const ie=i.forwardRef(function(p,j){return ee||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),ee=!0),e.jsx(_,de({ref:j},p))}),xe=()=>{const{data:t}=ce(),[p,j]=i.useState(""),{data:v,refetch:G}=ue(p,{skip:!p}),[b,N]=i.useState([]);i.useEffect(()=>{v&&(N(v.result),G())},[v]),console.log("designList",b),console.log("selectedCollectionId",p);const H=(t==null?void 0:t.result)||[],{enqueueSnackbar:F}=te(),[M,S]=i.useState([]),[y,$]=i.useState([]),[O,z]=i.useState([]),[U,w]=i.useState([]),[C,A]=i.useState([]),[E,D]=i.useState([]),[B,L]=i.useState([]),[s,d]=i.useState({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()});i.useEffect(()=>{(async()=>{try{const g=(await T.get("https://gecxc.com:4041/API/Common/GetPrePlanningLookUp?appID=1")).data.result[0];S(g.componentList),z(g.colorList),$(g.fabricList),A(g.noOfHeadsList),w(g.uom)}catch(x){console.error("Error fetching pre-planning lookup data:",x)}})()},[]),i.useEffect(()=>{const n=async g=>{try{const a=await T.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${g}`);console.log(a.data),D(a.data.result)}catch(a){console.error("Error fetching pre-planning lookup data:",a)}},x=async g=>{try{const a=await T.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningByPlanningHeaderId?planningHeaderId=${g}`);console.log("GetPrePlanningByPlanningHeaderI",a.data.result),L(a.data.result.map((o,c)=>({...o,id:c})))}catch(a){console.error("Error fetching pre-planning lookup data:",a)}};s.designId&&n(s.designId),s.designId&&x(s.planningHeaderId)},[s.designId,s.planningHeaderId]),i.useEffect(()=>{const n=()=>{const g=parseFloat(s.repeats)||0,a=parseFloat(s.repeatSize)||0;return g*a};d(g=>({...g,totalFabric:n()}));const x=()=>{const g=parseFloat(s.totalFabric)||0,a=parseFloat(s.shrinkage)||0,o=parseFloat(s.wastage)||0;return g*(100+(a+o))/100};d(g=>({...g,total:x()}))},[s.repeats,s.repeatSize,s.totalFabric,s.shrinkage,s.wastage]);const h=n=>{const{name:x,value:g}=n.target;if(x==="collectionId"){const a=H.find(o=>o.collectionId===parseInt(g));j(g),d({...s,collectionId:g,noOfDesigns:a?a.noOfDesigns:"",noOfColors:a?a.noOfColors:""})}else if(x==="designId"){const a=b.find(o=>o.designId===parseInt(g));d({...s,designId:g,baseColorId:a?a.colorId:"",baseColorName:a?a.colorName:""})}else if(x==="batchNo"){const a=E.find(o=>o.batchNo===g);d({...s,batchNo:g,planningHeaderId:a?a.planningHeaderId:""})}else d({...s,[x]:g})},W=async()=>{try{const n=await T.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",{designId:parseInt(s.designId),planningHeaderId:parseInt(s.planningHeaderId),componentId:parseInt(s.componentId),colorId:parseInt(s.colorId),batchNo:s.batchNo,baseColorId:parseInt(s.baseColorId),cuttingSize:parseFloat(s.cuttingSize),fabricId:parseInt(s.fabricId),noOfHeads:parseInt(s.noOfHeads),repeats:parseFloat(s.repeats),repeatSize:parseFloat(s.repeatSize),uomId:parseInt(s.uomId),totalFabric:parseFloat(s.totalFabric),shrinkage:parseFloat(s.shrinkage),wastage:parseFloat(s.wastage),total:parseFloat(s.total),appId:s.appId,createdOn:s.createdOn,createdBy:s.createdBy,lastUpdatedBy:s.lastUpdatedBy,lastUpdatedOn:s.lastUpdatedOn});console.log("Data saved successfully:",n.data),F("PrePlanning saved successfully!",{variant:"success",autoHideDuration:5e3}),d({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()}),L([])}catch(n){console.error("Error saving data:",n)}},P=[{field:"componentId",headerName:"Component",editable:!0,flex:1,type:"singleSelect",valueOptions:M.map(n=>({value:n.lookUpId,label:n.lookUpName}))},{field:"colorId",headerName:"Color",editable:!0,flex:1,type:"singleSelect",valueOptions:O.map(n=>({value:n.lookUpId,label:n.lookUpName}))},{field:"cuttingSize",headerName:"Cutting Size",flex:1,editable:!0},{field:"fabricId",headerName:"Fabrication",editable:!0,flex:1,type:"singleSelect",valueOptions:y.map(n=>({value:n.lookUpId,label:n.lookUpName}))},{field:"noOfHeads",headerName:"No. Of Heads",editable:!0,flex:1,type:"singleSelect",valueOptions:C.map(n=>({value:n.lookUpId,label:n.lookUpName}))},{field:"repeats",headerName:"Repeats",flex:1,editable:!0},{field:"repeatSize",headerName:"Repeat Size",flex:1,editable:!0},{field:"totalFabric",headerName:"Total Fabric",flex:1,editable:!0,valueSetter:(n,x)=>{const g=x.repeats??0,a=x.repeatSize??0,o=g*a;return console.log("totalFabric",o),{...x,totalFabric:o}}},{field:"uomId",headerName:"UOM",editable:!0,flex:1,type:"singleSelect",valueOptions:U.map(n=>({value:n.lookUpId,label:n.lookUpName}))},{field:"shrinkage",headerName:"Shrinkage",flex:1,editable:!0},{field:"wastage",headerName:"Wastage",flex:1,editable:!0},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(n,x)=>{const g=x.shrinkage??0,a=x.wastage??0,o=x.totalFabric??0,c=o*(100-(g+a))/100;return console.log("totalFabric",o),{...x,total:c}}}];return console.log("batchList:",E),e.jsxs(J,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23"},children:[e.jsx(K,{children:e.jsxs(l,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(l,{item:!0,sm:9,children:e.jsx(q,{variant:"h3",gutterBottom:!0,children:"Pre Planning"})}),e.jsx(l,{item:!0,sm:3,textAlign:"right",children:e.jsx(k,{variant:"contained",size:"small",onClick:W,children:"Save"})}),e.jsxs(l,{item:!0,sm:4,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:s.collectionId,onChange:h,size:"small",children:H.map(n=>e.jsx(I,{value:n.collectionId,children:n.collectionName},n.collectionId))})," "]}),e.jsx(l,{item:!0,sm:4,children:e.jsx(r,{label:"No of Design",fullWidth:!0,size:"small",name:"noOfDesigns",value:s.noOfDesigns,onChange:h,disabled:!0})}),e.jsx(l,{item:!0,sm:4,children:e.jsx(r,{label:"No of Color",fullWidth:!0,size:"small",name:"noOfColors",value:s.noOfColors,onChange:h,disabled:!0})}),e.jsx(l,{item:!0,sm:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:h,size:"small",children:b.map(n=>e.jsx(I,{value:n.designId,children:n.designerName},n.designId))})}),e.jsx(l,{item:!0,sm:4,children:e.jsx(r,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:h,disabled:!0})}),e.jsxs(l,{item:!0,sm:4,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:h,size:"small",children:E.map(n=>e.jsx(I,{value:n.batchNo,children:n.batchNo},n.batchNo))})," "]}),e.jsx(l,{item:!0,sm:12,children:e.jsx(X,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(_,{fullWidth:!0,options:M,getOptionLabel:n=>n.lookUpName,onChange:(n,x)=>h({target:{name:"componentId",value:x}}),renderInput:n=>e.jsx(r,{...n,label:"Select Component",variant:"outlined",size:"small",name:"componentId",value:s.componentId})})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(_,{fullWidth:!0,options:O,getOptionLabel:n=>n.lookUpName,onChange:(n,x)=>h({target:{name:"colorId",value:x}}),renderInput:n=>e.jsx(r,{...n,label:"Color",variant:"outlined",size:"small",name:"colorId",value:s.colorId})})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:s.cuttingSize,onChange:h})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(_,{fullWidth:!0,options:y,getOptionLabel:n=>n.lookUpName,onChange:(n,x)=>h({target:{name:"fabricId",value:x}}),renderInput:n=>e.jsx(r,{...n,label:"Fabrication",variant:"outlined",size:"small",name:"fabricId",value:s.fabricId})})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"No of Heads",defaultValue:"",size:"small",name:"noOfHeads",value:s.noOfHeads,onChange:h,children:C.map(n=>e.jsx(I,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:s.repeats,onChange:h})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Repeat Size",fullWidth:!0,size:"small",name:"repeatSize",value:s.repeatSize,onChange:h})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:s.totalFabric,onChange:h})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:s.uomId,onChange:h,children:U.map(n=>e.jsx(I,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Shrinkage %",fullWidth:!0,size:"small",name:"shrinkage",value:s.shrinkage,onChange:h})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Wastage %",fullWidth:!0,size:"small",name:"wastage",value:s.wastage,onChange:h})}),e.jsx(l,{item:!0,sm:3,children:e.jsx(r,{label:"Total",fullWidth:!0,size:"small",name:"total",value:s.total,onChange:h})})]})}),e.jsx(l,{container:!0,spacing:2,width:"Inherit",children:e.jsx(l,{sx:{marginTop:2},item:!0,sm:12,children:e.jsx(Z,{ncolumns:P,initialRows:B,formData:s,editAPi:"https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",deleteApi:"https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",deleteBy:"planningId",disableAddRecord:!0})})})]})},be=xe,Ie=()=>{const[t,p]=i.useState({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:""});console.log("Dyeing form data to send",t);const{data:j}=ae(),[v,G]=i.useState(""),{data:b}=le(),{data:N,refetch:H}=se(v,{skip:!v}),{data:F,refetch:M}=ne(t.designId,{skip:!t.designId}),{data:S}=oe(t.batchNo,{skip:!t.batchNo}),{data:y,refetch:$}=re(t.batchNo,{skip:!t.batchNo}),[O,z]=i.useState([]),[U,w]=i.useState([]),[C,A]=i.useState([]),[E,D]=i.useState([]),[B,L]=i.useState([]),[s,d]=i.useState([]),[h,W]=i.useState([]);i.useEffect(()=>{N&&z(N.result)},[N]),i.useEffect(()=>{F&&w(F.result)},[F]),i.useEffect(()=>{S&&A(S.result)},[S]),i.useEffect(()=>{b&&W(b.result[0].vendorList)},[S]),console.log(h),i.useEffect(()=>{y&&L(y.result.map((a,o)=>({id:o,...a})))},[y]),i.useEffect(()=>{if(b){const a=b.result[0];D(a.uomList)}},[b]);const P=(j==null?void 0:j.result)||[],f=a=>{const{name:o,value:c}=a.target;if(o==="collectionId"){const u=P.find(m=>m.collectionId===parseInt(c));G(c),p({...t,collectionId:c,poPcs:u?u.poPcs:""})}else if(o==="designId"){const u=O.find(m=>m.designId===parseInt(c));p({...t,designId:c,baseColorId:u?u.colorId:"",baseColorName:u?u.colorName:""})}else if(o==="batchNo"){const u=U.find(m=>m.batchNo===c);p({...t,batchNo:c,planningHeaderId:u?u.planningHeaderId:""})}else if(o==="fabricId"){const u=C.find(m=>m.fabricId===c);console.log("Selected Fabric:",C),p({...t,fabricId:c,OutputQty:u?u.total:""}),V(c)}else p({...t,[o]:c})},V=async a=>{try{const c=(await T.get(`https://gecxc.com:4041/api/DyeingPrinting/GetFabricColorFromPrePlanningByFabricId?fabricId=${a}`)).data.result;if(console.log("Dyeing Color Data",c),c.length>0){const m=c[0];p(Q=>({...Q,Shrinkage:m.shrinkage.toFixed(2),Wastage:m.wastage.toFixed(2),UOM:m.uom,AvailableQty:m.total.toString()}))}const u=c.map(m=>({label:m.color,value:m.colorId}));if(d(u),u.length>0){const m=u[0];p(Q=>({...Q,ColorId:m.value,color:m.label}))}}catch(o){console.error("Error fetching fabric color data:",o)}};i.useEffect(()=>{const a=()=>{const o=parseFloat(t.AvailableQty)||0,c=parseFloat(t.Shrinkage)||0,u=parseFloat(t.Wastage)||0;return o*(100-(c+u))/100};p(o=>({...o,OutputQty:a()}))},[t.AvailableQty,t.Shrinkage,t.Wastage]);const n=async()=>{console.log("Form Data:",t);const a={dpId:parseInt(t.DPId)||0,designId:parseInt(t.designId),batchNo:t.batchNo,fabricId:parseInt(t.fabricId),colorId:parseInt(t.ColorId)||0,vendorId:parseInt(t.vendorId)||0,processType:t.processType,availableQty:parseFloat(t.AvailableQty)||0,shrinkage:parseFloat(t.Shrinkage)||0,wastage:parseFloat(t.Wastage)||0,outputQty:parseFloat(t.OutputQty)||0,uomId:parseInt(t.UOM)||0,ratePerUOM:parseFloat(t.RatePerUOM)||0,unitRatePerPo:parseFloat(t.UnitRatePerPo)||0,totalExclGst:parseFloat(t.TotalExclGst)||0,gst:parseFloat(t.GST)||0,gstAmount:parseFloat(t.GSTAmount)||0,totalIncludingGst:parseFloat(t.TotalIncludingGst)||0,createdBy:t.createdBy};console.log("Payload:",a);try{const o=await T.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",a);o.status===200?console.log("Data saved successfully:",o.data):console.error("Failed to save data:",o.data)}catch(o){console.error("Error saving data:",o)}},x=[{field:"name",headerName:"Order Number",editable:!0,flex:2},{field:"DesignId",headerName:"Design",type:"number",flex:1,align:"left",headerAlign:"left",editable:!0},{field:"FabricId",headerName:"Fabric",type:"date",flex:1,editable:!0},{field:"ProcessType",headerName:"Process",flex:1,editable:!0},{field:"ColorId",headerName:"Color",flex:1,editable:!0},{field:"role",headerName:"Po Pcs",flex:1,editable:!0},{field:"AvailableQty",headerName:"Qty",flex:1,editable:!0},{field:"UOM",headerName:"UOM",flex:1,editable:!0},{field:"RatePerUOM",headerName:"Rate",flex:1,editable:!0},{field:"UnitRatePerPo",headerName:"Unit Price",flex:1,editable:!0},{field:"TotalIncludingGst",headerName:"Total W/ GST",flex:1,editable:!0}],g=[{value:"D",label:"Dyeing"},{value:"P",label:"Printing"}];return e.jsx(J,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(K,{children:e.jsxs(l,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(l,{item:!0,xs:9,md:9,children:e.jsx(q,{variant:"h3",gutterBottom:!0,children:"Dyeing/Printing"})}),e.jsx(l,{item:!0,xs:3,md:3,textAlign:"right",children:e.jsx(k,{variant:"contained",color:"primary",size:"small",onClick:n,children:"Save"})}),e.jsxs(l,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:v,onChange:f,size:"small",children:P.map(a=>e.jsx(I,{value:a.collectionId,children:a.collectionName},a.collectionId))})," "]}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:f,size:"small",children:O.map(a=>e.jsx(I,{value:a.designId,children:a.designNo},a.designId))})}),e.jsxs(l,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:f,size:"small",children:U.map(a=>e.jsx(I,{value:a.batchNo,children:a.batchNo},a.batchNo))})," "]}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:f,children:C.map(a=>e.jsx(I,{value:a.fabricId,children:a.fabric},a.fabricId))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(ie,{fullWidth:!0,options:s,getOptionLabel:a=>a.label||"",renderInput:a=>e.jsx(r,{...a,label:"Color",name:"ColorId",size:"small"}),value:s.find(a=>a.value===t.ColorId)||null,onChange:(a,o)=>{p(c=>({...c,ColorId:o?o.value:""}))}})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendor Name ",size:"small",value:t.vendorId,handleChange:f,children:h.map(a=>e.jsx(I,{value:a.lookUpId,children:a.lookUpName},a.lookUpId))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:f,disabled:!0,focused:!0})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Process Type ",size:"small",value:t.processType,handleChange:f,children:g.map(a=>e.jsx(I,{value:a.value,children:a.label},a.value))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:t.UOM})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"AvailableQty",fullWidth:!0,size:"small",name:"AvailableQty",value:t.AvailableQty})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Shrinkage%",fullWidth:!0,size:"small",name:"Shrinkage",value:t.Shrinkage})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Wastage%",fullWidth:!0,size:"small",name:"Wastage",value:t.Wastage})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",value:t.OutputQty})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Rate",fullWidth:!0,size:"small",name:"RatePerUOM",value:t.RatePerUOM,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Excluding GST",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalExclGst,onChange:f})}),e.jsxs(l,{item:!0,xs:12,md:1.5,children:[e.jsx(r,{label:"GST",fullWidth:!0,size:"small",name:"GST",value:t.GST,onChange:f})," "]}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"GST Amount",fullWidth:!0,size:"small",name:"GSTAmount",value:t.GSTAmount,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalIncludingGst,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:t.UnitRatePerPo,onChange:f})}),e.jsx(X,{color:"#cc8587",sx:{height:2,width:"100%",mt:2}}),e.jsx(l,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(Z,{initialRows:B,ncolumns:x})})]})})})},je=Ie,ve=()=>{const[t,p]=i.useState({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:""});console.log("Dyeing form data to send",t);const{data:j}=ae(),[v,G]=i.useState(""),{data:b}=le(),{data:N,refetch:H}=se(v,{skip:!v}),{data:F,refetch:M}=ne(t.designId,{skip:!t.designId}),{data:S}=oe(t.batchNo,{skip:!t.batchNo}),{data:y,refetch:$}=re(t.batchNo,{skip:!t.batchNo}),[O,z]=i.useState([]),[U,w]=i.useState([]),[C,A]=i.useState([]),[E,D]=i.useState([]),[B,L]=i.useState([]),[s,d]=i.useState([]),[h,W]=i.useState([]);i.useEffect(()=>{N&&z(N.result)},[N]),i.useEffect(()=>{F&&w(F.result)},[F]),i.useEffect(()=>{S&&A(S.result)},[S]),i.useEffect(()=>{b&&W(b.result[0].vendorList)},[S]),console.log(h),i.useEffect(()=>{y&&L(y.result.map((a,o)=>({id:o,...a})))},[y]),i.useEffect(()=>{if(b){const a=b.result[0];D(a.uomList)}},[b]);const P=(j==null?void 0:j.result)||[],f=a=>{const{name:o,value:c}=a.target;if(o==="collectionId"){const u=P.find(m=>m.collectionId===parseInt(c));G(c),p({...t,collectionId:c,poPcs:u?u.poPcs:""})}else if(o==="designId"){const u=O.find(m=>m.designId===parseInt(c));p({...t,designId:c,baseColorId:u?u.colorId:"",baseColorName:u?u.colorName:""})}else if(o==="batchNo"){const u=U.find(m=>m.batchNo===c);p({...t,batchNo:c,planningHeaderId:u?u.planningHeaderId:""})}else if(o==="fabricId"){const u=C.find(m=>m.fabricId===c);console.log("Selected Fabric:",C),p({...t,fabricId:c,OutputQty:u?u.total:""}),V(c)}else p({...t,[o]:c})},V=async a=>{try{const c=(await T.get(`https://gecxc.com:4041/api/DyeingPrinting/GetFabricColorFromPrePlanningByFabricId?fabricId=${a}`)).data.result;if(console.log("Dyeing Color Data",c),c.length>0){const m=c[0];p(Q=>({...Q,Shrinkage:m.shrinkage.toFixed(2),Wastage:m.wastage.toFixed(2),UOM:m.uom,AvailableQty:m.total.toString()}))}const u=c.map(m=>({label:m.color,value:m.colorId}));if(d(u),u.length>0){const m=u[0];p(Q=>({...Q,ColorId:m.value,color:m.label}))}}catch(o){console.error("Error fetching fabric color data:",o)}};i.useEffect(()=>{const a=()=>{const o=parseFloat(t.AvailableQty)||0,c=parseFloat(t.Shrinkage)||0,u=parseFloat(t.Wastage)||0;return o*(100-(c+u))/100};p(o=>({...o,OutputQty:a()}))},[t.AvailableQty,t.Shrinkage,t.Wastage]);const n=async()=>{console.log("Form Data:",t);const a={dpId:parseInt(t.DPId)||0,designId:parseInt(t.designId),batchNo:t.batchNo,fabricId:parseInt(t.fabricId),colorId:parseInt(t.ColorId)||0,vendorId:parseInt(t.vendorId)||0,processType:t.processType,availableQty:parseFloat(t.AvailableQty)||0,shrinkage:parseFloat(t.Shrinkage)||0,wastage:parseFloat(t.Wastage)||0,outputQty:parseFloat(t.OutputQty)||0,uomId:parseInt(t.UOM)||0,ratePerUOM:parseFloat(t.RatePerUOM)||0,unitRatePerPo:parseFloat(t.UnitRatePerPo)||0,totalExclGst:parseFloat(t.TotalExclGst)||0,gst:parseFloat(t.GST)||0,gstAmount:parseFloat(t.GSTAmount)||0,totalIncludingGst:parseFloat(t.TotalIncludingGst)||0,createdBy:t.createdBy};console.log("Payload:",a);try{const o=await T.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",a);o.status===200?console.log("Data saved successfully:",o.data):console.error("Failed to save data:",o.data)}catch(o){console.error("Error saving data:",o)}},x=[{field:"name",headerName:"Order Number",editable:!0,flex:2},{field:"DesignId",headerName:"Design",type:"number",flex:1,align:"left",headerAlign:"left",editable:!0},{field:"FabricId",headerName:"Fabric",type:"date",flex:1,editable:!0},{field:"ProcessType",headerName:"Process",flex:1,editable:!0},{field:"ColorId",headerName:"Color",flex:1,editable:!0},{field:"role",headerName:"Po Pcs",flex:1,editable:!0},{field:"AvailableQty",headerName:"Qty",flex:1,editable:!0},{field:"UOM",headerName:"UOM",flex:1,editable:!0},{field:"RatePerUOM",headerName:"Rate",flex:1,editable:!0},{field:"UnitRatePerPo",headerName:"Unit Price",flex:1,editable:!0},{field:"TotalIncludingGst",headerName:"Total W/ GST",flex:1,editable:!0}],g=[{value:"D",label:"Dyeing"},{value:"P",label:"Printing"}];return e.jsx(J,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(K,{children:e.jsxs(l,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(l,{item:!0,xs:9,md:9,children:e.jsx(q,{variant:"h3",gutterBottom:!0,children:"Schiffli"})}),e.jsx(l,{item:!0,xs:3,md:3,textAlign:"right",children:e.jsx(k,{variant:"contained",color:"primary",size:"small",onClick:n,children:"Save"})}),e.jsxs(l,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:v,onChange:f,size:"small",children:P.map(a=>e.jsx(I,{value:a.collectionId,children:a.collectionName},a.collectionId))})," "]}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:f,size:"small",children:O.map(a=>e.jsx(I,{value:a.designId,children:a.designNo},a.designId))})}),e.jsxs(l,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:f,size:"small",children:U.map(a=>e.jsx(I,{value:a.batchNo,children:a.batchNo},a.batchNo))})," "]}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:f,children:C.map(a=>e.jsx(I,{value:a.fabricId,children:a.fabric},a.fabricId))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(ie,{fullWidth:!0,options:s,getOptionLabel:a=>a.label||"",renderInput:a=>e.jsx(r,{...a,label:"Color",name:"ColorId",size:"small"}),value:s.find(a=>a.value===t.ColorId)||null,onChange:(a,o)=>{p(c=>({...c,ColorId:o?o.value:""}))}})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendor Name ",size:"small",value:t.vendorId,handleChange:f,children:h.map(a=>e.jsx(I,{value:a.lookUpId,children:a.lookUpName},a.lookUpId))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:f,disabled:!0,focused:!0})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Process Type ",size:"small",value:t.processType,handleChange:f,children:g.map(a=>e.jsx(I,{value:a.value,children:a.label},a.value))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:t.UOM})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"AvailableQty",fullWidth:!0,size:"small",name:"AvailableQty",value:t.AvailableQty})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Shrinkage%",fullWidth:!0,size:"small",name:"Shrinkage",value:t.Shrinkage})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Wastage%",fullWidth:!0,size:"small",name:"Wastage",value:t.Wastage})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",value:t.OutputQty})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Rate",fullWidth:!0,size:"small",name:"RatePerUOM",value:t.RatePerUOM,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Excluding GST",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalExclGst,onChange:f})}),e.jsxs(l,{item:!0,xs:12,md:1.5,children:[e.jsx(r,{label:"GST",fullWidth:!0,size:"small",name:"GST",value:t.GST,onChange:f})," "]}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"GST Amount",fullWidth:!0,size:"small",name:"GSTAmount",value:t.GSTAmount,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalIncludingGst,onChange:f})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:t.UnitRatePerPo,onChange:f})}),e.jsx(X,{color:"#cc8587",sx:{height:2,width:"100%",mt:2}}),e.jsx(l,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(Z,{initialRows:B,ncolumns:x})})]})})})},Se=ve,Y=["Pre Planning","Fabric Requisition","Dyeing/Printing  ","MultiHead ","Schiffli","name6","name7","name8"];function Ue(){const[t,p]=i.useState(0),[j,v]=i.useState(new Set),[G,b]=i.useState(null),[N,H]=i.useState([]),{enqueueSnackbar:F}=te(),M=d=>{b(d.currentTarget)},S=()=>{b(null)},y=d=>{const{name:h,value:W}=d.target;B(P=>({...P,[h]:W}))},$=!!G,O=$?"simple-popover":void 0,z=d=>d===1,U=d=>j.has(d),w=()=>{let d=j;U(t)&&(d=new Set(d.values()),d.delete(t)),p(h=>h+1),v(d)},C=()=>{p(d=>d-1)},A=()=>{if(!z(t))throw new Error("You can't skip a step that isn't optional.");p(d=>d+1),v(d=>{const h=new Set(d.values());return h.add(t),h})},E=()=>{p(0)},[D,B]=i.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),L=async()=>{try{const d=await T.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");H(d.data.result)}catch(d){console.error("Error fetching design options:",d)}console.log("LookupData",response)};i.useEffect(()=>{L()},[]);const s=async()=>{console.log(D);try{const d=await T.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${D.lookUpDomain}&LookUpName=${D.lookUpName}&appId=1`);return console.log("Form data saved:",d.data),F("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),B({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),d.data}catch(d){throw console.error("Error saving data:",d),d}};return e.jsxs(R,{sx:{width:"100%"},children:[e.jsxs(l,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(l,{item:!0,sm:6,children:e.jsx(q,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(l,{item:!0,sm:6,textAlign:"right",children:[e.jsx(k,{"aria-describedby":O,variant:"outlined",size:"small",onClick:M,children:"+Lookup"}),e.jsx(fe,{id:"mouse-over-popover",open:$,anchorEl:G,onClose:S,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(l,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(l,{item:!0,sm:12,children:e.jsx(r,{fullWidth:!0,id:"outlined-select-currency",select:!0,name:"lookUpDomain",value:D.lookUpDomain,label:"Select LookUp",size:"small",onChange:y,children:N.map(d=>e.jsx(I,{value:d.lookUpDomain,children:d.lookUpDomain},d.lookUpDomain))})}),e.jsx(l,{item:!0,sm:12,children:e.jsx(r,{fullWidth:!0,label:"Add Lookup Description",name:"lookUpName",value:D.lookUpName,size:"small",onChange:y})}),e.jsx(l,{item:!0,sm:3,textAlign:"right",children:e.jsx(k,{variant:"contained",size:"small",onClick:s,children:"Save"})})]})})]})]}),e.jsx(me,{activeStep:t,children:Y.map((d,h)=>{const W={},P={};return z(h)&&(P.optional=e.jsx(q,{variant:"caption",children:"Optional"})),U(h)&&(W.completed=!1),e.jsx(he,{...W,children:e.jsx(ge,{...P,children:d})},d)})}),e.jsxs(R,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(k,{color:"inherit",disabled:t===0,onClick:C,sx:{mr:1},children:"Back"}),e.jsx(R,{sx:{flex:"1 1 auto"}}),z(t)&&e.jsx(k,{color:"inherit",onClick:A,sx:{mr:1},children:"Skip"}),e.jsx(k,{onClick:w,children:t===Y.length-1?"Finish":"Next"})]}),t===Y.length?e.jsxs(i.Fragment,{children:[e.jsx(q,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(R,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(R,{sx:{flex:"1 1 auto"}}),e.jsx(k,{onClick:E,children:"Reset"})]})]}):e.jsxs(i.Fragment,{children:[t===0&&e.jsx(be,{}),t===1&&e.jsx(pe,{}),t===2&&e.jsx(je,{}),t===4&&e.jsx(Se,{}),e.jsxs(R,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(k,{color:"inherit",disabled:t===0,onClick:C,sx:{mr:1},children:"Back"}),e.jsx(R,{sx:{flex:"1 1 auto"}}),z(t)&&e.jsx(k,{color:"inherit",onClick:A,sx:{mr:1},children:"Skip"}),e.jsx(k,{onClick:w,children:t===Y.length-1?"Finish":"Next"})]})]})]})}export{Ue as default};
