import{j as e,_ as xt,r as ft,i as yt,u as ze,b as Be,a5 as vt,B as Ne,G as o,T as Ie,D as de,S as rt,c as Qe,a6 as Ct,a7 as Ee,a8 as Ye,a9 as _e,aa as Je,ab as Ze,ac as Mt,ad as Ke,C as xe,d as fe,ae as De,af as He,ag as Pt,ah as jt,ai as St,aj as kt,ak as Ot,al as At,am as Lt,an as Nt}from"./index-KHXveQAW.js";import{r as s}from"./vendor-BXCbSo2_.js";import{B as ie,a as ye,I as Te}from"./axios-B9NCLk-l.js";import{d as it,c as Ve,A as dt,e as ct,f as ut,S as Tt,a as Bt,b as wt,F as Ft}from"./Fabrication-D4KhZRYC.js";import{R as Re,d as qe,D as $e,a as et,b as tt,c as ot,B as pt}from"./ReuseableDataGrid-CFdmB6Vn.js";import{d as at}from"./Close-Dwk3nrpK.js";import{d as st}from"./PersonAddAlt1Outlined-DBAC3it5.js";import{T as r,P as Wt}from"./TextField-BZp6YcmY.js";import{M as L}from"./Skeleton-BiWCxejt.js";import{A as Xe,F as mt,C as ht}from"./ExcelExport-DZV8mTs4.js";import"./dayjs.min-DO4_1a-m.js";let lt=!1;const zt=s.forwardRef(function(_,R){return lt||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),lt=!0),e.jsx(Xe,xt({ref:R},_))});var nt={},Rt=yt;Object.defineProperty(nt,"__esModule",{value:!0});var gt=nt.default=void 0,Qt=Rt(ft()),Ut=e;gt=nt.default=(0,Qt.default)((0,Ut.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const Ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",qt=({initialFormData:c,setAdditionalProcessData:_,refetchDyeingPrintingData:R,handleClickOpen:m,showUpperDiv:t})=>{const{user:y}=ze(),[l,g]=s.useState([]),u=l.reduce((f,x)=>f+(x.assignedQty??0),0).toFixed(2);console.log("Quantity",u);const[d,B]=s.useState({dpIdDet:0,dpId:c.dpId||0,designId:c.designId||"",batchNo:c.batchNo||"",planningHeaderId:c.planningHeaderId||0,fabricId:c.fabricId||"",colorId:c.colorId||"",colorName:c.colorName||"",vendorId:"",processType:c.processType||"",availableQty:c.availableQty||"",remainingQty:c.availableQty-u||"",shrinkage:"",wastage:"",uomId:c.uomId||"",uom:c.uom||"",poPcs:c.poPcs||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:y.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:y.empId});s.useEffect(()=>{B({...d,remainingQty:c.availableQty-u||""})},[l]);const{data:U}=Be(),{data:p,refetch:M}=vt(d.dpId,{skip:!d.dpId}),[Q,q]=s.useState([]);s.useEffect(()=>{if(U){const f=U.result[0];q(f.vendorList)}},[U]),s.useEffect(()=>{p&&g(p.result.map((f,x)=>({id:x,...f})))},[p,M]),console.log("initialRows",l);const j=f=>{const{name:x,value:F}=f.target;B({...d,[x]:F})};s.useEffect(()=>{const f=()=>{const re=parseFloat(d.availableQty)||0,te=parseFloat(d.shrinkage)||0,me=parseFloat(d.wastage)||0;return(re*(100-(te+me))/100).toFixed(2)},x=()=>{const re=parseFloat(d.assignedQty)||0,te=parseFloat(d.rate)||0;return(re*te).toFixed(2)},F=(re,te)=>(re*(1+te/100)).toFixed(2),H=f(),C=x(),h=parseFloat(d.gst)||0,A=F(C,h),K=parseFloat(d.poPcs)||0,$=K?A/K:0;B(re=>({...re,outputQty:H,totalExcGst:C,TotalIncludingGst:A,unitRatePerPo:$.toFixed(2)}))},[d.availableQty,d.shrinkage,d.wastage,d.rate,d.gst,d.poPcs,d.unitRatePerPo]),console.log("formData",d);const Z=async()=>{console.log(d);try{const f=await ye.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrintingDetails",d);console.log("Save response:",f.data),B(x=>({...x,dpIdDet:0,vendorId:"",availableQty:c.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:y.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:y.empId})),M(),R()}catch(f){console.error("Error saving data:",f)}},E=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:f=>f.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:f=>f.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:f=>f.toLocaleString()},{field:"unitRatePerPo",headerName:"unitRatePerPo.",flex:1}];return e.jsxs(Ne,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!t,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"Fabric",name:"fabricName",value:d.fabricName,onChange:j,size:"small",disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Process Type",name:"processType",value:d.processType,onChange:j,size:"small",disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"Color",name:"colorName",value:d.colorName,onChange:j,size:"small",disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"UOM",name:"uom",value:d.uom,onChange:j,size:"small",disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:d.poPcs,onChange:j,disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:d.availableQty,onChange:j,disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:d.remainingQty,onChange:j,disabled:!0,sx:f=>({...d.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:d.vendorId,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}},children:Q.map(f=>e.jsx(L,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:d.assignedQty,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:d.rate,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:d.shrinkage,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:d.wastage,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:d.outputQty,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:d.totalExcGst,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:d.gst,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:d.TotalIncludingGst,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:d.unitRatePerPo,onChange:j,disabled:!d.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:Z,children:"Save"})})]})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Re,{iColumns:E,initialRows:l,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:M,disableEdit:!0})})]})]})},Et=({initialFormData:c,setAdditionalProcessData:_,refetchDyeingPrintingData:R,handleClickOpen:m,showUpperDiv:t})=>{const y=rt(),{enqueueSnackbar:l}=Qe(),{user:g}=ze(),[u,d]=s.useState([]),B=u.reduce((P,T)=>P+(T.assignedQty??0),0).toFixed(2);console.log("Quantity",B);const U=u.reduce((P,T)=>P+(T.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",U);const[p,M]=s.useState({embroideryIdDet:0,embroideryId:c.embroideryId||0,designId:c.designId||"",batchNo:c.batchNo||"",planningHeaderId:c.planningHeaderId||0,componentId:c.componentId||"",componentName:c.componentName||"",fabricId:c.fabricId||"",fabricName:c.fabricName||"",vendorId:"",colorId:c.colorId||"",colourName:c.colourName||"",availableQty:c.availableQty||"",assignedQty:"",remainingQty:(c.availableQty-B).toFixed(2)||0,noOfHead:c.noOfHead||"",noOfHeadsName:c.noOfHeadsName||"",repeats:c.repeats||"",assignedRepeats:"",remainingRepeats:c.repeats-U||"",cuttingSize:c.cuttingSize||"",itemsPerRepeat:c.itemsPerRepeat||"",poPcs:c.poPcs||"",totalPcs:c.totalPcs||"",remainingPcs:(c.totalPcs-U).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId}),Q=["Boring","Pooni","Laser","Doori","Dissolving"];function q(P,T,D){return{fontWeight:T.indexOf(P)===-1?D.typography.fontWeightRegular:D.typography.fontWeightMedium}}s.useEffect(()=>{M({...p,remainingQty:c.availableQty-B||0,remainingPcs:c.totalPcs-U||0})},[u]);const{data:j}=Be(),{data:Z,refetch:E}=Ct(p.embroideryId,{skip:!p.embroideryId}),[G,f]=s.useState([]);s.useEffect(()=>{if(j){const P=j.result[0];f(P.vendorList)}},[j]),s.useEffect(()=>{Z&&d(Z.result.map((P,T)=>({id:T,...P})))},[Z,E]),console.log("initialRows",u);const x=P=>{const{name:T,value:D}=P.target;M({...p,[T]:D})},F=P=>{const{name:T,checked:D}=P.target;M(se=>({...se,[T]:D}))};console.log("formData",p);const[H,C]=s.useState(null),[h,A]=s.useState(p);s.useEffect(()=>{const P=setTimeout(()=>{A(p)},50);return()=>{clearTimeout(P)}},[p]);const K=P=>new Intl.NumberFormat("en-US").format(P);s.useEffect(()=>{const P=()=>{const S=parseFloat(h.repeats)||0,O=parseFloat(h.itemsPerRepeat)||0;return(S*O).toFixed(2)},T=()=>{const S=parseFloat(h.threadStiches)||0,O=parseFloat(h.threadRate)||0,ne=parseFloat(h.noOfHead)||0,N=parseFloat(h.repeats)||0;return(S/1e3*(O*N*ne)).toFixed(2)},D=()=>{const S=parseFloat(h.tillaStiches)||0,O=parseFloat(h.tilaRate)||0,ne=parseFloat(h.noOfHead)||0,N=parseFloat(h.repeats)||0;return(S/1e3*(O*N*ne)).toFixed(2)},se=()=>{const S=parseFloat(h.sequence)||0,O=parseFloat(h.sequenceRate)||0,ne=parseFloat(h.noOfHead)||0,N=parseFloat(h.repeats)||0;return(S/1e3*(O*N*ne)).toFixed(2)},Oe=()=>{const S=parseFloat(h.repeats)||0,O=parseFloat(h.noOfHead)||0,ne=parseFloat(h.solvingLayers)||0;return(S*O*13/39.37*ne).toFixed(2)},Y=()=>{const S=parseFloat(h.solvingInMeters)||0,O=parseFloat(h.solvingRate)||0;return(S*O).toFixed(2)},le=()=>{const S=parseFloat(h.threadAmount)||0,O=parseFloat(h.tilaAmount)||0,ne=parseFloat(h.sequenceAmount)||0,N=parseFloat(h.solvingAmount)||0;return(S+O+ne+N).toFixed(2)},ee=()=>{const S=parseFloat(h.totalAmount)||0,O=parseFloat(h.totalPcs)||0;return(S/O).toFixed(2)},ce=le(),ue=ee();T(),M(S=>({...S,totalPcs:P(),threadAmount:T(),tilaAmount:D(),sequenceAmount:se(),solvingInMeters:Oe(),solvingAmount:Y(),totalAmount:K(ce),costPerComponent:K(ue)}))},[h.threadAmount,h.totalAmount,h.sequenceAmount,h.solvingAmount,h.repeats,h.tilaAmount,h.itemsPerRepeat,h.threadRate,h.threadStiches,h.noOfHead,h.tilaRate,h.tillaStiches,h.sequenceRate,h.sequence,h.solvingLayers,h.solvingInMeters,h.solvingRate]),s.useEffect(()=>{if(H==="assignedQty"){const P=()=>{const T=parseFloat(h.assignedQty)||0,D=parseFloat(h.availableQty)||0,se=parseFloat(h.totalPcs)||0;return Math.round(T*(se/D))};M(T=>({...T,requiredPcs:P()}))}else if(H==="requiredPcs"){const P=()=>{const T=parseFloat(h.requiredPcs)||0,D=parseFloat(h.availableQty)||0,se=parseFloat(h.totalPcs)||0;return(T*D/se).toFixed(2)};M(T=>({...T,assignedQty:P()}))}},[h.assignedQty,h.requiredPcs,H]);const $=P=>{const T=P.target.value;C("assignedQty"),M(D=>({...D,assignedQty:T}))},re=P=>{const T=P.target.value;C("requiredPcs"),M(D=>({...D,requiredPcs:T}))},te=async()=>{if(console.log(p),p.totalAmount===0&&p.costPerComponent===0){l("Please Thread, Tilla or Sequnce values ",{variant:"error",autoHideDuration:5e3});return}try{const P=await ye.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroideryDetails",{...p,additional:p.additional.join(", ")});P.data.success?l("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(l(`${P.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",P.data.message)),console.log("Save response:",P.data),M(T=>({...T,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,costPerComponent:0,createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId})),E(),R()}catch(P){console.error("Error saving data:",P),l("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},me=[{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"ThreadAdditional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Ne,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!t,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"Fabric",name:"fabricName",value:p.fabricName,onChange:x,size:"small",disabled:!0,sx:P=>({...p.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Component",name:"componentName",value:p.componentName,onChange:x,size:"small",disabled:!0,sx:P=>({...p.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"Color",name:"colourName",value:p.colourName,onChange:x,size:"small",disabled:!0,sx:P=>({...p.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:p.poPcs,onChange:x,size:"small",disabled:!0,sx:P=>({...p.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Heads",size:"small",name:"noOfHeadsName",value:p.noOfHeadsName,onChange:x,disabled:!0,sx:P=>({...p.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:p.cuttingSize,onChange:x,disabled:!0,sx:P=>({...p.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:p.itemsPerRepeat,onChange:x,disabled:!0,sx:P=>({...p.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:p.availableQty,onChange:x,disabled:!0,sx:P=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:p.remainingQty,onChange:x,disabled:!0,sx:P=>({...p.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:p.repeats,onChange:x,disabled:!0,sx:P=>({...p.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:p.totalPcs,onChange:x,disabled:!0,sx:P=>({...p.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Remaining Pcs",fullWidth:!0,size:"small",name:"remainingPcs",value:p.remainingPcs,onChange:x,disabled:!0,sx:P=>({...p.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:p.vendorId,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}},children:G.map(P=>e.jsx(L,{value:P.lookUpId,children:P.lookUpName},P.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:p.assignedQty,onChange:$,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Required Pcs",fullWidth:!0,disabled:!p.remainingPcs&&!p.remainingQty,size:"small",type:"number",name:"requiredPcs",value:p.requiredPcs,onChange:re,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4.5,children:e.jsx(r,{select:!0,label:"Additional",value:p.additional,name:"additional",size:"small",onChange:x,fullWidth:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:Q.map(P=>e.jsx(L,{value:P,style:q(P,p.additional,y),children:P},P))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(mt,{control:e.jsx(ht,{checked:p.isSolving,onChange:F,disabled:!p.remainingPcs&&!p.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:p.threadStiches,onChange:x,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:p.threadRate,onChange:x,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:p.threadAmount,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:p.tillaStiches,onChange:x,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:p.tilaRate,onChange:x,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:p.tilaAmount,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:p.sequence,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:p.sequenceRate,onChange:x,required:!0,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:p.sequenceAmount,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),p.isSolving?e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:p.solvingLayers,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:p.solvingInMeters,disabled:!p.remainingPcs&&!p.remainingQty,onChange:x,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:p.solvingRate,onChange:x,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:p.solvingAmount,disabled:!p.remainingPcs&&!p.remainingQty,onChange:x,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(r,{label:"Total Amount",fullWidth:!0,type:"text",size:"small",disabled:!p.remainingPcs&&!p.remainingQty,name:"totalAmount",value:p.totalAmount,onChange:x,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(r,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:p.costPerComponent,onChange:x,disabled:!p.remainingPcs&&!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:te,children:"Save"})})]})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(Ie,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Re,{iColumns:me,initialRows:u,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:E,disableEdit:!0})})]})})]})},Yt=()=>{rt();const{user:c}=ze(),[_,R]=s.useState(!0),{enqueueSnackbar:m}=Qe(),[t,y]=s.useState([]),[l,g]=s.useState(!1),[u,d]=s.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});s.useEffect(()=>{d({embroideryId:(t==null?void 0:t.embroideryId)||0,designId:(t==null?void 0:t.designId)||"",batchNo:(t==null?void 0:t.batchNo)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorId:(t==null?void 0:t.baseColorId)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[t]);const{data:B}=Ee(),[U,p]=s.useState(""),{data:M}=Be(),{data:Q,refetch:q}=Ye(U,{skip:!U}),{data:j,refetch:Z}=_e(u.designId,{skip:!u.designId}),{data:E,refetch:G}=Je({batchNo:u.planningHeaderId,componentId:u.componentId},{skip:!u.planningHeaderId||!u.componentId}),{data:f}=Ze({batchNo:u.planningHeaderId,componentId:u.componentId,fabricId:u.fabricId},{skip:!u.planningHeaderId||!u.componentId||!u.fabricId}),{data:x,refetch:F}=Mt(u.planningHeaderId,{skip:!u.planningHeaderId}),{data:H}=Ke(u.planningHeaderId,{skip:!u.planningHeaderId});console.log("formData.planningHeaderId",u.planningHeaderId),console.log("collectionData",B);const[C,h]=s.useState(!1),[A,K]=s.useState([]),[$,re]=s.useState([]),[te,me]=s.useState([]),[ve,P]=s.useState([]),[T,D]=s.useState([]),[se,Oe]=s.useState([]),[Y,le]=s.useState([]),[ee,ce]=s.useState([]);console.log("batchList",$),console.log("formData",u),s.useEffect(()=>{Q&&K(Q.result)},[Q]),s.useEffect(()=>{j&&re(j.result)},[j]),s.useEffect(()=>{E&&(G(),me(E.result))},[E,G]),s.useEffect(()=>{f&&Oe(E.result)},[f]),s.useEffect(()=>{H&&ce(H.result)},[H]),s.useEffect(()=>{x&&(R(!1),le(x.result.map((I,X)=>({id:X,...I}))))},[x,F]),console.log("embroideryList",x),console.log("initialRows",Y),s.useEffect(()=>{if(M){const I=M.result[0];P(I.vendorList),D(I.noOfHeadsList)}},[M]);const ue=(B==null?void 0:B.result)||[];s.useEffect(()=>{const I=()=>{const V=parseFloat(u.repeats)||0,Pe=parseFloat(u.itemsPerRepeat)||0;return(V*Pe).toFixed(2)};d(V=>({...V,totalPcs:I()}));const X=()=>{const V=parseFloat(u.threadStiches)||0,Pe=parseFloat(u.threadRate)||0,We=parseFloat(u.noOfHead)||0,Ue=parseFloat(u.repeats)||0;return(V/1e3*(Pe*Ue*We)).toFixed(2)};d(V=>({...V,threadAmount:X()}));const be=()=>{const V=parseFloat(u.tillaStiches)||0,Pe=parseFloat(u.tilaRate)||0,We=parseFloat(u.noOfHead)||0,Ue=parseFloat(u.repeats)||0;return(V/1e3*(Pe*Ue*We)).toFixed(2)};d(V=>({...V,tilaAmount:be()}));const J=()=>{const V=parseFloat(u.sequence)||0,Pe=parseFloat(u.sequenceRate)||0,We=parseFloat(u.noOfHead)||0,Ue=parseFloat(u.repeats)||0;return(V/1e3*(Pe*Ue*We)).toFixed(2)};d(V=>({...V,sequenceAmount:J()}));const he=()=>{const V=parseFloat(u.repeats)||0,Pe=parseFloat(u.noOfHead)||0,We=parseFloat(u.solvingLayers)||0;return(V*Pe*13/39.37*We).toFixed(2)};d(V=>({...V,solvingInMeters:he()}));const Fe=()=>{const V=parseFloat(u.solvingInMeters)||0,Pe=parseFloat(u.solvingRate)||0;return parseFloat(u.solvingLayers),(V*Pe).toFixed(2)};d(V=>({...V,solvingAmount:Fe()}));const It=()=>{const V=parseFloat(u.threadAmount)||0,Pe=parseFloat(u.tilaAmount)||0,We=parseFloat(u.sequenceAmount)||0,Ue=parseFloat(u.solvingAmount)||0;return(V+Pe+We+Ue).toFixed(2)};d(V=>({...V,totalAmount:It()||0}))},[u.threadAmount,u.totalAmount,u.sequenceAmount,u.solvingAmount,u.repeats,u.tilaAmount,u.itemsPerRepeat,u.threadRate,u.threadStiches,u.noOfHead,u.tilaRate,u.tillaStiches,u.sequenceRate,u.sequence,u.solvingLayers,u.solvingInMeters,u.solvingRate]);const S=I=>{const{name:X,value:be}=I.target;if(X==="collectionId")ue.find(J=>J.collectionId===parseInt(be)),p(be),g(!0),le([]),R(!0),d({...u,collectionId:be,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]});else if(X==="designId"){const J=A.find(he=>he.designId===parseInt(be));le([]),R(!0),d({...u,designId:be,baseColorId:J?J.colorId:"",baseColorName:J?J.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(X==="colorId"){const J=se.find(he=>he.colorId===be);d({...u,colorId:be,availableQty:J?J.total:"",cuttingSize:J?J.cuttingSize:"",repeats:J?J.repeats:"",noOfHead:J?J.noOfHeads:""})}else if(X==="batchNo"){const J=$.find(he=>he.batchNo===be);d({...u,batchNo:be,planningHeaderId:J?J.planningHeaderId:"",poPcs:J?J.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),h(!0),g(!1)}else d({...u,[X]:be}),ne(J=>({...J,[X]:""}))},[O,ne]=s.useState({}),N=async()=>{try{const I=await ye.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroidery",{...u,threadAdditional:u.threadAdditional.join(", ")});console.log("Save response:",I.data),I.data.success?m("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(m(`${I.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",I.data.message)),d(X=>({embroideryId:0,designId:X.designId,batchNo:X.batchNo,planningHeaderId:X.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:X.poPcs,baseColorId:X.baseColorId,baseColorName:X.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),F()}catch(I){console.error("Error saving data:",I),m("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",Y);const[w,ge]=s.useState({}),[Se,Ce]=s.useState(!1),ke=I=>{ge(I),Ce(!0)},[je,oe]=s.useState(!0),Ae=I=>{ge(I),Ce(!0),oe(!1)},Me=()=>{oe(!0),Ce(!1),ge({}),refetchDyeingPrintingData()};console.log("show div",je);const[we,pe]=s.useState(0),[Le,i]=s.useState(0),[a,n]=s.useState(0),[b,v]=s.useState(0);s.useEffect(()=>{const I=Y.reduce((he,Fe)=>he+(Fe.availableQty??0),0).toFixed(2),X=Y.reduce((he,Fe)=>he+(Fe.assignedQty??0),0).toFixed(2),be=Y.reduce((he,Fe)=>he+(Fe.totalPcs??0),0).toFixed(2),J=Y.reduce((he,Fe)=>he+(Fe.requiredPcs??0),0).toFixed(2);pe(parseFloat(I).toLocaleString()),i(parseFloat(X).toLocaleString()),n(parseFloat(be).toLocaleString()),v(parseFloat(J).toLocaleString())},[Y]);const k=[...Y,{id:"TOTAL_SUMMARY",availableQty:we,assignedQty:Le,totalPcs:a,requiredPcs:b}],z={sortable:!1,pinnable:!1,hideable:!1},W=[{field:"designNo",headerName:"Design",...z,colSpan:(I,X)=>X.id==="TOTAL_SUMMARY"?3:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):I.value},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component ",renderCell:I=>e.jsx(He,{label:I.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric "},{field:"vendorId",headerName:"Vendor"},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty",...z,valueGetter:I=>I.toLocaleString(),renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"assignedQty",headerName:"Assigned Qty",...z,valueGetter:I=>I,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"totalPcs",headerName:"Total Pcs",renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"requiredPcs",headerName:"Assigned Pcs",colSpan:(I,X)=>X.id==="TOTAL_SUMMARY"?4:void 0,renderCell:I=>I.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:I.value}):I.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:I=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(pt,{variant:"text",size:"small",children:[e.jsx(Te,{color:"primary",onClick:()=>ke(I.row),children:e.jsx(st,{})}),e.jsx(Te,{color:"primary",onClick:()=>Ae(I.row),children:e.jsx(qe,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(De,{src:Ht,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:U,onChange:S,size:"small",InputLabelProps:{sx:{color:"black"}},children:ue.map(I=>e.jsx(L,{value:I.collectionId,children:I.collectionName},I.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:u.designId,onChange:S,size:"small",InputLabelProps:{sx:{color:"black"}},children:A.map(I=>e.jsx(L,{value:I.designId,children:I.designNo},I.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:u.batchNo,onChange:S,size:"small",InputLabelProps:{sx:{color:"black"}},children:$.map(I=>e.jsx(L,{value:I.batchNo,children:I.batchNo},I.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:u.baseColorName,onChange:S,disabled:!0,sx:I=>({...u.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:u.componentId,onChange:S,size:"small",required:!0,error:!!O.componentId,helperText:O.componentId,InputLabelProps:{sx:{color:"black"}},children:ee.map(I=>e.jsx(L,{value:I.componentId,children:I.componentName},I.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:u.fabricId,onChange:S,required:!0,error:!!O.fabricId,helperText:O.fabricId,InputLabelProps:{sx:{color:"black"}},children:te.map(I=>e.jsx(L,{value:I.fabricId,children:I.fabric},I.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:u.colorId,onChange:S,required:!0,error:!!O.colorId,helperText:O.colorId,InputLabelProps:{sx:{color:"black"}},children:se.map(I=>e.jsx(L,{value:I.colorId,children:I.color},I.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:u.poPcs,onChange:S,disabled:!0,sx:I=>({...u.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:u.availableQty,onChange:S,InputLabelProps:{sx:{color:"black"}},sx:I=>({...u.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:u.repeats,onChange:S,InputLabelProps:{sx:{color:"black"}},sx:I=>({...u.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:u.noOfHead,onChange:S,required:!0,error:!!O.noOfHead,helperText:O.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:I=>({...u.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:T.map(I=>e.jsx(L,{value:I.lookUpId,children:I.lookUpName},I.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:u.cuttingSize,onChange:S,InputLabelProps:{sx:{color:"black"}},sx:I=>({...u.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:u.itemsPerRepeat,onChange:S,required:!0,error:!!O.itemsPerRepeat,helperText:O.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:I=>({...u.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:u.totalPcs,onChange:S})}),e.jsx(o,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:N,children:"Save"})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(qe,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(Re,{iColumns:W,initialRows:k,setInitialData:y,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:F,setAccordionExpanded:h,fileName:"Embroidery List",isLoading:_}),e.jsxs($e,{open:Se,onClose:Me,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(et,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(Ie,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Vendors "}),e.jsx(Te,{onClick:Me,sx:{color:"#ffffff"},children:e.jsx(at,{})})]}),e.jsxs(tt,{children:[e.jsx(ot,{id:"alert-dialog-slide-description"}),e.jsx(Et,{initialFormData:w,setInitialFormData:ge,refetchDyeingPrintingData:F,handleClickOpen:ke,showUpperDiv:je})]})]})]})})]})]})},Gt=Yt,Xt=()=>{const{user:c}=ze();console.log("user",c);const[_,R]=s.useState(!0),[m,t]=s.useState([]),[y,l]=s.useState([]),[g,u]=s.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedBy:c.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",g),s.useEffect(()=>{u({...g,processType:(m==null?void 0:m.processType)||"MultiHead",planningId:(m==null?void 0:m.planningId)||0,baseColorId:(m==null?void 0:m.baseColorId)||"",componentId:(m==null?void 0:m.componentId)||"",cuttingSize:(m==null?void 0:m.cuttingSize)||"",colorId:(m==null?void 0:m.colorId)||"",fabricId:(m==null?void 0:m.fabricId)||"",noOfHeads:(m==null?void 0:m.noOfHeads)||0,operatingMachineId:(m==null?void 0:m.operatingMachineId)||0,repeats:(m==null?void 0:m.repeats)||"",repeatSize:(m==null?void 0:m.repeatSize)||"",uomId:(m==null?void 0:m.uomId)||"",totalFabric:(m==null?void 0:m.totalFabric)||"",shrinkage:(m==null?void 0:m.shrinkage)||"",wastage:(m==null?void 0:m.wastage)||"",total:(m==null?void 0:m.total)||"",appId:1,createdOn:(m==null?void 0:m.createdOn)||new Date().toISOString(),createdBy:(m==null?void 0:m.createdBy)||c.empId,lastUpdatedBy:c.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(m==null?void 0:m.repeatsInMtr)||""})},[m]);const{data:d}=Ee(),[B,U]=s.useState(""),{data:p,refetch:M}=Ye(B,{skip:!B}),{data:Q,refetch:q}=Pt(g.planningHeaderId,{skip:!g.planningHeaderId}),{data:j}=Be(),[Z,E]=s.useState([]),{enqueueSnackbar:G}=Qe();console.log("lookupData",j);const[f,x]=s.useState([]);s.useEffect(()=>{d&&x(d.result)},[d]),s.useEffect(()=>{p&&(E(p.result),M())},[p]),s.useEffect(()=>{Q&&(R(!1),l(Q.result.map((i,a)=>({id:a,...i}))))},[Q,q]),console.log("designList",Z),console.log("collectionData",d);const[F,H]=s.useState(!1),[C,h]=s.useState([]),[A,K]=s.useState([]),[$,re]=s.useState([]),[te,me]=s.useState([]),[ve,P]=s.useState([]),[T,D]=s.useState([]),[se,Oe]=s.useState([]),[Y,le]=s.useState([]);console.log("components:",$),console.log("Fabrications:",te),console.log("colors:",ve),console.log("uoms:",T),console.log("heads:",se),console.log("lookupData",j),s.useEffect(()=>{if(j){const i=j.result[0];re(i.componentList),P(i.colorList),me(i.fabricList),Oe(i.noOfHeadsList),D(i.uomList),h(i.planningTypeProcessList),K(i.operatingMachineList)}},[j]),s.useEffect(()=>{const i=async a=>{try{const n=await ye.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${a}`);console.log(n.data),le(n.data.result)}catch(n){console.error("Error fetching pre-planning lookup data:",n)}};g.designId&&i(g.designId)},[g.designId,g.planningHeaderId]);const ee=g.planningProcessTypeId===212;console.log("isDyeing",ee),s.useEffect(()=>{const i=()=>{const z=parseFloat(g.poPcs)||0,W=parseFloat(g.cuttingSize)||0,ae=(z*W).toFixed(2);return parseFloat(ae).toLocaleString()},a=()=>{const z=parseFloat(g.repeats)||0,W=parseFloat(g.repeatSize)||0,ae=(z*W).toFixed(2);return parseFloat(ae).toLocaleString()},n=z=>{const W=z||0,ae=parseFloat(g.shrinkage)||0,I=parseFloat(g.wastage)||0,X=(W*(100+(ae+I))/100).toFixed(2);return parseFloat(X).toLocaleString()},b=()=>(.9144*(parseFloat(g.repeatSize)||0)).toFixed(2),v=()=>{const z=parseFloat(g.repeats)||0;return((parseFloat(g.repeatsInMtr)||0)*z).toFixed(2)};let k=0;ee?k=parseFloat(i().replace(/,/g,""))||0:k=parseFloat(a().replace(/,/g,""))||0,u(z=>({...z,totalFabric:k.toLocaleString(),total:n(k),repeatsInMtr:b()})),!ee&&g.isSchiffili&&u(z=>({...z,totalFabric:v()}))},[g.poPcs,g.cuttingSize,g.repeats,g.repeatSize,g.totalFabric,g.shrinkage,g.wastage,g.repeatsInMtr,g.isSchiffili,ee]);const[ce,ue]=s.useState(!1);s.useState(!1);const S=i=>{const{name:a,value:n}=i.target;if(a==="collectionId"){const b=f.find(v=>v.collectionId===parseInt(n));H(!0),l([]),R(!0),U(n),u({...g,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:n,noOfDesigns:b?b.noOfDesigns:"",noOfColors:b?b.noOfColors:""})}else if(a==="designId"){const b=Z.find(v=>v.designId===parseInt(n));l([]),R(!0),u({...g,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:n,baseColorId:b?b.colorId:"",baseColorName:b?b.colorName:""})}else if(a==="batchNo"){const b=Y.find(v=>v.batchNo===n);u({...g,componentId:"",processType:"MultiHead",poPcs:b?b.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:n,planningHeaderId:b?b.planningHeaderId:""}),ue(!0),H(!1)}else if(a==="planningProcessTypeId"){const b=C.find(v=>v.planningProcessTypeId===n);u({...g,planningProcessTypeId:n,planningProcessTypeName:b?b.lookUpName:"",noOfHeads:0,operatingMachineId:0}),ue(!0),H(!1)}else u({...g,[a]:n})},[O,ne]=s.useState({}),N=async()=>{const i=w();if(Object.keys(i).length>0){ne(i);return}try{const a={...g,totalFabric:parseFloat(g.totalFabric.replace(/,/g,"")),total:parseFloat(g.total.replace(/,/g,""))},n=await ye.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",a);console.log("Data saved successfully:",n.data),console.log("Save response:",n.data),n.data.success?G("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(G(`${n.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",n.data.message)),u(b=>({processType:"MultiHead",planningId:0,collectionId:b.collectionId,designId:b.designId,batchNo:b.batchNo,planningHeaderId:b.planningHeaderId,baseColorId:b.baseColorId,baseColorName:b.baseColorName,noOfDesigns:b.noOfDesigns,noOfColors:b.noOfColors,poPcs:b.poPcs,componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId,isSchiffili:!1,repeatsInMtr:""})),q()}catch(a){console.error("Error saving data:",a),G("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},w=()=>{const i={};return g.componentId||(i.componentId="componentId is required"),g.colorId||(i.colorId="colorId is required"),g.fabricId||(i.fabricId="fabricId is required"),g.cuttingSize||(i.cuttingSize="cuttingSize is required"),g.uomId||(i.uomId="uomId is required"),g.shrinkage||(i.shrinkage="shrinkage is required"),g.wastage||(i.wastage="wastage is required"),i};console.log("initialRows",y);const ge=y.reduce((i,a)=>i+(a.totalFabric??0),0).toFixed(2),Se=parseFloat(ge).toLocaleString();console.log("localizedTotalFabric",Se);const Ce=y.reduce((i,a)=>i+(a.total??0),0).toFixed(2),ke=parseFloat(Ce).toLocaleString(),je=[...y,{id:"TOTAL_SUMMARY",label:"Total Fabric",totalFabric:Se,total:ke}],oe={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",je);const Ae=[{field:"componentName",headerName:"Component",...oe,colSpan:(i,a)=>{if(a.id==="TOTAL_SUMMARY")return 9},valueGetter:(i,a)=>a.id==="TOTAL_SUMMARY"?a.label:i,renderCell:i=>e.jsx("div",{style:{color:i.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:i.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:i.value})},{field:"planningProcessTypeName",headerName:"Process Type",...oe,renderCell:i=>{const a=i.value==="MultiHead"?"primary.dark":i.value==="Schiffili"?theme.palette.grey[900]:i.value==="Dyeing"?"success.dark":"default";return e.jsx(He,{label:i.value,sx:{backgroundColor:a==="primary"||a==="default"?void 0:a,color:a==="primary"||a==="default"?void 0:"white"},color:a==="primary"?"primary":a==="default"?"default":void 0})}},{field:"color",headerName:"Color",...oe},{field:"cuttingSize",headerName:"Cutting Size",...oe},{field:"fabric",headerName:"Fabrication",...oe},{field:"noOfHeadName",headerName:"No. Of Heads",...oe},{field:"operatingMachineName",headerName:"Operating Machine",...oe},{field:"repeats",headerName:"Repeats",valueGetter:i=>i.toLocaleString(),...oe},{field:"repeatSize",headerName:"Repeat Size",valueGetter:i=>i.toLocaleString(),...oe},{field:"totalFabric",headerName:"Total Fabric",valueGetter:i=>i.toLocaleString(),renderCell:i=>e.jsx("div",{style:{color:i.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:i.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:i.value}),...oe},{field:"uom",headerName:"UOM",colSpan:(i,a)=>a.id==="TOTAL_SUMMARY"?2:void 0,valueGetter:(i,a)=>a.id==="TOTAL_SUMMARY"?"OverAll Total":i,renderCell:i=>e.jsx("div",{style:{color:i.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:i.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:i.value}),...oe},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:i=>i.toLocaleString(),colSpan:(i,a)=>a.id==="TOTAL_SUMMARY"?2:void 0,renderCell:i=>e.jsx("div",{style:{color:i.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:i.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:i.value}),...oe}],Me=g.planningProcessTypeId===198;s.useEffect(()=>{Me&&u({...g,uomId:139})},[Me]),console.log("formData",g);const we=({row:i,field:a})=>i.id==="TOTAL_SUMMARY"&&(a==="componentName"||a==="uom")?"bold":"";console.log("batchList:",Y);const pe="https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",Le=(i,a)=>{ue(!ce)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(gt,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:2.4,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g.collectionId,onChange:S,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:f.map(i=>e.jsx(L,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:g.designId,onChange:S,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:Z.map(i=>e.jsx(L,{value:i.designId,children:i.designNo},i.designId))})}),e.jsxs(o,{item:!0,xs:12,md:2.4,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:g.batchNo,onChange:S,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:Y.map(i=>e.jsx(L,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:g.poPcs,onChange:S,disabled:!0,sx:i=>({...g.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:2.4,children:e.jsx(r,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:g.baseColorName,onChange:S,disabled:!0,sx:i=>({...g.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"MainCard",avatar:e.jsx(it,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Te,{onClick:Le,sx:{mt:"-18px"},children:e.jsx(Ve,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(dt,{expanded:ce,onChange:Le,sx:{},children:[e.jsx(ct,{expandIcon:e.jsx(Ve,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(ut,{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:2,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:g.planningProcessTypeId,onChange:S,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:C.map(i=>e.jsx(L,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})," "]}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(Xe,{fullWidth:!0,options:$,getOptionLabel:i=>i.lookUpName,value:$.find(i=>i.lookUpId===g.componentId)||null,onChange:(i,a)=>{S({target:{name:"componentId",value:a?a.lookUpId:""}})},renderOption:(i,a)=>{const{lookUpName:n}=a;return e.jsx("span",{...i,children:n})},renderInput:i=>e.jsx(r,{...i,label:"Select Component",size:"small",name:"componentId",value:g.componentId,required:!0,error:!!O.componentId,helperText:O.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:i})=>e.jsx("div",{style:{backgroundColor:"white"},children:i})})}),e.jsxs(o,{item:!0,xs:12,md:2,children:[" ",e.jsx(Xe,{fullWidth:!0,options:ve,getOptionLabel:i=>i.lookUpName,value:ve.find(i=>i.lookUpId===g.colorId)||null,onChange:(i,a)=>{S({target:{name:"colorId",value:a?a.lookUpId:""}})},renderInput:i=>e.jsx(r,{...i,label:"Color",size:"small",value:g.colorId,name:"colorId",required:!0,error:!!O.colorId,helperText:O.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:i})=>e.jsx("div",{style:{backgroundColor:"white"},children:i})})]}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:g.cuttingSize,onChange:S,required:!0,error:!!O.cuttingSize,helperText:O.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(Xe,{fullWidth:!0,options:te,getOptionLabel:i=>i.lookUpName,value:te.find(i=>i.lookUpId===g.fabricId)||null,onChange:(i,a)=>{S({target:{name:"fabricId",value:a?a.lookUpId:""}})},renderInput:i=>e.jsx(r,{...i,label:"Fabrication",size:"small",name:"fabricId",value:g.fabricId,required:!0,error:!!O.fabricId,helperText:O.fabricId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:i})=>e.jsx("div",{style:{backgroundColor:"white"},children:i})})}),e.jsx(o,{item:!0,xs:12,md:2,children:Me?e.jsx(r,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:g.operatingMachineId,onChange:S,required:!0,disabled:ee,InputLabelProps:{sx:{color:"black"}},children:A.map(i=>e.jsx(L,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))}):e.jsx(r,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:g.noOfHeads,onChange:S,required:!0,disabled:ee,InputLabelProps:{sx:{color:"black"}},children:se.map(i=>e.jsx(L,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:g.repeats,onChange:S,required:!0,disabled:ee,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:g.repeatSize,onChange:S,disabled:ee,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:g.totalFabric,onChange:S,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:g.uomId,onChange:S,error:!!O.uomId,helperText:O.uomId,required:!0,disabled:Me,InputLabelProps:{sx:{color:"black"}},children:T.map(i=>e.jsx(L,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:g.shrinkage,onChange:S,error:!!O.shrinkage,helperText:O.shrinkage,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:g.wastage,onChange:S,error:!!O.wastage,helperText:O.wastage,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(r,{label:"Total",fullWidth:!0,size:"small",name:"total",value:g.total,onChange:S,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(o,{container:!0,spacing:1,width:"Inherit",children:e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Repeats in Meter",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:g.repeatsInMtr,onChange:S,sx:i=>({...g.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",children:e.jsx(ie,{variant:"contained",size:"small",onClick:N,children:"Save"})})]})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"MainCard",avatar:e.jsx(qe,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{sx:{paddingY:1,paddingX:1},children:e.jsx(o,{sx:{},item:!0,xs:12,children:e.jsx(Re,{iColumns:Ae,initialRows:je,setInitialData:t,deleteApi:pe,deleteBy:"planningId",refetch:q,getCellClassName:we,setAccordionExpanded:ue,fileName:"PrePlanningList",isLoading:_})})})]})]})},Vt=Xt,_t="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",Dt=()=>{const{user:c}=ze();console.log("user",c);const[_,R]=s.useState(!0),[m,t]=s.useState([]),[y,l]=s.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});s.useEffect(()=>{l({...y,dpId:m.dpId||0,fabricId:(m==null?void 0:m.fabricId)||"",colorId:(m==null?void 0:m.colorId)||"",color:(m==null?void 0:m.color)||"",processType:(m==null?void 0:m.processType)||"",availableQty:(m==null?void 0:m.availableQty)||"",Shrinkage:(m==null?void 0:m.shrinkage)||"",Wastage:(m==null?void 0:m.wastage)||"",outputQty:(m==null?void 0:m.outputQty)||0,UOM:(m==null?void 0:m.uom)||0,uomId:(m==null?void 0:m.uomId)||"",poPcs:(m==null?void 0:m.poPcs)||0,createdOn:(m==null?void 0:m.createdOn)||new Date().toISOString(),createdBy:(m==null?void 0:m.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[m]);const{enqueueSnackbar:g}=Qe(),[u,d]=s.useState(!1);console.log("Dyeing form data to send",y);const{data:B}=Ee(),[U,p]=s.useState(""),{data:M}=Be(),{data:Q,refetch:q}=Ye(U,{skip:!U}),{data:j,refetch:Z}=_e(y.designId,{skip:!y.designId}),{data:E}=jt({batchNo:y.planningHeaderId,processType:"Fabrication"},{skip:!y.planningHeaderId}),{data:G}=St({fabricId:y.fabricId,planningHeaderId:y.planningHeaderId},{skip:!y.fabricId||!y.planningHeaderId}),{data:f,refetch:x}=kt(y.planningHeaderId,{skip:!y.planningHeaderId}),[F,H]=s.useState([]),[C,h]=s.useState([]),[A,K]=s.useState([]),[$,re]=s.useState([]),[te,me]=s.useState([]),[ve,P]=s.useState([]);s.useState([]);const[T,D]=s.useState(!1);console.log("batchList",C),console.log("formData",y),s.useEffect(()=>{Q&&H(Q.result)},[Q]),s.useEffect(()=>{j&&h(j.result)},[j]),s.useEffect(()=>{E&&K(E.result)},[E]),s.useEffect(()=>{G&&P(G.result)},[G]),s.useEffect(()=>{f&&(R(!1),me(f.result.map((a,n)=>({id:n,...a}))))},[f,x]),s.useEffect(()=>{if(M){const a=M.result[0];re(a.uomList)}},[M]);const[se,Oe]=s.useState([]);s.useEffect(()=>{B&&Oe(B.result)},[B]);const Y=a=>{const{name:n,value:b}=a.target;if(n==="collectionId")se.find(v=>v.collectionId===parseInt(b)),p(b),d(!0),me([]),R(!0),l({...y,collectionId:b,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:""});else if(n==="designId"){const v=F.find(k=>k.designId===parseInt(b));me([]),R(!0),l({...y,designId:b,baseColorId:v?v.colorId:"",baseColorName:v?v.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(n==="batchNo"){const v=C.find(k=>k.batchNo===b);l({...y,batchNo:b,planningHeaderId:v?v.planningHeaderId:"",poPcs:v?v.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),D(!0),d(!1)}else if(n==="fabricId")A.find(v=>v.fabricId===b),console.log("Selected Fabric:",A),l({...y,fabricId:b});else if(n==="ColorId"){const v=ve.find(k=>k.colorId===b.colorId);l({...y,ColorId:b.colorId,color:v.color,availableQty:v.total,UOM:v.uom,Shrinkage:v.shrinkage,Wastage:v.wastage})}else n==="processType"?l({...y,processType:b}):n==="vendorId"?l({...y,vendorId:b}):(l({...y,[n]:b}),ee(v=>({...v,[n]:""})))};s.useEffect(()=>{const a=()=>{const W=parseFloat(y.availableQty)||0,ae=parseFloat(y.Shrinkage)||0,I=parseFloat(y.Wastage)||0;return(W*(100-(ae+I))/100).toFixed(2)},n=()=>{const W=parseFloat(y.availableQty)||0,ae=parseFloat(y.RatePerUOM)||0;return(W*ae).toFixed(2)},b=(W,ae)=>(W*(1+ae/100)).toFixed(2),v=a(),k=n(),z=parseFloat(y.GST)||0;b(k,z),parseFloat(y.poPcs),l(W=>({...W,outputQty:v}))},[y.availableQty,y.Shrinkage,y.Wastage,y.RatePerUOM,y.GST,y.poPcs,y.UnitRatePerPo]);const[le,ee]=s.useState({}),ce=async()=>{try{const a=await ye.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",y);console.log("Save response:",a.data),a.data.success?g("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(g(`${a.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",a.data.message)),l(n=>({designId:n.designId,planningHeaderId:n.planningHeaderId,batchNo:n.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:n.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),x()}catch(a){console.error("Error saving data:",a),g("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ue=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[S,O]=s.useState(!0),[ne,N]=s.useState({}),[w,ge]=s.useState(!1),Se=a=>{N(a),ge(!0)},Ce=a=>{N(a),ge(!0),O(!1)},ke=()=>{O(!0),ge(!1),N({}),x()},[je,oe]=s.useState(0),[Ae,Me]=s.useState(0);s.useEffect(()=>{const a=te.reduce((b,v)=>b+(v.availableQty??0),0).toFixed(2),n=te.reduce((b,v)=>b+(v.assignedQty??0),0).toFixed(2);oe(parseFloat(a).toLocaleString()),Me(parseFloat(n).toLocaleString())},[te]);const we=[...te,{id:"TOTAL_SUMMARY",componentName:"Total Summary",availableQty:je,assignedQty:Ae}],pe={sortable:!1,pinnable:!1,hideable:!1},Le=[{field:"fabricName",headerName:"Fabric",...pe,renderCell:a=>a.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):a.value},{field:"colorName",headerName:"Color",...pe,colSpan:(a,n)=>n.id==="TOTAL_SUMMARY"?2:void 0},{field:"processType",headerName:"Process Type",...pe,renderCell:a=>{const n=a.value==="Dyeing"?"primary.dark":a.value==="Printing"?"success.dark":"default";return e.jsx(He,{label:a.value,sx:{backgroundColor:n==="primary"||n==="default"?void 0:n,color:n==="primary"||n==="default"?void 0:"white"},color:n==="primary"?"primary":n==="default"?"default":void 0})}},{field:"uom",headerName:" UOM",...pe},{field:"poPcs",headerName:" PO PCS.",...pe},{field:"availableQty",headerName:"Available Quantitity",...pe,valueGetter:a=>a.toLocaleString(),renderCell:a=>a.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:a.value}):a.value},{field:"assignedQty",headerName:"Assigned Qty",...pe,valueGetter:a=>a.toLocaleString(),colSpan:(a,n)=>n.id==="TOTAL_SUMMARY"?4:void 0,renderCell:a=>a.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:a.value}):a.value},{field:"AddVendor",headerName:"Add Vendor",...pe,renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(pt,{variant:"text",size:"small",children:[e.jsx(Te,{color:"primary",onClick:()=>Se(a.row),children:e.jsx(st,{})}),e.jsx(Te,{color:"primary",onClick:()=>Ce(a.row),children:e.jsx(qe,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(De,{src:_t,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:U,onChange:Y,size:"small",InputLabelProps:{sx:{color:"black"}},children:se.map(a=>e.jsx(L,{value:a.collectionId,children:a.collectionName},a.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:y.designId,onChange:Y,size:"small",InputLabelProps:{sx:{color:"black"}},children:F.map(a=>e.jsx(L,{value:a.designId,children:a.designNo},a.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:y.batchNo,onChange:Y,size:"small",InputLabelProps:{sx:{color:"black"}},children:C.map(a=>e.jsx(L,{value:a.batchNo,children:a.batchNo},a.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:y.baseColorName,onChange:Y,disabled:!0,sx:a=>({...y.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:y.fabricId,onChange:Y,error:!!le.fabricId,helperText:le.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:A.map(a=>e.jsx(L,{value:a.fabricId,children:a.fabric},a.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(zt,{fullWidth:!0,options:ve,getOptionLabel:a=>a.color||"",renderInput:a=>e.jsx(r,{...a,label:"Color",name:"colorId",size:"small",error:!!le.colorId,helperText:le.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:a})=>e.jsx("div",{style:{backgroundColor:"white"},children:a}),value:ve.find(a=>a.colorId===y.colorId)||null,onChange:(a,n)=>{l(b=>({...b,colorId:n?n.colorId:"",color:n?n.color:"",availableQty:n?n.total:"",UOM:n?n.uom:"",uomId:n?n.uomId:"",Shrinkage:n?n.shrinkage:"",Wastage:n?n.wastage:""}))}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:y.processType,onChange:Y,error:!!le.processType,helperText:le.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:ue.map(a=>e.jsx(L,{value:a.value,children:a.label},a.value))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:y.poPcs,onChange:Y,disabled:!0,sx:a=>({...y.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:y.UOM,onChange:Y,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Available Qty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:y.availableQty,onChange:Y,disabled:!0,sx:a=>({...y.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(o,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(ie,{variant:"contained",color:"primary",size:"small",onClick:ce,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(qe,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(Re,{iColumns:Le,initialRows:we,setInitialData:t,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:x,setAccordionExpanded:D,fileName:"Dyeing&PrintingList",isLoading:_}),e.jsxs($e,{open:w,onClose:ke,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(et,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(Ie,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(Te,{onClick:ke,sx:{color:"#ffffff"},children:e.jsx(at,{})})]}),e.jsxs(tt,{children:[e.jsx(ot,{id:"alert-dialog-slide-description"}),e.jsx(qt,{initialFormData:ne,setInitialFormData:N,refetchDyeingPrintingData:x,handleClickOpen:Se,showUpperDiv:S})]})]})]})})]})]})},Jt=Dt,bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",Zt=()=>{const{user:c}=ze(),{enqueueSnackbar:_}=Qe(),[R,m]=s.useState(!0),[t,y]=s.useState([]),[l,g]=s.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId});s.useEffect(()=>{g({...l,schiffiliId:t.schiffiliId||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})},[t]);const[u,d]=s.useState(!1),B=(n,b)=>{d(!u)},[U,p]=s.useState(!1),{data:M}=Ee(),[Q,q]=s.useState(""),{data:j}=Be(),{data:Z,refetch:E}=Ye(Q,{skip:!Q}),{data:G,refetch:f}=_e(l.designId,{skip:!l.designId}),{data:x}=Je({batchNo:l.planningHeaderId,componentId:l.componentId},{skip:!l.planningHeaderId||!l.componentId}),{data:F}=Ze({batchNo:l.planningHeaderId,componentId:l.componentId,fabricId:l.fabricId},{skip:!l.planningHeaderId||!l.componentId||!l.fabricId}),{data:H,refetch:C}=Ot(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:h}=Ke(l.planningHeaderId,{skip:!l.planningHeaderId});console.log("formData.planningHeaderId",l.planningHeaderId),console.log("collectionData",M),console.log("schiffliList",H);const[A,K]=s.useState([]),[$,re]=s.useState([]),[te,me]=s.useState([]),[ve,P]=s.useState([]),[T,D]=s.useState([]),[se,Oe]=s.useState([]),[Y,le]=s.useState([]),[ee,ce]=s.useState([]),[ue,S]=s.useState([]);s.useEffect(()=>{Z&&K(Z.result)},[Z]),s.useEffect(()=>{G&&re(G.result)},[G]),s.useEffect(()=>{x&&me(x.result)},[x]),s.useEffect(()=>{F&&le(x.result)},[F]),s.useEffect(()=>{h&&S(h.result)},[h]),s.useEffect(()=>{H&&(m(!1),ce(H.result.map((n,b)=>({id:b,...n}))))},[H,C]),s.useEffect(()=>{if(j){const n=j.result[0];P(n.vendorList),D(n.operatingMachineList),Oe(n.workingHeadList)}},[j]),console.log("initialRows",ee);const O=(M==null?void 0:M.result)||[];s.useEffect(()=>{const n=()=>{const W=parseFloat(l.thaanQty)||0,ae=parseFloat(l.operatingMachine)||0;return(W*ae).toFixed(2)};g(W=>({...W,totalEmbroidry:n()}));const b=()=>{const W=parseFloat(l.thaanQty)||0,ae=parseFloat(l.noOfItemPerThaan)||0;return(W*ae).toFixed(2)};g(W=>({...W,totalPcs:b()}));const v=()=>{const W=parseFloat(l.noOfStichesPerYard)||0,ae=parseFloat(l.rate)||0;return(W/1e3*ae).toFixed(2)};g(W=>({...W,amountPerYard:v()}));const k=()=>{const W=parseFloat(l.totalAmount)||0,ae=parseFloat(l.totalPcs)||0;return(W/ae).toFixed(2)};g(W=>({...W,costPerComponent:k()}));const z=()=>{const W=parseFloat(l.amountPerYard)||0,ae=parseFloat(l.totalEmbroidry)||0,I=parseFloat(l.laserCutRate)||0,X=parseFloat(l.pcsForLaserCut)||0;return(W*ae+X*I).toFixed(2)};g(W=>({...W,totalAmount:z()}))},[l.thaanQty,l.operatingMachine,l.noOfStichesPerYard,l.rate,l.totalAmount,l.totalPcs,l.amountPerYard,l.totalEmbroidry,l.laserCutRate,l.pcsForLaserCut]);const ne=n=>{const{name:b,checked:v}=n.target;g(k=>({...k,[b]:v}))},N=n=>{const{name:b,value:v}=n.target;if(b==="collectionId")O.find(k=>k.collectionId===parseInt(v)),q(v),p(!0),ce([]),m(!0),g({...l,collectionId:v,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(b==="designId"){const k=A.find(z=>z.designId===parseInt(v));ce([]),m(!0),g({...l,designId:v,baseColorId:k?k.colorId:"",baseColorName:k?k.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(b==="batchNo"){const k=$.find(z=>z.batchNo===v);g({...l,batchNo:v,planningHeaderId:k?k.planningHeaderId:"",poPcs:k?k.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),d(!0),p(!1)}else if(b==="colorId"){const k=Y.find(z=>z.colorId===v);g({...l,colorId:v,availableQty:k?k.total:"",cuttingSize:k?k.cuttingSize:"",repeats:k?k.repeats:""})}else if(b==="operatingMachineId"){const k=T.find(z=>z.lookUpId===v);g({...l,operatingMachineId:v,operatingMachine:k?k.lookUpName:""})}else g({...l,[b]:v})};console.log("colors",Y);const[w,ge]=s.useState({}),Se=async()=>{const n=Ce();if(Object.keys(n).length>0){ge(n);return}try{const b=await ye.post("https://gecxc.com:4041/api/Schiffli/SaveSchiffili",l);console.log("Save response:",b.data),b.data.success?_("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(_(`${b.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",b.data.message)),g(v=>({designId:v.designId,planningHeaderId:v.planningHeaderId,batchNo:v.batchNo,baseColorName:v.baseColorName,schiffiliId:0,componentId:"",poPcs:v.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId})),C()}catch(b){console.error("Error saving data:",b),_("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Ce=()=>{const n={};return l.fabricId||(n.fabricId="fabricId is required"),l.colorId||(n.colorId="colorId is required"),l.vendorId||(n.vendorId="vendorId is required"),l.componentId||(n.componentId="componentId is required"),l.thaanQty||(n.thaanQty="thaanQty is required"),l.workingHeadId||(n.workingHeadId="workingHeadId is required"),l.rate||(n.rate="rate is required"),l.operatingMachineId||(n.operatingMachineId="operatingMachineId is required"),l.noOfStichesPerYard||(n.noOfStichesPerYard="noOfStichesPerYard is required"),l.noOfItemPerThaan||(n.noOfItemPerThaan="noOfItemPerThaan is required"),n};console.log("formData",l);const[ke,je]=s.useState(0),[oe,Ae]=s.useState(0),[Me,we]=s.useState(0);s.useEffect(()=>{const n=ee.reduce((k,z)=>k+(z.totalAmount??0),0).toFixed(2),b=ee.reduce((k,z)=>k+(z.totalEmbroidry??0),0).toFixed(2),v=ee.reduce((k,z)=>k+(z.totalPcs??0),0).toFixed(2);je(parseFloat(n).toLocaleString()),Ae(parseFloat(b).toLocaleString()),we(parseFloat(v).toLocaleString())},[ee]);const pe={id:"TOTAL_SUMMARY",fabricName:"Total Summary",totalAmount:ke,totalEmbroidry:oe,totalPcs:Me},Le=[...ee,pe],i=[{field:"fabricName",headerName:"Fabric",colSpan:(n,b)=>b.id==="TOTAL_SUMMARY"?2:void 0,renderCell:n=>n.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):n.value},{field:"componentName",headerName:"Component",renderCell:n=>e.jsx(He,{label:n.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:n=>n.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:n.value}):n.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:n=>n.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:n.value}):n.value},{field:"totalAmount",headerName:"Total Amount",renderCell:n=>n.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:n.value}):n.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(De,{src:bt,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:Q,onChange:N,size:"small",InputLabelProps:{sx:{color:"black"}},children:O.map(n=>e.jsx(L,{value:n.collectionId,children:n.collectionName},n.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:N,size:"small",InputLabelProps:{sx:{color:"black"}},children:A.map(n=>e.jsx(L,{value:n.designId,children:n.designNo},n.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:N,size:"small",InputLabelProps:{sx:{color:"black"}},children:$.map(n=>e.jsx(L,{value:n.batchNo,children:n.batchNo},n.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:n=>({...l.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(it,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Te,{onClick:B,sx:{mt:"-18px"},children:e.jsx(Ve,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(dt,{expanded:u,onChange:B,sx:{},children:[e.jsx(ct,{expandIcon:e.jsx(Ve,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(ut,{children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:l.componentId,onChange:N,size:"small",required:!0,error:!!w.componentId,helperText:w.componentId,InputLabelProps:{sx:{color:"black"}},children:ue.map(n=>e.jsx(L,{value:n.componentId,children:n.componentName},n.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:l.fabricId,onChange:N,required:!0,error:!!w.fabricId,helperText:w.fabricId,InputLabelProps:{sx:{color:"black"}},children:te.map(n=>e.jsx(L,{value:n.fabricId,children:n.fabric},n.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:l.vendorId,onChange:N,required:!0,error:!!w.vendorId,helperText:w.vendorId,InputLabelProps:{sx:{color:"black"}},children:ve.map(n=>e.jsx(L,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:l.colorId,onChange:N,required:!0,error:!!w.colorId,helperText:w.colorId,InputLabelProps:{sx:{color:"black"}},children:Y.map(n=>e.jsx(L,{value:n.colorId,children:n.color},n.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,disabled:!0,onChange:N,sx:n=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:l.availableQty,onChange:N,sx:n=>({...l.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:l.thaanQty,onChange:N,required:!0,error:!!w.thaanQty,helperText:w.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:l.operatingMachineId,onChange:N,required:!0,error:!!w.operatingMachineId,helperText:w.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:T.map(n=>e.jsx(L,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:l.workingHeadId,onChange:N,required:!0,error:!!w.workingHeadId,helperText:w.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:se.map(n=>e.jsx(L,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:l.cuttingSize,onChange:N,sx:n=>({...l.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:l.rate,onChange:N,required:!0,error:!!w.rate,helperText:w.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:l.noOfStichesPerYard,onChange:N,required:!0,error:!!w.noOfStichesPerYard,helperText:w.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:l.noOfItemPerThaan,onChange:N,required:!0,error:!!w.noOfItemPerThaan,helperText:w.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:l.totalEmbroidry,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:l.amountPerYard,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:l.totalPcs,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:l.costPerComponent,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:l.totalAmount,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(mt,{control:e.jsx(ht,{checked:l.laserCut,onChange:ne,name:"laserCut"}),label:"Laser Cut"})}),l.laserCut?e.jsx(o,{item:!0,xs:12,md:4.5,children:e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(r,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:l.laserCutRate,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(r,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:l.pcsForLaserCut,onChange:N,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:Se,children:"Save"})})]})})]})]}),e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(de,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(qe,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Re,{iColumns:i,initialRows:Le,setInitialData:y,deleteApi:"https://gecxc.com:4041/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:C,setAccordionExpanded:d,fileName:"Schffili List",isLoading:R})})})]})]})},Kt=Zt,$t=({additionalProcessData:c,setAdditionalProcessData:_,refetchAdditionalProcessList:R,handleClickOpen:m})=>{const{user:t}=ze(),[y,l]=s.useState([]),{enqueueSnackbar:g}=Qe(),u=y.reduce((f,x)=>f+(x.quantity??0),0).toFixed(2);console.log("Quantity",u);const[d,B]=s.useState({additionalProcessDetId:0,additionalProcessId:c.additionalProcessId||0,designId:c.designNo||"",planningHeaderId:c.planningHeaderId||0,batchNo:c.batchNo||"",componentName:c.componentName||"",componentId:c.componentId||"",colorName:c.colorName||"",colorId:c.colorId||"",fabricName:c.fabricName||"",fabricId:c.fabricId||"",uomId:c.uomId||"",uom:c.uom||"",vendorId:"",pcsPerComponent:c.pcsPerComponent||"",remainingPcsPerComponent:c.pcsPerComponent-u||"",processTypeName:c.processTypeName||"",processTypeId:c.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});s.useEffect(()=>{B({...d,remainingPcsPerComponent:c.pcsPerComponent-u||""})},[y]);const{data:U}=Be(),{data:p,refetch:M}=At(d.additionalProcessId,{skip:!d.additionalProcessId}),[Q,q]=s.useState([]);s.useEffect(()=>{if(U){const f=U.result[0];q(f.vendorList)}},[U]),s.useEffect(()=>{p&&l(p.result.map((f,x)=>({id:x,...f})))},[p,M]),console.log("initialRows",y);const j=f=>{const{name:x,value:F}=f.target;B({...d,[x]:F})};s.useEffect(()=>{const f=()=>{const F=parseFloat(d.quantity)||0,H=parseFloat(d.ratePerPcs)||0;return(F*H).toFixed(2)};B(F=>({...F,totalAmount:f()}));const x=()=>{const F=parseFloat(d.totalAmount)||0,H=parseFloat(d.poPcs)||0;return(F/H).toFixed(2)};B(F=>({...F,costPerComponent:x()}))},[d.quantity,d.ratePerPcs,d.totalAmount]);const Z=async()=>{console.log(d);try{const f=await ye.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcessDetails",d);console.log("Save response:",f.data),f.data.success?g("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(g(`${f.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",f.data.message)),M(),B(x=>({...x,vendorId:"",pcsPerComponent:c.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),R()}catch(f){console.error("Error saving data:",f),g("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},E=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:1},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Ne,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Select Design",name:"designId",value:d.designId,onChange:j,size:"small",disabled:!0,sx:f=>({...d.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:d.batchNo,onChange:j,size:"small",disabled:!0,sx:f=>({...d.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,label:"Components",name:"componentName",value:d.componentName,onChange:j,size:"small",disabled:!0,sx:f=>({...d.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:d.fabricName,onChange:j,disabled:!0,sx:f=>({...d.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:d.colorName,onChange:j,disabled:!0,sx:f=>({...d.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:d.processTypeName,onChange:j,disabled:!0,sx:f=>({...d.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:d.pcsPerComponent,onChange:j,disabled:!0,sx:f=>({...d.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:d.remainingPcsPerComponent,onChange:j,disabled:!0,sx:f=>({...d.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:d.vendorId,onChange:j,InputLabelProps:{sx:{color:"black"}},children:Q.map(f=>e.jsx(L,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:d.quantity,onChange:j,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:d.ratePerPcs,onChange:j,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:d.totalAmount,onChange:j,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:d.uom,onChange:j,disabled:!0,sx:f=>({...d.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:Z,children:"Save"})})]}),e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(o,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Re,{iColumns:E,initialRows:y,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:M,disableEdit:!0})})})]})},eo=()=>{const{user:c}=ze(),{enqueueSnackbar:_}=Qe(),[R,m]=s.useState(!0),[t,y]=s.useState([]),[l,g]=s.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId});console.log("initialData",t),s.useEffect(()=>{g({additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId})},[t]);const[u,d]=s.useState(!1),{data:B}=Ee(),[U,p]=s.useState(""),{data:M}=Be(),{data:Q,refetch:q}=Ye(U,{skip:!U}),{data:j,refetch:Z}=_e(l.designId,{skip:!l.designId}),{data:E}=Je({batchNo:l.planningHeaderId,componentId:l.componentId},{skip:!l.planningHeaderId||!l.componentId}),{data:G}=Ze({batchNo:l.planningHeaderId,componentId:l.componentId,fabricId:l.fabricId},{skip:!l.planningHeaderId||!l.componentId||!l.fabricId}),{data:f,refetch:x}=Lt(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:F}=Ke(l.planningHeaderId,{skip:!l.planningHeaderId});console.log("lookupData",M),console.log("collectionData",B),console.log("colorData",G);const[H,C]=s.useState([]),[h,A]=s.useState([]),[K,$]=s.useState([]),[re,te]=s.useState([]),[me,ve]=s.useState([]),[P,T]=s.useState([]),[D,se]=s.useState([]),[Oe,Y]=s.useState([]),[le,ee]=s.useState([]),[ce,ue]=s.useState([]),[S,O]=s.useState([]);console.log("batchData",j);const[ne,N]=s.useState([]);s.useEffect(()=>{B&&N(B.result)},[B]),s.useEffect(()=>{Q&&C(Q.result)},[Q]),s.useEffect(()=>{j&&A(j.result)},[j]),s.useEffect(()=>{E&&$(E.result)},[E]),s.useEffect(()=>{G&&ee(G.result)},[G]),s.useEffect(()=>{F&&O(F.result)},[F]),s.useEffect(()=>{if(M){const a=M.result[0];ve(a.uomList),T(a.processList)}},[M]),s.useEffect(()=>{f&&(m(!1),ue(f.result.map((a,n)=>({id:n,...a}))))},[f,x]),s.useEffect(()=>{if(M){const a=M.result[0];te(a.vendorList),se(a.operatingMachineList),Y(a.workingHeadList)}},[M]),console.log("initialRows",ce);const w=a=>{const{name:n,value:b}=a.target;if(n==="collectionId")ne.find(v=>v.collectionId===parseInt(b)),p(b),ue([]),m(!0),g({...l,collectionId:b,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId});else if(n==="designId"){const v=H.find(k=>k.designId===parseInt(b));ue([]),m(!0),g({...l,designId:b,baseColorId:v?v.colorId:"",baseColorName:v?v.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId})}else if(n==="batchNo"){const v=h.find(k=>k.batchNo===b);g({...l,batchNo:b,planningHeaderId:v?v.planningHeaderId:"",poPcs:v?v.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId}),d(!0)}else g({...l,[n]:b})};console.log("colors",le);const ge=async()=>{console.log("formData",l);try{const a=await ye.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcess",l);console.log("Save response:",a.data),a.data.success?_("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(_(`${a.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",a.data.message)),g(n=>({additionalProcessId:0,designId:n.designId,planningHeaderId:n.planningHeaderId,batchNo:n.batchNo,baseColorName:n.baseColorName,poPcs:n.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:c.empId})),x()}catch(a){console.error("Error saving data:",a),_("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",l),s.forwardRef(function(n,b){return e.jsx(Nt,{direction:"up",ref:b,...n})});const[Se,Ce]=s.useState({}),[ke,je]=s.useState(!1),oe=a=>{Ce(a),je(!0)},Ae=()=>{je(!1),Ce({}),x()},[Me,we]=s.useState(0);s.useEffect(()=>{const a=ce.reduce((n,b)=>n+(b.assignedQty??0),0).toFixed(2);we(parseFloat(a).toLocaleString())},[ce]);const pe=[...ce,{id:"TOTAL_SUMMARY",assignedQty:Me}],Le=[{field:"designNo",headerName:"Design",colSpan:(a,n)=>n.id==="TOTAL_SUMMARY"?3:void 0,renderCell:a=>a.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):a.value},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component",renderCell:a=>e.jsx(He,{label:a.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity",colSpan:(a,n)=>n.id==="TOTAL_SUMMARY"?3:void 0,valueGetter:a=>a,renderCell:a=>a.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:a.value}):a.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(Te,{color:"primary",onClick:()=>oe(a.row),children:e.jsx(st,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(De,{src:bt,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:U,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:ne.map(a=>e.jsx(L,{value:a.collectionId,children:a.collectionName},a.collectionId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:H.map(a=>e.jsx(L,{value:a.designId,children:a.designNo},a.designId))})}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:h.map(a=>e.jsx(L,{value:a.batchNo,children:a.batchNo},a.batchNo))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,onChange:w,disabled:!0,sx:a=>({...l.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsx(de,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(o,{item:!0,xs:12,md:3,children:[e.jsx(r,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:l.componentId,onChange:w,size:"small",InputLabelProps:{sx:{color:"black"}},children:S.map(a=>e.jsx(L,{value:a.componentId,children:a.componentName},a.componentId))})," "]}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:l.fabricId,onChange:w,InputLabelProps:{sx:{color:"black"}},children:K.map(a=>e.jsx(L,{value:a.fabricId,children:a.fabric},a.fabricId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:l.colorId,onChange:w,InputLabelProps:{sx:{color:"black"}},children:le.map(a=>e.jsx(L,{value:a.colorId,children:a.color},a.colorId))})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:w,disabled:!0,sx:a=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:1.5,children:e.jsx(r,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:l.pcsPerComponent,onChange:w,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:l.uomId,onChange:w,InputLabelProps:{sx:{color:"black"}},children:me.map(a=>e.jsx(L,{value:a.lookUpId,children:a.lookUpName},a.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:l.processTypeId,onChange:w,InputLabelProps:{sx:{color:"black"}},children:P.map(a=>e.jsx(L,{value:a.lookUpId,children:a.lookUpName},a.lookUpId))})}),e.jsx(o,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(ie,{variant:"contained",size:"small",onClick:ge,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(qe,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(o,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(o,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(Re,{iColumns:Le,initialRows:pe,setInitialData:y,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:x,setAccordionExpanded:d,fileName:"AdditionalProcess",isLoading:R}),e.jsxs($e,{open:ke,onClose:Ae,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(et,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(Ie,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(Te,{onClick:Ae,sx:{color:"#ffffff"},children:e.jsx(at,{})})]}),e.jsxs(tt,{children:[e.jsx(ot,{id:"alert-dialog-slide-description"}),e.jsx($t,{additionalProcessData:Se,setAdditionalProcessData:Ce,refetchAdditionalProcessList:x,handleClickOpen:oe})]})]})]})})]})]})},to=eo;function oo({}){const[c,_]=s.useState(!0),{data:R}=Be(),[m,t]=s.useState([]),[y,l]=s.useState([]),[g,u]=s.useState([]),[d,B]=s.useState([]),[U,p]=s.useState([]);ze(),s.useEffect(()=>{R&&(u(R.result[0].vendorList),l(R.result[0].serviceList),t(R.result[0].serviceTypeList),p(R.result[0].uomList))},[R]);const[M,Q]=s.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()}),q=async C=>{const{name:h,value:A}=C.target;if(console.log(`Updating ${h} to ${A}`),Q({...M,[h]:A}),h==="collectionId"){const K=d.find($=>$.collectionId===A);K&&Q($=>({...$,poPcs:K.poPcs}))}};s.useEffect(()=>{const C=()=>{const A=parseFloat(M.qty)||0,K=parseFloat(M.rate)||0;return(A*K).toFixed(2)};Q(A=>({...A,totalAmount:C()}));const h=()=>{const A=parseFloat(M.poPcs)||0,K=parseFloat(M.totalAmount)||0;return(A/K).toFixed(2)};Q(A=>({...A,costperPiece:h()}))},[M.qty,M.rate,M.totalAmount,M.costperPiece]);const j=async()=>{try{const C=await ye.post("https://gecxc.com:4041/api/AdditionalServices/SaveAdditionalServices",M);console.log("Form data saved:",C.data),Q({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(C){console.error("Error saving data:",C)}};s.useEffect(()=>{(async()=>{try{const h=await ye.get("https://gecxc.com:4041/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",h),B(h.data.result)}catch(h){console.error("Error fetching design options:",h)}})()},[]);const[Z,E]=s.useState([]),G=s.useCallback(async()=>{try{const C=await ye.get(`https://gecxc.com:4041/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${M.collectionId}`);Array.isArray(C.data.result)?(_(!1),E(C.data.result.map((h,A)=>({id:A,...h})))):(console.error("API returned unexpected data format:",C.data.result),E([]))}catch(C){console.error("Error fetching data:",C),E([])}},[M.collectionId]);s.useEffect(()=>{G()},[G]);const[f,x]=s.useState(0);s.useEffect(()=>{const C=Z.reduce((h,A)=>h+(A.totalAmount??0),0).toFixed(2);x(parseFloat(C).toLocaleString())},[Z]);const F=[...Z,{id:"TOTAL_SUMMARY",totalAmount:f}],H=[{field:"collectionName",headerName:"Collection Name",colSpan:(C,h)=>h.id==="TOTAL_SUMMARY"?3:void 0,renderCell:C=>C.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):C.value},{field:"serviceType",headerName:"Service Type",renderCell:C=>e.jsx(He,{label:C.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"serviceListName",headerName:"Service List Name",renderCell:C=>e.jsx(He,{label:C.value,sx:{backgroundColor:"success.dark",color:"white"},color:void 0})},{field:"vendor",headerName:"Vendor"},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount",renderCell:C=>C.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:C.value}):C.value},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:M.collectionId,onChange:q,size:"small",InputLabelProps:{sx:{color:"black"}},children:d.length>0?d.map(C=>e.jsx(L,{id:"collectionId",value:C.collectionId,children:C.collectionName},C.collectionId)):e.jsx(L,{disabled:!0,children:"No Collections Available"})})}),e.jsx(o,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:M.serviceTypeId,onChange:q,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:m.map(C=>e.jsx(L,{value:C.lookUpId,children:C.lookUpName},C.lookUpId))})}),e.jsx(o,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:M.serviceListId,onChange:q,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:y.map(C=>e.jsx(L,{value:C.lookUpId,children:C.lookUpName},C.lookUpId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:M.vendorId,onChange:q,InputLabelProps:{sx:{color:"black"}},children:g.map(C=>e.jsx(L,{value:C.lookUpId,children:C.lookUpName},C.lookUpId))})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:M.poPcs,onChange:q,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:C=>({...M.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-required",label:"Qty",name:"qty",value:M.qty,onChange:q,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(r,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:M.uomId,onChange:q,InputLabelProps:{sx:{color:"black"}},children:U.map(C=>e.jsx(L,{value:C.lookUpId,children:C.lookUpName},C.lookUpId))})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-required",label:"Rate",name:"rate",value:M.rate,onChange:q,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:M.totalAmount,onChange:q,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(r,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:M.costperPiece,onChange:q,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(o,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(ie,{variant:"contained",color:"primary",size:"small",onClick:j,children:"Save"})})]})]}),e.jsx(de,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(xe,{variant:"outlined",children:[e.jsx(fe,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Re,{iColumns:H,initialRows:F,isLoading:c})]})]})}const Ge=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function go(){const[c,_]=s.useState(0),[R,m]=s.useState(new Set),[t,y]=s.useState(null),[l,g]=s.useState([]),{enqueueSnackbar:u}=Qe(),{data:d,refetch:B}=Be(),U=h=>{y(h.currentTarget)},p=()=>{y(null)},M=!!t,Q=M?"simple-popover":void 0,q=h=>h===1,j=h=>R.has(h),Z=()=>{let h=R;j(c)&&(h=new Set(h.values()),h.delete(c)),_(A=>A+1),m(h)},E=()=>{_(h=>h-1)},G=()=>{if(!q(c))throw new Error("You can't skip a step that isn't optional.");_(h=>h+1),m(h=>{const A=new Set(h.values());return A.add(c),A})},f=()=>{_(0)},[x,F]=s.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),H=async()=>{if(!x.lookUpDomain||!x.lookUpName){u("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const h=await ye.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${x.lookUpDomain}&LookUpName=${x.lookUpName}&appId=1`);return console.log("Form data saved:",h.data),u("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),F({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),B(),h.data}catch(h){throw console.error("Error saving data:",h),u("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),h}},C=h=>{F({...x,[h.target.name]:h.target.value})};return s.useEffect(()=>{(async()=>{try{const A=await ye.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",A),g(A.data.result)}catch(A){console.error("Error fetching design options:",A)}})()},[]),e.jsxs(Ne,{sx:{width:"100%"},children:[e.jsxs(o,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(o,{item:!0,sm:6,children:e.jsx(Ie,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(o,{item:!0,sm:6,textAlign:"right",children:[e.jsx(ie,{"aria-describedby":Q,variant:"outlined",size:"small",onClick:U,children:"+Lookup"}),e.jsx(Wt,{id:"mouse-over-popover",open:M,anchorEl:t,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(o,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(o,{item:!0,sm:12,children:e.jsx(r,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:x.lookUpDomain,name:"lookUpDomain",onChange:C,children:l.map(h=>e.jsx(L,{value:h.lookUpDomain,children:h.lookUpDomain},h.lookUpDomain))})}),e.jsx(o,{item:!0,sm:12,children:e.jsx(r,{fullWidth:!0,label:"Add Lookup Description",value:x.lookUpName,onChange:C,name:"lookUpName",size:"small"})}),e.jsx(o,{item:!0,sm:3,textAlign:"right",children:e.jsx(ie,{variant:"contained",size:"small",onClick:H,children:"Save"})})]})})]})]}),e.jsx(Tt,{activeStep:c,children:Ge.map((h,A)=>{const K={},$={};return q(A)&&($.optional=e.jsx(Ie,{variant:"caption",children:"Optional"})),j(A)&&(K.completed=!1),e.jsx(Bt,{...K,children:e.jsxs(wt,{...$,onClick:()=>_(A),style:{cursor:"pointer"},children:[" ",h]})},h)})}),e.jsxs(Ne,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ie,{color:"inherit",disabled:c===0,onClick:E,sx:{mr:1},children:"Back"}),e.jsx(Ne,{sx:{flex:"1 1 auto"}}),q(c)&&e.jsx(ie,{color:"inherit",onClick:G,sx:{mr:1},children:"Skip"}),e.jsx(ie,{onClick:Z,children:c===Ge.length-1?"Finish":"Next"})]}),c===Ge.length?e.jsxs(s.Fragment,{children:[e.jsx(Ie,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(Ne,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Ne,{sx:{flex:"1 1 auto"}}),e.jsx(ie,{onClick:f,children:"Reset"})]})]}):e.jsxs(s.Fragment,{children:[c===0&&e.jsx(Vt,{}),c===1&&e.jsx(Ft,{}),c===2&&e.jsx(Jt,{}),c===3&&e.jsx(Gt,{}),c===4&&e.jsx(Kt,{}),c===5&&e.jsx(to,{}),c===6&&e.jsx(oo,{}),e.jsxs(Ne,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ie,{color:"inherit",disabled:c===0,onClick:E,sx:{mr:1},children:"Back"}),e.jsx(Ne,{sx:{flex:"1 1 auto"}}),q(c)&&e.jsx(ie,{color:"inherit",onClick:G,sx:{mr:1},children:"Skip"}),e.jsx(ie,{onClick:Z,children:c===Ge.length-1?"Finish":"Next"})]})]})]})}export{go as default};
