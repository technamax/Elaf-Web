import{a6 as U,a7 as J,j as h,r as B,i as ie,_ as ue,L as ve,a8 as me,B as Me}from"./index-QV_izsA6.js";import{a as ce}from"./axios-dN3qa5E9.js";import{a as pe,p as G,D as we,n as ye,q as xe}from"./DataGrid-LBF-WdiM.js";import{M as ge}from"./Skeleton-BeUP2jfQ.js";import{B as De}from"./TextField-CPLw8Kp8.js";var re={},_e=J;Object.defineProperty(re,"__esModule",{value:!0});var le=re.default=void 0,Se=_e(U()),be=h;le=re.default=(0,Se.default)((0,be.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var ne={},je=J;Object.defineProperty(ne,"__esModule",{value:!0});var de=ne.default=void 0,Ce=je(U()),ke=h;de=ne.default=(0,Ce.default)((0,ke.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var se={},Oe=J;Object.defineProperty(se,"__esModule",{value:!0});var fe=se.default=void 0,Re=Oe(U()),Ie=h;fe=se.default=(0,Re.default)((0,Ie.jsx)("path",{d:"M16 9v10H8V9zm-1.5-6h-5l-1 1H5v2h14V4h-3.5zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2z"}),"DeleteOutlined");var oe={},Ee=J;Object.defineProperty(oe,"__esModule",{value:!0});var he=oe.default=void 0,He=Ee(U()),Te=h;he=oe.default=(0,He.default)((0,Te.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");var ae={},Pe=J;Object.defineProperty(ae,"__esModule",{value:!0});var $e=ae.default=void 0,ze=Pe(U()),Ae=h;$e=ae.default=(0,ze.default)((0,Ae.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");const Le=["label","icon","showInMenu","onClick"],Ye=["label","icon","showInMenu","onClick","closeMenuOnClick","closeMenu"],K=B.forwardRef((D,N)=>{var p;const I=pe();if(!D.showInMenu){const{label:d,icon:O,onClick:$}=D,b=ie(D,Le),L=V=>{$==null||$(V)};return h.jsx(I.slots.baseIconButton,ue({ref:N,size:"small",role:"menuitem","aria-label":d},b,{onClick:L},(p=I.slotProps)==null?void 0:p.baseIconButton,{children:B.cloneElement(O,{fontSize:"small"})}))}const{label:C,icon:H,onClick:k,closeMenuOnClick:_=!0,closeMenu:x}=D,S=ie(D,Ye),y=d=>{k==null||k(d),_&&(x==null||x())};return h.jsxs(ge,ue({ref:N},S,{onClick:y,children:[H&&h.jsx(ve,{children:H}),C]}))});var Ne={exports:{}};(function(D,N){(function(I,C){D.exports=C()})(me,function(){var I=1e3,C=6e4,H=36e5,k="millisecond",_="second",x="minute",S="hour",y="day",p="week",d="month",O="quarter",$="year",b="date",L="Invalid Date",V=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,X=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ee={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var t=["th","st","nd","rd"],e=s%100;return"["+s+(t[(e-20)%10]||t[e]||t[0])+"]"}},W=function(s,t,e){var n=String(s);return!n||n.length>=t?s:""+Array(t+1-n.length).join(e)+s},te={s:W,z:function(s){var t=-s.utcOffset(),e=Math.abs(t),n=Math.floor(e/60),r=e%60;return(t<=0?"+":"-")+W(n,2,"0")+":"+W(r,2,"0")},m:function s(t,e){if(t.date()<e.date())return-s(e,t);var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,d),o=e-r<0,a=t.clone().add(n+(o?-1:1),d);return+(-(n+(e-r)/(o?r-a:a-r))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:d,y:$,w:p,d:y,D:b,h:S,m:x,s:_,ms:k,Q:O}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},T="en",R={};R[T]=ee;var Z="$isDayjsObject",u=function(s){return s instanceof j||!(!s||!s[Z])},m=function s(t,e,n){var r;if(!t)return T;if(typeof t=="string"){var o=t.toLowerCase();R[o]&&(r=o),e&&(R[o]=e,r=o);var a=t.split("-");if(!r&&a.length>1)return s(a[0])}else{var l=t.name;R[l]=t,r=l}return!n&&r&&(T=r),r||!n&&T},c=function(s,t){if(u(s))return s.clone();var e=typeof t=="object"?t:{};return e.date=s,e.args=arguments,new j(e)},i=te;i.l=m,i.i=u,i.w=function(s,t){return c(s,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var j=function(){function s(e){this.$L=m(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[Z]=!0}var t=s.prototype;return t.parse=function(e){this.$d=function(n){var r=n.date,o=n.utc;if(r===null)return new Date(NaN);if(i.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var a=r.match(V);if(a){var l=a[2]-1||0,f=(a[7]||"0").substring(0,3);return o?new Date(Date.UTC(a[1],l,a[3]||1,a[4]||0,a[5]||0,a[6]||0,f)):new Date(a[1],l,a[3]||1,a[4]||0,a[5]||0,a[6]||0,f)}}return new Date(r)}(e),this.init()},t.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},t.$utils=function(){return i},t.isValid=function(){return this.$d.toString()!==L},t.isSame=function(e,n){var r=c(e);return this.startOf(n)<=r&&r<=this.endOf(n)},t.isAfter=function(e,n){return c(e)<this.startOf(n)},t.isBefore=function(e,n){return this.endOf(n)<c(e)},t.$g=function(e,n,r){return i.u(e)?this[n]:this.set(r,e)},t.unix=function(){return Math.floor(this.valueOf()/1e3)},t.valueOf=function(){return this.$d.getTime()},t.startOf=function(e,n){var r=this,o=!!i.u(n)||n,a=i.p(e),l=function(A,w){var E=i.w(r.$u?Date.UTC(r.$y,w,A):new Date(r.$y,w,A),r);return o?E:E.endOf(y)},f=function(A,w){return i.w(r.toDate()[A].apply(r.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(w)),r)},v=this.$W,M=this.$M,g=this.$D,Y="set"+(this.$u?"UTC":"");switch(a){case $:return o?l(1,0):l(31,11);case d:return o?l(1,M):l(0,M+1);case p:var z=this.$locale().weekStart||0,q=(v<z?v+7:v)-z;return l(o?g-q:g+(6-q),M);case y:case b:return f(Y+"Hours",0);case S:return f(Y+"Minutes",1);case x:return f(Y+"Seconds",2);case _:return f(Y+"Milliseconds",3);default:return this.clone()}},t.endOf=function(e){return this.startOf(e,!1)},t.$set=function(e,n){var r,o=i.p(e),a="set"+(this.$u?"UTC":""),l=(r={},r[y]=a+"Date",r[b]=a+"Date",r[d]=a+"Month",r[$]=a+"FullYear",r[S]=a+"Hours",r[x]=a+"Minutes",r[_]=a+"Seconds",r[k]=a+"Milliseconds",r)[o],f=o===y?this.$D+(n-this.$W):n;if(o===d||o===$){var v=this.clone().set(b,1);v.$d[l](f),v.init(),this.$d=v.set(b,Math.min(this.$D,v.daysInMonth())).$d}else l&&this.$d[l](f);return this.init(),this},t.set=function(e,n){return this.clone().$set(e,n)},t.get=function(e){return this[i.p(e)]()},t.add=function(e,n){var r,o=this;e=Number(e);var a=i.p(n),l=function(M){var g=c(o);return i.w(g.date(g.date()+Math.round(M*e)),o)};if(a===d)return this.set(d,this.$M+e);if(a===$)return this.set($,this.$y+e);if(a===y)return l(1);if(a===p)return l(7);var f=(r={},r[x]=C,r[S]=H,r[_]=I,r)[a]||1,v=this.$d.getTime()+e*f;return i.w(v,this)},t.subtract=function(e,n){return this.add(-1*e,n)},t.format=function(e){var n=this,r=this.$locale();if(!this.isValid())return r.invalidDate||L;var o=e||"YYYY-MM-DDTHH:mm:ssZ",a=i.z(this),l=this.$H,f=this.$m,v=this.$M,M=r.weekdays,g=r.months,Y=r.meridiem,z=function(w,E,F,Q){return w&&(w[E]||w(n,o))||F[E].slice(0,Q)},q=function(w){return i.s(l%12||12,w,"0")},A=Y||function(w,E,F){var Q=w<12?"AM":"PM";return F?Q.toLowerCase():Q};return o.replace(X,function(w,E){return E||function(F){switch(F){case"YY":return String(n.$y).slice(-2);case"YYYY":return i.s(n.$y,4,"0");case"M":return v+1;case"MM":return i.s(v+1,2,"0");case"MMM":return z(r.monthsShort,v,g,3);case"MMMM":return z(g,v);case"D":return n.$D;case"DD":return i.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return z(r.weekdaysMin,n.$W,M,2);case"ddd":return z(r.weekdaysShort,n.$W,M,3);case"dddd":return M[n.$W];case"H":return String(l);case"HH":return i.s(l,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return A(l,f,!0);case"A":return A(l,f,!1);case"m":return String(f);case"mm":return i.s(f,2,"0");case"s":return String(n.$s);case"ss":return i.s(n.$s,2,"0");case"SSS":return i.s(n.$ms,3,"0");case"Z":return a}return null}(w)||a.replace(":","")})},t.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},t.diff=function(e,n,r){var o,a=this,l=i.p(n),f=c(e),v=(f.utcOffset()-this.utcOffset())*C,M=this-f,g=function(){return i.m(a,f)};switch(l){case $:o=g()/12;break;case d:o=g();break;case O:o=g()/3;break;case p:o=(M-v)/6048e5;break;case y:o=(M-v)/864e5;break;case S:o=M/H;break;case x:o=M/C;break;case _:o=M/I;break;default:o=M}return r?o:i.a(o)},t.daysInMonth=function(){return this.endOf(d).$D},t.$locale=function(){return R[this.$L]},t.locale=function(e,n){if(!e)return this.$L;var r=this.clone(),o=m(e,n,!0);return o&&(r.$L=o),r},t.clone=function(){return i.w(this.$d,this)},t.toDate=function(){return new Date(this.valueOf())},t.toJSON=function(){return this.isValid()?this.toISOString():null},t.toISOString=function(){return this.$d.toISOString()},t.toString=function(){return this.$d.toUTCString()},s}(),P=j.prototype;return c.prototype=P,[["$ms",k],["$s",_],["$m",x],["$H",S],["$W",y],["$M",d],["$y",$],["$D",b]].forEach(function(s){P[s[1]]=function(t){return this.$g(t,s[0],s[1])}}),c.extend=function(s,t){return s.$i||(s(t,j,c),s.$i=!0),c},c.locale=m,c.isDayjs=u,c.unix=function(s){return c(1e3*s)},c.en=R[T],c.Ls=R,c.p={},c})})(Ne);function Be({initialRows:D,ncolumns:N,formData:I,deleteApi:C,disableDelete:H,deleteBy:k,editAPi:_,disableEdit:x,disableAddRecord:S,refetch:y}){const[p,d]=B.useState(D),[O,$]=B.useState({});B.useEffect(()=>{d(D)},[D]);function b(u){const{setRows:m,setRowModesModel:c}=u,i=()=>{const j=p.length+1,P={id:j,...I,isNew:!0};m(s=>[...s,P]),c(s=>({...s,[j]:{mode:G.Edit,fieldToFocus:"collectionName"}}))};return h.jsx(ye,{children:h.jsx(De,{color:"primary",startIcon:h.jsx(le,{}),onClick:i,disab:!0,children:"Add record"})})}const L=(u,m)=>{u.reason===xe.rowFocusOut&&(m.defaultMuiPrevented=!0)},V=u=>()=>{$({...O,[u]:{mode:G.Edit}})},X=u=>async()=>{const c=p.find(i=>i.id===u)[k];try{await ce.delete(`${C}${c}`),d(p.filter(i=>i.id!==u))}catch(i){console.error("Error deleting data:",i)}},ee=u=>()=>{$({...O,[u]:{mode:G.View,ignoreModifications:!0}}),p.find(c=>c.id===u).isNew&&d(p.filter(c=>c.id!==u))},W=async(u,m)=>{console.log("newRow",u);try{const{id:c,...i}=u;console.log("formattedRow",i);const j=await ce.post(_,i),P={...j.data.result,id:u.id};return d(s=>s.map(t=>t.id===u.id?P:t)),console.log("response.data:",j.data),P;y()}catch(c){throw console.error("Error updating data:",c),c}},te=u=>{$(u)},T=u=>async()=>{$(m=>({...m,[u]:{mode:G.View}})),y()},R=[...N,{field:"actions",type:"actions",headerName:"Actions",width:100,cellClassName:"actions",getActions:({id:u})=>{var c;return((c=O[u])==null?void 0:c.mode)===G.Edit?[h.jsx(K,{icon:h.jsx(he,{}),label:"Save",sx:{color:"primary.main"},onClick:T(u)}),h.jsx(K,{icon:h.jsx($e,{}),label:"Cancel",className:"textPrimary",onClick:ee(u),color:"inherit",sx:{color:"error.dark"}})]:[h.jsx(K,{icon:h.jsx(de,{}),label:"Edit",className:"textPrimary",onClick:V(u),color:"inherit",sx:{color:"secondary.dark"},disabled:x}),h.jsx(K,{icon:h.jsx(fe,{}),label:"Delete",onClick:X(u),color:"inherit",sx:{color:"error.dark"},disabled:H})]}}],Z=(u,m)=>{m.defaultMuiPrevented=!0};return h.jsx(Me,{sx:{height:500,width:"inherit","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}},children:h.jsx(we,{rows:p,columns:R,editMode:"row",rowModesModel:O,onRowModesModelChange:te,onRowEditStop:L,processRowUpdate:W,slots:{toolbar:S?null:b},slotProps:{toolbar:{setRows:d,setRowModesModel:$}},getRowId:u=>u.id,onCellDoubleClick:Z})})}export{Be as F};
