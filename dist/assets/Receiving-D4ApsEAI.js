import{c as ge,u as je,N as ve,n as ye,O as Ie,P as Ce,j as e,B as O,C as X,d as Y,G as d,T as R,e as be,Q as Se,M as De}from"./index-k9GWQJOu.js";import{r as a}from"./vendor-BXCbSo2_.js";import{d as we}from"./CategoryOutlined-MdM7JIJy.js";import{d as j}from"./AssignmentOutlined-DQJc0R_Q.js";import{I as N,a as Re,B as v}from"./axios-CaswPiu6.js";import{d as P}from"./Close-CwC_dym4.js";import{R as Ne}from"./ReceivingDetails-DOjPavAN.js";import{R as U,a as G,b as k,c as T,d as B,B as _}from"./ReuseableDataGrid-D6KGNruf.js";import q from"./Reports-BgemgIcq.js";import{S as L}from"./StatusChip-DQNIzaKK.js";import{T as J}from"./TextField-Bw61L3Ab.js";import{M as K}from"./MenuItem-BJ2KxKJk.js";import{T as Pe,a as Ge,b as h,c}from"./TabPanel-CYIvsX5V.js";import"./Skeleton-C1-xTFDk.js";const ke=()=>{const{enqueueSnackbar:r}=ge(),{user:n}=je();a.useState([]),a.useState(!1);const[s,u]=a.useState({issuanceId:"",poId:"",productionId:"",ogpNumber:"",appId:n.appId,createdOn:new Date().toISOString(),createdBy:n.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:n.empId}),[p,y]=a.useState([]),[f,x]=a.useState([]),[l,o]=a.useState(null),[A,Z]=a.useState([]),[ee,te]=a.useState([]);a.useState(!1);const{data:I,error:Te,isLoading:Be,refetch:ae}=ve(s.productionId,{skip:!s.productionId}),{data:C,refetch:se}=ye(),{data:b,refetch:ie}=Ie(s.poId,{skip:!s.poId}),{data:g,refetch:Q}=Ce({issuanceId:l,processTypename:"Dyeing"},{skip:!l});console.log("receivingData",g);const[oe,re]=a.useState([]);a.useEffect(()=>{C&&re(C.result.map((t,i)=>({id:i,...t})))},[C,se]),a.useEffect(()=>{I&&x(I.result.map((t,i)=>({id:i+1,...t})))},[I,ae]),a.useEffect(()=>{g&&te(g.result.map((t,i)=>({id:i+1,...t})))},[g,Q]),console.log("issId",l),a.useEffect(()=>{b&&Z(b.result.map((t,i)=>({id:i,...t})))},[b,ie]),console.log("initialRows",p);const E=t=>{const{name:i,value:m}=t.target;if(i==="poId"){const V=f.find(xe=>xe.poId===parseInt(m));u({...s,poId:m,issuanceId:V?V.issuanceId:""})}else u({...s,[i]:m})},W=async()=>{try{const t=await Re.get(`http://100.42.177.77:8091/api/Receiving/GetIssuanceByPoIdAndOGPNumber?poId=${s.poId}`);console.log("Save response:",t.data),t.data.success?(r(`${t.data.message} !`,{variant:"success",autoHideDuration:5e3}),y(t.data.result.map((i,m)=>({id:m+1,...i})))):(r(`${t.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",t.data.message))}catch(t){console.error("Error saving data:",t),r("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};a.useEffect(()=>(W(),()=>{}),[s.poId]),console.log("formData",s);const[ne,z]=a.useState(!1),[le,M]=a.useState(!1),[de,$]=a.useState(!1),[S,D]=a.useState(!1),ce=async t=>{D(t),z(!0)},ue=async t=>{M(!0),D(t)},pe=async t=>{$(!0),D(t)},w=()=>{z(!1)},H=()=>{M(!1)},F=()=>{$(!1)},fe=async t=>{o(t.issuanceId),Q()},me=[{field:"id",headerName:"Sr#"},{field:"issuanceId",headerName:"Issuance#"},{field:"vendorName",headerName:"Vendor"},{field:"issuanceQuantity",headerName:"Total",valueGetter:t=>t.toLocaleString(),renderCell:t=>e.jsx(be,{label:t.value.toLocaleString(),sx:{backgroundColor:"primary.dark",color:"white"}})},{field:"dispatchedQuantity",headerName:"Dispatched",valueGetter:t=>t.toLocaleString(),renderCell:t=>e.jsx(L,{label:t.row.dispatchedQuantity.toLocaleString(),status:"Issued"})},{field:"receivedQty",headerName:"Received",renderCell:t=>e.jsx(L,{label:t.row.receivedQty.toLocaleString(),status:"Received"})},{field:"issuanceDate",headerName:"Issuance Date",valueGetter:t=>new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"expectedReturnDate",headerName:"Expected Return",valueGetter:t=>new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"Actions",headerName:"Actions",renderCell:t=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(_,{variant:"text",size:"small",sx:{mt:1},children:[e.jsx(v,{size:"small",color:"primary",onClick:()=>ce(t.row),disabled:t.row.status!==9||t.row.dispatchedQuantity===t.row.receivedQty,children:"Generate IGP"}),e.jsx(v,{size:"small",color:"primary",onClick:()=>fe(t.row),children:"View Receivings"}),e.jsx(v,{size:"small",color:"primary",onClick:()=>ue(t.row),children:"Receiving Report"})]})})}],he=[{field:"id",headerName:"Sr #"},{field:"collectionName",headerName:"Collection Name"},{field:"poName",headerName:"PO"},{field:"igpNumber",headerName:"IGP Number"},{field:"igpDate",headerName:"IGP Date",valueGetter:t=>new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"receivingDate",headerName:"Receiving Date",valueGetter:t=>new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"receivedQty",headerName:"Received"},{field:"processTypename",headerName:"Process Type"},{field:"statusName",headerName:"Status",renderCell:t=>e.jsx(L,{label:t.value,status:t.value})},{field:"Actions",headerName:"Actions",renderCell:t=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(_,{variant:"text",size:"small",sx:{mt:1},children:e.jsx(v,{size:"small",color:"primary",onClick:()=>pe(t.row),children:"IGP"})})})}];return e.jsxs(O,{sx:{width:"100%",typography:"body1"},children:[e.jsxs(X,{variant:"outlined",children:[e.jsx(Y,{className:"css-4rfrnx-MuiCardHeader-root",title:"Pending Receivables",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(d,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(d,{item:!0,xs:12,md:3,children:e.jsx(J,{fullWidth:!0,select:!0,label:"Production",name:"productionId",value:s.productionId,onChange:E,size:"small",children:oe.map(t=>e.jsx(K,{value:t.productionId,children:t.collectionName},t.productionId))})}),e.jsx(d,{item:!0,xs:12,md:3,children:e.jsx(J,{fullWidth:!0,select:!0,label:"PO#",name:"poId",value:s.poId,onChange:E,size:"small",children:f.map(t=>e.jsx(K,{value:t.poId,children:t.poIdName},t.poId))})}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx(U,{initialRows:p,iColumns:me,onRowDoubleClick:t=>o(t.row.issuanceId),hideAction:!0}),e.jsxs(G,{open:ne,onClose:w,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(k,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(R,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Receiving Details"}),e.jsx(N,{onClick:w,sx:{color:"#ffffff"},children:e.jsx(P,{})})]}),e.jsxs(T,{children:[e.jsx(B,{id:"alert-dialog-slide-description"}),e.jsx(Ne,{iss:S,handleClose:w,refetchIssuanceData:W})]})]}),e.jsxs(G,{open:le,onClose:H,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(k,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(R,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx(N,{onClick:H,sx:{color:"#ffffff"},children:e.jsx(P,{})})]}),e.jsxs(T,{children:[e.jsx(B,{id:"alert-dialog-slide-description"}),e.jsx(q,{rId:16,receiving:{paramIssuanceId:S.issuanceId}})]})]})]})]})]}),e.jsxs(X,{variant:"outlined",sx:{marginTop:2},children:[e.jsx(Y,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Receivings",titleTypographyProps:{style:{color:"white"}}}),e.jsx(d,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(d,{item:!0,xs:12,children:[e.jsx(U,{initialRows:ee,iColumns:he,hideAction:!0}),e.jsxs(G,{open:de,onClose:F,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(k,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(R,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx(N,{onClick:F,sx:{color:"#ffffff"},children:e.jsx(P,{})})]}),e.jsxs(T,{children:[e.jsx(B,{id:"alert-dialog-slide-description"}),e.jsx(q,{rId:14,igpReport:{ParamIGPNumber:S.igpNumber}})]})]})]})})]})]})},Ue=()=>{var f,x,l;const r=Se(),n=(f=r.state)==null?void 0:f.data,s=(l=(x=r.state)==null?void 0:x.tab)==null?void 0:l.toString();console.log("rowData",n),console.log("tab",s);const[u,p]=a.useState("1"),y=(o,A)=>{p(A),console.log("value",u)};return a.useEffect(()=>{s&&p(s)},[s]),e.jsx(De,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(O,{sx:{width:"100%",typography:"body1"},children:e.jsxs(Pe,{value:u,children:[e.jsx(O,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Ge,{onChange:y,children:[e.jsx(h,{icon:e.jsx(we,{}),label:"Dyeing Receiving",value:"1",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(h,{icon:e.jsx(j,{}),label:"Embroidery Receiving",value:"2",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(h,{icon:e.jsx(j,{}),label:"Schiffili Receiving",value:"3",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(h,{icon:e.jsx(j,{}),label:"Additional Process Receiving",value:"4",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(h,{icon:e.jsx(j,{}),label:"Additional Services Receiving",value:"5",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})})]})}),e.jsx(c,{value:"1",children:e.jsx(ke,{rowData:n})}),e.jsx(c,{value:"2"}),e.jsx(c,{value:"3"}),e.jsx(c,{value:"4"}),e.jsx(c,{value:"5"}),e.jsx(c,{value:"6"})]})})})};export{Ue as default};
