import{j as e,_ as rt,r as it,i as dt,u as Se,b as je,a5 as ct,B as Me,G as a,D as ce,S as _e,c as Ne,a6 as ut,T as fe,a7 as Be,a8 as Te,a9 as We,aa as Ue,ab as qe,ac as pt,ad as Ee,C as me,d as he,ae as He,af as mt,ag as ht,ah as gt,ai as bt,aj as It,ak as xt,al as ft,am as yt}from"./index-BNJRzY36.js";import{r as o}from"./vendor-BXCbSo2_.js";import{B as ie,a as ge,I as ke}from"./axios-6bxm8tWY.js";import{d as $e,c as ze,A as et,e as tt,f as at,S as Ct,a as Pt,b as vt,F as Mt}from"./Fabrication-B7mqPoJS.js";import{R as Oe,d as Ae,D as Ge,a as Ye,b as Xe,c as Ve,B as jt}from"./ReuseableDataGrid-Ast58ONo.js";import{d as De}from"./Close-rTqFuf_B.js";import{d as Je}from"./PersonAddAlt1Outlined-8JaXNHKY.js";import{T as l,P as kt}from"./TextField-PP-VWxC4.js";import{M as S}from"./Skeleton-D0EzwVRA.js";import{A as we,F as ot,C as st}from"./ExcelExport-CskTXQIo.js";import"./dayjs.min-DO4_1a-m.js";let Ke=!1;const St=o.forwardRef(function(ee,E){return Ke||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),Ke=!0),e.jsx(we,rt({ref:E},ee))});var Ze={},Ot=dt;Object.defineProperty(Ze,"__esModule",{value:!0});var nt=Ze.default=void 0,Nt=Ot(it()),Lt=e;nt=Ze.default=(0,Nt.default)((0,Lt.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const At="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",Bt=({initialFormData:d,setAdditionalProcessData:ee,refetchDyeingPrintingData:E,handleClickOpen:p})=>{const{user:t}=Se(),[x,n]=o.useState([]),m=x.reduce((M,P)=>M+(P.assignedQty??0),0).toFixed(2);console.log("Quantity",m);const[s,I]=o.useState({dpIdDet:0,dpId:d.dpId||0,designId:d.designId||"",batchNo:d.batchNo||"",planningHeaderId:d.planningHeaderId||0,fabricId:d.fabricId||"",colorId:d.colorId||"",colorName:d.colorName||"",vendorId:"",processType:d.processType||"",availableQty:d.availableQty||"",remainingQty:d.availableQty-m||"",shrinkage:"",wastage:"",uomId:d.uomId||"",uom:d.uom||"",poPcs:d.poPcs||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});o.useEffect(()=>{I({...s,remainingQty:d.availableQty-m||""})},[x]);const{data:W}=je(),{data:V,refetch:c}=ct(s.dpId,{skip:!s.dpId}),[y,G]=o.useState([]);o.useEffect(()=>{if(W){const M=W.result[0];G(M.vendorList)}},[W]),o.useEffect(()=>{V&&n(V.result.map((M,P)=>({id:P,...M})))},[V,c]),console.log("initialRows",x);const O=M=>{const{name:P,value:h}=M.target;I({...s,[P]:h})};o.useEffect(()=>{const M=()=>{const ae=parseFloat(s.availableQty)||0,ue=parseFloat(s.shrinkage)||0,pe=parseFloat(s.wastage)||0;return(ae*(100-(ue+pe))/100).toFixed(2)},P=()=>{const ae=parseFloat(s.assignedQty)||0,ue=parseFloat(s.rate)||0;return(ae*ue).toFixed(2)},h=(ae,ue)=>(ae*(1+ue/100)).toFixed(2),L=M(),w=P(),J=parseFloat(s.gst)||0,g=h(w,J),D=parseFloat(s.poPcs)||0,ne=D?g/D:0;I(ae=>({...ae,outputQty:L,totalExcGst:w,TotalIncludingGst:g,unitRatePerPo:ne.toFixed(2)}))},[s.availableQty,s.shrinkage,s.wastage,s.rate,s.gst,s.poPcs,s.unitRatePerPo]),console.log("formData",s);const k=async()=>{console.log(s);try{const M=await ge.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrintingDetails",s);console.log("Save response:",M.data),I(P=>({...P,dpIdDet:0,vendorId:"",availableQty:d.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),c(),E()}catch(M){console.error("Error saving data:",M)}},oe=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:M=>M.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:M=>M.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:M=>M.toLocaleString()},{field:"unitRatePerPo",headerName:"unitRatePerPo.",flex:1}];return e.jsxs(Me,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Fabric",name:"fabricName",value:s.fabricName,onChange:O,size:"small",disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Process Type",name:"processType",value:s.processType,onChange:O,size:"small",disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Color",name:"colorName",value:s.colorName,onChange:O,size:"small",disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"UOM",name:"uom",value:s.uom,onChange:O,size:"small",disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:s.poPcs,onChange:O,disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:s.availableQty,onChange:O,disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:s.remainingQty,onChange:O,disabled:!0,sx:M=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:s.vendorId,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}},children:y.map(M=>e.jsx(S,{value:M.lookUpId,children:M.lookUpName},M.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:s.assignedQty,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:s.rate,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:s.shrinkage,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:s.wastage,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:s.outputQty,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:s.totalExcGst,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:s.gst,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:s.TotalIncludingGst,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:s.unitRatePerPo,onChange:O,disabled:!s.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:k,children:"Save"})})]}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Oe,{iColumns:oe,initialRows:x,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:c,disableEdit:!0})})})]})},Tt=({initialFormData:d,setAdditionalProcessData:ee,refetchDyeingPrintingData:E,handleClickOpen:p,showUpperDiv:t})=>{const x=_e(),{enqueueSnackbar:n}=Ne(),{user:m}=Se(),[s,I]=o.useState([]),W=s.reduce((f,H)=>f+(H.assignedQty??0),0).toFixed(2);console.log("Quantity",W);const V=s.reduce((f,H)=>f+(H.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",V);const[c,y]=o.useState({embroideryIdDet:0,embroideryId:d.embroideryId||0,designId:d.designId||"",batchNo:d.batchNo||"",planningHeaderId:d.planningHeaderId||0,componentId:d.componentId||"",componentName:d.componentName||"",fabricId:d.fabricId||"",fabricName:d.fabricName||"",vendorId:"",colorId:d.colorId||"",colourName:d.colourName||"",availableQty:d.availableQty||"",assignedQty:"",remainingQty:(d.availableQty-W).toFixed(2)||0,noOfHead:d.noOfHead||"",noOfHeadsName:d.noOfHeadsName||"",repeats:d.repeats||"",assignedRepeats:"",remainingRepeats:d.repeats-V||"",cuttingSize:d.cuttingSize||"",itemsPerRepeat:d.itemsPerRepeat||"",poPcs:d.poPcs||"",totalPcs:d.totalPcs||"",remainingPcs:(d.totalPcs-V).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:m.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:m.empId}),G=["Boring","Pooni","Laser","Doori","Dissolving"];function O(f,H,$){return{fontWeight:H.indexOf(f)===-1?$.typography.fontWeightRegular:$.typography.fontWeightMedium}}o.useEffect(()=>{y({...c,remainingQty:d.availableQty-W||0,remainingPcs:d.totalPcs-V||0})},[s]);const{data:k}=je(),{data:oe,refetch:K}=ut(c.embroideryId,{skip:!c.embroideryId}),[M,P]=o.useState([]);o.useEffect(()=>{if(k){const f=k.result[0];P(f.vendorList)}},[k]),o.useEffect(()=>{oe&&I(oe.result.map((f,H)=>({id:H,...f})))},[oe,K]),console.log("initialRows",s);const h=f=>{const{name:H,value:$}=f.target;y({...c,[H]:$})},L=f=>{const{name:H,checked:$}=f.target;y(le=>({...le,[H]:$}))};console.log("formData",c);const[w,J]=o.useState(null),[g,D]=o.useState(c);o.useEffect(()=>{const f=setTimeout(()=>{D(c)},50);return()=>{clearTimeout(f)}},[c]),o.useEffect(()=>{const f=()=>{const z=parseFloat(g.repeats)||0,Z=parseFloat(g.itemsPerRepeat)||0;return(z*Z).toFixed(2)},H=()=>{const z=parseFloat(g.threadStiches)||0,Z=parseFloat(g.threadRate)||0,R=parseFloat(g.noOfHead)||0,N=parseFloat(g.repeats)||0;return(z/1e3*(Z*N*R)).toFixed(2)},$=()=>{const z=parseFloat(g.tillaStiches)||0,Z=parseFloat(g.tilaRate)||0,R=parseFloat(g.noOfHead)||0,N=parseFloat(g.repeats)||0;return(z/1e3*(Z*N*R)).toFixed(2)},le=()=>{const z=parseFloat(g.sequence)||0,Z=parseFloat(g.sequenceRate)||0,R=parseFloat(g.noOfHead)||0,N=parseFloat(g.repeats)||0;return(z/1e3*(Z*N*R)).toFixed(2)},be=()=>{const z=parseFloat(g.repeats)||0,Z=parseFloat(g.noOfHead)||0,R=parseFloat(g.solvingLayers)||0;return(z*Z*13/39.37*R).toFixed(2)},Ie=()=>{const z=parseFloat(g.solvingInMeters)||0,Z=parseFloat(g.solvingRate)||0;return(z*Z).toFixed(2)},te=()=>{const z=parseFloat(g.threadAmount)||0,Z=parseFloat(g.tilaAmount)||0,R=parseFloat(g.sequenceAmount)||0,N=parseFloat(g.solvingAmount)||0;return(z+Z+R+N).toFixed(2)},de=()=>{const z=parseFloat(g.totalAmount)||0,Z=parseFloat(g.totalPcs)||0;return(z/Z).toFixed(2)};y(z=>({...z,totalPcs:f(),threadAmount:H(),tilaAmount:$(),sequenceAmount:le(),solvingInMeters:be(),solvingAmount:Ie(),totalAmount:te(),costPerComponent:de()}))},[g.threadAmount,g.totalAmount,g.sequenceAmount,g.solvingAmount,g.repeats,g.tilaAmount,g.itemsPerRepeat,g.threadRate,g.threadStiches,g.noOfHead,g.tilaRate,g.tillaStiches,g.sequenceRate,g.sequence,g.solvingLayers,g.solvingInMeters,g.solvingRate]),o.useEffect(()=>{if(w==="assignedQty"){const f=()=>{const H=parseFloat(g.assignedQty)||0,$=parseFloat(g.availableQty)||0,le=parseFloat(g.totalPcs)||0;return Math.round(H*(le/$))};y(H=>({...H,requiredPcs:f()}))}else if(w==="requiredPcs"){const f=()=>{const H=parseFloat(g.requiredPcs)||0,$=parseFloat(g.availableQty)||0,le=parseFloat(g.totalPcs)||0;return(H*$/le).toFixed(2)};y(H=>({...H,assignedQty:f()}))}},[g.assignedQty,g.requiredPcs,w]);const ne=f=>{const H=f.target.value;J("assignedQty"),y($=>({...$,assignedQty:H}))},ae=f=>{const H=f.target.value;J("requiredPcs"),y($=>({...$,requiredPcs:H}))},ue=async()=>{if(console.log(c),c.totalAmount===0&&c.costPerComponent===0){n("Please Thread, Tilla or Sequnce values ",{variant:"error",autoHideDuration:5e3});return}try{const f=await ge.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroideryDetails",{...c,additional:c.additional.join(", ")});f.data.success?n("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(n(`${f.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",f.data.message)),console.log("Save response:",f.data),y(H=>({...H,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,costPerComponent:0,createdOn:new Date().toISOString(),createdBy:m.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:m.empId})),K(),E()}catch(f){console.error("Error saving data:",f),n("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},pe=[{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"ThreadAdditional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Me,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!t,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(fe,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Fabric",name:"fabricName",value:c.fabricName,onChange:h,size:"small",disabled:!0,sx:f=>({...c.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Component",name:"componentName",value:c.componentName,onChange:h,size:"small",disabled:!0,sx:f=>({...c.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Color",name:"colourName",value:c.colourName,onChange:h,size:"small",disabled:!0,sx:f=>({...c.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:c.poPcs,onChange:h,size:"small",disabled:!0,sx:f=>({...c.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"noOfHead",size:"small",name:"noOfHeadsName",value:c.noOfHeadsName,onChange:h,disabled:!0,sx:f=>({...c.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:c.cuttingSize,onChange:h,disabled:!0,sx:f=>({...c.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:c.itemsPerRepeat,onChange:h,disabled:!0,sx:f=>({...c.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:c.availableQty,onChange:h,disabled:!0,sx:f=>({...c.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:c.remainingQty,onChange:h,disabled:!0,sx:f=>({...c.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:c.repeats,onChange:h,disabled:!0,sx:f=>({...c.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:c.totalPcs,onChange:h,disabled:!0,sx:f=>({...c.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"remainingPcs",fullWidth:!0,size:"small",name:"remainingPcs",value:c.remainingPcs,onChange:h,disabled:!0,sx:f=>({...c.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:c.vendorId,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}},children:M.map(f=>e.jsx(S,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:c.assignedQty,onChange:ne,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Required Pcs",fullWidth:!0,disabled:!c.remainingPcs&&!c.remainingQty,size:"small",type:"number",name:"requiredPcs",value:c.requiredPcs,onChange:ae,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsx(l,{select:!0,label:"Additional",value:c.additional,name:"additional",size:"small",onChange:h,fullWidth:!0,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:G.map(f=>e.jsx(S,{value:f,style:O(f,c.additional,x),children:f},f))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(ot,{control:e.jsx(st,{checked:c.isSolving,onChange:L,disabled:!c.remainingPcs&&!c.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(fe,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:c.threadStiches,onChange:h,required:!0,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:c.threadRate,onChange:h,required:!0,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:c.threadAmount,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(fe,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:c.tillaStiches,onChange:h,required:!0,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:c.tilaRate,onChange:h,required:!0,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:c.tilaAmount,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(a,{item:!0,xs:12,md:6,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(fe,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:c.sequence,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:c.sequenceRate,onChange:h,required:!0,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:c.sequenceAmount,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),c.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(fe,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:c.solvingLayers,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:c.solvingInMeters,disabled:!c.remainingPcs&&!c.remainingQty,onChange:h,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:c.solvingRate,onChange:h,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:c.solvingAmount,disabled:!c.remainingPcs&&!c.remainingQty,onChange:h,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(l,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",disabled:!c.remainingPcs&&!c.remainingQty,name:"totalAmount",value:c.totalAmount,onChange:h,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:c.costPerComponent,onChange:h,disabled:!c.remainingPcs&&!c.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:ue,children:"Save"})})]})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(fe,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Oe,{iColumns:pe,initialRows:s,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:K,disableEdit:!0})})]})})]})},Ft=()=>{_e();const{user:d}=Se(),[ee,E]=o.useState(!0),{enqueueSnackbar:p}=Ne(),[t,x]=o.useState([]),[n,m]=o.useState(!1),[s,I]=o.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:d.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId});o.useEffect(()=>{I({embroideryId:(t==null?void 0:t.embroideryId)||0,designId:(t==null?void 0:t.designId)||"",batchNo:(t==null?void 0:t.batchNo)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorId:(t==null?void 0:t.baseColorId)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})},[t]);const{data:W}=Be(),[V,c]=o.useState(""),{data:y}=je(),{data:G,refetch:O}=Te(V,{skip:!V}),{data:k,refetch:oe}=We(s.designId,{skip:!s.designId}),{data:K}=Ue({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:M}=qe({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:P,refetch:h}=pt(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:L}=Ee(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("formData.planningHeaderId",s.planningHeaderId),console.log("collectionData",W);const[w,J]=o.useState(!1),[g,D]=o.useState([]),[ne,ae]=o.useState([]),[ue,pe]=o.useState([]),[ye,f]=o.useState([]),[H,$]=o.useState([]),[le,be]=o.useState([]),[Ie,te]=o.useState([]),[de,z]=o.useState([]);console.log("batchList",ne),console.log("formData",s),o.useEffect(()=>{G&&D(G.result)},[G]),o.useEffect(()=>{k&&ae(k.result)},[k]),o.useEffect(()=>{K&&pe(K.result)},[K]),o.useEffect(()=>{M&&be(K.result)},[M]),o.useEffect(()=>{L&&z(L.result)},[L]),o.useEffect(()=>{P&&(E(!1),te(P.result.map((i,B)=>({id:B,...i}))))},[P,h]),console.log("embroideryList",P),console.log("initialRows",Ie),o.useEffect(()=>{if(y){const i=y.result[0];f(i.vendorList),$(i.noOfHeadsList)}},[y]);const Z=(W==null?void 0:W.result)||[];o.useEffect(()=>{const i=()=>{const C=parseFloat(s.repeats)||0,F=parseFloat(s.itemsPerRepeat)||0;return(C*F).toFixed(2)};I(C=>({...C,totalPcs:i()}));const B=()=>{const C=parseFloat(s.threadStiches)||0,F=parseFloat(s.threadRate)||0,q=parseFloat(s.noOfHead)||0,se=parseFloat(s.repeats)||0;return(C/1e3*(F*se*q)).toFixed(2)};I(C=>({...C,threadAmount:B()}));const r=()=>{const C=parseFloat(s.tillaStiches)||0,F=parseFloat(s.tilaRate)||0,q=parseFloat(s.noOfHead)||0,se=parseFloat(s.repeats)||0;return(C/1e3*(F*se*q)).toFixed(2)};I(C=>({...C,tilaAmount:r()}));const b=()=>{const C=parseFloat(s.sequence)||0,F=parseFloat(s.sequenceRate)||0,q=parseFloat(s.noOfHead)||0,se=parseFloat(s.repeats)||0;return(C/1e3*(F*se*q)).toFixed(2)};I(C=>({...C,sequenceAmount:b()}));const u=()=>{const C=parseFloat(s.repeats)||0,F=parseFloat(s.noOfHead)||0,q=parseFloat(s.solvingLayers)||0;return(C*F*13/39.37*q).toFixed(2)};I(C=>({...C,solvingInMeters:u()}));const j=()=>{const C=parseFloat(s.solvingInMeters)||0,F=parseFloat(s.solvingRate)||0;return parseFloat(s.solvingLayers),(C*F).toFixed(2)};I(C=>({...C,solvingAmount:j()}));const U=()=>{const C=parseFloat(s.threadAmount)||0,F=parseFloat(s.tilaAmount)||0,q=parseFloat(s.sequenceAmount)||0,se=parseFloat(s.solvingAmount)||0;return(C+F+q+se).toFixed(2)};I(C=>({...C,totalAmount:U()||0}))},[s.threadAmount,s.totalAmount,s.sequenceAmount,s.solvingAmount,s.repeats,s.tilaAmount,s.itemsPerRepeat,s.threadRate,s.threadStiches,s.noOfHead,s.tilaRate,s.tillaStiches,s.sequenceRate,s.sequence,s.solvingLayers,s.solvingInMeters,s.solvingRate]);const R=i=>{const{name:B,value:r}=i.target;if(B==="collectionId")Z.find(b=>b.collectionId===parseInt(r)),c(r),m(!0),te([]),E(!0),I({...s,collectionId:r,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]});else if(B==="designId"){const b=g.find(u=>u.designId===parseInt(r));te([]),E(!0),I({...s,designId:r,baseColorId:b?b.colorId:"",baseColorName:b?b.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(B==="colorId"){const b=le.find(u=>u.colorId===r);I({...s,colorId:r,availableQty:b?b.total:"",cuttingSize:b?b.cuttingSize:"",repeats:b?b.repeats:"",noOfHead:b?b.noOfHeads:""})}else if(B==="batchNo"){const b=ne.find(u=>u.batchNo===r);I({...s,batchNo:r,planningHeaderId:b?b.planningHeaderId:"",poPcs:b?b.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),J(!0),m(!1)}else I({...s,[B]:r}),_(b=>({...b,[B]:""}))},[N,_]=o.useState({}),Pe=async()=>{try{const i=await ge.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroidery",{...s,threadAdditional:s.threadAdditional.join(", ")});console.log("Save response:",i.data),i.data.success?p("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(p(`${i.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",i.data.message)),I(B=>({embroideryId:0,designId:B.designId,batchNo:B.batchNo,planningHeaderId:B.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:B.poPcs,baseColorId:B.baseColorId,baseColorName:B.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})),h()}catch(i){console.error("Error saving data:",i),p("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",Ie);const[X,T]=o.useState({}),[ve,xe]=o.useState(!1),Ce=i=>{T(i),xe(!0)},[v,A]=o.useState(!0),Q=i=>{T(i),xe(!0),A(!1)},Y=()=>{A(!0),xe(!1),T({}),refetchDyeingPrintingData()};console.log("show div",v);const re=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component "},{field:"fabricName",headerName:"Fabric "},{field:"vendorId",headerName:"Vendor"},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty"},{field:"assignedQty",headerName:"Assigned Qty"},{field:"totalPcs",headerName:"Total Pcs"},{field:"requiredPcs",headerName:"Assigned Pcs"},{field:"AddVendor",headerName:"Add Vendor",renderCell:i=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(jt,{variant:"text",size:"small",children:[e.jsx(ke,{color:"primary",onClick:()=>Ce(i.row),children:e.jsx(Je,{})}),e.jsx(ke,{color:"primary",onClick:()=>Q(i.row),children:e.jsx(Ae,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:At,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:V,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:Z.map(i=>e.jsx(S,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:g.map(i=>e.jsx(S,{value:i.designId,children:i.designNo},i.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:ne.map(i=>e.jsx(S,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:R,disabled:!0,sx:i=>({...s.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:R,size:"small",required:!0,error:!!N.componentId,helperText:N.componentId,InputLabelProps:{sx:{color:"black"}},children:de.map(i=>e.jsx(S,{value:i.componentId,children:i.componentName},i.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:R,required:!0,error:!!N.fabricId,helperText:N.fabricId,InputLabelProps:{sx:{color:"black"}},children:ue.map(i=>e.jsx(S,{value:i.fabricId,children:i.fabric},i.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:R,required:!0,error:!!N.colorId,helperText:N.colorId,InputLabelProps:{sx:{color:"black"}},children:le.map(i=>e.jsx(S,{value:i.colorId,children:i.color},i.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,onChange:R,disabled:!0,sx:i=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:s.availableQty,onChange:R,InputLabelProps:{sx:{color:"black"}},sx:i=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:s.repeats,onChange:R,InputLabelProps:{sx:{color:"black"}},sx:i=>({...s.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:s.noOfHead,onChange:R,required:!0,error:!!N.noOfHead,helperText:N.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:i=>({...s.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:H.map(i=>e.jsx(S,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:s.cuttingSize,onChange:R,InputLabelProps:{sx:{color:"black"}},sx:i=>({...s.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:s.itemsPerRepeat,onChange:R,required:!0,error:!!N.itemsPerRepeat,helperText:N.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:i=>({...s.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:s.totalPcs,onChange:R})}),e.jsx(a,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:Pe,children:"Save"})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(Oe,{iColumns:re,initialRows:Ie,setInitialData:x,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:h,setAccordionExpanded:J,fileName:"Embroidery List",isLoading:ee}),e.jsxs(Ge,{open:ve,onClose:Y,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(Ye,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(fe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Vendors "}),e.jsx(ke,{onClick:Y,sx:{color:"#ffffff"},children:e.jsx(De,{})})]}),e.jsxs(Xe,{children:[e.jsx(Ve,{id:"alert-dialog-slide-description"}),e.jsx(Tt,{initialFormData:X,setInitialFormData:T,refetchDyeingPrintingData:h,handleClickOpen:Ce,showUpperDiv:v})]})]})]})})]})]})},wt=Ft,zt=()=>{const{user:d}=Se();console.log("user",d);const[ee,E]=o.useState(!0),[p,t]=o.useState([]),[x,n]=o.useState([]),[m,s]=o.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedBy:d.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",m),o.useEffect(()=>{s({...m,processType:(p==null?void 0:p.processType)||"MultiHead",planningId:(p==null?void 0:p.planningId)||0,baseColorId:(p==null?void 0:p.baseColorId)||"",componentId:(p==null?void 0:p.componentId)||"",cuttingSize:(p==null?void 0:p.cuttingSize)||"",colorId:(p==null?void 0:p.colorId)||"",fabricId:(p==null?void 0:p.fabricId)||"",noOfHeads:(p==null?void 0:p.noOfHeads)||0,operatingMachineId:(p==null?void 0:p.operatingMachineId)||0,repeats:(p==null?void 0:p.repeats)||"",repeatSize:(p==null?void 0:p.repeatSize)||"",uomId:(p==null?void 0:p.uomId)||"",totalFabric:(p==null?void 0:p.totalFabric)||"",shrinkage:(p==null?void 0:p.shrinkage)||"",wastage:(p==null?void 0:p.wastage)||"",total:(p==null?void 0:p.total)||"",appId:1,createdOn:(p==null?void 0:p.createdOn)||new Date().toISOString(),createdBy:(p==null?void 0:p.createdBy)||d.empId,lastUpdatedBy:d.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(p==null?void 0:p.repeatsInMtr)||""})},[p]);const{data:I}=Be(),[W,V]=o.useState(""),{data:c,refetch:y}=Te(W,{skip:!W}),{data:G,refetch:O}=mt(m.planningHeaderId,{skip:!m.planningHeaderId}),{data:k}=je(),[oe,K]=o.useState([]),{enqueueSnackbar:M}=Ne();console.log("lookupData",k);const[P,h]=o.useState([]);o.useEffect(()=>{I&&h(I.result)},[I]),o.useEffect(()=>{c&&(K(c.result),y())},[c]),o.useEffect(()=>{G&&(E(!1),n(G.result.map((r,b)=>({id:b,...r}))))},[G,O]),console.log("designList",oe),console.log("collectionData",I);const[L,w]=o.useState(!1),[J,g]=o.useState([]),[D,ne]=o.useState([]),[ae,ue]=o.useState([]),[pe,ye]=o.useState([]),[f,H]=o.useState([]),[$,le]=o.useState([]),[be,Ie]=o.useState([]),[te,de]=o.useState([]);console.log("components:",ae),console.log("Fabrications:",pe),console.log("colors:",f),console.log("uoms:",$),console.log("heads:",be),console.log("lookupData",k),o.useEffect(()=>{if(k){const r=k.result[0];ue(r.componentList),H(r.colorList),ye(r.fabricList),Ie(r.noOfHeadsList),le(r.uomList),g(r.planningTypeProcessList),ne(r.operatingMachineList)}},[k]),o.useEffect(()=>{const r=async b=>{try{const u=await ge.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${b}`);console.log(u.data),de(u.data.result)}catch(u){console.error("Error fetching pre-planning lookup data:",u)}};m.designId&&r(m.designId)},[m.designId,m.planningHeaderId]);const z=m.planningProcessTypeId===212;console.log("isDyeing",z),o.useEffect(()=>{const r=()=>{const F=parseFloat(m.poPcs)||0,q=parseFloat(m.cuttingSize)||0,se=(F*q).toFixed(2);return parseFloat(se).toLocaleString()},b=()=>{const F=parseFloat(m.repeats)||0,q=parseFloat(m.repeatSize)||0,se=(F*q).toFixed(2);return parseFloat(se).toLocaleString()},u=F=>{const q=F||0,se=parseFloat(m.shrinkage)||0,Re=parseFloat(m.wastage)||0,Qe=(q*(100+(se+Re))/100).toFixed(2);return parseFloat(Qe).toLocaleString()},j=()=>(.9144*(parseFloat(m.repeatSize)||0)).toFixed(2),U=()=>{const F=parseFloat(m.repeats)||0;return((parseFloat(m.repeatsInMtr)||0)*F).toFixed(2)};let C=0;z?C=parseFloat(r().replace(/,/g,""))||0:C=parseFloat(b().replace(/,/g,""))||0,s(F=>({...F,totalFabric:C.toLocaleString(),total:u(C),repeatsInMtr:j()})),!z&&m.isSchiffili&&s(F=>({...F,totalFabric:U()}))},[m.poPcs,m.cuttingSize,m.repeats,m.repeatSize,m.totalFabric,m.shrinkage,m.wastage,m.repeatsInMtr,m.isSchiffili,z]);const[Z,R]=o.useState(!1);o.useState(!1);const N=r=>{const{name:b,value:u}=r.target;if(b==="collectionId"){const j=P.find(U=>U.collectionId===parseInt(u));w(!0),n([]),E(!0),V(u),s({...m,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:u,noOfDesigns:j?j.noOfDesigns:"",noOfColors:j?j.noOfColors:""})}else if(b==="designId"){const j=oe.find(U=>U.designId===parseInt(u));n([]),E(!0),s({...m,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:u,baseColorId:j?j.colorId:"",baseColorName:j?j.colorName:""})}else if(b==="batchNo"){const j=te.find(U=>U.batchNo===u);s({...m,componentId:"",processType:"MultiHead",poPcs:j?j.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:u,planningHeaderId:j?j.planningHeaderId:""}),R(!0),w(!1)}else if(b==="planningProcessTypeId"){const j=J.find(U=>U.planningProcessTypeId===u);s({...m,planningProcessTypeId:u,planningProcessTypeName:j?j.lookUpName:"",noOfHeads:0,operatingMachineId:0}),R(!0),w(!1)}else s({...m,[b]:u})},[_,Pe]=o.useState({}),X=async()=>{const r=T();if(Object.keys(r).length>0){Pe(r);return}try{const b={...m,totalFabric:parseFloat(m.totalFabric.replace(/,/g,"")),total:parseFloat(m.total.replace(/,/g,""))},u=await ge.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",b);console.log("Data saved successfully:",u.data),console.log("Save response:",u.data),u.data.success?M("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(M(`${u.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",u.data.message)),s(j=>({processType:"MultiHead",planningId:0,collectionId:j.collectionId,designId:j.designId,batchNo:j.batchNo,planningHeaderId:j.planningHeaderId,baseColorId:j.baseColorId,baseColorName:j.baseColorName,noOfDesigns:j.noOfDesigns,noOfColors:j.noOfColors,poPcs:j.poPcs,componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId,isSchiffili:!1,repeatsInMtr:""})),O()}catch(b){console.error("Error saving data:",b),M("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},T=()=>{const r={};return m.componentId||(r.componentId="componentId is required"),m.colorId||(r.colorId="colorId is required"),m.fabricId||(r.fabricId="fabricId is required"),m.cuttingSize||(r.cuttingSize="cuttingSize is required"),m.repeats||(r.repeats="repeats is required"),m.repeatSize||(r.repeatSize="repeatSize is required"),m.uomId||(r.uomId="uomId is required"),m.shrinkage||(r.shrinkage="shrinkage is required"),m.wastage||(r.wastage="wastage is required"),r};console.log("initialRows",x);const ve=x.reduce((r,b)=>r+(b.totalFabric??0),0).toFixed(2),xe=parseFloat(ve).toLocaleString();console.log("localizedTotalFabric",xe);const Ce=x.reduce((r,b)=>r+(b.total??0),0).toFixed(2),v=parseFloat(Ce).toLocaleString(),A=[...x,{id:"TOTAL_FABRIC",label:"Total Fabric",totalFabric:xe,total:v}],Q={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",A);const Y=[{field:"componentName",headerName:"Component",...Q,colSpan:(r,b)=>{if(b.id==="TOTAL_FABRIC")return 9},valueGetter:(r,b)=>b.id==="TOTAL_FABRIC"?b.label:r},{field:"planningProcessTypeName",headerName:"Process Type",...Q},{field:"color",headerName:"Color",...Q},{field:"cuttingSize",headerName:"Cutting Size",...Q},{field:"fabric",headerName:"Fabrication",...Q},{field:"noOfHeadName",headerName:"No. Of Heads",...Q},{field:"operatingMachineName",headerName:"Operating Machine",...Q},{field:"repeats",headerName:"Repeats",valueGetter:r=>r.toLocaleString(),...Q},{field:"repeatSize",headerName:"Repeat Size",valueGetter:r=>r.toLocaleString(),...Q},{field:"totalFabric",headerName:"Total Fabric",valueGetter:r=>r.toLocaleString(),...Q},{field:"uom",headerName:"UOM",colSpan:(r,b)=>{if(b.id==="TOTAL_FABRIC")return 2},valueGetter:(r,b)=>b.id==="TOTAL_FABRIC"?"OverAll Total":r},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:r=>r.toLocaleString(),colSpan:(r,b)=>{if(b.id==="TOTAL_FABRIC")return 2}}],re=m.planningProcessTypeId===198;o.useEffect(()=>{re&&s({...m,uomId:139})},[re]),console.log("formData",m);const Le=({row:r,field:b})=>r.id==="TOTAL_FABRIC"&&(b==="componentName"||b==="uom")?"bold":"";console.log("batchList:",te);const i="https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",B=(r,b)=>{R(!Z)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(nt,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:m.collectionId,onChange:N,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:P.map(r=>e.jsx(S,{value:r.collectionId,children:r.collectionName},r.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:m.designId,onChange:N,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:oe.map(r=>e.jsx(S,{value:r.designId,children:r.designNo},r.designId))})}),e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:m.batchNo,onChange:N,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:te.map(r=>e.jsx(S,{value:r.batchNo,children:r.batchNo},r.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:m.poPcs,onChange:N,disabled:!0,sx:r=>({...m.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:m.baseColorName,onChange:N,disabled:!0,sx:r=>({...m.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"MainCard",avatar:e.jsx($e,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ke,{onClick:B,sx:{mt:"-18px"},children:e.jsx(ze,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(et,{expanded:Z,onChange:B,sx:{},children:[e.jsx(tt,{expandIcon:e.jsx(ze,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(at,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:m.planningProcessTypeId,onChange:N,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:J.map(r=>e.jsx(S,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(we,{fullWidth:!0,options:ae,getOptionLabel:r=>r.lookUpName,value:ae.find(r=>r.lookUpId===m.componentId)||null,onChange:(r,b)=>{N({target:{name:"componentId",value:b?b.lookUpId:""}})},renderOption:(r,b)=>{const{lookUpName:u}=b;return e.jsx("span",{...r,children:u})},renderInput:r=>e.jsx(l,{...r,label:"Select Component",size:"small",name:"componentId",value:m.componentId,required:!0,error:!!_.componentId,helperText:_.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[" ",e.jsx(we,{fullWidth:!0,options:f,getOptionLabel:r=>r.lookUpName,value:f.find(r=>r.lookUpId===m.colorId)||null,onChange:(r,b)=>{N({target:{name:"colorId",value:b?b.lookUpId:""}})},renderInput:r=>e.jsx(l,{...r,label:"Color",size:"small",value:m.colorId,name:"colorId",required:!0,error:!!_.colorId,helperText:_.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:m.cuttingSize,onChange:N,required:!0,error:!!_.cuttingSize,helperText:_.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(we,{fullWidth:!0,options:pe,getOptionLabel:r=>r.lookUpName,value:pe.find(r=>r.lookUpId===m.fabricId)||null,onChange:(r,b)=>{N({target:{name:"fabricId",value:b?b.lookUpId:""}})},renderInput:r=>e.jsx(l,{...r,label:"Fabrication",size:"small",name:"fabricId",value:m.fabricId,required:!0,error:!!_.fabricId,helperText:_.fabricId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:r})=>e.jsx("div",{style:{backgroundColor:"white"},children:r})})}),e.jsx(a,{item:!0,xs:12,md:2,children:re?e.jsx(l,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:m.operatingMachineId,onChange:N,required:!0,disabled:z,InputLabelProps:{sx:{color:"black"}},children:D.map(r=>e.jsx(S,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))}):e.jsx(l,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:m.noOfHeads,onChange:N,required:!0,disabled:z,InputLabelProps:{sx:{color:"black"}},children:be.map(r=>e.jsx(S,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:m.repeats,onChange:N,error:!!_.repeats,helperText:_.repeats,required:!0,disabled:z,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:m.repeatSize,onChange:N,disabled:z,error:!!_.repeatSize,helperText:_.repeatSize,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:m.totalFabric,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:m.uomId,onChange:N,error:!!_.uomId,helperText:_.uomId,required:!0,disabled:re,InputLabelProps:{sx:{color:"black"}},children:$.map(r=>e.jsx(S,{value:r.lookUpId,children:r.lookUpName},r.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:m.shrinkage,onChange:N,error:!!_.shrinkage,helperText:_.shrinkage,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:m.wastage,onChange:N,error:!!_.wastage,helperText:_.wastage,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Total",fullWidth:!0,size:"small",name:"total",value:m.total,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(a,{container:!0,spacing:1,width:"Inherit",children:e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"repeat in mtr",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:m.repeatsInMtr,onChange:N,sx:r=>({...m.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",children:e.jsx(ie,{variant:"contained",size:"small",onClick:X,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"MainCard",avatar:e.jsx(Ae,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{sx:{paddingY:1,paddingX:1},children:e.jsx(a,{sx:{},item:!0,xs:12,children:e.jsx(Oe,{iColumns:Y,initialRows:A,setInitialData:t,deleteApi:i,deleteBy:"planningId",refetch:O,getCellClassName:Le,setAccordionExpanded:R,fileName:"PrePlanningList",isLoading:ee})})})]})]})},Wt=zt,Ht="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",Rt=()=>{const{user:d}=Se();console.log("user",d);const[ee,E]=o.useState(!0),[p,t]=o.useState([]),[x,n]=o.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:d.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId});o.useEffect(()=>{n({...x,dpId:p.dpId||0,fabricId:(p==null?void 0:p.fabricId)||"",colorId:(p==null?void 0:p.colorId)||"",color:(p==null?void 0:p.color)||"",processType:(p==null?void 0:p.processType)||"",availableQty:(p==null?void 0:p.availableQty)||"",Shrinkage:(p==null?void 0:p.shrinkage)||"",Wastage:(p==null?void 0:p.wastage)||"",outputQty:(p==null?void 0:p.outputQty)||0,UOM:(p==null?void 0:p.uom)||0,uomId:(p==null?void 0:p.uomId)||"",poPcs:(p==null?void 0:p.poPcs)||0,createdOn:(p==null?void 0:p.createdOn)||new Date().toISOString(),createdBy:(p==null?void 0:p.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})},[p]);const{enqueueSnackbar:m}=Ne(),[s,I]=o.useState(!1);console.log("Dyeing form data to send",x);const{data:W}=Be(),[V,c]=o.useState(""),{data:y}=je(),{data:G,refetch:O}=Te(V,{skip:!V}),{data:k,refetch:oe}=We(x.designId,{skip:!x.designId}),{data:K}=ht({batchNo:x.planningHeaderId,processType:"Fabrication"},{skip:!x.planningHeaderId}),{data:M}=gt({fabricId:x.fabricId,planningHeaderId:x.planningHeaderId},{skip:!x.fabricId||!x.planningHeaderId}),{data:P,refetch:h}=bt(x.planningHeaderId,{skip:!x.planningHeaderId}),[L,w]=o.useState([]),[J,g]=o.useState([]),[D,ne]=o.useState([]),[ae,ue]=o.useState([]),[pe,ye]=o.useState([]),[f,H]=o.useState([]);o.useState([]);const[$,le]=o.useState(!1);console.log("batchList",J),console.log("formData",x),o.useEffect(()=>{G&&w(G.result)},[G]),o.useEffect(()=>{k&&g(k.result)},[k]),o.useEffect(()=>{K&&ne(K.result)},[K]),o.useEffect(()=>{M&&H(M.result)},[M]),o.useEffect(()=>{P&&(E(!1),ye(P.result.map((v,A)=>({id:A,...v}))))},[P,h]),o.useEffect(()=>{if(y){const v=y.result[0];ue(v.uomList)}},[y]);const[be,Ie]=o.useState([]);o.useEffect(()=>{W&&Ie(W.result)},[W]);const te=v=>{const{name:A,value:Q}=v.target;if(A==="collectionId")be.find(Y=>Y.collectionId===parseInt(Q)),c(Q),I(!0),ye([]),E(!0),n({...x,collectionId:Q,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:""});else if(A==="designId"){const Y=L.find(re=>re.designId===parseInt(Q));ye([]),E(!0),n({...x,designId:Q,baseColorId:Y?Y.colorId:"",baseColorName:Y?Y.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(A==="batchNo"){const Y=J.find(re=>re.batchNo===Q);n({...x,batchNo:Q,planningHeaderId:Y?Y.planningHeaderId:"",poPcs:Y?Y.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),le(!0),I(!1)}else if(A==="fabricId")D.find(Y=>Y.fabricId===Q),console.log("Selected Fabric:",D),n({...x,fabricId:Q});else if(A==="ColorId"){const Y=f.find(re=>re.colorId===Q.colorId);n({...x,ColorId:Q.colorId,color:Y.color,availableQty:Y.total,UOM:Y.uom,Shrinkage:Y.shrinkage,Wastage:Y.wastage})}else A==="processType"?n({...x,processType:Q}):A==="vendorId"?n({...x,vendorId:Q}):(n({...x,[A]:Q}),z(Y=>({...Y,[A]:""})))};o.useEffect(()=>{const v=()=>{const i=parseFloat(x.availableQty)||0,B=parseFloat(x.Shrinkage)||0,r=parseFloat(x.Wastage)||0;return(i*(100-(B+r))/100).toFixed(2)},A=()=>{const i=parseFloat(x.availableQty)||0,B=parseFloat(x.RatePerUOM)||0;return(i*B).toFixed(2)},Q=(i,B)=>(i*(1+B/100)).toFixed(2),Y=v(),re=A(),Le=parseFloat(x.GST)||0;Q(re,Le),parseFloat(x.poPcs),n(i=>({...i,outputQty:Y}))},[x.availableQty,x.Shrinkage,x.Wastage,x.RatePerUOM,x.GST,x.poPcs,x.UnitRatePerPo]);const[de,z]=o.useState({}),Z=async()=>{try{const v=await ge.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",x);console.log("Save response:",v.data),v.data.success?m("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(m(`${v.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",v.data.message)),n(A=>({designId:A.designId,planningHeaderId:A.planningHeaderId,batchNo:A.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:A.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})),h()}catch(v){console.error("Error saving data:",v),m("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},R=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[N,_]=o.useState({}),[Pe,X]=o.useState(!1),T=v=>{_(v),X(!0)},ve=()=>{X(!1),_({}),h()},xe=[{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processType",headerName:"Process Type"},{field:"uom",headerName:" UOM"},{field:"poPcs",headerName:" PO PCS."},{field:"availableQty",headerName:"Available Quantitity",valueGetter:v=>v.toLocaleString()},{field:"assignedQty",headerName:"Assigned Qty",valueGetter:v=>v.toLocaleString()},{field:"AddVendor",headerName:"Add Vendor",renderCell:v=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(ke,{color:"primary",onClick:()=>T(v.row),children:e.jsx(Je,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:Ht,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:V,onChange:te,size:"small",InputLabelProps:{sx:{color:"black"}},children:be.map(v=>e.jsx(S,{value:v.collectionId,children:v.collectionName},v.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:x.designId,onChange:te,size:"small",InputLabelProps:{sx:{color:"black"}},children:L.map(v=>e.jsx(S,{value:v.designId,children:v.designNo},v.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:x.batchNo,onChange:te,size:"small",InputLabelProps:{sx:{color:"black"}},children:J.map(v=>e.jsx(S,{value:v.batchNo,children:v.batchNo},v.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:x.baseColorName,onChange:te,disabled:!0,sx:v=>({...x.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:x.fabricId,onChange:te,error:!!de.fabricId,helperText:de.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:D.map(v=>e.jsx(S,{value:v.fabricId,children:v.fabric},v.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(St,{fullWidth:!0,options:f,getOptionLabel:v=>v.color||"",renderInput:v=>e.jsx(l,{...v,label:"Color",name:"colorId",size:"small",error:!!de.colorId,helperText:de.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),value:f.find(v=>v.colorId===x.colorId)||null,onChange:(v,A)=>{n(Q=>({...Q,colorId:A?A.colorId:"",color:A?A.color:"",availableQty:A?A.total:"",UOM:A?A.uom:"",uomId:A?A.uomId:"",Shrinkage:A?A.shrinkage:"",Wastage:A?A.wastage:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:x.processType,onChange:te,error:!!de.processType,helperText:de.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:R.map(v=>e.jsx(S,{value:v.value,children:v.label},v.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:x.poPcs,onChange:te,disabled:!0,sx:v=>({...x.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:x.UOM,onChange:te,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"availableQty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:x.availableQty,onChange:te,disabled:!0,sx:v=>({...x.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(ie,{variant:"contained",color:"primary",size:"small",onClick:Z,children:"Save"})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(Oe,{iColumns:xe,initialRows:pe,setInitialData:t,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:h,setAccordionExpanded:le,fileName:"Dyeing&PrintingList",isLoading:ee}),e.jsxs(Ge,{open:Pe,onClose:ve,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(Ye,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(fe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(ke,{onClick:ve,sx:{color:"#ffffff"},children:e.jsx(De,{})})]}),e.jsxs(Xe,{children:[e.jsx(Ve,{id:"alert-dialog-slide-description"}),e.jsx(Bt,{initialFormData:N,setInitialFormData:_,refetchDyeingPrintingData:h,handleClickOpen:T})]})]})]})})]})]})},Qt=Rt,lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",Ut=()=>{const{user:d}=Se(),{enqueueSnackbar:ee}=Ne(),[E,p]=o.useState(!0),[t,x]=o.useState([]),[n,m]=o.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:d.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId});o.useEffect(()=>{m({...n,schiffiliId:t.schiffiliId||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})},[t]);const[s,I]=o.useState(!1),W=(u,j)=>{I(!s)},[V,c]=o.useState(!1),{data:y}=Be(),[G,O]=o.useState(""),{data:k}=je(),{data:oe,refetch:K}=Te(G,{skip:!G}),{data:M,refetch:P}=We(n.designId,{skip:!n.designId}),{data:h}=Ue({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:L}=qe({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:w,refetch:J}=It(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:g}=Ee(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("formData.planningHeaderId",n.planningHeaderId),console.log("collectionData",y),console.log("schiffliList",w);const[D,ne]=o.useState([]),[ae,ue]=o.useState([]),[pe,ye]=o.useState([]),[f,H]=o.useState([]),[$,le]=o.useState([]),[be,Ie]=o.useState([]),[te,de]=o.useState([]),[z,Z]=o.useState([]),[R,N]=o.useState([]);o.useEffect(()=>{oe&&ne(oe.result)},[oe]),o.useEffect(()=>{M&&ue(M.result)},[M]),o.useEffect(()=>{h&&ye(h.result)},[h]),o.useEffect(()=>{L&&de(h.result)},[L]),o.useEffect(()=>{g&&N(g.result)},[g]),o.useEffect(()=>{w&&(p(!1),Z(w.result.map((u,j)=>({id:j,...u}))))},[w,J]),o.useEffect(()=>{if(k){const u=k.result[0];H(u.vendorList),le(u.operatingMachineList),Ie(u.workingHeadList)}},[k]),console.log("initialRows",z);const _=(y==null?void 0:y.result)||[];o.useEffect(()=>{const u=()=>{const q=parseFloat(n.thaanQty)||0,se=parseFloat(n.operatingMachine)||0;return(q*se).toFixed(2)};m(q=>({...q,totalEmbroidry:u()}));const j=()=>{const q=parseFloat(n.thaanQty)||0,se=parseFloat(n.noOfItemPerThaan)||0;return(q*se).toFixed(2)};m(q=>({...q,totalPcs:j()}));const U=()=>{const q=parseFloat(n.noOfStichesPerYard)||0,se=parseFloat(n.rate)||0;return(q/1e3*se).toFixed(2)};m(q=>({...q,amountPerYard:U()}));const C=()=>{const q=parseFloat(n.totalAmount)||0,se=parseFloat(n.totalPcs)||0;return(q/se).toFixed(2)};m(q=>({...q,costPerComponent:C()}));const F=()=>{const q=parseFloat(n.amountPerYard)||0,se=parseFloat(n.totalEmbroidry)||0,Re=parseFloat(n.laserCutRate)||0,Qe=parseFloat(n.pcsForLaserCut)||0;return(q*se+Qe*Re).toFixed(2)};m(q=>({...q,totalAmount:F()}))},[n.thaanQty,n.operatingMachine,n.noOfStichesPerYard,n.rate,n.totalAmount,n.totalPcs,n.amountPerYard,n.totalEmbroidry,n.laserCutRate,n.pcsForLaserCut]);const Pe=u=>{const{name:j,checked:U}=u.target;m(C=>({...C,[j]:U}))},X=u=>{const{name:j,value:U}=u.target;if(j==="collectionId")_.find(C=>C.collectionId===parseInt(U)),O(U),c(!0),Z([]),p(!0),m({...n,collectionId:U,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0});else if(j==="designId"){const C=D.find(F=>F.designId===parseInt(U));Z([]),p(!0),m({...n,designId:U,baseColorId:C?C.colorId:"",baseColorName:C?C.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(j==="batchNo"){const C=ae.find(F=>F.batchNo===U);m({...n,batchNo:U,planningHeaderId:C?C.planningHeaderId:"",poPcs:C?C.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),I(!0),c(!1)}else if(j==="colorId"){const C=te.find(F=>F.colorId===U);m({...n,colorId:U,availableQty:C?C.total:"",cuttingSize:C?C.cuttingSize:"",repeats:C?C.repeats:""})}else if(j==="operatingMachineId"){const C=$.find(F=>F.lookUpId===U);m({...n,operatingMachineId:U,operatingMachine:C?C.lookUpName:""})}else m({...n,[j]:U})};console.log("colors",te);const[T,ve]=o.useState({}),xe=async()=>{const u=Ce();if(Object.keys(u).length>0){ve(u);return}try{const j=await ge.post("https://gecxc.com:4041/api/Schiffli/SaveSchiffili",n);console.log("Save response:",j.data),j.data.success?ee("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(ee(`${j.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",j.data.message)),m(U=>({designId:U.designId,planningHeaderId:U.planningHeaderId,batchNo:U.batchNo,baseColorName:U.baseColorName,schiffiliId:0,componentId:"",poPcs:U.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})),J()}catch(j){console.error("Error saving data:",j),ee("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Ce=()=>{const u={};return n.fabricId||(u.fabricId="fabricId is required"),n.colorId||(u.colorId="colorId is required"),n.vendorId||(u.vendorId="vendorId is required"),n.componentId||(u.componentId="componentId is required"),n.thaanQty||(u.thaanQty="thaanQty is required"),n.workingHeadId||(u.workingHeadId="workingHeadId is required"),n.rate||(u.rate="rate is required"),n.operatingMachineId||(u.operatingMachineId="operatingMachineId is required"),n.noOfStichesPerYard||(u.noOfStichesPerYard="noOfStichesPerYard is required"),n.noOfItemPerThaan||(u.noOfItemPerThaan="noOfItemPerThaan is required"),u};console.log("formData",n);const[v,A]=o.useState(0),[Q,Y]=o.useState(0),[re,Le]=o.useState(0);o.useEffect(()=>{const u=z.reduce((C,F)=>C+(F.totalAmount??0),0).toFixed(2),j=z.reduce((C,F)=>C+(F.totalEmbroidry??0),0).toFixed(2),U=z.reduce((C,F)=>C+(F.totalPcs??0),0).toFixed(2);A(parseFloat(u).toLocaleString()),Y(parseFloat(j).toLocaleString()),Le(parseFloat(U).toLocaleString())},[z]);const i={id:"TOTAL_SUMMARY",componentName:"Total Summary",totalAmount:v,totalEmbroidry:Q,totalPcs:re},B=[...z,i],r=[{field:"componentName",headerName:"Component",renderCell:u=>u.row.id==="TOTAL_SUMMARY"?"Total Summary":u.value},{field:"fabricName",headerName:"Fabric"},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"totalAmount",headerName:"Total Amount",renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:lt,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:G,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:_.map(u=>e.jsx(S,{value:u.collectionId,children:u.collectionName},u.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:D.map(u=>e.jsx(S,{value:u.designId,children:u.designNo},u.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:ae.map(u=>e.jsx(S,{value:u.batchNo,children:u.batchNo},u.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:u=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx($e,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ke,{onClick:W,sx:{mt:"-18px"},children:e.jsx(ze,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(et,{expanded:s,onChange:W,sx:{},children:[e.jsx(tt,{expandIcon:e.jsx(ze,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(at,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:X,size:"small",required:!0,error:!!T.componentId,helperText:T.componentId,InputLabelProps:{sx:{color:"black"}},children:R.map(u=>e.jsx(S,{value:u.componentId,children:u.componentName},u.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:X,required:!0,error:!!T.fabricId,helperText:T.fabricId,InputLabelProps:{sx:{color:"black"}},children:pe.map(u=>e.jsx(S,{value:u.fabricId,children:u.fabric},u.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:n.vendorId,onChange:X,required:!0,error:!!T.vendorId,helperText:T.vendorId,InputLabelProps:{sx:{color:"black"}},children:f.map(u=>e.jsx(S,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:X,required:!0,error:!!T.colorId,helperText:T.colorId,InputLabelProps:{sx:{color:"black"}},children:te.map(u=>e.jsx(S,{value:u.colorId,children:u.color},u.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,disabled:!0,onChange:X,sx:u=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:n.availableQty,onChange:X,sx:u=>({...n.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:n.thaanQty,onChange:X,required:!0,error:!!T.thaanQty,helperText:T.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:n.operatingMachineId,onChange:X,required:!0,error:!!T.operatingMachineId,helperText:T.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:$.map(u=>e.jsx(S,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:n.workingHeadId,onChange:X,required:!0,error:!!T.workingHeadId,helperText:T.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:be.map(u=>e.jsx(S,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:n.cuttingSize,onChange:X,sx:u=>({...n.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:n.rate,onChange:X,required:!0,error:!!T.rate,helperText:T.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:n.noOfStichesPerYard,onChange:X,required:!0,error:!!T.noOfStichesPerYard,helperText:T.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:n.noOfItemPerThaan,onChange:X,required:!0,error:!!T.noOfItemPerThaan,helperText:T.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:n.totalEmbroidry,onChange:X,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:n.amountPerYard,onChange:X,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:n.totalPcs,onChange:X,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:n.costPerComponent,onChange:X,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:n.totalAmount,onChange:X,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(ot,{control:e.jsx(st,{checked:n.laserCut,onChange:Pe,name:"laserCut"}),label:"Laser Cut"})}),n.laserCut?e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(l,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:n.laserCutRate,onChange:X,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(l,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:n.pcsForLaserCut,onChange:X,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:xe,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ce,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Oe,{iColumns:r,initialRows:B,setInitialData:x,deleteApi:"https://gecxc.com:4041/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:J,setAccordionExpanded:I,fileName:"Schffili List",isLoading:E})})})]})]})},qt=Ut,Et=({additionalProcessData:d,setAdditionalProcessData:ee,refetchAdditionalProcessList:E,handleClickOpen:p})=>{const{user:t}=Se(),[x,n]=o.useState([]),{enqueueSnackbar:m}=Ne(),s=x.reduce((P,h)=>P+(h.quantity??0),0).toFixed(2);console.log("Quantity",s);const[I,W]=o.useState({additionalProcessDetId:0,additionalProcessId:d.additionalProcessId||0,designId:d.designNo||"",planningHeaderId:d.planningHeaderId||0,batchNo:d.batchNo||"",componentName:d.componentName||"",componentId:d.componentId||"",colorName:d.colorName||"",colorId:d.colorId||"",fabricName:d.fabricName||"",fabricId:d.fabricId||"",uomId:d.uomId||"",uom:d.uom||"",vendorId:"",pcsPerComponent:d.pcsPerComponent||"",remainingPcsPerComponent:d.pcsPerComponent-s||"",processTypeName:d.processTypeName||"",processTypeId:d.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});o.useEffect(()=>{W({...I,remainingPcsPerComponent:d.pcsPerComponent-s||""})},[x]);const{data:V}=je(),{data:c,refetch:y}=xt(I.additionalProcessId,{skip:!I.additionalProcessId}),[G,O]=o.useState([]);o.useEffect(()=>{if(V){const P=V.result[0];O(P.vendorList)}},[V]),o.useEffect(()=>{c&&n(c.result.map((P,h)=>({id:h,...P})))},[c,y]),console.log("initialRows",x);const k=P=>{const{name:h,value:L}=P.target;W({...I,[h]:L})};o.useEffect(()=>{const P=()=>{const L=parseFloat(I.quantity)||0,w=parseFloat(I.ratePerPcs)||0;return(L*w).toFixed(2)};W(L=>({...L,totalAmount:P()}));const h=()=>{const L=parseFloat(I.totalAmount)||0,w=parseFloat(I.poPcs)||0;return(L/w).toFixed(2)};W(L=>({...L,costPerComponent:h()}))},[I.quantity,I.ratePerPcs,I.totalAmount]);const oe=async()=>{console.log(I);try{const P=await ge.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcessDetails",I);console.log("Save response:",P.data),P.data.success?m("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(m(`${P.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",P.data.message)),y(),W(h=>({...h,vendorId:"",pcsPerComponent:d.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),E()}catch(P){console.error("Error saving data:",P),m("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},K=[{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:1},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Me,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Select Design",name:"designId",value:I.designId,onChange:k,size:"small",disabled:!0,sx:P=>({...I.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:I.batchNo,onChange:k,size:"small",disabled:!0,sx:P=>({...I.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,label:"Components",name:"componentName",value:I.componentName,onChange:k,size:"small",disabled:!0,sx:P=>({...I.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:I.fabricName,onChange:k,disabled:!0,sx:P=>({...I.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:I.colorName,onChange:k,disabled:!0,sx:P=>({...I.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:I.processTypeName,onChange:k,disabled:!0,sx:P=>({...I.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:I.pcsPerComponent,onChange:k,disabled:!0,sx:P=>({...I.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:I.remainingPcsPerComponent,onChange:k,disabled:!0,sx:P=>({...I.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:I.vendorId,onChange:k,InputLabelProps:{sx:{color:"black"}},children:G.map(P=>e.jsx(S,{value:P.lookUpId,children:P.lookUpName},P.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:I.quantity,onChange:k,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:I.ratePerPcs,onChange:k,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:I.totalAmount,onChange:k,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:I.uom,onChange:k,disabled:!0,sx:P=>({...I.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ie,{variant:"contained",size:"small",onClick:oe,children:"Save"})})]}),e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(Oe,{iColumns:K,initialRows:x,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:y,disableEdit:!0})})})]})},Gt=()=>{const{user:d}=Se(),{enqueueSnackbar:ee}=Ne(),[E,p]=o.useState(!0),[t,x]=o.useState([]),[n,m]=o.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId});console.log("initialData",t),o.useEffect(()=>{m({additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,designId:(t==null?void 0:t.designId)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||0,batchNo:(t==null?void 0:t.batchNo)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})},[t]);const[s,I]=o.useState(!1),{data:W}=Be(),[V,c]=o.useState(""),{data:y}=je(),{data:G,refetch:O}=Te(V,{skip:!V}),{data:k,refetch:oe}=We(n.designId,{skip:!n.designId}),{data:K}=Ue({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:M}=qe({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:P,refetch:h}=ft(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:L}=Ee(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("lookupData",y),console.log("collectionData",W),console.log("colorData",M);const[w,J]=o.useState([]),[g,D]=o.useState([]),[ne,ae]=o.useState([]),[ue,pe]=o.useState([]),[ye,f]=o.useState([]),[H,$]=o.useState([]),[le,be]=o.useState([]),[Ie,te]=o.useState([]),[de,z]=o.useState([]),[Z,R]=o.useState([]),[N,_]=o.useState([]);console.log("batchData",k);const[Pe,X]=o.useState([]);o.useEffect(()=>{W&&X(W.result)},[W]),o.useEffect(()=>{G&&J(G.result)},[G]),o.useEffect(()=>{k&&D(k.result)},[k]),o.useEffect(()=>{K&&ae(K.result)},[K]),o.useEffect(()=>{M&&z(M.result)},[M]),o.useEffect(()=>{L&&_(L.result)},[L]),o.useEffect(()=>{if(y){const i=y.result[0];f(i.uomList),$(i.processList)}},[y]),o.useEffect(()=>{P&&(p(!1),R(P.result.map((i,B)=>({id:B,...i}))))},[P,h]),o.useEffect(()=>{if(y){const i=y.result[0];pe(i.vendorList),be(i.operatingMachineList),te(i.workingHeadList)}},[y]),console.log("initialRows",Z);const T=i=>{const{name:B,value:r}=i.target;if(B==="collectionId")Pe.find(b=>b.collectionId===parseInt(r)),c(r),R([]),p(!0),m({...n,collectionId:r,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId});else if(B==="designId"){const b=w.find(u=>u.designId===parseInt(r));R([]),p(!0),m({...n,designId:r,baseColorId:b?b.colorId:"",baseColorName:b?b.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})}else if(B==="batchNo"){const b=g.find(u=>u.batchNo===r);m({...n,batchNo:r,planningHeaderId:b?b.planningHeaderId:"",poPcs:b?b.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId}),I(!0)}else m({...n,[B]:r})};console.log("colors",de);const ve=async()=>{console.log("formData",n);try{const i=await ge.post("https://gecxc.com:4041/api/AdditionalProcess/SaveAdditionalProcess",n);console.log("Save response:",i.data),i.data.success?ee("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(ee(`${i.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",i.data.message)),m(B=>({additionalProcessId:0,designId:B.designId,planningHeaderId:B.planningHeaderId,batchNo:B.batchNo,baseColorName:B.baseColorName,poPcs:B.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})),h()}catch(i){console.error("Error saving data:",i),ee("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",n),o.forwardRef(function(B,r){return e.jsx(yt,{direction:"up",ref:r,...B})});const[xe,Ce]=o.useState({}),[v,A]=o.useState(!1),Q=i=>{Ce(i),A(!0)},Y=()=>{A(!1),Ce({}),h()},re=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component"},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"AddVendor",headerName:"Add Vendor",renderCell:i=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(ke,{color:"primary",onClick:()=>Q(i.row),children:e.jsx(Je,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(He,{src:lt,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:V,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:Pe.map(i=>e.jsx(S,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:w.map(i=>e.jsx(S,{value:i.designId,children:i.designNo},i.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:g.map(i=>e.jsx(S,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:T,disabled:!0,sx:i=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(ce,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:T,size:"small",InputLabelProps:{sx:{color:"black"}},children:N.map(i=>e.jsx(S,{value:i.componentId,children:i.componentName},i.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:T,InputLabelProps:{sx:{color:"black"}},children:ne.map(i=>e.jsx(S,{value:i.fabricId,children:i.fabric},i.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:T,InputLabelProps:{sx:{color:"black"}},children:de.map(i=>e.jsx(S,{value:i.colorId,children:i.color},i.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:T,disabled:!0,sx:i=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:n.pcsPerComponent,onChange:T,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:n.uomId,onChange:T,InputLabelProps:{sx:{color:"black"}},children:ye.map(i=>e.jsx(S,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:n.processTypeId,onChange:T,InputLabelProps:{sx:{color:"black"}},children:H.map(i=>e.jsx(S,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(ie,{variant:"contained",size:"small",onClick:ve,children:"Save"})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ae,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(Oe,{iColumns:re,initialRows:Z,setInitialData:x,deleteApi:"https://gecxc.com:4041/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:h,setAccordionExpanded:I,fileName:"AdditionalProcess",isLoading:E}),e.jsxs(Ge,{open:v,onClose:Y,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(Ye,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(fe,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Assign Vendors "}),e.jsx(ke,{onClick:Y,sx:{color:"#ffffff"},children:e.jsx(De,{})})]}),e.jsxs(Xe,{children:[e.jsx(Ve,{id:"alert-dialog-slide-description"}),e.jsx(Et,{additionalProcessData:xe,setAdditionalProcessData:Ce,refetchAdditionalProcessList:h,handleClickOpen:Q})]})]})]})})]})]})},Yt=Gt;function Xt({}){const[d,ee]=o.useState(!0),{data:E}=je(),[p,t]=o.useState([]),[x,n]=o.useState([]),[m,s]=o.useState([]),[I,W]=o.useState([]),[V,c]=o.useState([]);Se(),o.useEffect(()=>{E&&(s(E.result[0].vendorList),n(E.result[0].serviceList),t(E.result[0].serviceTypeList),c(E.result[0].uomList))},[E]);const[y,G]=o.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()}),O=async h=>{const{name:L,value:w}=h.target;if(console.log(`Updating ${L} to ${w}`),G({...y,[L]:w}),L==="collectionId"){const J=I.find(g=>g.collectionId===w);J&&G(g=>({...g,poPcs:J.poPcs}))}};o.useEffect(()=>{const h=()=>{const w=parseFloat(y.qty)||0,J=parseFloat(y.rate)||0;return(w*J).toFixed(2)};G(w=>({...w,totalAmount:h()}));const L=()=>{const w=parseFloat(y.poPcs)||0,J=parseFloat(y.totalAmount)||0;return(w/J).toFixed(2)};G(w=>({...w,costperPiece:L()}))},[y.qty,y.rate,y.totalAmount,y.costperPiece]);const k=async()=>{try{const h=await ge.post("https://gecxc.com:4041/api/AdditionalServices/SaveAdditionalServices",y);console.log("Form data saved:",h.data),G({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(h){console.error("Error saving data:",h)}};o.useEffect(()=>{(async()=>{try{const L=await ge.get("https://gecxc.com:4041/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",L),W(L.data.result)}catch(L){console.error("Error fetching design options:",L)}})()},[]);const[oe,K]=o.useState([]),M=o.useCallback(async()=>{try{const h=await ge.get(`https://gecxc.com:4041/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${y.collectionId}`);Array.isArray(h.data.result)?(ee(!1),K(h.data.result.map((L,w)=>({id:w,...L})))):(console.error("API returned unexpected data format:",h.data.result),K([]))}catch(h){console.error("Error fetching data:",h),K([])}},[y.collectionId]);o.useEffect(()=>{M()},[M]);const P=[{field:"collectionName",headerName:"Collection Name",flex:1},{field:"serviceType",headerName:"Service Type",flex:1},{field:"serviceListName",headerName:"Service List Name",flex:1},{field:"vendor",headerName:"Vendor",flex:1},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount"},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:y.collectionId,onChange:O,size:"small",InputLabelProps:{sx:{color:"black"}},children:I.length>0?I.map(h=>e.jsx(S,{id:"collectionId",value:h.collectionId,children:h.collectionName},h.collectionId)):e.jsx(S,{disabled:!0,children:"No Collections Available"})})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:y.serviceTypeId,onChange:O,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:p.map(h=>e.jsx(S,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:y.serviceListId,onChange:O,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:x.map(h=>e.jsx(S,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:y.vendorId,onChange:O,InputLabelProps:{sx:{color:"black"}},children:m.map(h=>e.jsx(S,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:y.poPcs,onChange:O,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:h=>({...y.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Qty",name:"qty",value:y.qty,onChange:O,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:y.uomId,onChange:O,InputLabelProps:{sx:{color:"black"}},children:V.map(h=>e.jsx(S,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"rate",value:y.rate,onChange:O,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:y.totalAmount,onChange:O,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:y.costperPiece,onChange:O,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(ie,{variant:"contained",color:"primary",size:"small",onClick:k,children:"Save"})})]})]}),e.jsx(ce,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(me,{variant:"outlined",children:[e.jsx(he,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Oe,{iColumns:P,initialRows:oe,isLoading:d})]})]})}const Fe=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function sa(){const[d,ee]=o.useState(0),[E,p]=o.useState(new Set),[t,x]=o.useState(null),[n,m]=o.useState([]),{enqueueSnackbar:s}=Ne(),{data:I,refetch:W}=je(),V=g=>{x(g.currentTarget)},c=()=>{x(null)},y=!!t,G=y?"simple-popover":void 0,O=g=>g===1,k=g=>E.has(g),oe=()=>{let g=E;k(d)&&(g=new Set(g.values()),g.delete(d)),ee(D=>D+1),p(g)},K=()=>{ee(g=>g-1)},M=()=>{if(!O(d))throw new Error("You can't skip a step that isn't optional.");ee(g=>g+1),p(g=>{const D=new Set(g.values());return D.add(d),D})},P=()=>{ee(0)},[h,L]=o.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),w=async()=>{if(!h.lookUpDomain||!h.lookUpName){s("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const g=await ge.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${h.lookUpDomain}&LookUpName=${h.lookUpName}&appId=1`);return console.log("Form data saved:",g.data),s("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),L({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),W(),g.data}catch(g){throw console.error("Error saving data:",g),s("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),g}},J=g=>{L({...h,[g.target.name]:g.target.value})};return o.useEffect(()=>{(async()=>{try{const D=await ge.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",D),m(D.data.result)}catch(D){console.error("Error fetching design options:",D)}})()},[]),e.jsxs(Me,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(fe,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(ie,{"aria-describedby":G,variant:"outlined",size:"small",onClick:V,children:"+Lookup"}),e.jsx(kt,{id:"mouse-over-popover",open:y,anchorEl:t,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:h.lookUpDomain,name:"lookUpDomain",onChange:J,children:n.map(g=>e.jsx(S,{value:g.lookUpDomain,children:g.lookUpDomain},g.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,label:"Add Lookup Description",value:h.lookUpName,onChange:J,name:"lookUpName",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(ie,{variant:"contained",size:"small",onClick:w,children:"Save"})})]})})]})]}),e.jsx(Ct,{activeStep:d,children:Fe.map((g,D)=>{const ne={},ae={};return O(D)&&(ae.optional=e.jsx(fe,{variant:"caption",children:"Optional"})),k(D)&&(ne.completed=!1),e.jsx(Pt,{...ne,children:e.jsxs(vt,{...ae,onClick:()=>ee(D),style:{cursor:"pointer"},children:[" ",g]})},g)})}),e.jsxs(Me,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ie,{color:"inherit",disabled:d===0,onClick:K,sx:{mr:1},children:"Back"}),e.jsx(Me,{sx:{flex:"1 1 auto"}}),O(d)&&e.jsx(ie,{color:"inherit",onClick:M,sx:{mr:1},children:"Skip"}),e.jsx(ie,{onClick:oe,children:d===Fe.length-1?"Finish":"Next"})]}),d===Fe.length?e.jsxs(o.Fragment,{children:[e.jsx(fe,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(Me,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Me,{sx:{flex:"1 1 auto"}}),e.jsx(ie,{onClick:P,children:"Reset"})]})]}):e.jsxs(o.Fragment,{children:[d===0&&e.jsx(Wt,{}),d===1&&e.jsx(Mt,{}),d===2&&e.jsx(Qt,{}),d===3&&e.jsx(wt,{}),d===4&&e.jsx(qt,{}),d===5&&e.jsx(Yt,{}),d===6&&e.jsx(Xt,{}),e.jsxs(Me,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ie,{color:"inherit",disabled:d===0,onClick:K,sx:{mr:1},children:"Back"}),e.jsx(Me,{sx:{flex:"1 1 auto"}}),O(d)&&e.jsx(ie,{color:"inherit",onClick:M,sx:{mr:1},children:"Skip"}),e.jsx(ie,{onClick:oe,children:d===Fe.length-1?"Finish":"Next"})]})]})]})}export{sa as default};
