import{u as p,c as M,r as l,b as R,j as e,C as W,d as k,B as C,G as o,T as I,M as z}from"./index-UoeC-e26.js";import{a as i}from"./axios-D07O1bWV.js";import{F as $}from"./EditAbleDataGrid-D5o07o2-.js";import{T as A,a as O,b as f,d as Q,c as _,e as j}from"./AddCircle-VR9aSnJN.js";import{T as r,B as q}from"./TextField-dRB4SJvn.js";import{M as c}from"./Skeleton-DxWEYmQ_.js";import"./DataGrid-BiLKzzfV.js";const ae=()=>{const{data:V,error:X,isLoading:J,refetch:b}=p(),{data:d}=p();M(),l.useState(!0);const{enqueueSnackbar:y}=R(),P=(d==null?void 0:d.result)||[],[a,h]=l.useState({collectionName:"",collectionId:"",plannedCollectionId:"",plannedDesignedId:"",designId:"",poPcs:"",batchNo:"",createdBy:0,createdOn:new Date().toISOString()}),[v,D]=l.useState([]),[m,S]=l.useState([]),[B,N]=l.useState([]),[G,x]=l.useState([]),g=l.useCallback(async()=>{try{const t=await i.get(`https://gecxc.com:4041/api/PrePlanning/GetPlanningHeaderListByDesignId?designId=${a.plannedDesignedId}`);console.log("DataGridResponse",t);const n=t.data.result.map((u,L)=>({...u,id:L+1}));x(n)}catch(t){console.error("Error fetching data:",t),x([])}},[a.plannedDesignedId]);l.useEffect(()=>{g()},[g]);const H=[{field:"collectionName",headerName:"Collection",editable:!0,flex:2},{field:"batchNo",headerName:"Batch#",flex:1,editable:!0},{field:"designNo",headerName:"Design Number",flex:1,editable:!0},{field:"Status",headerName:"Status",flex:1,editable:!0}],[w,F]=l.useState("1"),T=(t,n)=>{F(n)},s=async t=>{const{name:n,value:u}=t.target;h({...a,[n]:u})},E=async()=>{console.log(a);try{const t=await i.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanningHeader",a);console.log("Form data saved:",t.data),y("Planning Batch saved successfully!",{variant:"success",autoHideDuration:5e3}),h({collectionName:"",collectionId:"",designId:"",poPcs:"",batchNo:""}),b()}catch(t){console.error("Error saving data:",t)}};return l.useEffect(()=>{(async()=>{if(a.collectionId)try{const n=await i.get(`https://gecxc.com:4041/API/DesignRegistration/GetDesignListByCollectionId?CollectionId=${a.collectionId}`);console.log(a.collectionId),console.log(n),D(n.data.result)}catch(n){console.error("Error fetching design options:",n)}})()},[a.collectionId]),l.useEffect(()=>{(async()=>{try{const n=await i.get("https://gecxc.com:4041/api/PrePlanning/GetCollectionListFromPlanningHeader");console.log("GetCollectionFromPlanningHeader",n),S(n.data.result)}catch(n){console.error("Error fetching design options:",n)}})()},[]),l.useEffect(()=>{(async()=>{if(a.plannedCollectionId)try{const n=await i.get(`https://gecxc.com:4041/api/PrePlanning/GetDesignFromPlanningHeaderByCollectionId?collectionid=${a.plannedCollectionId}`);console.log("GetDesignFromPlanningHeaderByCollectionId",n),N(n.data.result)}catch(n){console.error("Error fetching design options:",n)}})()},[a.plannedCollectionId]),console.log("formData",a),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:10,borderRadius:7,width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto",padding:5},children:e.jsxs(W,{variant:"outlined",children:[e.jsx(k,{className:"css-4rfrnx-MuiCardHeader-root",title:"Create Batch Planning",titleTypographyProps:{style:{color:"white"}}}),e.jsx(C,{sx:{width:"100%",typography:"body1"},children:e.jsxs(A,{value:w,children:[e.jsx(C,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(O,{onChange:T,"aria-label":"lab API tabs example",children:[e.jsx(f,{icon:e.jsx(Q,{}),label:"Add Collection",value:"1",sx:t=>({"& .MuiTouchRipple-child":{backgroundColor:`${t.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(_,{}),label:"Search Collection",value:"2",sx:t=>({"& .MuiTouchRipple-child":{backgroundColor:`${t.palette.primary.main} !important`}})})]})}),e.jsx(j,{value:"1",children:e.jsxs(o,{container:!0,spacing:2,width:"inherit",sx:{paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:a.collectionId,onChange:s,size:"small",children:P.map(t=>e.jsx(c,{value:t.collectionId,children:t.collectionName},t.collectionId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:a.designId,onChange:s,size:"small",children:v.map(t=>e.jsx(c,{value:t.designId,children:t.designNo},t.designId))})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{label:"Po PCs",fullWidth:!0,size:"small",name:"poPcs",value:a.poPcs,onChange:s})}),e.jsx(o,{item:!0,xs:12,md:12,textAlign:"right",sx:{marginBottom:2},children:e.jsx(q,{variant:"contained",size:"small",onClick:E,children:"Save"})})]})}),e.jsx(j,{value:"2",children:e.jsx(o,{container:!0,spacing:2,width:"inherit",children:e.jsx(o,{item:!0,xs:9,md:9,children:e.jsx(I,{variant:"h3",gutterBottom:!0,children:"Search Collection"})})})})]})})]})}),e.jsx(z,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23"},children:e.jsxs(o,{container:!0,spacing:2,width:"inherit",children:[e.jsx(o,{item:!0,xs:12,md:12,children:e.jsx(I,{variant:"h4",gutterBottom:!0,children:"Search"})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Select Collection",name:"plannedCollectionId",value:a.plannedCollectionId,onChange:s,size:"small",children:m.length>0?m.map(t=>e.jsx(c,{id:"ddlCollection",value:t.collectionId,children:t.collectionName},t.planningHeaderId)):e.jsx(c,{disabled:!0,children:"No Collections Available"})})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(r,{fullWidth:!0,select:!0,label:"Design",name:"plannedDesignedId",value:a.plannedDesignedId,onChange:s,size:"small",children:B.map(t=>e.jsx(c,{value:t.designId,children:t.designNo},t.planningHeaderId))})}),e.jsx(o,{item:!0,xs:12,paddingTop:1,children:e.jsx($,{initialRows:G,ncolumns:H,formData:a,fetchData:g})})]})})]})};export{ae as default};
