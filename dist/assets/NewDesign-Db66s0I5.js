import{a as E,e as H,c as $,j as e,M as _,B as C,C as b,d as N,G as a,D as P,T as Q}from"./index-P63s4xo1.js";import{r as o}from"./vendor-BXCbSo2_.js";import{B as S,a as w}from"./axios-Csp6NEuH.js";import{T as V,a as X,b as O,d as Y,c as q,e as B,F as k}from"./EditAbleDataGrid-auPVv5ae.js";import{d as J}from"./VisibilityOutlined-DdvVQzSI.js";import{T as i}from"./TextField-BsV9VrK2.js";import{M as T}from"./Skeleton-_785vHRP.js";import"./DataGrid--PoTrKUE.js";import"./ExcelExport-DPVX8EPO.js";import"./dayjs.min-DicwS6T5.js";const re=()=>{const{data:d}=E(),[g,U]=o.useState(""),{data:c,refetch:u}=H(g,{skip:!g}),{enqueueSnackbar:p}=$(),[x,f]=o.useState([]),[j,R]=o.useState([]),[z,A]=o.useState("1"),L=(t,l)=>{A(l)};o.useEffect(()=>{c&&(f(c.result),u())},[c]),o.useEffect(()=>{(async()=>{try{const r=(await w.get(" https://gecxc.com:4041/api/Common/GetLookUpByDomain?lookupDomain=COLOURS")).data.result;R(r)}catch(l){console.error("Error fetching pre-planning lookup data:",l)}})()},[]);const m=(d==null?void 0:d.result)||[],[s,h]=o.useState({collectionId:"",designNo:"",designerName:"",poPcs:"",dateOfPlanning:"",colorId:"",appId:1,createdBy:0,createdOn:new Date().toISOString(),lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()}),n=t=>{const{name:l,value:r}=t.target;if(l==="collectionId"){const D=m.find(M=>M.collectionId===parseInt(r));U(r),h({...s,collectionId:r,poPcs:D?D.poPcs:"",designNo:"",designerName:"",dateOfPlanning:"",colorId:""})}else h({...s,[l]:r})},v=x.map((t,l)=>({id:l+1,designId:t.designId,collectionId:t.collectionId,designNo:t.designNo,designerName:t.designerName,poPcs:t.poPcs,dateOfPlanning:t.dateOfPlanning,colorId:t.colorId,appId:t.appId,createdBy:t.createdBy,createdOn:t.createdOn,lastUpdatedBy:t.lastUpdatedBy,lastUpdatedOn:t.lastUpdatedOn}));console.log("initialRows",v);const I=[{field:"collectionId",headerName:"Collection ID",editable:!0,flex:2,type:"singleSelect",valueOptions:m.map(t=>({value:t.collectionId,label:t.collectionName}))},{field:"designNo",headerName:"Design No",flex:1,editable:!0},{field:"designerName",headerName:"Designer Name",flex:1,editable:!0},{field:"poPcs",headerName:"Po PCs",flex:1,editable:!0},{field:"dateOfPlanning",headerName:"Date of Planning",type:"date",flex:1,editable:!0,valueGetter:t=>t?new Date(t):null,valueFormatter:t=>{const l=t;return l?l.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"}):""}},{field:"colorId",headerName:"Color",flex:1,editable:!0,type:"singleSelect",valueOptions:j.map(t=>({value:t.lookUpId,label:t.lookUpName}))}],W=async()=>{console.log(s);try{const t=await w.post("https://gecxc.com:4041/API/DesignRegistration/SaveDesign",s);p("Design saved successfully!",{variant:"success",autoHideDuration:5e3}),console.log("Form data saved:",t.data),f([...x,t.data]),h({...s,designNo:"",designerName:"",poPcs:"",dateOfPlanning:"",colorId:""}),u()}catch(t){console.error("Error saving data:",t),p("Design not saved successfully!",{variant:"error",autoHideDuration:5e3})}},F="https://gecxc.com:4041/api/DesignRegistration/DeleteDesignById?designId=",y="https://gecxc.com:4041/API/DesignRegistration/SaveDesign",G=()=>{};return e.jsx(_,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(C,{sx:{width:"100%",typography:"body1"},children:e.jsxs(V,{value:z,children:[e.jsx(C,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(X,{onChange:L,children:[e.jsx(O,{icon:e.jsx(Y,{}),label:"Add Design",value:"1",sx:t=>({"& .MuiTouchRipple-child":{backgroundColor:`${t.palette.primary.main} !important`}})}),e.jsx(O,{icon:e.jsx(q,{}),label:"Search Design",value:"2",sx:t=>({"& .MuiTouchRipple-child":{backgroundColor:`${t.palette.primary.main} !important`}})})]})}),e.jsxs(B,{value:"1",children:[e.jsxs(b,{variant:"outlined",children:[e.jsx(N,{className:"css-4rfrnx-MuiCardHeader-root",title:"Add Design ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:s.collectionId,onChange:n,size:"small",children:m.map(t=>e.jsx(T,{value:t.collectionId,children:t.collectionName},t.collectionId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Design No.",name:"designNo",fullWidth:!0,size:"small",value:s.designNo,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Designer Name",fullWidth:!0,size:"small",name:"designerName",value:s.designerName,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{size:"small",type:"date",label:"Planning Date",name:"dateOfPlanning",value:s.dateOfPlanning,onChange:n,fullWidth:!0,focused:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{label:"Po PCs",fullWidth:!0,size:"small",name:"poPcs",type:"number",value:s.poPcs,disabled:!0,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:n,children:j.map(t=>e.jsx(T,{value:t.lookUpId,children:t.lookUpName},t.lookUpId))})}),e.jsxs(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:[e.jsx(S,{variant:"contained",size:"small",onClick:W,children:"Save"})," "]})]})]}),e.jsx(P,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(b,{variant:"outlined",children:[e.jsx(N,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(J,{}),title:"View Designs ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(k,{initialRows:v,ncolumns:I,formData:s,editAPi:y,deleteApi:F,deleteBy:"designId",refetch:u})})})]})]}),e.jsxs(B,{value:"2",children:[e.jsxs(a,{container:!0,spacing:2,width:"inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(Q,{variant:"h3",gutterBottom:!0,children:"Search Design"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(S,{variant:"contained",size:"small",onClick:G,children:"Search"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(i,{size:"small",type:"date",label:"Date From",name:"planningDate",value:s.planningDate,onChange:n,fullWidth:!0,focused:!0})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(i,{size:"small",type:"date",label:"Date to",name:"launchDate",value:s.launchDate,onChange:n,fullWidth:!0,focused:!0})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(P,{color:"#cc8587",sx:{height:2,width:"100%"}})})]}),e.jsx(a,{container:!0,spacing:2,width:"inherit",paddingTop:2,children:e.jsx(a,{item:!0,xs:12,children:e.jsx(k,{initialRows:[],ncolumns:I,formData:s,editAPi:y,disableAddRecord:!0})})})]})]})})})};export{re as default};
