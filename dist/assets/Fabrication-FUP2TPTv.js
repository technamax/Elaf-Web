import{r,E as w,A as q,s as F,_ as b,P as A,i as E,j as a,l as W,g as O,a9 as J,aa as Y,h as K,m as ee,a as te,n as ae,o as oe,x as ne,t as le,M as se,F as re,G as g,T as ie,D as ce}from"./index-DJGER93a.js";import{a as de}from"./axios-C-jwrZQb.js";import{F as pe}from"./EditAbleDataGrid-DJtVCxAi.js";import{B as ue,T as y}from"./TextField-5grZhScd.js";import{M as k}from"./Skeleton-3iGZ_ZrH.js";const _=r.createContext({}),V=r.createContext({});function me(e){return w("MuiStep",e)}q("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const be=["active","children","className","component","completed","disabled","expanded","index","last"],he=e=>{const{classes:t,orientation:o,alternativeLabel:l,completed:i}=e;return O({root:["root",o,l&&"alternativeLabel",i&&"completed"]},me,t)},xe=F("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({},e.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},e.alternativeLabel&&{flex:1,position:"relative"})),Ke=r.forwardRef(function(t,o){const l=A({props:t,name:"MuiStep"}),{active:i,children:d,className:h,component:f="div",completed:u,disabled:I,expanded:x=!1,index:c,last:C}=l,P=E(l,be),{activeStep:M,connector:j,alternativeLabel:z,orientation:U,nonLinear:D}=r.useContext(_);let[L=!1,T=!1,R=!1]=[i,u,I];M===c?L=i!==void 0?i:!0:!D&&M>c?T=u!==void 0?u:!0:!D&&M<c&&(R=I!==void 0?I:!0);const $=r.useMemo(()=>({index:c,last:C,expanded:x,icon:c+1,active:L,completed:T,disabled:R}),[c,C,x,L,T,R]),N=b({},l,{active:L,orientation:U,alternativeLabel:z,completed:T,disabled:R,expanded:x,component:f}),v=he(N),B=a.jsxs(xe,b({as:f,className:W(v.root,h),ref:o,ownerState:N},P,{children:[j&&z&&c!==0?j:null,d]}));return a.jsx(V.Provider,{value:$,children:j&&!z&&c!==0?a.jsxs(r.Fragment,{children:[j,B]}):B})}),ve=J(a.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),fe=J(a.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function ge(e){return w("MuiStepIcon",e)}const H=q("MuiStepIcon",["root","active","completed","error","text"]);var Z;const Se=["active","className","completed","error","icon"],Ce=e=>{const{classes:t,active:o,completed:l,error:i}=e;return O({root:["root",o&&"active",l&&"completed",i&&"error"],text:["text"]},ge,t)},Q=F(Y,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${H.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${H.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${H.error}`]:{color:(e.vars||e).palette.error.main}})),Ie=F("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily})),Le=r.forwardRef(function(t,o){const l=A({props:t,name:"MuiStepIcon"}),{active:i=!1,className:d,completed:h=!1,error:f=!1,icon:u}=l,I=E(l,Se),x=b({},l,{active:i,completed:h,error:f}),c=Ce(x);if(typeof u=="number"||typeof u=="string"){const C=W(d,c.root);return f?a.jsx(Q,b({as:fe,className:C,ref:o,ownerState:x},I)):h?a.jsx(Q,b({as:ve,className:C,ref:o,ownerState:x},I)):a.jsxs(Q,b({className:C,ref:o,ownerState:x},I,{children:[Z||(Z=a.jsx("circle",{cx:"12",cy:"12",r:"12"})),a.jsx(Ie,{className:c.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:x,children:u})]}))}return u});function ye(e){return w("MuiStepLabel",e)}const G=q("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),je=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],Ne=e=>{const{classes:t,orientation:o,active:l,completed:i,error:d,disabled:h,alternativeLabel:f}=e;return O({root:["root",o,d&&"error",h&&"disabled",f&&"alternativeLabel"],label:["label",l&&"active",i&&"completed",d&&"error",h&&"disabled",f&&"alternativeLabel"],iconContainer:["iconContainer",l&&"active",i&&"completed",d&&"error",h&&"disabled",f&&"alternativeLabel"],labelContainer:["labelContainer",f&&"alternativeLabel"]},ye,t)},Pe=F("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation]]}})(({ownerState:e})=>b({display:"flex",alignItems:"center",[`&.${G.alternativeLabel}`]:{flexDirection:"column"},[`&.${G.disabled}`]:{cursor:"default"}},e.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),Re=F("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})(({theme:e})=>b({},e.typography.body2,{display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${G.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${G.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${G.alternativeLabel}`]:{marginTop:16},[`&.${G.error}`]:{color:(e.vars||e).palette.error.main}})),Fe=F("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${G.alternativeLabel}`]:{paddingRight:0}})),Me=F("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${G.alternativeLabel}`]:{textAlign:"center"}})),ze=r.forwardRef(function(t,o){var l;const i=A({props:t,name:"MuiStepLabel"}),{children:d,className:h,componentsProps:f={},error:u=!1,icon:I,optional:x,slotProps:c={},StepIconComponent:C,StepIconProps:P}=i,M=E(i,je),{alternativeLabel:j,orientation:z}=r.useContext(_),{active:U,disabled:D,completed:L,icon:T}=r.useContext(V),R=I||T;let $=C;R&&!$&&($=Le);const N=b({},i,{active:U,alternativeLabel:j,completed:L,disabled:D,error:u,orientation:z}),v=Ne(N),B=(l=c.label)!=null?l:f.label;return a.jsxs(Pe,b({className:W(v.root,h),ref:o,ownerState:N},M,{children:[R||$?a.jsx(Fe,{className:v.iconContainer,ownerState:N,children:a.jsx($,b({completed:L,active:U,error:u,icon:R},P))}):null,a.jsxs(Me,{className:v.labelContainer,ownerState:N,children:[d?a.jsx(Re,b({ownerState:N},B,{className:W(v.label,B==null?void 0:B.className),children:d})):null,x]})]}))});ze.muiName="StepLabel";function Ue(e){return w("MuiStepConnector",e)}q("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const De=["className"],Te=e=>{const{classes:t,orientation:o,alternativeLabel:l,active:i,completed:d,disabled:h}=e,f={root:["root",o,l&&"alternativeLabel",i&&"active",d&&"completed",h&&"disabled"],line:["line",`line${K(o)}`]};return O(f,Ue,t)},$e=F("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({flex:"1 1 auto"},e.orientation==="vertical"&&{marginLeft:12},e.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),Be=F("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.line,t[`line${K(o.orientation)}`]]}})(({ownerState:e,theme:t})=>{const o=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return b({display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:o},e.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},e.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),Ge=r.forwardRef(function(t,o){const l=A({props:t,name:"MuiStepConnector"}),{className:i}=l,d=E(l,De),{alternativeLabel:h,orientation:f="horizontal"}=r.useContext(_),{active:u,disabled:I,completed:x}=r.useContext(V),c=b({},l,{alternativeLabel:h,orientation:f,active:u,completed:x,disabled:I}),C=Te(c);return a.jsx($e,b({className:W(C.root,i),ref:o,ownerState:c},d,{children:a.jsx(Be,{className:C.line,ownerState:c})}))});function We(e){return w("MuiStepper",e)}q("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const ke=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],we=e=>{const{orientation:t,alternativeLabel:o,classes:l}=e;return O({root:["root",t,o&&"alternativeLabel"]},We,l)},qe=F("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel]}})(({ownerState:e})=>b({display:"flex"},e.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},e.orientation==="vertical"&&{flexDirection:"column"},e.alternativeLabel&&{alignItems:"flex-start"})),Ae=a.jsx(Ge,{}),Xe=r.forwardRef(function(t,o){const l=A({props:t,name:"MuiStepper"}),{activeStep:i=0,alternativeLabel:d=!1,children:h,className:f,component:u="div",connector:I=Ae,nonLinear:x=!1,orientation:c="horizontal"}=l,C=E(l,ke),P=b({},l,{alternativeLabel:d,orientation:c,component:u}),M=we(P),j=r.Children.toArray(h).filter(Boolean),z=j.map((D,L)=>r.cloneElement(D,b({index:L,last:L+1===j.length},D.props))),U=r.useMemo(()=>({activeStep:i,alternativeLabel:d,connector:I,nonLinear:x,orientation:c}),[i,d,I,x,c]);return a.jsx(_.Provider,{value:U,children:a.jsx(qe,b({as:u,ownerState:P,className:W(M.root,f),ref:o},C,{children:z}))})}),Ee=()=>{const[e,t]=r.useState({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:o}=ee();console.log(o);const[l,i]=r.useState(""),{data:d}=te(),{data:h,refetch:f}=ae(l,{skip:!l}),{data:u,refetch:I}=oe(e.designId,{skip:!e.designId}),{data:x}=ne(e.batchNo,{skip:!e.batchNo}),{data:c,refetch:C}=le(e.batchNo,{skip:!e.batchNo});console.log("fabricRequisitionData",c);const[P,M]=r.useState([]),[j,z]=r.useState([]),[U,D]=r.useState([]),[L,T]=r.useState([]),[R,$]=r.useState([]);r.useEffect(()=>{h&&M(h.result)},[h]),r.useEffect(()=>{u&&z(u.result)},[u]),r.useEffect(()=>{x&&D(x.result)},[x]),r.useEffect(()=>{c&&$(c.result.map((n,m)=>({id:m,...n})))},[c]),r.useEffect(()=>{if(d){const n=d.result[0];T(n.uomList)}},[d]);const N=(o==null?void 0:o.result)||[];r.useEffect(()=>{const n=()=>{const s=parseFloat(e.quantity)||0,p=parseFloat(e.rate)||0;return s*p};t(s=>({...s,total:n()}));const m=()=>{const s=parseFloat(e.total)||0,p=parseFloat(e.gst)||0;return s*(1+p/100)};t(s=>({...s,totalInclGst:m()}));const S=()=>{const s=parseFloat(e.total)||0,p=parseFloat(e.poPcs)||0;return s/p};t(s=>({...s,unitPrice:S()}))},[e.quantity,e.rate,e.total,e.gst]);const v=n=>{const{name:m,value:S}=n.target;if(m==="collectionId"){const s=N.find(p=>p.collectionId===parseInt(S));i(S),t({...e,collectionId:S,poPcs:s?s.poPcs:""})}else if(m==="designId"){const s=P.find(p=>p.designId===parseInt(S));t({...e,designId:S,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:""})}else if(m==="batchNo"){const s=j.find(p=>p.batchNo===S);t({...e,batchNo:S,planningHeaderId:s?s.planningHeaderId:""})}else if(m==="fabricId"){const s=U.find(p=>p.fabricId===S);t({...e,fabricId:S,quantity:s?s.total:""})}else t({...e,[m]:S})},B=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:P.map(n=>({value:n.designId,label:n.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"uomId",headerName:"UOM",editable:!0,flex:1,type:"singleSelect",valueOptions:L.map(n=>({value:n.lookUpId,label:n.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(n,m)=>{const S=m.quantity??0,s=m.rate??0,p=S*s;return console.log("total",p),{...m,total:p}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(n,m)=>{const S=m.total??0,s=m.poPcs??0,p=S/s;return console.log("unitPrice",p),{...m,unitPrice:p}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(n,m)=>{const S=m.total??0,s=m.gst??0,p=S*(1+s/100);return console.log("totalInclGst",p),{...m,totalInclGst:p}}}],X=async()=>{try{const n=await de.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",e);console.log("Save response:",n.data),C(),t({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(n){console.error("Error saving data:",n)}};return console.log("formData",e),a.jsxs(se,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[a.jsx(re,{children:a.jsxs(g,{container:!0,spacing:2,width:"Inherit",children:[a.jsx(g,{item:!0,xs:9,md:9,children:a.jsx(ie,{variant:"h3",gutterBottom:!0,children:"Fabric Requisition"})}),a.jsx(g,{item:!0,xs:3,textAlign:"right",children:a.jsx(ue,{variant:"contained",size:"small",onClick:X,children:"Save"})}),a.jsxs(g,{item:!0,xs:12,md:3,children:[a.jsx(y,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:l,onChange:v,size:"small",children:N.map(n=>a.jsx(k,{value:n.collectionId,children:n.collectionName},n.collectionId))})," "]}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:e.designId,onChange:v,size:"small",children:P.map(n=>a.jsx(k,{value:n.designId,children:n.designNo},n.designId))})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:e.baseColorName,onChange:v,disabled:!0})}),a.jsxs(g,{item:!0,xs:12,md:3,children:[a.jsx(y,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:e.batchNo,onChange:v,size:"small",children:j.map(n=>a.jsx(k,{value:n.batchNo,children:n.batchNo},n.batchNo))})," "]}),a.jsx(g,{item:!0,xs:12,md:12,children:a.jsx(ce,{color:"#cc8587",sx:{height:2,width:"100%"}})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:e.fabricId,onChange:v,children:U.map(n=>a.jsx(k,{value:n.fabricId,children:n.fabric},n.fabricId))})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:e.uomId,onChange:v,children:L.map(n=>a.jsx(k,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:e.poPcs,onChange:v})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{label:"Quantity",fullWidth:!0,size:"small",name:"quantity",value:e.quantity,onChange:v})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{label:"Rate",fullWidth:!0,size:"small",name:"rate",value:e.rate,onChange:v})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{label:"Total",fullWidth:!0,size:"small",name:"total",value:e.total,onChange:v})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(y,{label:"Unit Price",fullWidth:!0,size:"small",name:"unitPrice",value:e.unitPrice,onChange:v})}),a.jsx(g,{item:!0,xs:12,md:1.5,children:a.jsx(y,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:e.gst,onChange:v})}),a.jsx(g,{item:!0,xs:12,md:1.5,children:a.jsx(y,{label:"Total Inc GSt.",fullWidth:!0,size:"small",name:"totalInclGst",value:e.totalInclGst,onChange:v})})]})}),a.jsx(g,{container:!0,spacing:2,width:"Inherit",children:a.jsx(g,{sx:{marginTop:2},item:!0,xs:12,children:a.jsx(pe,{ncolumns:B,initialRows:R,formData:e,editAPi:"https://gecxc.com:4041/api/Fabrication/SaveFabrication",refetch:C,deleteApi:"https://gecxc.com:4041/api/Fabrication/DeleteFabricByFabricId?fabricationId=",deleteBy:"fabricationId",disableAddRecord:!0})})})]})},Ye=Ee;export{Ye as F,Xe as S,Ke as a,ze as b};
