import{r,n as q,m as w,s as M,_ as b,x as E,y as _,j as a,E as D,H,$ as J,a0 as Y,N as K,e as ee,a as te,f as ae,g as oe,h as le,i as se,M as ne,F as re,G as g,T as ie,D as ce}from"./index-4q30TYyY.js";import{a as de}from"./axios-C5WTuVyO.js";import{F as pe}from"./EditAbleDataGrid-BM9QIaIC.js";import{B as ue,T as j}from"./TextField-D7MtEos9.js";import{M as k}from"./Skeleton-bPUoW8Jd.js";const O=r.createContext({}),V=r.createContext({});function me(e){return q("MuiStep",e)}w("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const be=["active","children","className","component","completed","disabled","expanded","index","last"],he=e=>{const{classes:t,orientation:o,alternativeLabel:n,completed:c}=e;return H({root:["root",o,n&&"alternativeLabel",c&&"completed"]},me,t)},ve=M("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({},e.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},e.alternativeLabel&&{flex:1,position:"relative"})),Je=r.forwardRef(function(t,o){const n=E({props:t,name:"MuiStep"}),{active:c,children:p,className:h,component:f="div",completed:m,disabled:C,expanded:v=!1,index:d,last:S}=n,P=_(n,be),{activeStep:z,connector:L,alternativeLabel:U,orientation:R,nonLinear:T}=r.useContext(O);let[I=!1,$=!1,F=!1]=[c,m,C];z===d?I=c!==void 0?c:!0:!T&&z>d?$=m!==void 0?m:!0:!T&&z<d&&(F=C!==void 0?C:!0);const G=r.useMemo(()=>({index:d,last:S,expanded:v,icon:d+1,active:I,completed:$,disabled:F}),[d,S,v,I,$,F]),N=b({},n,{active:I,orientation:R,alternativeLabel:U,completed:$,disabled:F,expanded:v,component:f}),x=he(N),W=a.jsxs(ve,b({as:f,className:D(x.root,h),ref:o,ownerState:N},P,{children:[L&&U&&d!==0?L:null,p]}));return a.jsx(V.Provider,{value:G,children:L&&!U&&d!==0?a.jsxs(r.Fragment,{children:[L,W]}):W})}),xe=J(a.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),fe=J(a.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function ge(e){return q("MuiStepIcon",e)}const A=w("MuiStepIcon",["root","active","completed","error","text"]);var Z;const Se=["active","className","completed","error","icon"],Ce=e=>{const{classes:t,active:o,completed:n,error:c}=e;return H({root:["root",o&&"active",n&&"completed",c&&"error"],text:["text"]},ge,t)},Q=M(Y,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${A.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${A.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${A.error}`]:{color:(e.vars||e).palette.error.main}})),Ie=M("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily})),Le=r.forwardRef(function(t,o){const n=E({props:t,name:"MuiStepIcon"}),{active:c=!1,className:p,completed:h=!1,error:f=!1,icon:m}=n,C=_(n,Se),v=b({},n,{active:c,completed:h,error:f}),d=Ce(v);if(typeof m=="number"||typeof m=="string"){const S=D(p,d.root);return f?a.jsx(Q,b({as:fe,className:S,ref:o,ownerState:v},C)):h?a.jsx(Q,b({as:xe,className:S,ref:o,ownerState:v},C)):a.jsxs(Q,b({className:S,ref:o,ownerState:v},C,{children:[Z||(Z=a.jsx("circle",{cx:"12",cy:"12",r:"12"})),a.jsx(Ie,{className:d.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:v,children:m})]}))}return m});function ye(e){return q("MuiStepLabel",e)}const B=w("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),je=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],Ne=e=>{const{classes:t,orientation:o,active:n,completed:c,error:p,disabled:h,alternativeLabel:f}=e;return H({root:["root",o,p&&"error",h&&"disabled",f&&"alternativeLabel"],label:["label",n&&"active",c&&"completed",p&&"error",h&&"disabled",f&&"alternativeLabel"],iconContainer:["iconContainer",n&&"active",c&&"completed",p&&"error",h&&"disabled",f&&"alternativeLabel"],labelContainer:["labelContainer",f&&"alternativeLabel"]},ye,t)},Pe=M("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation]]}})(({ownerState:e})=>b({display:"flex",alignItems:"center",[`&.${B.alternativeLabel}`]:{flexDirection:"column"},[`&.${B.disabled}`]:{cursor:"default"}},e.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),Fe=M("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})(({theme:e})=>b({},e.typography.body2,{display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${B.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${B.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${B.alternativeLabel}`]:{marginTop:16},[`&.${B.error}`]:{color:(e.vars||e).palette.error.main}})),Re=M("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${B.alternativeLabel}`]:{paddingRight:0}})),Me=M("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${B.alternativeLabel}`]:{textAlign:"center"}})),ze=r.forwardRef(function(t,o){var n;const c=E({props:t,name:"MuiStepLabel"}),{children:p,className:h,componentsProps:f={},error:m=!1,icon:C,optional:v,slotProps:d={},StepIconComponent:S,StepIconProps:P}=c,z=_(c,je),{alternativeLabel:L,orientation:U}=r.useContext(O),{active:R,disabled:T,completed:I,icon:$}=r.useContext(V),F=C||$;let G=S;F&&!G&&(G=Le);const N=b({},c,{active:R,alternativeLabel:L,completed:I,disabled:T,error:m,orientation:U}),x=Ne(N),W=(n=d.label)!=null?n:f.label;return a.jsxs(Pe,b({className:D(x.root,h),ref:o,ownerState:N},z,{children:[F||G?a.jsx(Re,{className:x.iconContainer,ownerState:N,children:a.jsx(G,b({completed:I,active:R,error:m,icon:F},P))}):null,a.jsxs(Me,{className:x.labelContainer,ownerState:N,children:[p?a.jsx(Fe,b({ownerState:N},W,{className:D(x.label,W==null?void 0:W.className),children:p})):null,v]})]}))});ze.muiName="StepLabel";function Ue(e){return q("MuiStepConnector",e)}w("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const Te=["className"],$e=e=>{const{classes:t,orientation:o,alternativeLabel:n,active:c,completed:p,disabled:h}=e,f={root:["root",o,n&&"alternativeLabel",c&&"active",p&&"completed",h&&"disabled"],line:["line",`line${K(o)}`]};return H(f,Ue,t)},Ge=M("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({flex:"1 1 auto"},e.orientation==="vertical"&&{marginLeft:12},e.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),We=M("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.line,t[`line${K(o.orientation)}`]]}})(({ownerState:e,theme:t})=>{const o=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return b({display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:o},e.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},e.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),Be=r.forwardRef(function(t,o){const n=E({props:t,name:"MuiStepConnector"}),{className:c}=n,p=_(n,Te),{alternativeLabel:h,orientation:f="horizontal"}=r.useContext(O),{active:m,disabled:C,completed:v}=r.useContext(V),d=b({},n,{alternativeLabel:h,orientation:f,active:m,completed:v,disabled:C}),S=$e(d);return a.jsx(Ge,b({className:D(S.root,c),ref:o,ownerState:d},p,{children:a.jsx(We,{className:S.line,ownerState:d})}))});function De(e){return q("MuiStepper",e)}w("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const ke=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],qe=e=>{const{orientation:t,alternativeLabel:o,classes:n}=e;return H({root:["root",t,o&&"alternativeLabel"]},De,n)},we=M("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel]}})(({ownerState:e})=>b({display:"flex"},e.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},e.orientation==="vertical"&&{flexDirection:"column"},e.alternativeLabel&&{alignItems:"flex-start"})),Ee=a.jsx(Be,{}),Ke=r.forwardRef(function(t,o){const n=E({props:t,name:"MuiStepper"}),{activeStep:c=0,alternativeLabel:p=!1,children:h,className:f,component:m="div",connector:C=Ee,nonLinear:v=!1,orientation:d="horizontal"}=n,S=_(n,ke),P=b({},n,{alternativeLabel:p,orientation:d,component:m}),z=qe(P),L=r.Children.toArray(h).filter(Boolean),U=L.map((T,I)=>r.cloneElement(T,b({index:I,last:I+1===L.length},T.props))),R=r.useMemo(()=>({activeStep:c,alternativeLabel:p,connector:C,nonLinear:v,orientation:d}),[c,p,C,v,d]);return a.jsx(O.Provider,{value:R,children:a.jsx(we,b({as:m,ownerState:P,className:D(z.root,f),ref:o},S,{children:U}))})}),_e=()=>{const[e,t]=r.useState({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0}),{data:o}=ee();console.log(o);const[n,c]=r.useState(""),{data:p}=te(),{data:h,refetch:f}=ae(n,{skip:!n}),{data:m,refetch:C}=oe(e.designId,{skip:!e.designId}),{data:v}=le(e.batchNo,{skip:!e.batchNo}),{data:d,refetch:S}=se(e.batchNo,{skip:!e.batchNo});console.log("fabricRequisitionData",d);const[P,z]=r.useState([]),[L,U]=r.useState([]),[R,T]=r.useState([]),[I,$]=r.useState([]),[F,G]=r.useState([]);r.useEffect(()=>{h&&z(h.result)},[h]),r.useEffect(()=>{m&&U(m.result)},[m]),r.useEffect(()=>{v&&T(v.result)},[v]),r.useEffect(()=>{d&&G(d.result.map((l,i)=>({id:i,...l})))},[d]),r.useEffect(()=>{if(p){const l=p.result[0];$(l.uomList)}},[p]),console.log("designList",P),console.log("selectedCollectionId",n),console.log("batchList",L),console.log("uom",I),console.log("Fabrications",R),console.log("initialRows",F);const N=(o==null?void 0:o.result)||[];console.log("collectionList",N),r.useEffect(()=>{const l=()=>{const s=parseFloat(e.quantity)||0,y=parseFloat(e.rate)||0;return s*y};t(s=>({...s,total:l()}));const i=()=>{const s=parseFloat(e.total)||0,y=parseFloat(e.gst)||0;return s*(1+y/100)};t(s=>({...s,totalInclGst:i()}));const u=()=>{const s=parseFloat(e.total)||0,y=parseFloat(e.poPcs)||0;return s/y};t(s=>({...s,unitPrice:u()}))},[e.quantity,e.rate,e.total,e.gst]);const x=l=>{const{name:i,value:u}=l.target;if(i==="collectionId"){const s=N.find(y=>y.collectionId===parseInt(u));c(u),t({...e,collectionId:u,poPcs:s?s.poPcs:""})}else if(i==="designId"){const s=P.find(y=>y.designId===parseInt(u));t({...e,designId:u,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:""})}else if(i==="batchNo"){const s=L.find(y=>y.batchNo===u);t({...e,batchNo:u,planningHeaderId:s?s.planningHeaderId:""})}else if(i==="fabricId"){const s=R.find(y=>y.fabricId===u);t({...e,fabricId:u,quantity:s?s.total:""})}else t({...e,[i]:u})},W=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:P.map(l=>({value:l.designId,label:l.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"uomId",headerName:"UOM",editable:!0,flex:1,type:"singleSelect",valueOptions:I.map(l=>({value:l.lookUpId,label:l.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!1,valueGetter:(l,i)=>{const u=parseFloat(i.quantity)||0,s=parseFloat(i.rate)||0;return u*s},valueSetter:(l,i)=>{const u=parseFloat(i.quantity)||0,s=parseFloat(i.rate)||0;return u*s}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!1,valueGetter:(l,i)=>{const u=parseFloat(i.total)||0,s=parseFloat(i.poPcs)||0;return u/s},valueSetter:(l,i)=>{const u=parseFloat(i.total)||0,s=parseFloat(i.poPcs)||0;return u/s}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!1,valueGetter:(l,i)=>{const u=parseFloat(i.total)||0,s=parseFloat(i.gst)||0;return u*(1+s/100)},valueSetter:(l,i)=>{const u=parseFloat(i.total)||0,s=parseFloat(i.gst)||0;return u*(1+s/100)}}],X=async()=>{try{const l=await de.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",e);console.log("Save response:",l.data),S(),t({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(l){console.error("Error saving data:",l)}};return console.log("formData",e),a.jsxs(ne,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[a.jsx(re,{children:a.jsxs(g,{container:!0,spacing:2,width:"Inherit",children:[a.jsx(g,{item:!0,xs:9,md:9,children:a.jsx(ie,{variant:"h3",gutterBottom:!0,children:"Fabric Requisition"})}),a.jsx(g,{item:!0,xs:3,textAlign:"right",children:a.jsx(ue,{variant:"contained",size:"small",onClick:X,children:"Save"})}),a.jsxs(g,{item:!0,xs:12,md:3,children:[a.jsx(j,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:n,onChange:x,size:"small",children:N.map(l=>a.jsx(k,{value:l.collectionId,children:l.collectionName},l.collectionId))})," "]}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:e.designId,onChange:x,size:"small",children:P.map(l=>a.jsx(k,{value:l.designId,children:l.designNo},l.designId))})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:e.baseColorName,onChange:x,disabled:!0})}),a.jsxs(g,{item:!0,xs:12,md:3,children:[a.jsx(j,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:e.batchNo,onChange:x,size:"small",children:L.map(l=>a.jsx(k,{value:l.batchNo,children:l.batchNo},l.batchNo))})," "]}),a.jsx(g,{item:!0,xs:12,md:12,children:a.jsx(ce,{color:"#cc8587",sx:{height:2,width:"100%"}})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:e.fabricId,onChange:x,children:R.map(l=>a.jsx(k,{value:l.fabricId,children:l.fabric},l.fabricId))})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:e.uomId,onChange:x,children:I.map(l=>a.jsx(k,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:e.poPcs,onChange:x})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{label:"Quantity",fullWidth:!0,size:"small",name:"quantity",value:e.quantity,onChange:x})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{label:"Rate",fullWidth:!0,size:"small",name:"rate",value:e.rate,onChange:x})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{label:"Total",fullWidth:!0,size:"small",name:"total",value:e.total,onChange:x})}),a.jsx(g,{item:!0,xs:12,md:3,children:a.jsx(j,{label:"Unit Price",fullWidth:!0,size:"small",name:"unitPrice",value:e.unitPrice,onChange:x})}),a.jsx(g,{item:!0,xs:12,md:1.5,children:a.jsx(j,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:e.gst,onChange:x})}),a.jsx(g,{item:!0,xs:12,md:1.5,children:a.jsx(j,{label:"Total Inc GSt.",fullWidth:!0,size:"small",name:"totalInclGst",value:e.totalInclGst,onChange:x})})]})}),a.jsx(g,{container:!0,spacing:2,width:"Inherit",children:a.jsx(g,{sx:{marginTop:2},item:!0,xs:12,children:a.jsx(pe,{ncolumns:W,initialRows:F,formData:e,editAPi:"https://gecxc.com:4041/api/Fabrication/SaveFabrication",refetch:S})})})]})},Xe=_e;export{Xe as F,Ke as S,Je as a,ze as b};
