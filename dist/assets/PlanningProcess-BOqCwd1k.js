import{j as e,_ as Bo,z as Fo,A as Ro,u as Qe,c as We,b as _e,be as zo,B as Re,G as a,T as ye,D as me,aB as ct,bf as Qo,aS as $e,aT as Xe,aU as at,bg as ut,bh as pt,bi as Wo,bj as mt,C as Se,d as Ce,aX as rt,e as Ye,bk as _o,aV as Uo,bl as Ho,bm as qo,bn as Eo,bo as Go,bp as Yo,bq as Vo,bc as $o,M as Ko,br as Xo,bs as Do}from"./index-D1tX9wrp.js";import{r as o,g as Jo}from"./vendor-BXCbSo2_.js";import{B as ge,a as Me,I as ze}from"./axios-Cxh9UTPd.js";import{d as Bt,c as et,A as Ft,e as Rt,f as zt,S as Zo,a as ea,b as ta,F as oa}from"./Fabrication-Dlqf0P0e.js";import{d as Ve}from"./VisibilityOutlined-BP3iibPv.js";import{A as Ze,R as qe,F as Qt,C as Wt,a as nt,b as ht,c as st,d as gt,B as bt,u as aa,D as Ge,g as Mt,h as ra}from"./ReuseableDataGrid-Dv91oMQ6.js";import{d as ft}from"./Close-tPnCrOwd.js";import{d as It}from"./PersonAddAlt1Outlined-BvSk8nGA.js";import{T as c,P as St}from"./TextField-DuUhpNBk.js";import{M as Q}from"./MenuItem-DQgeQNjY.js";import"./dayjs.min-DO4_1a-m.js";import"./Skeleton-CzlzLFeS.js";let Pt=!1;const na=o.forwardRef(function(i,C){return Pt||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),Pt=!0),e.jsx(Ze,Bo({ref:C},i))});var xt={},sa=Ro;Object.defineProperty(xt,"__esModule",{value:!0});var _t=xt.default=void 0,la=sa(Fo()),ia=e;_t=xt.default=(0,la.default)((0,ia.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const da="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",ca=({initialFormData:r,setAdditionalProcessData:i,refetchDyeingPrintingData:C,handleClickOpen:j,showUpperDiv:g})=>{const{user:t}=Qe(),[f,n]=o.useState([]),[I,l]=o.useState([]),{enqueueSnackbar:S}=We(),[W,b]=o.useState({}),P=f.reduce((v,H)=>v+(H.assignedQty??0),0).toFixed(2);console.log("Quantity",P);const[p,T]=o.useState({dpIdDet:0,dpId:r.dpId||0,designId:r.designId||"",batchNo:r.batchNo||"",planningHeaderId:r.planningHeaderId||0,fabricId:r.fabricId||"",fabricName:r.fabricName||"",colorId:r.colorId||"",colorName:r.colorName||"",uomId:r.uomId||"",uom:r.uom||"",poPcs:r.poPcs||"",vendorId:"",processType:r.processType||"",availableQty:r.availableQty||"",remainingQty:r.availableQty-P||"",shrinkage:r.allowedWastage||"",wastage:r.allowedWastage||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});o.useEffect(()=>{T(v=>({...p,dpIdDet:I.dpIdDet||0,dpId:I.dpId||0,designId:(I==null?void 0:I.designId)||"",planningHeaderId:(I==null?void 0:I.planningHeaderId)||0,batchNo:(I==null?void 0:I.batchNo)||"",vendorId:(I==null?void 0:I.vendorId)||"",shrinkage:(I==null?void 0:I.shrinkage)||"",wastage:(I==null?void 0:I.wastage)||"",outputQty:(I==null?void 0:I.outputQty)||0,remainingQty:v.remainingQty+(I==null?void 0:I.assignedQty)||"",assignedQty:(I==null?void 0:I.assignedQty)||"",rate:(I==null?void 0:I.rate)||0,unitRatePerPo:(I==null?void 0:I.unitRatePerPo)||"",totalExcGst:(I==null?void 0:I.totalExcGst)||"",gst:(I==null?void 0:I.gst)||0,TotalIncludingGst:(I==null?void 0:I.totalIncludingGst)||"",createdOn:(I==null?void 0:I.createdOn)||new Date().toISOString(),createdBy:(I==null?void 0:I.createdBy)||t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId}))},[I]),o.useEffect(()=>{T({...p,remainingQty:r.availableQty-P>=0?r.availableQty-P:""})},[f,r.availableQty,P]);const{data:m}=_e(),{data:O,refetch:ee}=zo(p.dpId,{skip:!p.dpId}),[X,G]=o.useState([]);o.useEffect(()=>{if(m){const v=m.result[0];G(v.vendorList)}},[m]),o.useEffect(()=>{O&&n(O.result.map((v,H)=>({id:H+1,...v})))},[O,ee]),console.log("initialRows",f);const z=v=>{const{name:H,value:oe}=v.target;T({...p,[H]:oe}),T(pe=>{const h={...pe,[H]:oe};if(H==="assignedQty"||H==="remainingQty"){const U=h.assignedQty,E=h.remainingQty;U>E?b(D=>({...D,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):b(D=>({...D,assignedQty:""}))}return h})};o.useEffect(()=>{const v=()=>{const se=parseFloat(p.assignedQty)||0,w=parseFloat(p.shrinkage)||0,te=parseFloat(p.wastage)||0,k=w+te;return(se*100/(100+k)).toFixed(2)},H=()=>{const se=parseFloat(p.assignedQty)||0,w=parseFloat(p.rate)||0;return(se*w).toFixed(2)},oe=(se,w)=>(se*(1+w/100)).toFixed(2),pe=v(),h=H(),U=parseFloat(p.gst)||0,E=oe(h,U),D=parseFloat(p.poPcs)||0,be=D?E/D:0;T(se=>({...se,outputQty:pe,totalExcGst:h,TotalIncludingGst:E,unitRatePerPo:be.toFixed(2)}))},[p.availableQty,p.assignedQty,p.shrinkage,p.wastage,p.rate,p.gst,p.poPcs,p.unitRatePerPo]),console.log("formData",p);const Y=async()=>{console.log(p);try{if(p.assignedQty>p.remainingQty){S("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}const v=await Me.post("http://100.42.177.77:83/api/DyeingPrinting/SaveDyeingPrintingDetails",p);console.log("Save response:",v.data),T(H=>({...H,dpIdDet:0,vendorId:"",availableQty:r.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",remainingQty:r.availableQty-P||"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),ee(),C()}catch(v){console.error("Error saving data:",v)}},ae=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:v=>v.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:v=>v.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:v=>v.toLocaleString()},{field:"outputQty",headerName:"Output Qty",flex:1}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!g,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Fabric",name:"fabricName",value:p.fabricName,onChange:z,size:"small",disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Process Type",name:"processType",value:p.processType,onChange:z,size:"small",disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Color",name:"colorName",value:p.colorName,onChange:z,size:"small",disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"UOM",name:"uom",value:p.uom,onChange:z,size:"small",disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:p.poPcs,onChange:z,disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:p.availableQty,onChange:z,disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:p.remainingQty,onChange:z,disabled:!0,sx:v=>({...p.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:p.vendorId,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}},children:X.map(v=>e.jsx(Q,{value:v.lookUpId,children:v.lookUpName},v.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:p.assignedQty,onChange:z,disabled:!p.remainingQty,error:!!W.assignedQty,helperText:W.assignedQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:p.rate,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:p.shrinkage,onChange:z,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:p.wastage,onChange:z,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:p.outputQty,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:p.totalExcGst,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:p.gst,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:p.TotalIncludingGst,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:p.unitRatePerPo,onChange:z,disabled:!p.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:Y,children:"Save"})})]})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:ae,initialRows:f,setInitialData:l,deleteApi:"http://100.42.177.77:83/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:ee})})]})]})},ua=({initialFormData:r,setAdditionalProcessData:i,refetchDyeingPrintingData:C,handleClickOpen:j,showUpperDiv:g})=>{const t=ct(),{enqueueSnackbar:f}=We(),[n,I]=o.useState({}),{user:l}=Qe(),[S,W]=o.useState([]),[b,P]=o.useState([]),p=S.reduce((k,q)=>k+(q.assignedQty??0),0).toFixed(2);console.log("Quantity",p);const T=S.reduce((k,q)=>k+(q.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",T);const[m,O]=o.useState({embroideryIdDet:0,embroideryId:r.embroideryId||0,designId:r.designId||"",batchNo:r.batchNo||"",planningHeaderId:r.planningHeaderId||0,componentId:r.componentId||"",componentName:r.componentName||"",fabricId:r.fabricId||"",fabricName:r.fabricName||"",vendorId:"",colorId:r.colorId||"",colourName:r.colourName||"",availableQty:r.availableQty||"",assignedQty:0,remainingQty:(r.availableQty-p).toFixed(2)||0,remainingRepeats:r.repeats-T||"",noOfHead:r.noOfHead||"",noOfHeadsName:r.noOfHeadsName||"",repeats:r.repeats||"",assignedRepeats:"",cuttingSize:r.cuttingSize||"",itemsPerRepeat:r.itemsPerRepeat||"",poPcs:r.poPcs||"",totalPcs:r.totalPcs||"",remainingPcs:(r.totalPcs-T).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:l.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:l.empId});o.useEffect(()=>{O(k=>({...m,embroideryIdDet:b.embroideryIdDet||0,embroideryId:b.embroideryId||0,vendorId:(b==null?void 0:b.vendorId)||"",assignedQty:(b==null?void 0:b.assignedQty)||0,requiredPcs:(b==null?void 0:b.requiredPcs)||0,remainingQty:k.remainingQty+(b==null?void 0:b.assignedQty)||0,remainingPcs:k.remainingPcs+(b==null?void 0:b.requiredPcs)||0,totalAmount:(b==null?void 0:b.totalAmount)||0,threadStiches:(b==null?void 0:b.threadStiches)||0,threadRate:(b==null?void 0:b.threadRate)||0,threadAmount:(b==null?void 0:b.threadAmount)||0,tillaStiches:(b==null?void 0:b.tillaStiches)||0,tilaRate:(b==null?void 0:b.tilaRate)||0,tilaAmount:(b==null?void 0:b.tilaAmount)||0,sequence:(b==null?void 0:b.sequence)||0,sequenceRate:(b==null?void 0:b.sequenceRate)||0,sequenceAmount:(b==null?void 0:b.sequenceAmount)||0,isSolving:(b==null?void 0:b.isSolving)||!1,solvingLayers:(b==null?void 0:b.solvingLayers)||0,solvingInMeters:(b==null?void 0:b.solvingInMeters)||0,solvingRate:(b==null?void 0:b.solvingRate)||0,solvingAmount:(b==null?void 0:b.solvingAmount)||0,additional:(b==null?void 0:b.additional)||0,costPerComponent:(b==null?void 0:b.costPerComponent)||0,createdOn:(b==null?void 0:b.createdOn)||new Date().toISOString(),createdBy:(b==null?void 0:b.createdBy)||l.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:l.empId}))},[b]);const ee=["Boring","Pooni","Laser","Doori","Dissolving"];function X(k,q,F){return{fontWeight:q.indexOf(k)===-1?F.typography.fontWeightRegular:F.typography.fontWeightMedium}}o.useEffect(()=>{O({...m,remainingQty:(r.availableQty-p).toFixed(2)||0,remainingPcs:r.totalPcs-T||0})},[S]);const{data:G}=_e(),{data:z,refetch:Y}=Qo(m.embroideryId,{skip:!m.embroideryId}),[ae,B]=o.useState([]);o.useEffect(()=>{if(G){const k=G.result[0];B(k.vendorList)}},[G]),o.useEffect(()=>{z&&W(z.result.map((k,q)=>({id:q+1,...k})))},[z,Y]),console.log("initialRows",S);const v=k=>{const{name:q,value:F}=k.target;O({...m,[q]:F})},H=k=>{const{name:q,checked:F}=k.target;O(J=>({...J,[q]:F}))};console.log("formData",m);const[oe,pe]=o.useState(null),[h,U]=o.useState(m);o.useEffect(()=>{const k=setTimeout(()=>{U(m)},10);return()=>{clearTimeout(k)}},[m]);const E=k=>new Intl.NumberFormat("en-US").format(k);o.useEffect(()=>{const k=()=>{const R=parseFloat(h.repeats)||0,L=parseFloat(h.itemsPerRepeat)||0;return(R*L).toFixed(2)},q=()=>{const R=parseFloat(h.threadStiches)||0,L=parseFloat(h.threadRate)||0,ce=parseFloat(h.noOfHeadsName)||0,he=parseFloat(h.repeats)||0;return(R/1e3*(L*he*ce)).toFixed(2)},F=()=>{const R=parseFloat(h.tillaStiches)||0,L=parseFloat(h.tilaRate)||0,ce=parseFloat(h.noOfHeadsName)||0,he=parseFloat(h.repeats)||0;return(R/1e3*(L*he*ce)).toFixed(2)},J=()=>{const R=parseFloat(h.sequence)||0,L=parseFloat(h.sequenceRate)||0,ce=parseFloat(h.noOfHeadsName)||0,he=parseFloat(h.repeats)||0;return(R/1e3*(L*he*ce)).toFixed(2)},de=()=>{const R=parseFloat(h.repeats)||0,L=parseFloat(h.noOfHeadsName)||0,ce=parseFloat(h.solvingLayers)||0;return(R*L*13/39.37*ce).toFixed(2)},ne=()=>{const R=parseFloat(h.solvingInMeters)||0,L=parseFloat(h.solvingRate)||0;return(R*L).toFixed(2)},fe=()=>{const R=parseFloat(h.threadAmount)||0,L=parseFloat(h.tilaAmount)||0,ce=parseFloat(h.sequenceAmount)||0,he=parseFloat(h.solvingAmount)||0;return(R+L+ce+he).toFixed(2)},Z=()=>{const R=parseFloat(String(h.totalAmount).replace(/,/g,""))||0,L=parseFloat(h.requiredPcs)||0;return(R/L).toFixed(2)},V=fe(),le=Z();q(),O(R=>({...R,totalPcs:k(),threadAmount:q(),tilaAmount:F(),sequenceAmount:J(),solvingInMeters:de(),solvingAmount:ne(),totalAmount:E(V),costPerComponent:E(le)}))},[h.threadAmount,h.totalAmount,h.sequenceAmount,h.solvingAmount,h.repeats,h.tilaAmount,h.itemsPerRepeat,h.threadRate,h.threadStiches,h.noOfHeadsName,h.tilaRate,h.tillaStiches,h.sequenceRate,h.sequence,h.solvingLayers,h.solvingInMeters,h.solvingRate,h.requiredPcs]),o.useEffect(()=>{if(oe==="assignedQty"){const k=()=>{const q=parseFloat(h.assignedQty)||0,F=parseFloat(h.availableQty)||0,J=parseFloat(h.totalPcs)||0;return Math.round(q*(J/F))};O(q=>({...q,requiredPcs:k()}))}else if(oe==="requiredPcs"){const k=()=>{const q=parseFloat(h.requiredPcs)||0,F=parseFloat(h.availableQty)||0,J=parseFloat(h.totalPcs)||0;return(q*F/J).toFixed(2)};O(q=>({...q,assignedQty:k()}))}},[h.assignedQty,h.requiredPcs,oe]);const D=k=>{const q=k.target.value,F=k.target.name;pe("assignedQty"),O(J=>({...J,assignedQty:q})),O(J=>{const de={...J,[F]:q};if(F==="assignedQty"||F==="remainingQty"){const ne=parseFloat(de.assignedQty),fe=parseFloat(de.remainingQty);ne>fe?I(Z=>({...Z,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):I(Z=>({...Z,assignedQty:""}))}return de})},be=k=>{const q=k.target.value,F=k.target.name;pe("requiredPcs"),O(J=>({...J,requiredPcs:q})),O(J=>{const de={...J,[F]:q};if(F==="requiredPcs"||F==="remainingPcs"){const ne=parseFloat(de.requiredPcs),fe=parseFloat(de.remainingPcs);ne>fe?(console.log(),I(Z=>({...Z,requiredPcs:"Required Pcs cannot be greater than Remaining Pcs"}))):I(Z=>({...Z,requiredPcs:""}))}return de})},se=async()=>{if(console.log(m),m.totalAmount==0||m.costPerComponent==0){f("Please Enter Thread, Tilla or Sequnce values , Total Amount cannot be zero",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(m.assignedQty)>parseFloat(m.remainingQty)){f("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(m.requiredPcs)>parseFloat(m.remainingPcs)){f("Required Pcs can not be greater then Remaining Pcs !",{variant:"error",autoHideDuration:5e3});return}try{const k=await Me.post("http://100.42.177.77:83/api/Embroidery/SaveEmbroideryDetails",{...m,additional:m.additional.join(", ")});k.data.success?f("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(f(`${k.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",k.data.message)),console.log("Save response:",k.data),O(q=>({...q,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,remainingQty:(r.availableQty-p).toFixed(2)||0,remainingRepeats:r.repeats-T||"",costPerComponent:0,createdOn:new Date().toISOString(),createdBy:l.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:l.empId})),Y(),C()}catch(k){console.error("Error saving data:",k),f("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},w=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"Additional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!g,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Fabric",name:"fabricName",value:m.fabricName,onChange:v,size:"small",disabled:!0,sx:k=>({...m.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Component",name:"componentName",value:m.componentName,onChange:v,size:"small",disabled:!0,sx:k=>({...m.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Color",name:"colourName",value:m.colourName,onChange:v,size:"small",disabled:!0,sx:k=>({...m.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:m.poPcs,onChange:v,size:"small",disabled:!0,sx:k=>({...m.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Heads",size:"small",name:"noOfHeadsName",value:m.noOfHeadsName,onChange:v,disabled:!0,sx:k=>({...m.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:m.cuttingSize,onChange:v,disabled:!0,sx:k=>({...m.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:m.itemsPerRepeat,onChange:v,disabled:!0,sx:k=>({...m.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Available Qty",fullWidth:!0,size:"small",name:"availableQty",value:m.availableQty,onChange:v,disabled:!0,sx:k=>({...m.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:m.remainingQty,type:"number",error:!!n.remainingQty,helperText:n.remainingQty,onChange:v,disabled:!0,sx:k=>({...m.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:m.repeats,onChange:v,disabled:!0,sx:k=>({...m.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:m.totalPcs,onChange:v,disabled:!0,sx:k=>({...m.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Pcs",fullWidth:!0,size:"small",name:"remainingPcs",value:m.remainingPcs,onChange:v,disabled:!0,sx:k=>({...m.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:m.vendorId,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}},children:ae.map(k=>e.jsx(Q,{value:k.lookUpId,children:k.lookUpName},k.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:m.assignedQty,onChange:D,error:!!n.assignedQty,helperText:n.assignedQty,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Required Pcs",fullWidth:!0,disabled:!m.remainingPcs&&!m.remainingQty,size:"small",type:"number",name:"requiredPcs",value:m.requiredPcs,error:!!n.requiredPcs,helperText:n.requiredPcs,onChange:be,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{select:!0,label:"Additional",value:m.additional,name:"additional",size:"small",onChange:v,fullWidth:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:ee.map(k=>e.jsx(Q,{value:k,style:X(k,m.additional,t),children:k},k))})}),e.jsx(a,{item:!0,xs:12,md:1,children:e.jsx(Qt,{control:e.jsx(Wt,{checked:m.isSolving,onChange:H,disabled:!m.remainingPcs&&!m.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:m.threadStiches,onChange:v,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:m.threadRate,onChange:v,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:m.threadAmount,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:m.tillaStiches,onChange:v,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:m.tilaRate,onChange:v,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:m.tilaAmount,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(a,{item:!0,xs:12,md:6,children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:m.sequence,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:m.sequenceRate,onChange:v,required:!0,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:m.sequenceAmount,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),m.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:m.solvingLayers,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:m.solvingInMeters,disabled:!m.remainingPcs&&!m.remainingQty,onChange:v,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:m.solvingRate,onChange:v,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:m.solvingAmount,disabled:!m.remainingPcs&&!m.remainingQty,onChange:v,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(c,{label:"Total Amount",fullWidth:!0,size:"small",disabled:!m.remainingPcs&&!m.remainingQty,name:"totalAmount",value:m.totalAmount,onChange:v,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(c,{label:"Cost Per Component",fullWidth:!0,type:"number",size:"small",name:"costPerComponent",value:m.costPerComponent,onChange:v,disabled:!m.remainingPcs&&!m.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:se,children:"Save"})})]})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(ye,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:w,initialRows:S,setInitialData:P,deleteApi:"http://100.42.177.77:83/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:Y})})]})})]})},pa=({initialValues:r})=>{ct();const{user:i}=Qe(),[C,j]=o.useState(!0),{enqueueSnackbar:g}=We(),[t,f]=o.useState([]),[n,I]=o.useState(!1),[l,S]=o.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:i.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId});o.useEffect(()=>{S({...l,embroideryId:(t==null?void 0:t.embroideryId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})},[t]);const{data:W}=$e(),[b,P]=o.useState("");o.useEffect(()=>{P(r.collectionId)},[]);const{data:p}=_e(),{data:T,refetch:m}=Xe(b,{skip:!b}),{data:O,refetch:ee}=at(l.designId,{skip:!l.designId}),{data:X,refetch:G}=ut({batchNo:l.planningHeaderId,componentId:l.componentId},{skip:!l.planningHeaderId||!l.componentId}),{data:z}=pt({batchNo:l.planningHeaderId,componentId:l.componentId,fabricId:l.fabricId},{skip:!l.planningHeaderId||!l.componentId||!l.fabricId}),{data:Y,refetch:ae}=Wo(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:B}=mt(l.planningHeaderId,{skip:!l.planningHeaderId});console.log("formData.planningHeaderId",l.planningHeaderId),console.log("collectionData",W);const[v,H]=o.useState(!1),[oe,pe]=o.useState([]),[h,U]=o.useState([]),[E,D]=o.useState([]),[be,se]=o.useState([]),[w,te]=o.useState([]),[k,q]=o.useState([]),[F,J]=o.useState([]),[de,ne]=o.useState([]);console.log("batchList",h),console.log("formData",l),o.useEffect(()=>{T&&pe(T.result)},[T]),o.useEffect(()=>{O&&U(O.result)},[O]),o.useEffect(()=>{X&&(G(),D(X.result))},[X,G]),o.useEffect(()=>{z&&q(X.result)},[z]),o.useEffect(()=>{B&&ne(B.result)},[B]),o.useEffect(()=>{Y&&(j(!1),J(Y.result.map((y,$)=>({id:$+1,...y}))))},[Y,ae]),console.log("embroideryList",Y),console.log("initialRows",F),o.useEffect(()=>{if(p){const y=p.result[0];se(y.vendorList),te(y.noOfHeadsList)}},[p]);const fe=(W==null?void 0:W.result)||[];o.useEffect(()=>{const y=()=>{const ie=parseFloat(l.repeats)||0,Le=parseFloat(l.itemsPerRepeat)||0;return(ie*Le).toFixed(2)};S(ie=>({...ie,totalPcs:y()}));const $=()=>{const ie=parseFloat(l.threadStiches)||0,Le=parseFloat(l.threadRate)||0,Ue=parseFloat(l.noOfHead)||0,Ee=parseFloat(l.repeats)||0;return(ie/1e3*(Le*Ee*Ue)).toFixed(2)};S(ie=>({...ie,threadAmount:$()}));const xe=()=>{const ie=parseFloat(l.tillaStiches)||0,Le=parseFloat(l.tilaRate)||0,Ue=parseFloat(l.noOfHead)||0,Ee=parseFloat(l.repeats)||0;return(ie/1e3*(Le*Ee*Ue)).toFixed(2)};S(ie=>({...ie,tilaAmount:xe()}));const re=()=>{const ie=parseFloat(l.sequence)||0,Le=parseFloat(l.sequenceRate)||0,Ue=parseFloat(l.noOfHead)||0,Ee=parseFloat(l.repeats)||0;return(ie/1e3*(Le*Ee*Ue)).toFixed(2)};S(ie=>({...ie,sequenceAmount:re()}));const ve=()=>{const ie=parseFloat(l.repeats)||0,Le=parseFloat(l.noOfHead)||0,Ue=parseFloat(l.solvingLayers)||0;return(ie*Le*13/39.37*Ue).toFixed(2)};S(ie=>({...ie,solvingInMeters:ve()}));const Fe=()=>{const ie=parseFloat(l.solvingInMeters)||0,Le=parseFloat(l.solvingRate)||0;return parseFloat(l.solvingLayers),(ie*Le).toFixed(2)};S(ie=>({...ie,solvingAmount:Fe()}));const To=()=>{const ie=parseFloat(l.threadAmount)||0,Le=parseFloat(l.tilaAmount)||0,Ue=parseFloat(l.sequenceAmount)||0,Ee=parseFloat(l.solvingAmount)||0;return(ie+Le+Ue+Ee).toFixed(2)};S(ie=>({...ie,totalAmount:To()||0}))},[l.threadAmount,l.totalAmount,l.sequenceAmount,l.solvingAmount,l.repeats,l.tilaAmount,l.itemsPerRepeat,l.threadRate,l.threadStiches,l.noOfHead,l.tilaRate,l.tillaStiches,l.sequenceRate,l.sequence,l.solvingLayers,l.solvingInMeters,l.solvingRate]),o.useEffect(()=>{l.productionStatus===3&&g("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[l.productionStatus]);const Z=y=>{const{name:$,value:xe}=y.target;if($==="collectionId"){const re=fe.find(ve=>ve.collectionId===parseInt(xe));P(xe),I(!0),J([]),j(!0),S({...l,collectionId:xe,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",productionStatus:re?re.productionStatus:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if($==="designId"){const re=oe.find(ve=>ve.designId===parseInt(xe));J([]),j(!0),S({...l,designId:xe,baseColorId:re?re.colorId:"",baseColorName:re?re.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if($==="colorId"){const re=k.find(ve=>ve.colorId===xe);S({...l,colorId:xe,availableQty:re?re.total:"",cuttingSize:re?re.cuttingSize:"",repeats:re?re.repeats:"",noOfHead:re?re.noOfHeads:""})}else if($==="batchNo"){const re=h.find(ve=>ve.batchNo===xe);S({...l,batchNo:xe,planningHeaderId:re?re.planningHeaderId:"",poPcs:re?re.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),H(!0),I(!1)}else S({...l,[$]:xe}),le(re=>({...re,[$]:""}))},[V,le]=o.useState({}),R=async()=>{try{const y=await Me.post("http://100.42.177.77:83/api/Embroidery/SaveEmbroidery",{...l,threadAdditional:l.threadAdditional.join(", ")});console.log("Save response:",y.data),y.data.success?g("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(g(`${y.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",y.data.message)),S($=>({embroideryId:0,designId:$.designId,batchNo:$.batchNo,planningHeaderId:$.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:$.poPcs,baseColorId:$.baseColorId,baseColorName:$.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})),ae()}catch(y){console.error("Error saving data:",y),g("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",F);const[L,ce]=o.useState({}),[he,Pe]=o.useState(!1),ke=y=>{ce(y),Pe(!0)},[Oe,je]=o.useState(!0),Ae=y=>{ce(y),Pe(!0),je(!1)},Ne=()=>{je(!0),Pe(!1),ce({}),refetchDyeingPrintingData()};console.log("show div",Oe);const[we,M]=o.useState(0),[K,Ie]=o.useState(0),[u,d]=o.useState(0),[A,s]=o.useState(0);o.useEffect(()=>{const y=F.reduce((ve,Fe)=>ve+(Fe.availableQty??0),0).toFixed(2),$=F.reduce((ve,Fe)=>ve+(Fe.assignedQty??0),0).toFixed(2),xe=F.reduce((ve,Fe)=>ve+(Fe.totalPcs??0),0).toFixed(2),re=F.reduce((ve,Fe)=>ve+(Fe.requiredPcs??0),0).toFixed(2);M(parseFloat(y).toLocaleString()),Ie(parseFloat($).toLocaleString()),d(parseFloat(xe).toLocaleString()),s(parseFloat(re).toLocaleString())},[F]);const x=[...F,{id:"TOTAL_SUMMARY",availableQty:we,assignedQty:K,totalPcs:u,requiredPcs:A}],_={sortable:!1,pinnable:!1,hideable:!1},N=[{field:"id",headerName:"Sr#",..._,colSpan:(y,$)=>$.id==="TOTAL_SUMMARY"?4:void 0,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):y.value},{field:"designNo",headerName:"Design",..._,colSpan:(y,$)=>$.id==="TOTAL_SUMMARY"?3:void 0,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):y.value},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component ",renderCell:y=>e.jsx(Ye,{label:y.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric "},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty",..._,valueGetter:y=>y.toLocaleString(),renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"assignedQty",headerName:"Assigned Qty",..._,valueGetter:y=>y,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"totalPcs",headerName:"Total Pcs",renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"requiredPcs",headerName:"Assigned Pcs",colSpan:(y,$)=>$.id==="TOTAL_SUMMARY"?4:void 0,renderCell:y=>y.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:y.value}):y.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:y=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(bt,{variant:"text",size:"small",children:[e.jsx(ze,{color:"primary",onClick:()=>ke(y.row),children:e.jsx(It,{})}),e.jsx(ze,{color:"primary",onClick:()=>Ae(y.row),children:e.jsx(Ve,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:da,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:b,onChange:Z,size:"small",InputLabelProps:{sx:{color:"black"}},children:fe.map(y=>e.jsx(Q,{value:y.collectionId,children:y.collectionName},y.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:Z,size:"small",InputLabelProps:{sx:{color:"black"}},children:oe.map(y=>e.jsx(Q,{value:y.designId,children:y.designNo},y.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:Z,size:"small",InputLabelProps:{sx:{color:"black"}},children:h.map(y=>e.jsx(Q,{value:y.batchNo,children:y.batchNo},y.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,onChange:Z,disabled:!0,sx:y=>({...l.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:l.componentId,onChange:Z,size:"small",required:!0,error:!!V.componentId,helperText:V.componentId,InputLabelProps:{sx:{color:"black"}},children:de.map(y=>e.jsx(Q,{value:y.componentId,children:y.componentName},y.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:l.fabricId,onChange:Z,required:!0,error:!!V.fabricId,helperText:V.fabricId,InputLabelProps:{sx:{color:"black"}},children:E.map(y=>e.jsx(Q,{value:y.fabricId,children:y.fabric},y.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:l.colorId,onChange:Z,required:!0,error:!!V.colorId,helperText:V.colorId,InputLabelProps:{sx:{color:"black"}},children:k.map(y=>e.jsx(Q,{value:y.colorId,children:y.color},y.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:Z,disabled:!0,sx:y=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:l.availableQty,onChange:Z,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:l.repeats,onChange:Z,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:l.noOfHead,onChange:Z,required:!0,error:!!V.noOfHead,helperText:V.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:w.map(y=>e.jsx(Q,{value:y.lookUpId,children:y.lookUpName},y.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:l.cuttingSize,onChange:Z,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:l.itemsPerRepeat,onChange:Z,required:!0,error:!!V.itemsPerRepeat,helperText:V.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:y=>({...l.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:l.totalPcs,onChange:Z})}),e.jsx(a,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",disabled:l.productionStatus===3,onClick:R,children:"Save"})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(qe,{iColumns:N,initialRows:x,setInitialData:f,deleteApi:"http://100.42.177.77:83/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:ae,setAccordionExpanded:H,fileName:"Embroidery List",isLoading:C}),e.jsxs(nt,{open:he,onClose:Ne,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(ye,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Embroidery > Assign Vendors "}),e.jsx(ze,{onClick:Ne,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(ua,{initialFormData:L,setInitialFormData:ce,refetchDyeingPrintingData:ae,handleClickOpen:ke,showUpperDiv:Oe})]})]})]})})]})]})},ma=pa,ha=({setInitialValues:r,initialValues:i})=>{const{user:C}=Qe();console.log("user",C);const[j,g]=o.useState(!0),[t,f]=o.useState([]),[n,I]=o.useState([]),[l,S]=o.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:C.empId,lastUpdatedBy:C.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",l),o.useEffect(()=>{S({...l,processType:(t==null?void 0:t.processType)||"MultiHead",planningId:(t==null?void 0:t.planningId)||0,baseColorId:(t==null?void 0:t.baseColorId)||"",componentId:(t==null?void 0:t.componentId)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",colorId:(t==null?void 0:t.colorId)||"",fabricId:(t==null?void 0:t.fabricId)||"",noOfHeads:(t==null?void 0:t.noOfHeads)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,repeats:(t==null?void 0:t.repeats)||0,repeatSize:(t==null?void 0:t.repeatSize)||0,uomId:(t==null?void 0:t.uomId)||"",totalFabric:(t==null?void 0:t.totalFabric)||"",shrinkage:(t==null?void 0:t.shrinkage)||"",wastage:(t==null?void 0:t.wastage)||"",total:(t==null?void 0:t.total)||"",appId:1,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||C.empId,lastUpdatedBy:C.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(t==null?void 0:t.repeatsInMtr)||""})},[t]);const{data:W}=$e(),[b,P]=o.useState(""),{data:p,refetch:T}=Xe(b,{skip:!b}),{data:m,refetch:O}=_o(l.planningHeaderId,{skip:!l.planningHeaderId}),{data:ee}=_e(),[X,G]=o.useState([]),{enqueueSnackbar:z}=We();console.log("lookupData",ee);const[Y,ae]=o.useState([]);o.useEffect(()=>{W&&ae(W.result)},[W]),o.useEffect(()=>{p&&(G(p.result),T())},[p]),o.useEffect(()=>{m&&(g(!1),I(m.result.map((s,x)=>({id:x+1,...s}))))},[m,O]),console.log("designList",X),console.log("collectionData",W);const[B,v]=o.useState(!1),[H,oe]=o.useState([]),[pe,h]=o.useState([]),[U,E]=o.useState([]),[D,be]=o.useState([]),[se,w]=o.useState([]),[te,k]=o.useState([]),[q,F]=o.useState([]),[J,de]=o.useState([]);console.log("components:",U),console.log("Fabrications:",D),console.log("colors:",se),console.log("uoms:",te),console.log("heads:",q),console.log("lookupData",ee),o.useEffect(()=>{if(ee){const s=ee.result[0];E(s.componentList),w(s.colorList),be(s.fabricList),F(s.noOfHeadsList),k(s.uomList),oe(s.planningTypeProcessList),h(s.operatingMachineList)}},[ee]),o.useEffect(()=>{const s=async x=>{try{const _=await Me.get(`http://100.42.177.77:83/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${x}`);console.log(_.data),de(_.data.result)}catch(_){console.error("Error fetching pre-planning lookup data:",_)}};l.designId&&s(l.designId)},[l.designId,l.planningHeaderId]);const ne=l.planningProcessTypeId===212||l.planningProcessTypeId===1219;console.log("initialValues",i),console.log("selectedCollectionId",b),o.useEffect(()=>{P((i==null?void 0:i.collectionId)||""),S({...l,designId:(i==null?void 0:i.designId)||"",planningHeaderId:(i==null?void 0:i.planningHeaderId)||"",batchNo:(i==null?void 0:i.batchNo)||""})},[i]),o.useEffect(()=>{const s=()=>{const $=parseFloat(l.poPcs)||0,xe=parseFloat(l.cuttingSize)||0,re=($*xe).toFixed(2);return parseFloat(re).toLocaleString()},x=()=>{const $=parseFloat(l.repeats)||0,xe=parseFloat(l.repeatSize)||0,re=($*xe).toFixed(2);return parseFloat(re).toLocaleString()},_=$=>{const xe=$||0,re=parseFloat(l.shrinkage)||0,ve=parseFloat(l.wastage)||0,Fe=(xe*(100+(re+ve))/100).toFixed(2);return parseFloat(Fe).toLocaleString()},N=()=>(.9144*(parseFloat(l.repeatSize)||0)).toFixed(2),ue=()=>{const $=parseFloat(l.repeats)||0;return((parseFloat(l.repeatsInMtr)||0)*$).toFixed(2)};let y=0;ne?y=parseFloat(s().replace(/,/g,""))||0:y=parseFloat(x().replace(/,/g,""))||0,S($=>({...$,totalFabric:y.toLocaleString(),total:_(y),repeatsInMtr:N()})),!ne&&l.isSchiffili&&S($=>({...$,totalFabric:ue()}))},[l.poPcs,l.cuttingSize,l.repeats,l.repeatSize,l.totalFabric,l.shrinkage,l.wastage,l.repeatsInMtr,l.isSchiffili,ne]);const[fe,Z]=o.useState(!1);o.useState(!1),o.useEffect(()=>{l.productionStatus===3&&z("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[l.productionStatus]);const V=s=>{const{name:x,value:_}=s.target;if(x==="collectionId"){const N=Y.find(ue=>ue.collectionId===parseInt(_));v(!0),I([]),g(!0),P(_),S({...l,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:_,noOfDesigns:N?N.noOfDesigns:"",productionStatus:N?N.productionStatus:"",noOfColors:N?N.noOfColors:""})}else if(x==="designId"){const N=X.find(ue=>ue.designId===parseInt(_));I([]),g(!0),S({...l,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:_,baseColorId:N?N.colorId:"",baseColorName:N?N.colorName:""})}else if(x==="batchNo"){const N=J.find(ue=>ue.batchNo===_);S({...l,componentId:"",processType:"MultiHead",poPcs:N?N.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:_,planningHeaderId:N?N.planningHeaderId:""}),Z(!0),v(!1)}else if(x==="planningProcessTypeId"){const N=H.find(ue=>ue.lookUpId===_);console.log("selectedProcess",N),S({...l,planningProcessTypeId:_,planningProcessTypeName:N?N.lookUpName:"",noOfHeads:0,operatingMachineId:0}),Z(!0),v(!1)}else S({...l,[x]:_})},[le,R]=o.useState({}),[L,ce]=o.useState(!1),he=()=>{ce(!L)},Pe=async()=>{const s=ke();if(Object.keys(s).length>0){R(s);return}try{const x={...l,totalFabric:parseFloat(l.totalFabric.replace(/,/g,"")),total:parseFloat(l.total.replace(/,/g,""))},_=await Me.post("http://100.42.177.77:83/api/PrePlanning/SavePrePlanning",x);console.log("Data saved successfully:",_.data),console.log("Save response:",_.data),_.data.success?_.data.success&&z("PrePlanning saved successfully!",{variant:"success",autoHideDuration:5e3}):(z(`${_.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",_.data.message)),S(N=>({processType:"MultiHead",planningId:0,collectionId:N.collectionId,designId:N.designId,batchNo:N.batchNo,planningHeaderId:N.planningHeaderId,baseColorId:N.baseColorId,baseColorName:N.baseColorName,noOfDesigns:N.noOfDesigns,noOfColors:N.noOfColors,poPcs:N.poPcs,fabricId:N.fabricId,shrinkage:N.shrinkage,wastage:N.wastage,componentId:"",cuttingSize:"",colorId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:C.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:C.empId,isSchiffili:!1,repeatsInMtr:""})),O()}catch(x){console.error("Error saving data:",x),z("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ke=()=>{const s={};return l.componentId||(s.componentId="componentId is required"),l.colorId||(s.colorId="colorId is required"),l.fabricId||(s.fabricId="fabricId is required"),l.cuttingSize||(s.cuttingSize="cuttingSize is required"),l.uomId||(s.uomId="uomId is required"),l.shrinkage||(s.shrinkage="shrinkage is required"),l.wastage||(s.wastage="wastage is required"),s};console.log("initialRows",n);const Oe=n.reduce((s,x)=>s+(x.totalFabric??0),0).toFixed(2),je=parseFloat(Oe).toLocaleString();console.log("localizedTotalFabric",je);const Ae=n.reduce((s,x)=>s+(x.total??0),0).toFixed(2),Ne=parseFloat(Ae).toLocaleString(),we=[...n,{id:"TOTAL_SUMMARY",label:"Total Fabric",totalFabric:je,total:Ne}],M={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",we);const K=[{field:"id",headerName:"Sr#",...M,colSpan:(s,x)=>{if(x.id==="TOTAL_SUMMARY")return 10},valueGetter:(s,x)=>x.id==="TOTAL_SUMMARY"?x.label:s,renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value})},{field:"componentName",headerName:"Component",...M},{field:"planningProcessTypeName",headerName:"Process Type",...M,renderCell:s=>{const x=s.value==="MultiHead"?"primary.dark":s.value==="Schiffili"?theme.palette.grey[900]:s.value==="Dyeing"?"success.dark":"default";return e.jsx(Ye,{label:s.value,sx:{backgroundColor:x==="primary"||x==="default"?void 0:x,color:x==="primary"||x==="default"?void 0:"white"},color:x==="primary"?"primary":x==="default"?"default":void 0})}},{field:"color",headerName:"Color",...M},{field:"cuttingSize",headerName:"Cutting Size",...M},{field:"fabric",headerName:"Fabrication",...M},{field:"noOfHeadName",headerName:"No. Of Heads",...M},{field:"operatingMachineName",headerName:"Operating Machine",...M},{field:"repeats",headerName:"Repeats",valueGetter:s=>s.toLocaleString(),...M},{field:"repeatSize",headerName:"Repeat Size",valueGetter:s=>s.toLocaleString(),...M},{field:"totalFabric",headerName:"Total Fabric",valueGetter:s=>s.toLocaleString(),renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value}),...M},{field:"uom",headerName:"UOM",colSpan:(s,x)=>x.id==="TOTAL_SUMMARY"?2:void 0,valueGetter:(s,x)=>x.id==="TOTAL_SUMMARY"?"OverAll Total":s,renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value}),...M},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:s=>s.toLocaleString(),colSpan:(s,x)=>x.id==="TOTAL_SUMMARY"?2:void 0,renderCell:s=>e.jsx("div",{style:{color:s.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:s.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:s.value}),...M}],Ie=l.planningProcessTypeId===198;o.useEffect(()=>{Ie&&S({...l,uomId:139})},[Ie]),console.log("formData",l);const u=({row:s,field:x})=>s.id==="TOTAL_SUMMARY"&&(x==="componentName"||x==="uom")?"bold":"";console.log("batchList:",J);const d="http://100.42.177.77:83/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",A=(s,x)=>{Z(!fe)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(_t,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:b,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:Y.map(s=>e.jsx(Q,{value:s.collectionId,children:s.collectionName},s.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:l.designId,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:X.map(s=>e.jsx(Q,{value:s.designId,children:s.designNo},s.designId))})}),e.jsxs(a,{item:!0,xs:12,md:2.4,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:l.batchNo,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:J.map(s=>e.jsx(Q,{value:s.batchNo,children:s.batchNo},s.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:l.poPcs,onChange:V,disabled:!0,sx:s=>({...l.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:2.4,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:l.baseColorName,onChange:V,disabled:!0,sx:s=>({...l.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"MainCard",avatar:e.jsx(Bt,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ze,{onClick:A,sx:{mt:"-18px"},children:e.jsx(et,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(Ft,{expanded:fe,onChange:A,sx:{},children:[e.jsx(Rt,{expandIcon:e.jsx(et,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(zt,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(Ze,{fullWidth:!0,disabled:L,options:D,getOptionLabel:s=>s.lookUpName,value:D.find(s=>s.lookUpId===l.fabricId)||null,onChange:(s,x)=>{V({target:{name:"fabricId",value:x?x.lookUpId:""}})},renderInput:s=>e.jsx(c,{...s,label:"Fabrication",size:"small",name:"fabricId",value:l.fabricId,required:!0,error:!!le.fabricId,helperText:le.fabricId,disabled:L,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:s})=>e.jsx("div",{style:{backgroundColor:"white"},children:s})})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:l.shrinkage,onChange:V,error:!!le.shrinkage,helperText:le.shrinkage,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:l.wastage,onChange:V,error:!!le.wastage,helperText:le.wastage,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(ge,{variant:"contained",size:"small",onClick:he,children:L||L?"Unlock":"Lock"})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:l.planningProcessTypeId,onChange:V,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:H.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})," "]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(Ze,{fullWidth:!0,options:U,getOptionLabel:s=>s.lookUpName,value:U.find(s=>s.lookUpId===l.componentId)||null,onChange:(s,x)=>{V({target:{name:"componentId",value:x?x.lookUpId:""}})},renderOption:(s,x)=>{const{lookUpName:_}=x;return e.jsx("span",{...s,children:_})},renderInput:s=>e.jsx(c,{...s,label:"Select Component",size:"small",name:"componentId",value:l.componentId,required:!0,error:!!le.componentId,helperText:le.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:s})=>e.jsx("div",{style:{backgroundColor:"white"},children:s})})}),e.jsxs(a,{item:!0,xs:12,md:2,children:[" ",e.jsx(Ze,{fullWidth:!0,options:se,getOptionLabel:s=>s.lookUpName,value:se.find(s=>s.lookUpId===l.colorId)||null,onChange:(s,x)=>{V({target:{name:"colorId",value:x?x.lookUpId:""}})},renderInput:s=>e.jsx(c,{...s,label:"Color",size:"small",value:l.colorId,name:"colorId",required:!0,error:!!le.colorId,helperText:le.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:s})=>e.jsx("div",{style:{backgroundColor:"white"},children:s})})]}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:l.cuttingSize,onChange:V,required:!0,error:!!le.cuttingSize,helperText:le.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:Ie?e.jsx(c,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:l.operatingMachineId,onChange:V,required:!0,disabled:ne,InputLabelProps:{sx:{color:"black"}},children:pe.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))}):e.jsx(c,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:l.noOfHeads,onChange:V,required:!0,disabled:ne,InputLabelProps:{sx:{color:"black"}},children:q.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:l.repeatSize,onChange:V,disabled:ne,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"No. of Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:l.repeats,onChange:V,required:!0,disabled:ne,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:l.totalFabric,onChange:V,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:l.uomId,onChange:V,error:!!le.uomId,helperText:le.uomId,required:!0,disabled:Ie,InputLabelProps:{sx:{color:"black"}},children:te.map(s=>e.jsx(Q,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Repeats in Meter",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:l.repeatsInMtr,onChange:V,sx:s=>({...l.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(c,{label:"Total",fullWidth:!0,size:"small",name:"total",value:l.total,onChange:V,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(a,{container:!0,spacing:1,width:"Inherit"})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",children:e.jsx(ge,{variant:"contained",size:"small",onClick:Pe,disabled:l.productionStatus===3,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"MainCard",avatar:e.jsx(Ve,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{sx:{paddingY:1,paddingX:1},children:e.jsx(a,{sx:{},item:!0,xs:12,children:e.jsx(qe,{iColumns:K,initialRows:we,setInitialData:f,deleteApi:d,deleteBy:"planningId",refetch:O,getCellClassName:u,setAccordionExpanded:Z,fileName:"PrePlanningList",isLoading:j})})})]})]})},ga=ha,ba="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",fa=({initialValues:r})=>{const{user:i}=Qe();console.log("user",i);const[C,j]=o.useState(!0),[g,t]=o.useState([]),[f,n]=o.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:i.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId});o.useEffect(()=>{n({...f,dpId:g.dpId||0,fabricId:(g==null?void 0:g.fabricId)||"",colorId:(g==null?void 0:g.colorId)||"",color:(g==null?void 0:g.color)||"",processType:(g==null?void 0:g.processType)||"",availableQty:(g==null?void 0:g.availableQty)||"",Shrinkage:(g==null?void 0:g.shrinkage)||"",Wastage:(g==null?void 0:g.wastage)||"",outputQty:(g==null?void 0:g.outputQty)||0,UOM:(g==null?void 0:g.uom)||0,uomId:(g==null?void 0:g.uomId)||"",poPcs:(g==null?void 0:g.poPcs)||0,createdOn:(g==null?void 0:g.createdOn)||new Date().toISOString(),createdBy:(g==null?void 0:g.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})},[g]);const{enqueueSnackbar:I}=We(),[l,S]=o.useState(!1);console.log("Dyeing form data to send",f);const{data:W}=$e(),[b,P]=o.useState("");o.useEffect(()=>{P(r.collectionId)},[]);const{data:p}=_e(),{data:T,refetch:m}=Xe(b,{skip:!b}),{data:O,refetch:ee}=at(f.designId,{skip:!f.designId}),{data:X}=Uo({batchNo:f.planningHeaderId,processType:"Fabrication"},{skip:!f.planningHeaderId}),{data:G}=Ho({fabricId:f.fabricId,planningHeaderId:f.planningHeaderId},{skip:!f.fabricId||!f.planningHeaderId}),{data:z,refetch:Y}=qo(f.planningHeaderId,{skip:!f.planningHeaderId}),[ae,B]=o.useState([]),[v,H]=o.useState([]),[oe,pe]=o.useState([]),[h,U]=o.useState([]),[E,D]=o.useState([]),[be,se]=o.useState([]);o.useState([]);const[w,te]=o.useState(!1);console.log("batchList",v),console.log("formData",f),o.useEffect(()=>{T&&B(T.result)},[T]),o.useEffect(()=>{O&&H(O.result)},[O]),o.useEffect(()=>{X&&pe(X.result)},[X]),o.useEffect(()=>{G&&se(G.result)},[G]),o.useEffect(()=>{z&&(j(!1),D(z.result.map((u,d)=>({id:d+1,...u}))))},[z,Y]),o.useEffect(()=>{if(p){const u=p.result[0];U(u.uomList)}},[p]);const[k,q]=o.useState([]);o.useEffect(()=>{W&&q(W.result)},[W]),o.useEffect(()=>{f.productionStatus===3&&I("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[f.productionStatus]);const F=u=>{const{name:d,value:A}=u.target;if(d==="collectionId"){const s=k.find(x=>x.collectionId===parseInt(A));P(A),S(!0),D([]),j(!0),n({...f,collectionId:A,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",productionStatus:s?s.productionStatus:"",poPcs:"",baseColorName:""})}else if(d==="designId"){const s=ae.find(x=>x.designId===parseInt(A));D([]),j(!0),n({...f,designId:A,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(d==="batchNo"){const s=v.find(x=>x.batchNo===A);n({...f,batchNo:A,planningHeaderId:s?s.planningHeaderId:"",poPcs:s?s.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),te(!0),S(!1)}else if(d==="fabricId")oe.find(s=>s.fabricId===A),console.log("Selected Fabric:",oe),n({...f,fabricId:A});else if(d==="ColorId"){const s=be.find(x=>x.colorId===A.colorId);n({...f,ColorId:A.colorId,color:s.color,availableQty:s.total,UOM:s.uom,Shrinkage:s.shrinkage,Wastage:s.wastage})}else d==="processType"?n({...f,processType:A}):d==="vendorId"?n({...f,vendorId:A}):(n({...f,[d]:A}),de(s=>({...s,[d]:""})))};o.useEffect(()=>{const u=()=>{const N=parseFloat(f.availableQty)||0,ue=parseFloat(f.Shrinkage)||0,y=parseFloat(f.Wastage)||0;return(N*(100-(ue+y))/100).toFixed(2)},d=()=>{const N=parseFloat(f.availableQty)||0,ue=parseFloat(f.RatePerUOM)||0;return(N*ue).toFixed(2)},A=(N,ue)=>(N*(1+ue/100)).toFixed(2),s=u(),x=d(),_=parseFloat(f.GST)||0;A(x,_),parseFloat(f.poPcs),n(N=>({...N,outputQty:s}))},[f.availableQty,f.Shrinkage,f.Wastage,f.RatePerUOM,f.GST,f.poPcs,f.UnitRatePerPo]);const[J,de]=o.useState({}),ne=async()=>{try{const u=await Me.post("http://100.42.177.77:83/api/DyeingPrinting/SaveDyeingPrinting",f);console.log("Save response:",u.data),u.data.success?I("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(I(`${u.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",u.data.message)),n(d=>({designId:d.designId,planningHeaderId:d.planningHeaderId,batchNo:d.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:d.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})),Y()}catch(u){console.error("Error saving data:",u),I("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},fe=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[Z,V]=o.useState(!0),[le,R]=o.useState({}),[L,ce]=o.useState(!1),he=u=>{R(u),ce(!0)},Pe=u=>{R(u),ce(!0),V(!1)},ke=()=>{V(!0),ce(!1),R({}),Y()},[Oe,je]=o.useState(0),[Ae,Ne]=o.useState(0);o.useEffect(()=>{const u=E.reduce((A,s)=>A+(s.availableQty??0),0).toFixed(2),d=E.reduce((A,s)=>A+(s.assignedQty??0),0).toFixed(2);je(parseFloat(u).toLocaleString()),Ne(parseFloat(d).toLocaleString())},[E]);const we=[...E,{id:"TOTAL_SUMMARY",componentName:"Total Summary",availableQty:Oe,assignedQty:Ae}],M={sortable:!1,pinnable:!1,hideable:!1},K=[{field:"id",headerName:"Sr#",...M,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):u.value},{field:"fabricName",headerName:"Fabric",...M},{field:"colorName",headerName:"Color",...M,colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?2:void 0},{field:"processType",headerName:"Process Type",...M,renderCell:u=>{const d=u.value==="Dyeing"?"primary.dark":u.value==="Printing"?"success.dark":"default";return e.jsx(Ye,{label:u.value,sx:{backgroundColor:d==="primary"||d==="default"?void 0:d,color:d==="primary"||d==="default"?void 0:"white"},color:d==="primary"?"primary":d==="default"?"default":void 0})}},{field:"uom",headerName:" UOM",...M},{field:"poPcs",headerName:" PO PCS.",...M},{field:"availableQty",headerName:"Available Quantitity",...M,valueGetter:u=>u.toLocaleString(),renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"assignedQty",headerName:"Assigned Qty",...M,valueGetter:u=>u.toLocaleString(),colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?4:void 0,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"AddVendor",headerName:"Add Vendor",...M,renderCell:u=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(bt,{variant:"text",size:"small",children:[e.jsx(ze,{color:"primary",onClick:()=>he(u.row),children:e.jsx(It,{})}),e.jsx(ze,{color:"primary",onClick:()=>Pe(u.row),children:e.jsx(Ve,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:ba,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:b,onChange:F,size:"small",InputLabelProps:{sx:{color:"black"}},children:k.map(u=>e.jsx(Q,{value:u.collectionId,children:u.collectionName},u.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:f.designId,onChange:F,size:"small",InputLabelProps:{sx:{color:"black"}},children:ae.map(u=>e.jsx(Q,{value:u.designId,children:u.designNo},u.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:f.batchNo,onChange:F,size:"small",InputLabelProps:{sx:{color:"black"}},children:v.map(u=>e.jsx(Q,{value:u.batchNo,children:u.batchNo},u.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:f.baseColorName,onChange:F,disabled:!0,sx:u=>({...f.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:f.fabricId,onChange:F,error:!!J.fabricId,helperText:J.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:oe.map(u=>e.jsx(Q,{value:u.fabricId,children:u.fabric},u.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(na,{fullWidth:!0,options:be,getOptionLabel:u=>u.color||"",renderInput:u=>e.jsx(c,{...u,label:"Color",name:"colorId",size:"small",error:!!J.colorId,helperText:J.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:u})=>e.jsx("div",{style:{backgroundColor:"white",boxShadow:"0 3px 5px rgba(0, 0, 0, 0.2)"},children:u}),value:be.find(u=>u.colorId===f.colorId)||null,onChange:(u,d)=>{n(A=>({...A,colorId:d?d.colorId:"",color:d?d.color:"",availableQty:d?d.total:"",UOM:d?d.uom:"",uomId:d?d.uomId:"",Shrinkage:d?d.shrinkage:"",Wastage:d?d.wastage:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:f.processType,onChange:F,error:!!J.processType,helperText:J.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:fe.map(u=>e.jsx(Q,{value:u.value,children:u.label},u.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:f.poPcs,onChange:F,disabled:!0,sx:u=>({...f.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:f.UOM,onChange:F,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Available Qty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:f.availableQty,onChange:F,disabled:!0,sx:u=>({...f.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(a,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(ge,{variant:"contained",color:"primary",size:"small",disabled:f.productionStatus===3,onClick:ne,children:"Save"})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(qe,{iColumns:K,initialRows:we,setInitialData:t,deleteApi:"http://100.42.177.77:83/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:Y,setAccordionExpanded:te,fileName:"Dyeing&PrintingList",isLoading:C}),e.jsxs(nt,{open:L,onClose:ke,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(ye,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Dyeing and Printing > Assign Vendors "}),e.jsx(ze,{onClick:ke,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(ca,{initialFormData:le,setInitialFormData:R,refetchDyeingPrintingData:Y,handleClickOpen:he,showUpperDiv:Z})]})]})]})})]})]})},Ia=fa,Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",xa=({initialValues:r})=>{const{user:i}=Qe(),{enqueueSnackbar:C}=We(),[j,g]=o.useState(!0),[t,f]=o.useState([]),[n,I]=o.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:i.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId});o.useEffect(()=>{I({...n,schiffiliId:t.schiffiliId||0,componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})},[t]);const[l,S]=o.useState(!1),W=(d,A)=>{S(!l)},[b,P]=o.useState(!1),{data:p}=$e(),[T,m]=o.useState("");o.useEffect(()=>{m(r.collectionId)},[]);const{data:O}=_e(),{data:ee,refetch:X}=Xe(T,{skip:!T}),{data:G,refetch:z}=at(n.designId,{skip:!n.designId}),{data:Y}=ut({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:ae}=pt({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:B,refetch:v}=Eo(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:H}=mt(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("formData.planningHeaderId",n.planningHeaderId),console.log("collectionData",p),console.log("schiffliList",B);const[oe,pe]=o.useState([]),[h,U]=o.useState([]),[E,D]=o.useState([]),[be,se]=o.useState([]),[w,te]=o.useState([]),[k,q]=o.useState([]),[F,J]=o.useState([]),[de,ne]=o.useState([]),[fe,Z]=o.useState([]);o.useEffect(()=>{ee&&pe(ee.result)},[ee]),o.useEffect(()=>{G&&U(G.result)},[G]),o.useEffect(()=>{Y&&D(Y.result)},[Y]),o.useEffect(()=>{ae&&J(Y.result)},[ae]),o.useEffect(()=>{H&&Z(H.result)},[H]),o.useEffect(()=>{B&&(g(!1),ne(B.result.map((d,A)=>({id:A+1,...d}))))},[B,v]),o.useEffect(()=>{if(O){const d=O.result[0];se(d.vendorList),te(d.operatingMachineList),q(d.workingHeadList)}},[O]),console.log("initialRows",de);const V=(p==null?void 0:p.result)||[];o.useEffect(()=>{const d=()=>{const N=parseFloat(n.thaanQty)||0,ue=parseFloat(n.operatingMachine)||0;return(N*ue).toFixed(2)};I(N=>({...N,totalEmbroidry:d()}));const A=()=>{const N=parseFloat(n.thaanQty)||0,ue=parseFloat(n.noOfItemPerThaan)||0;return(N*ue).toFixed(2)};I(N=>({...N,totalPcs:A()}));const s=()=>{const N=parseFloat(n.noOfStichesPerYard)||0,ue=parseFloat(n.rate)||0;return(N/1e3*ue).toFixed(2)};I(N=>({...N,amountPerYard:s()}));const x=()=>{const N=parseFloat(n.totalAmount)||0,ue=parseFloat(n.totalPcs)||0;return(N/ue).toFixed(2)};I(N=>({...N,costPerComponent:x()}));const _=()=>{const N=parseFloat(n.amountPerYard)||0,ue=parseFloat(n.totalEmbroidry)||0,y=parseFloat(n.laserCutRate)||0,$=parseFloat(n.pcsForLaserCut)||0;return(N*ue+$*y).toFixed(2)};I(N=>({...N,totalAmount:_()}))},[n.thaanQty,n.operatingMachine,n.noOfStichesPerYard,n.rate,n.totalAmount,n.totalPcs,n.amountPerYard,n.totalEmbroidry,n.laserCutRate,n.pcsForLaserCut]);const le=d=>{const{name:A,checked:s}=d.target;I(x=>({...x,[A]:s}))};o.useEffect(()=>{n.productionStatus===3&&C("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[n.productionStatus]);const R=d=>{const{name:A,value:s}=d.target;if(A==="collectionId"){const x=V.find(_=>_.collectionId===parseInt(s));m(s),P(!0),ne([]),g(!0),I({...n,collectionId:s,designId:"",planningHeaderId:0,productionStatus:x?x.productionStatus:"",batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(A==="designId"){const x=oe.find(_=>_.designId===parseInt(s));ne([]),g(!0),I({...n,designId:s,baseColorId:x?x.colorId:"",baseColorName:x?x.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(A==="batchNo"){const x=h.find(_=>_.batchNo===s);I({...n,batchNo:s,planningHeaderId:x?x.planningHeaderId:"",poPcs:x?x.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),S(!0),P(!1)}else if(A==="colorId"){const x=F.find(_=>_.colorId===s);I({...n,colorId:s,availableQty:x?x.total:"",cuttingSize:x?x.cuttingSize:"",repeats:x?x.repeats:""})}else if(A==="operatingMachineId"){const x=w.find(_=>_.lookUpId===s);I({...n,operatingMachineId:s,operatingMachine:x?x.lookUpName:""})}else I({...n,[A]:s})};console.log("colors",F);const[L,ce]=o.useState({}),he=async()=>{const d=Pe();if(Object.keys(d).length>0){ce(d);return}try{const A=await Me.post("http://100.42.177.77:83/api/Schiffli/SaveSchiffili",n);console.log("Save response:",A.data),A.data.success?C("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(C(`${A.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",A.data.message)),I(s=>({designId:s.designId,planningHeaderId:s.planningHeaderId,batchNo:s.batchNo,baseColorName:s.baseColorName,schiffiliId:0,componentId:"",poPcs:s.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:i.empId})),v()}catch(A){console.error("Error saving data:",A),C("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Pe=()=>{const d={};return n.fabricId||(d.fabricId="fabricId is required"),n.colorId||(d.colorId="colorId is required"),n.vendorId||(d.vendorId="vendorId is required"),n.componentId||(d.componentId="componentId is required"),n.thaanQty||(d.thaanQty="thaanQty is required"),n.workingHeadId||(d.workingHeadId="workingHeadId is required"),n.rate||(d.rate="rate is required"),n.operatingMachineId||(d.operatingMachineId="operatingMachineId is required"),n.noOfStichesPerYard||(d.noOfStichesPerYard="noOfStichesPerYard is required"),n.noOfItemPerThaan||(d.noOfItemPerThaan="noOfItemPerThaan is required"),d};console.log("formData",n);const[ke,Oe]=o.useState(0),[je,Ae]=o.useState(0),[Ne,we]=o.useState(0);o.useEffect(()=>{const d=de.reduce((x,_)=>x+(_.totalAmount??0),0).toFixed(2),A=de.reduce((x,_)=>x+(_.totalEmbroidry??0),0).toFixed(2),s=de.reduce((x,_)=>x+(_.totalPcs??0),0).toFixed(2);Oe(parseFloat(d).toLocaleString()),Ae(parseFloat(A).toLocaleString()),we(parseFloat(s).toLocaleString())},[de]);const M={id:"TOTAL_SUMMARY",fabricName:"Total Summary",totalAmount:ke,totalEmbroidry:je,totalPcs:Ne},K=[...de,M],Ie=[{field:"id",headerName:"Sr#",colSpan:(d,A)=>A.id==="TOTAL_SUMMARY"?3:void 0,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):d.value},{field:"fabricName",headerName:"Fabric",colSpan:(d,A)=>A.id==="TOTAL_SUMMARY"?2:void 0,renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):d.value},{field:"componentName",headerName:"Component",renderCell:d=>e.jsx(Ye,{label:d.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"totalAmount",headerName:"Total Amount",renderCell:d=>d.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:d.value}):d.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:Ut,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:T,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:V.map(d=>e.jsx(Q,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:oe.map(d=>e.jsx(Q,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:R,size:"small",InputLabelProps:{sx:{color:"black"}},children:h.map(d=>e.jsx(Q,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:d=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Bt,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(ze,{onClick:W,sx:{mt:"-18px"},children:e.jsx(et,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(Ft,{expanded:l,onChange:W,sx:{},children:[e.jsx(Rt,{expandIcon:e.jsx(et,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(zt,{children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:R,size:"small",required:!0,error:!!L.componentId,helperText:L.componentId,InputLabelProps:{sx:{color:"black"}},children:fe.map(d=>e.jsx(Q,{value:d.componentId,children:d.componentName},d.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:R,required:!0,error:!!L.fabricId,helperText:L.fabricId,InputLabelProps:{sx:{color:"black"}},children:E.map(d=>e.jsx(Q,{value:d.fabricId,children:d.fabric},d.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:n.vendorId,onChange:R,required:!0,error:!!L.vendorId,helperText:L.vendorId,InputLabelProps:{sx:{color:"black"}},children:be.map(d=>e.jsx(Q,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:R,required:!0,error:!!L.colorId,helperText:L.colorId,InputLabelProps:{sx:{color:"black"}},children:F.map(d=>e.jsx(Q,{value:d.colorId,children:d.color},d.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,disabled:!0,onChange:R,sx:d=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:n.availableQty,onChange:R,sx:d=>({...n.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:n.thaanQty,onChange:R,required:!0,error:!!L.thaanQty,helperText:L.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:n.operatingMachineId,onChange:R,required:!0,error:!!L.operatingMachineId,helperText:L.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:w.map(d=>e.jsx(Q,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:n.workingHeadId,onChange:R,required:!0,error:!!L.workingHeadId,helperText:L.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:k.map(d=>e.jsx(Q,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:n.cuttingSize,onChange:R,sx:d=>({...n.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:n.rate,onChange:R,required:!0,error:!!L.rate,helperText:L.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:n.noOfStichesPerYard,onChange:R,required:!0,error:!!L.noOfStichesPerYard,helperText:L.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:n.noOfItemPerThaan,onChange:R,required:!0,error:!!L.noOfItemPerThaan,helperText:L.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:n.totalEmbroidry,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:n.amountPerYard,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:n.totalPcs,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:n.costPerComponent,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:n.totalAmount,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(Qt,{control:e.jsx(Wt,{checked:n.laserCut,onChange:le,name:"laserCut"}),label:"Laser Cut"})}),n.laserCut?e.jsx(a,{item:!0,xs:12,md:4.5,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(c,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:n.laserCutRate,onChange:R,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(c,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:n.pcsForLaserCut,onChange:R,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:he,disabled:n.productionStatus===3,children:"Save"})})]})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:Ie,initialRows:K,setInitialData:f,deleteApi:"http://100.42.177.77:83/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:v,setAccordionExpanded:S,fileName:"Schffili List",isLoading:j})})})]})]})},va=xa,ya=({additionalProcessData:r,setAdditionalProcessData:i,refetchAdditionalProcessList:C,handleClickOpen:j})=>{const{user:g}=Qe(),[t,f]=o.useState([]),{enqueueSnackbar:n}=We(),[I,l]=o.useState({}),[S,W]=o.useState([]),b=t.reduce((B,v)=>B+(v.quantity??0),0).toFixed(2);console.log("Quantity",b);const[P,p]=o.useState({additionalProcessDetId:0,additionalProcessId:r.additionalProcessId||0,designId:r.designNo||"",planningHeaderId:r.planningHeaderId||0,batchNo:r.batchNo||"",componentName:r.componentName||"",componentId:r.componentId||"",colorName:r.colorName||"",colorId:r.colorId||"",fabricName:r.fabricName||"",fabricId:r.fabricId||"",uomId:r.uomId||"",uom:r.uom||"",vendorId:"",pcsPerComponent:r.pcsPerComponent||"",remainingPcsPerComponent:r.pcsPerComponent-b||"",processTypeName:r.processTypeName||"",processTypeId:r.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId});o.useEffect(()=>{p(B=>({...B,additionalProcessDetId:S.additionalProcessDetId||0,vendorId:(S==null?void 0:S.vendorId)||"",quantity:(S==null?void 0:S.quantity)||"",ratePerPcs:(S==null?void 0:S.ratePerPcs)||"",remainingPcsPerComponent:B.remainingPcsPerComponent+(S==null?void 0:S.quantity)||"",totalAmount:(S==null?void 0:S.totalAmount)||"",costPerComponent:(S==null?void 0:S.costPerComponent)||0,createdOn:(S==null?void 0:S.createdOn)||new Date().toISOString(),createdBy:(S==null?void 0:S.createdBy)||g.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:g.empId}))},[S]),o.useEffect(()=>{p({...P,remainingPcsPerComponent:r.pcsPerComponent-b>=0?r.pcsPerComponent-b:""})},[t,r.pcsPerComponent,b]);const{data:T}=_e(),{data:m,refetch:O}=Go(P.additionalProcessId,{skip:!P.additionalProcessId}),[ee,X]=o.useState([]);o.useEffect(()=>{if(T){const B=T.result[0];X(B.vendorList)}},[T]),o.useEffect(()=>{m&&f(m.result.map((B,v)=>({id:v+1,...B})))},[m,O]),console.log("initialRows",t);const G=B=>{const{name:v,value:H}=B.target;p({...P,[v]:H}),p(oe=>{const pe={...oe,[v]:H};if(v==="quantity"||v==="remainingPcsPerComponent"){const h=pe.quantity,U=pe.remainingPcsPerComponent;h>U?l(E=>({...E,quantity:"Assigned Quantity cannot be greater than Remaining Quantity"})):l(E=>({...E,quantity:""}))}return pe})};o.useEffect(()=>{const B=()=>{const H=parseFloat(P.quantity)||0,oe=parseFloat(P.ratePerPcs)||0;return(H*oe).toFixed(2)};p(H=>({...H,totalAmount:B()}));const v=()=>{const H=parseFloat(P.totalAmount)||0,oe=parseFloat(P.poPcs)||0;return(H/oe).toFixed(2)};p(H=>({...H,costPerComponent:v()}))},[P.quantity,P.ratePerPcs,P.totalAmount]);const z=async()=>{if(console.log(P),P.quantity>P.remainingPcsPerComponent){n("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}try{const B=await Me.post("http://100.42.177.77:83/api/AdditionalProcess/SaveAdditionalProcessDetails",P);console.log("Save response:",B.data),B.data.success?n("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(n(`${B.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",B.data.message)),O(),p(v=>({...v,vendorId:"",pcsPerComponent:r.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",remainingPcsPerComponent:r.pcsPerComponent-b||"",createdOn:new Date().toISOString(),createdBy:g.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:g.empId})),C()}catch(B){console.error("Error saving data:",B),n("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Y=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:2},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Select Design",name:"designId",value:P.designId,onChange:G,size:"small",disabled:!0,sx:B=>({...P.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:P.batchNo,onChange:G,size:"small",disabled:!0,sx:B=>({...P.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,label:"Components",name:"componentName",value:P.componentName,onChange:G,size:"small",disabled:!0,sx:B=>({...P.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:P.fabricName,onChange:G,disabled:!0,sx:B=>({...P.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:P.colorName,onChange:G,disabled:!0,sx:B=>({...P.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:P.processTypeName,onChange:G,disabled:!0,sx:B=>({...P.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:P.pcsPerComponent,onChange:G,disabled:!0,sx:B=>({...P.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:P.remainingPcsPerComponent,onChange:G,disabled:!0,sx:B=>({...P.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:P.uom,onChange:G,disabled:!0,sx:B=>({...P.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:P.vendorId,onChange:G,disabled:!P.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}},children:ee.map(B=>e.jsx(Q,{value:B.lookUpId,children:B.lookUpName},B.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:P.quantity,onChange:G,disabled:!P.remainingPcsPerComponent,error:!!I.quantity,helperText:I.quantity,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:P.ratePerPcs,onChange:G,disabled:!P.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:P.totalAmount,onChange:G,disabled:!P.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ge,{variant:"contained",size:"small",onClick:z,disabled:!P.remainingPcsPerComponent,children:"Save"})})]}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:Y,initialRows:t,setInitialData:W,deleteApi:"http://100.42.177.77:83/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:O})})})]})},Ca=({initialValues:r})=>{const{user:i}=Qe(),{enqueueSnackbar:C}=We(),[j,g]=o.useState(!0),[t,f]=o.useState([]),[n,I]=o.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId});console.log("initialData",t),o.useEffect(()=>{I({...n,additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})},[t]);const[l,S]=o.useState(!1),{data:W}=$e(),[b,P]=o.useState("");o.useEffect(()=>{P(r.collectionId)},[]);const{data:p}=_e(),{data:T,refetch:m}=Xe(b,{skip:!b}),{data:O,refetch:ee}=at(n.designId,{skip:!n.designId}),{data:X}=ut({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:G}=pt({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:z,refetch:Y}=Yo(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:ae}=mt(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("lookupData",p),console.log("collectionData",W),console.log("colorData",G);const[B,v]=o.useState([]),[H,oe]=o.useState([]),[pe,h]=o.useState([]),[U,E]=o.useState([]),[D,be]=o.useState([]),[se,w]=o.useState([]),[te,k]=o.useState([]),[q,F]=o.useState([]),[J,de]=o.useState([]),[ne,fe]=o.useState([]),[Z,V]=o.useState([]);console.log("batchData",O);const[le,R]=o.useState([]);o.useEffect(()=>{W&&R(W.result)},[W]),o.useEffect(()=>{T&&v(T.result)},[T]),o.useEffect(()=>{O&&oe(O.result)},[O]),o.useEffect(()=>{X&&h(X.result)},[X]),o.useEffect(()=>{G&&de(G.result)},[G]),o.useEffect(()=>{ae&&V(ae.result)},[ae]),o.useEffect(()=>{if(p){const u=p.result[0];be(u.uomList),w(u.processList)}},[p]),o.useEffect(()=>{z&&(g(!1),fe(z.result.map((u,d)=>({id:d+1,...u}))))},[z,Y]),o.useEffect(()=>{if(p){const u=p.result[0];E(u.vendorList),k(u.operatingMachineList),F(u.workingHeadList)}},[p]),console.log("initialRows",ne),o.useEffect(()=>{n.productionStatus===3&&C("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[n.productionStatus]);const L=u=>{const{name:d,value:A}=u.target;if(d==="collectionId"){const s=le.find(x=>x.collectionId===parseInt(A));P(A),fe([]),g(!0),I({...n,collectionId:A,designId:"",planningHeaderId:0,productionStatus:s?s.productionStatus:"",batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})}else if(d==="designId"){const s=B.find(x=>x.designId===parseInt(A));fe([]),g(!0),I({...n,designId:A,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})}else if(d==="batchNo"){const s=H.find(x=>x.batchNo===A);I({...n,batchNo:A,planningHeaderId:s?s.planningHeaderId:"",poPcs:s?s.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId}),S(!0)}else I({...n,[d]:A})};console.log("colors",J);const ce=async()=>{console.log("formData",n);try{const u=await Me.post("http://100.42.177.77:83/api/AdditionalProcess/SaveAdditionalProcess",n);console.log("Save response:",u.data),u.data.success?C("Process saved successfully!",{variant:"success",autoHideDuration:5e3}):(C(`${u.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",u.data.message)),I(d=>({additionalProcessId:0,designId:d.designId,planningHeaderId:d.planningHeaderId,batchNo:d.batchNo,baseColorName:d.baseColorName,poPcs:d.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:i.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:i.empId})),Y()}catch(u){console.error("Error saving data:",u),C("Process not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",n),o.forwardRef(function(d,A){return e.jsx(Vo,{direction:"up",ref:A,...d})});const[he,Pe]=o.useState({}),[ke,Oe]=o.useState(!1),je=u=>{Pe(u),Oe(!0)},Ae=()=>{Oe(!1),Pe({}),Y()},[Ne,we]=o.useState(0);o.useEffect(()=>{const u=ne.reduce((d,A)=>d+(A.assignedQty??0),0).toFixed(2);we(parseFloat(u).toLocaleString())},[ne]);const M=[...ne,{id:"TOTAL_SUMMARY",assignedQty:Ne}],K=[{field:"id",headerName:"Sr#",colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?4:void 0,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):u.value},{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component",renderCell:u=>e.jsx(Ye,{label:u.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity",colSpan:(u,d)=>d.id==="TOTAL_SUMMARY"?3:void 0,valueGetter:u=>u,renderCell:u=>u.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:u.value}):u.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:u=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(ze,{color:"primary",onClick:()=>je(u.row),children:e.jsx(It,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:Ut,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:b,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:le.map(u=>e.jsx(Q,{value:u.collectionId,children:u.collectionName},u.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:B.map(u=>e.jsx(Q,{value:u.designId,children:u.designNo},u.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:H.map(u=>e.jsx(Q,{value:u.batchNo,children:u.batchNo},u.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:L,disabled:!0,sx:u=>({...n.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(a,{item:!0,xs:12,md:12,children:[e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(c,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:Z.map(u=>e.jsx(Q,{value:u.componentId,children:u.componentName},u.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:pe.map(u=>e.jsx(Q,{value:u.fabricId,children:u.fabric},u.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:J.map(u=>e.jsx(Q,{value:u.colorId,children:u.color},u.colorId))})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:L,disabled:!0,sx:u=>({...n.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(c,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:n.pcsPerComponent,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:n.uomId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:D.map(u=>e.jsx(Q,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:n.processTypeId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:se.map(u=>e.jsx(Q,{value:u.lookUpId,children:u.lookUpName},u.lookUpId))})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(ge,{variant:"contained",size:"small",onClick:ce,disabled:n.productionStatus===3,children:"Save"})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(a,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(qe,{iColumns:K,initialRows:M,setInitialData:f,deleteApi:"http://100.42.177.77:83/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:Y,setAccordionExpanded:S,fileName:"AdditionalProcess",isLoading:j}),e.jsxs(nt,{open:ke,onClose:Ae,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(ye,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Additional Process > Assign Vendors "}),e.jsx(ze,{onClick:Ae,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(ya,{additionalProcessData:he,setAdditionalProcessData:Pe,refetchAdditionalProcessList:Y,handleClickOpen:je})]})]})]})})]})]})},Ma=Ca;function Sa({initialValues:r}){const[i,C]=o.useState(!0),{data:j}=_e(),[g,t]=o.useState([]),[f,n]=o.useState([]),[I,l]=o.useState([]),[S,W]=o.useState([]),[b,P]=o.useState([]),[p,T]=o.useState([]),{user:m}=Qe();o.useEffect(()=>{j&&(l(j.result[0].vendorList),n(j.result[0].serviceList),t(j.result[0].serviceTypeList),P(j.result[0].uomList))},[j]);const[O,ee]=o.useState({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()});o.useEffect(()=>{ee({...O,additionalServiceId:p.additionalServiceId||0,collectionId:(p==null?void 0:p.collectionId)||"",serviceTypeId:(p==null?void 0:p.serviceTypeId)||"",serviceListId:(p==null?void 0:p.serviceListId)||"",vendorId:(p==null?void 0:p.vendorId)||"",qty:(p==null?void 0:p.qty)||"",uomId:(p==null?void 0:p.uomId)||"",rate:(p==null?void 0:p.rate)||"",totalAmount:(p==null?void 0:p.totalAmount)||0,UOM:(p==null?void 0:p.uom)||0,uom:(p==null?void 0:p.uom)||"",createdOn:(p==null?void 0:p.createdOn)||new Date().toISOString(),createdBy:(p==null?void 0:p.createdBy)||m.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:m.empId})},[p]),o.useEffect(()=>{ee({...O,collectionId:(r==null?void 0:r.collectionId)||""})},[ee]),o.useEffect(()=>{O.productionStatus===3&&enqueueSnackbar("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[O.productionStatus]);const X=async h=>{const{name:U,value:E}=h.target;if(console.log(`Updating ${U} to ${E}`),ee({...O,[U]:E}),U==="collectionId"){const D=S.find(be=>be.collectionId===E);ee({...O,collectionId:E,productionStatus:D?D.productionStatus:""}),D&&ee(be=>({...be,poPcs:D.poPcs,productionStatus:D?D.productionStatus:""}))}};o.useEffect(()=>{const h=()=>{const E=parseFloat(O.qty)||0,D=parseFloat(O.rate)||0;return(E*D).toFixed(2)};ee(E=>({...E,totalAmount:h()}));const U=()=>{const E=parseFloat(O.poPcs)||0,D=parseFloat(O.totalAmount)||0;return(E/D).toFixed(2)};ee(E=>({...E,costperPiece:U()}))},[O.qty,O.rate,O.totalAmount,O.costperPiece]);const G=async()=>{try{const h=await Me.post("http://100.42.177.77:83/api/AdditionalServices/SaveAdditionalServices",O);console.log("Form data saved:",h.data),ee({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(h){console.error("Error saving data:",h)}};o.useEffect(()=>{(async()=>{try{const U=await Me.get("http://100.42.177.77:83/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",U),W(U.data.result)}catch(U){console.error("Error fetching design options:",U)}})()},[]);const[z,Y]=o.useState([]),ae=o.useCallback(async()=>{try{const h=await Me.get(`http://100.42.177.77:83/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${O.collectionId}`);Array.isArray(h.data.result)?(C(!1),Y(h.data.result.map((U,E)=>({id:E+1,...U})))):(console.error("API returned unexpected data format:",h.data.result),Y([]))}catch(h){console.error("Error fetching data:",h),Y([])}},[O.collectionId]);o.useEffect(()=>{ae()},[ae]);const[B,v]=o.useState(0);o.useEffect(()=>{const h=z.reduce((U,E)=>U+(E.totalAmount??0),0).toFixed(2);v(parseFloat(h).toLocaleString())},[z]);const H=[...z,{id:"TOTAL_SUMMARY",totalAmount:B}],oe=[{field:"id",headerName:"Sr#",colSpan:(h,U)=>U.id==="TOTAL_SUMMARY"?4:void 0,renderCell:h=>h.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):h.value},{field:"collectionName",headerName:"Collection Name"},{field:"serviceType",headerName:"Service Type",renderCell:h=>e.jsx(Ye,{label:h.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"serviceListName",headerName:"Service List Name",renderCell:h=>e.jsx(Ye,{label:h.value,sx:{backgroundColor:"success.dark",color:"white"},color:void 0})},{field:"vendor",headerName:"Vendor"},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount",colSpan:(h,U)=>U.id==="TOTAL_SUMMARY"?3:void 0,renderCell:h=>h.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:h.value}):h.value},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:O.collectionId,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:S.length>0?S.map(h=>e.jsx(Q,{id:"collectionId",value:h.collectionId,children:h.collectionName},h.collectionId)):e.jsx(Q,{disabled:!0,children:"No Collections Available"})})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:O.serviceTypeId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:g.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:O.serviceListId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:f.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:O.vendorId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:I.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:O.poPcs,onChange:X,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:h=>({...O.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Qty",name:"qty",value:O.qty,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:O.uomId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:b.map(h=>e.jsx(Q,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Rate",name:"rate",value:O.rate,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:O.totalAmount,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(c,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:O.costperPiece,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(ge,{variant:"contained",color:"primary",size:"small",disabled:O.productionStatus===3,onClick:G,children:"Save"})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(qe,{iColumns:oe,initialRows:H,isLoading:i,setInitialData:T,deleteApi:"http://100.42.177.77:83/api/AdditionalServices/DeleteAdditionalProcess?servicesId=",refetch:ae,deleteBy:"additionalServiceId"})]})]})}$o(Ko)(({theme:r})=>({backgroundColor:r.palette.primary.main,color:r.palette.primary.light,overflow:"hidden",position:"relative","&:after":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(210.04deg, ${r.palette.grey[400]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,borderRadius:"50%",top:-30,right:-180},"&:before":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(140.9deg, ${r.palette.grey[400]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,borderRadius:"50%",top:-160,right:-130}}));const Pa=({initialValues:r,setActiveStep:i,collectionId:C,setInitialValues:j})=>{var ke,Oe,je,Ae,Ne,we;const{user:g}=Qe(),{enqueueSnackbar:t}=We();o.useState([]);const{data:f}=$e(),[n,I]=o.useState(null),[l,S]=o.useState(!1);ct();const[W,b]=o.useState(!1),[P,p]=o.useState(C||""),[T,m]=o.useState({designId:"",planningHeaderId:"",batchNo:"",distinctId:"",collectionBatchId:"",collectionId:P||""}),O=M=>{he.current&&he.current.autosizeColumns&&he.current.autosizeColumns({includeOutliers:!0,includeHeaders:!0})},[ee,X]=o.useState([]),G=M=>{X(M),console.log("New Selection:",M)},{data:z,refetch:Y}=Xo(P,{skip:!P}),[ae,B]=o.useState([]),[v,H]=o.useState([]),[oe,pe]=o.useState([]);console.log("distinctData",z),o.useEffect(()=>{f&&pe(f.result)},[f]),o.useEffect(()=>{z&&(console.log("Distinct Data:",z.result),H(z||[]))},[z]);const h=M=>{const{name:K,value:Ie}=M.target;if(console.log(`handleChange called with name: ${K}, value: ${Ie}`),K==="collectionId")p(Ie),m({...T,collectionId:Ie,collectionBatchId:""}),Y(C);else if(K==="collectionBatchId")m({...T,collectionBatchId:Ie,planningHeaderId:T.planningHeaderId});else{const u={...T,[K]:Ie};m(u)}},{data:U,refetch:E}=Do({collectionId:T.collectionId,collectionBatchId:T.collectionBatchId},{skip:!T.collectionId||!T.collectionBatchId});o.useEffect(()=>{U&&U.length>0&&B(U)},[U]),console.log("Selected collection ID:",P),console.log("distinctCollectionList data:",v);const D=async M=>{S(!0);try{console.log("Fetching Summary Data for ID:",M);const K=await Me.get(`http://100.42.177.77:83/api/PrePlanning/GetPrePlanningSummaryByBatchId?planningHeaderId=${M}`);K.data.success?I(K.data.result):console.error(K.data.message)}catch(K){console.error("Failed to fetch summary data",K)}finally{S(!1)}};console.log("formData",T);const be=M=>{console.log("Selected PlanningHeaderId:",M),D(M),b(!0)},se=()=>{b(!1)},w=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"planningProcessTypeName",headerName:"Process Type"},{field:"componentsCount",headerName:"Components Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalFabricSum",headerName:"Total Fabric Sum",valueGetter:M=>M.toLocaleString()},{field:"totalFabricRequiredSum",headerName:"Total Fabric Required Sum",valueGetter:M=>M.toLocaleString()}],te=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalExcGst",headerName:"Total Excluding GST",valueGetter:M=>M.toLocaleString()},{field:"totalIncGst",headerName:"Total Including GST",valueGetter:M=>M.toLocaleString()}],k=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"processType",headerName:"Process Type"},{field:"assignedQtySum",headerName:"Assigned Qty Sum"},{field:"availableQtySum",headerName:"Available Qty Sum",valueGetter:M=>M.toLocaleString()},{field:"colorCount",headerName:"Color Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"outputQtySum",headerName:"Output Qty Sum"},{field:"totalIncGst",headerName:"Total Including GST",valueGetter:M=>M.toLocaleString()}],q=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150},{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150},{field:"requiredPcsSum",headerName:"Required Pcs Sum",width:150},{field:"totalAmountSum",headerName:"Total Amount Sum",valueGetter:M=>M.toLocaleString(),width:150}],F=[{field:"availableQtySum",headerName:"Available Qty Sum",valueGetter:M=>M.toLocaleString(),width:150},{field:"totalPcsSum",headerName:"Total Pcs Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150}],J=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"pcsPerComponent",headerName:"Pcs Per Component",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150}],de=[{field:"collectionName",headerName:"Collection Name"},{field:"batchNo",headerName:"Batch No"},{field:"designNo",headerName:"Design No"},{field:"orderNumber",headerName:"Order Number"},{field:"designerName",headerName:"Designer Name"},{field:"colorName",headerName:"Color Name"},{field:"poPcs",headerName:"PO Pieces"},{field:"batchStatusName",headerName:"Batch Status"},{field:"planningDate",headerName:"Planning Date",valueGetter:M=>new Date(M).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"action",headerName:"Action",renderCell:M=>e.jsx(bt,{variant:"outlined",size:"small","aria-label":"outlined primary button group",children:e.jsx(ge,{onClick:()=>be(M.row.planningHeaderId),children:"View"})}),sortable:!1,filterable:!1}],[ne,fe]=o.useState([]);o.useEffect(()=>{const M=(ae==null?void 0:ae.map((K,Ie)=>({id:K.planningHeaderId||Ie,...K})))||[];fe(M)},[ae]);const Z=((ke=n==null?void 0:n.prePlanningList)==null?void 0:ke.map((M,K)=>({id:K,...M})))||[],V=((Oe=n==null?void 0:n.fabricationList)==null?void 0:Oe.map((M,K)=>({id:K,...M})))||[],le=((je=n==null?void 0:n.dyeingPrintingList)==null?void 0:je.map((M,K)=>({id:K,...M})))||[],R=((Ae=n==null?void 0:n.embroideryList)==null?void 0:Ae.map((M,K)=>({id:K,...M})))||[],L=((Ne=n==null?void 0:n.schiffiliList)==null?void 0:Ne.map((M,K)=>({id:K,...M})))||[],ce=((we=n==null?void 0:n.additionalProcessList)==null?void 0:we.map((M,K)=>({id:K,...M})))||[],he=aa(),Pe=async()=>{if(ee.length===0){t("No rows selected",{variant:"warning"});return}const M=ee,K={planningHeaderId:M,collectionBatchId:T.collectionBatchId,createdBy:g.empId,batchStatus:3};try{(await Me.post("http://100.42.177.77:83/api/PrePlanning/FinalizePrePlanningBatch",K)).data===!0?(t("Pre Planning Finalized successfully",{variant:"success"}),console.log("requestbody",K),fe(u=>u.filter(d=>!M.includes(d.id)))):t("Failed to save data",{variant:"error"})}catch(Ie){console.error("Failed to save data",Ie),t("Failed to save data",{variant:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:T.collectionId,onChange:h,size:"small",InputLabelProps:{sx:{color:"black"}},children:oe.map(M=>e.jsx(Q,{value:M.collectionId,children:M.collectionName},M.collectionId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Collection Batch",name:"collectionBatchId",value:T.collectionBatchId,onChange:h,size:"small",InputLabelProps:{sx:{color:"black"}},children:v.length>0?v.map(M=>e.jsx(Q,{value:M.collectionBatchId,children:M.distinctId},M.collectionBatchId)):e.jsx(Q,{disabled:!0,children:"No batches available"})})}),e.jsx(a,{item:!0,xs:4,textAlign:"right",sx:{mt:1},children:e.jsx(ge,{variant:"contained",size:"small",onClick:Pe,color:"success",children:"Finalize"})})]})]}),e.jsx(a,{item:!0,xs:12,md:12,mb:1}),e.jsxs(Se,{variant:"outlined",children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(a,{container:!0,spacing:1,width:"inherit",sx:{paddingY:1,paddingX:1},children:[e.jsx(a,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(Ge,{rows:ne,columns:de,checkboxSelection:!0,getRowId:M=>M.id,disableRowSelectionOnClick:!0,autosizeOnMount:!0,apiRef:he,onStateChange:O,onRowSelectionModelChange:M=>G(M)})}),e.jsxs(nt,{open:W,onClose:se,maxWidth:"lg",fullWidth:!0,children:[e.jsx(Ce,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsx(st,{children:l?e.jsx(Re,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(Mt,{})}):n?e.jsxs(e.Fragment,{children:[e.jsx(ye,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(0),children:"Pre Planning"}),e.jsx(Ge,{rows:Z,columns:w,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,onStateChange:O,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:3,width:"100%",mb:1}}),e.jsx(ye,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(1),children:"Fabrication"}),e.jsx(Ge,{rows:V,columns:te,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mt:1,mb:1}}),e.jsx(ye,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(2),children:"Dyeing"}),e.jsx(Ge,{rows:le,columns:k,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(ye,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(3),children:"Embroidery"}),e.jsx(Ge,{rows:R,columns:q,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(ye,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(4),children:"Schiffli"}),e.jsx(Ge,{rows:L,columns:F,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(me,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(ye,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>i(5),children:"Additional Process"}),e.jsx(Ge,{rows:ce,columns:J,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}})]}):e.jsx(Mt,{})}),e.jsx(ra,{children:e.jsx(ge,{onClick:se,children:"Close"})})]})]})]})]})},jt=Pa;var ja={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},vt=ja,ka=vt;function Oa(r){return!!(r&&ka[typeof r])}var lt=Oa,Aa=Object.prototype,Na=Aa.toString,wa=RegExp("^"+String(Na).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),it=wa,La=vt,Ta=Object.prototype,Ba=Ta.hasOwnProperty,Fa=function(r){var i,C=r,j=[];if(!C||!La[typeof r])return j;for(i in C)Ba.call(C,i)&&j.push(i);return j},Ra=Fa,za=lt,Qa=it,Wa=Ra,tt=Qa.test(tt=Object.keys)&&tt,_a=tt?function(r){return za(r)?tt(r):[]}:Wa,Ht=_a;function Ua(){}var Ha=Ua,qt=lt,qa=it,ot=qa.test(ot=Object.create)&&ot;function Et(r,i){return qt(r)?ot(r):{}}ot||(Et=function(){function r(){}return function(i){if(qt(i)){r.prototype=i;var C=new r;r.prototype=null}return C||window.Object()}}());var Gt=Et,Ea=Ha,Ga=it,kt={configurable:!1,enumerable:!1,value:null,writable:!1},Ot=function(){try{var r={},i=Ga.test(i=Object.defineProperty)&&i,C=i(r,r,r)&&i}catch{}return C}(),Ya=Ot?function(r,i){kt.value=i,Ot(r,"__bindData__",kt)}:Ea,yt=Ya,Va=Gt,$a=lt,Ka=yt,Xa=[],Da=Xa.push;function Ja(r){var i=r[0],C=r[2],j=r[4];function g(){if(C){var t=C.slice();Da.apply(t,arguments)}if(this instanceof g){var f=Va(i.prototype),n=i.apply(f,t||arguments);return $a(n)?n:f}return i.apply(j,t||arguments)}return Ka(g,r),g}var Za=Ja;function er(r,i,C){i||(i=0),typeof C>"u"&&(C=r?r.length:0);for(var j=-1,g=C-i||0,t=Array(g<0?0:g);++j<g;)t[j]=r[i+j];return t}var Yt=er,tr=Gt,or=lt,ar=yt,rr=Yt,nr=[],At=nr.push;function Vt(r){var i=r[0],C=r[1],j=r[2],g=r[3],t=r[4],f=r[5],n=C&1,I=C&2,l=C&4,S=C&8,W=i;function b(){var P=n?t:this;if(j){var p=j.slice();At.apply(p,arguments)}if((g||l)&&(p||(p=rr(arguments)),g&&At.apply(p,g),l&&p.length<f))return C|=16,Vt([i,S?C:C&-4,p,null,t,f]);if(p||(p=arguments),I&&(i=P[W]),this instanceof b){P=tr(i.prototype);var T=i.apply(P,p);return or(T)?T:P}return i.apply(P,p)}return ar(b,r),b}var sr=Vt;function lr(r){return typeof r=="function"}var ir=lr,dr=Za,cr=sr,ur=ir,pr=[],Nt=pr.push;function $t(r,i,C,j,g,t){var f=i&1,n=i&2,I=i&4,l=i&16,S=i&32;if(!n&&!ur(r))throw new TypeError;l&&!C.length&&(i&=-17,l=C=!1),S&&!j.length&&(i&=-33,S=j=!1);var W=r&&r.__bindData__;if(W&&W!==!0)return W=W.slice(),f&&!(W[1]&1)&&(W[4]=g),!f&&W[1]&1&&(i|=8),I&&!(W[1]&4)&&(W[5]=t),l&&Nt.apply(W[2]||(W[2]=[]),C),S&&Nt.apply(W[3]||(W[3]=[]),j),W[1]|=i,$t.apply(null,W);var b=i==1||i===17?dr:cr;return b([r,i,C,j,g,t])}var mr=$t,wt=mr,hr=Yt;function gr(r,i){return arguments.length>2?wt(r,17,hr(arguments,2),null,i):wt(r,1,null,null,i)}var br=gr;function fr(r){return r}var Ir=fr,xr=it,vr=/\bthis\b/,Ct={};Ct.funcDecomp=!xr.test(window.WinRTError)&&vr.test(function(){return this});Ct.funcNames=typeof Function.name=="string";var yr=Ct,Cr=br,Mr=Ir,Sr=yt,dt=yr,Pr=/^\s*function[ \n\r\t]+\w/,jr=/\bthis\b/,kr=Function.prototype.toString;function Or(r,i,C){if(typeof r!="function")return Mr;if(typeof i>"u"||!("prototype"in r))return r;var j=r.__bindData__;if(typeof j>"u"&&(dt.funcNames&&(j=!r.name),j=j||!dt.funcDecomp,!j)){var g=kr.call(r);dt.funcNames||(j=!Pr.test(g)),j||(j=jr.test(g),Sr(r,j))}if(j===!1||j!==!0&&j[1]&1)return r;switch(C){case 1:return function(t){return r.call(i,t)};case 2:return function(t,f){return r.call(i,t,f)};case 3:return function(t,f,n){return r.call(i,t,f,n)};case 4:return function(t,f,n,I){return r.call(i,t,f,n,I)}}return Cr(r,i)}var Kt=Or,Ar=Kt,Nr=Ht,Lt=vt,wr=function(r,i,C){var j,g=r,t=g;if(!g||!Lt[typeof g])return t;i=i&&typeof C>"u"?i:Ar(i,C,3);for(var f=-1,n=Lt[typeof g]&&Nr(g),I=n?n.length:0;++f<I;)if(j=n[f],i(g[j],j,r)===!1)return t;return t},Lr=wr,Tr=Kt,Br=Lr;function Fr(r,i,C){var j=-1,g=r?r.length:0;if(i=i&&typeof C>"u"?i:Tr(i,C,3),typeof g=="number")for(;++j<g&&i(r[j],j,r)!==!1;);else Br(r,i);return r}var Rr=Fr,Xt,Dt;Xt={mm:{name:{singular:"Millimeter",plural:"Millimeters"},to_anchor:1/1e3},cm:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1/100},m:{name:{singular:"Meter",plural:"Meters"},to_anchor:1},km:{name:{singular:"Kilometer",plural:"Kilometers"},to_anchor:1e3}};Dt={in:{name:{singular:"Inch",plural:"Inches"},to_anchor:1/12},yd:{name:{singular:"Yard",plural:"Yards"},to_anchor:3},"ft-us":{name:{singular:"US Survey Foot",plural:"US Survey Feet"},to_anchor:1.000002},ft:{name:{singular:"Foot",plural:"Feet"},to_anchor:1},mi:{name:{singular:"Mile",plural:"Miles"},to_anchor:5280}};var zr={metric:Xt,imperial:Dt,_anchors:{metric:{unit:"m",ratio:3.28084},imperial:{unit:"ft",ratio:1/3.28084}}},Jt,Zt;Jt={mm2:{name:{singular:"Square Millimeter",plural:"Square Millimeters"},to_anchor:1/1e6},cm2:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1/1e4},m2:{name:{singular:"Square Meter",plural:"Square Meters"},to_anchor:1},ha:{name:{singular:"Hectare",plural:"Hectares"},to_anchor:1e4},km2:{name:{singular:"Square Kilometer",plural:"Square Kilometers"},to_anchor:1e6}};Zt={in2:{name:{singular:"Square Inch",plural:"Square Inches"},to_anchor:1/144},yd2:{name:{singular:"Square Yard",plural:"Square Yards"},to_anchor:9},ft2:{name:{singular:"Square Foot",plural:"Square Feet"},to_anchor:1},ac:{name:{singular:"Acre",plural:"Acres"},to_anchor:43560},mi2:{name:{singular:"Square Mile",plural:"Square Miles"},to_anchor:27878400}};var Qr={metric:Jt,imperial:Zt,_anchors:{metric:{unit:"m2",ratio:10.7639},imperial:{unit:"ft2",ratio:1/10.7639}}},eo,to;eo={mcg:{name:{singular:"Microgram",plural:"Micrograms"},to_anchor:1/1e6},mg:{name:{singular:"Milligram",plural:"Milligrams"},to_anchor:1/1e3},g:{name:{singular:"Gram",plural:"Grams"},to_anchor:1},kg:{name:{singular:"Kilogram",plural:"Kilograms"},to_anchor:1e3},mt:{name:{singular:"Metric Tonne",plural:"Metric Tonnes"},to_anchor:1e6}};to={oz:{name:{singular:"Ounce",plural:"Ounces"},to_anchor:1/16},lb:{name:{singular:"Pound",plural:"Pounds"},to_anchor:1},t:{name:{singular:"Ton",plural:"Tons"},to_anchor:2e3}};var Wr={metric:eo,imperial:to,_anchors:{metric:{unit:"g",ratio:1/453.592},imperial:{unit:"lb",ratio:453.592}}},oo,ao;oo={mm3:{name:{singular:"Cubic Millimeter",plural:"Cubic Millimeters"},to_anchor:1/1e6},cm3:{name:{singular:"Cubic Centimeter",plural:"Cubic Centimeters"},to_anchor:1/1e3},ml:{name:{singular:"Millilitre",plural:"Millilitres"},to_anchor:1/1e3},cl:{name:{singular:"Centilitre",plural:"Centilitres"},to_anchor:1/100},dl:{name:{singular:"Decilitre",plural:"Decilitres"},to_anchor:1/10},l:{name:{singular:"Litre",plural:"Litres"},to_anchor:1},kl:{name:{singular:"Kilolitre",plural:"Kilolitres"},to_anchor:1e3},m3:{name:{singular:"Cubic meter",plural:"Cubic meters"},to_anchor:1e3},km3:{name:{singular:"Cubic kilometer",plural:"Cubic kilometers"},to_anchor:1e12},krm:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:1/1e3},tsk:{name:{singular:"Tesked",plural:"Teskedar"},to_anchor:5/1e3},msk:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:15/1e3},kkp:{name:{singular:"Kaffekopp",plural:"Kaffekoppar"},to_anchor:150/1e3},glas:{name:{singular:"Glas",plural:"Glas"},to_anchor:200/1e3},kanna:{name:{singular:"Kanna",plural:"Kannor"},to_anchor:2.617}};ao={tsp:{name:{singular:"Teaspoon",plural:"Teaspoons"},to_anchor:1/6},Tbs:{name:{singular:"Tablespoon",plural:"Tablespoons"},to_anchor:1/2},in3:{name:{singular:"Cubic inch",plural:"Cubic inches"},to_anchor:.55411},"fl-oz":{name:{singular:"Fluid Ounce",plural:"Fluid Ounces"},to_anchor:1},cup:{name:{singular:"Cup",plural:"Cups"},to_anchor:8},pnt:{name:{singular:"Pint",plural:"Pints"},to_anchor:16},qt:{name:{singular:"Quart",plural:"Quarts"},to_anchor:32},gal:{name:{singular:"Gallon",plural:"Gallons"},to_anchor:128},ft3:{name:{singular:"Cubic foot",plural:"Cubic feet"},to_anchor:957.506},yd3:{name:{singular:"Cubic yard",plural:"Cubic yards"},to_anchor:25852.7}};var _r={metric:oo,imperial:ao,_anchors:{metric:{unit:"l",ratio:33.8140226},imperial:{unit:"fl-oz",ratio:1/33.8140226}}},ro;ro={ea:{name:{singular:"Each",plural:"Each"},to_anchor:1},dz:{name:{singular:"Dozen",plural:"Dozens"},to_anchor:12}};var Ur={metric:ro,imperial:{},_anchors:{metric:{unit:"ea",ratio:1}}},no,so;no={C:{name:{singular:"degree Celsius",plural:"degrees Celsius"},to_anchor:1,anchor_shift:0},K:{name:{singular:"degree Kelvin",plural:"degrees Kelvin"},to_anchor:1,anchor_shift:273.15}};so={F:{name:{singular:"degree Fahrenheit",plural:"degrees Fahrenheit"},to_anchor:1},R:{name:{singular:"degree Rankine",plural:"degrees Rankine"},to_anchor:1,anchor_shift:459.67}};var Hr={metric:no,imperial:so,_anchors:{metric:{unit:"C",transform:function(r){return r/(5/9)+32}},imperial:{unit:"F",transform:function(r){return(r-32)*(5/9)}}}},lo,Tt=365.25;lo={ns:{name:{singular:"Nanosecond",plural:"Nanoseconds"},to_anchor:1/1e9},mu:{name:{singular:"Microsecond",plural:"Microseconds"},to_anchor:1/1e6},ms:{name:{singular:"Millisecond",plural:"Milliseconds"},to_anchor:1/1e3},s:{name:{singular:"Second",plural:"Seconds"},to_anchor:1},min:{name:{singular:"Minute",plural:"Minutes"},to_anchor:60},h:{name:{singular:"Hour",plural:"Hours"},to_anchor:60*60},d:{name:{singular:"Day",plural:"Days"},to_anchor:60*60*24},week:{name:{singular:"Week",plural:"Weeks"},to_anchor:60*60*24*7},month:{name:{singular:"Month",plural:"Months"},to_anchor:60*60*24*Tt/12},year:{name:{singular:"Year",plural:"Years"},to_anchor:60*60*24*Tt}};var qr={metric:lo,_anchors:{metric:{unit:"s",ratio:1}}},io,co;io={b:{name:{singular:"Bit",plural:"Bits"},to_anchor:1},Kb:{name:{singular:"Kilobit",plural:"Kilobits"},to_anchor:1024},Mb:{name:{singular:"Megabit",plural:"Megabits"},to_anchor:1048576},Gb:{name:{singular:"Gigabit",plural:"Gigabits"},to_anchor:1073741824},Tb:{name:{singular:"Terabit",plural:"Terabits"},to_anchor:1099511627776}};co={B:{name:{singular:"Byte",plural:"Bytes"},to_anchor:1},KB:{name:{singular:"Kilobyte",plural:"Kilobytes"},to_anchor:1024},MB:{name:{singular:"Megabyte",plural:"Megabytes"},to_anchor:1048576},GB:{name:{singular:"Gigabyte",plural:"Gigabytes"},to_anchor:1073741824},TB:{name:{singular:"Terabyte",plural:"Terabytes"},to_anchor:1099511627776}};var Er={bits:io,bytes:co,_anchors:{bits:{unit:"b",ratio:1/8},bytes:{unit:"B",ratio:8}}},uo;uo={ppm:{name:{singular:"Part-per Million",plural:"Parts-per Million"},to_anchor:1},ppb:{name:{singular:"Part-per Billion",plural:"Parts-per Billion"},to_anchor:.001},ppt:{name:{singular:"Part-per Trillion",plural:"Parts-per Trillion"},to_anchor:1e-6},ppq:{name:{singular:"Part-per Quadrillion",plural:"Parts-per Quadrillion"},to_anchor:1e-9}};var Gr={metric:uo,imperial:{},_anchors:{metric:{unit:"ppm",ratio:1e-6}}},po,mo;po={"m/s":{name:{singular:"Metre per second",plural:"Metres per second"},to_anchor:3.6},"km/h":{name:{singular:"Kilometre per hour",plural:"Kilometres per hour"},to_anchor:1}};mo={"m/h":{name:{singular:"Mile per hour",plural:"Miles per hour"},to_anchor:1},knot:{name:{singular:"Knot",plural:"Knots"},to_anchor:1.150779},"ft/s":{name:{singular:"Foot per second",plural:"Feet per second"},to_anchor:.681818}};var Yr={metric:po,imperial:mo,_anchors:{metric:{unit:"km/h",ratio:1/1.609344},imperial:{unit:"m/h",ratio:1.609344}}},ho,go;ho={"min/km":{name:{singular:"Minute per kilometre",plural:"Minutes per kilometre"},to_anchor:.06},"s/m":{name:{singular:"Second per metre",plural:"Seconds per metre"},to_anchor:1}};go={"min/mi":{name:{singular:"Minute per mile",plural:"Minutes per mile"},to_anchor:.0113636},"s/ft":{name:{singular:"Second per foot",plural:"Seconds per foot"},to_anchor:1}};var Vr={metric:ho,imperial:go,_anchors:{metric:{unit:"s/m",ratio:.3048},imperial:{unit:"s/ft",ratio:1/.3048}}},bo,fo;bo={Pa:{name:{singular:"pascal",plural:"pascals"},to_anchor:1/1e3},kPa:{name:{singular:"kilopascal",plural:"kilopascals"},to_anchor:1},MPa:{name:{singular:"megapascal",plural:"megapascals"},to_anchor:1e3},hPa:{name:{singular:"hectopascal",plural:"hectopascals"},to_anchor:1/10},bar:{name:{singular:"bar",plural:"bar"},to_anchor:100},torr:{name:{singular:"torr",plural:"torr"},to_anchor:101325/76e4}};fo={psi:{name:{singular:"pound per square inch",plural:"pounds per square inch"},to_anchor:1/1e3},ksi:{name:{singular:"kilopound per square inch",plural:"kilopound per square inch"},to_anchor:1}};var $r={metric:bo,imperial:fo,_anchors:{metric:{unit:"kPa",ratio:.00014503768078},imperial:{unit:"psi",ratio:1/.00014503768078}}},Io;Io={A:{name:{singular:"Ampere",plural:"Amperes"},to_anchor:1},mA:{name:{singular:"Milliampere",plural:"Milliamperes"},to_anchor:.001},kA:{name:{singular:"Kiloampere",plural:"Kiloamperes"},to_anchor:1e3}};var Kr={metric:Io,_anchors:{metric:{unit:"A",ratio:1}}},xo;xo={V:{name:{singular:"Volt",plural:"Volts"},to_anchor:1},mV:{name:{singular:"Millivolt",plural:"Millivolts"},to_anchor:.001},kV:{name:{singular:"Kilovolt",plural:"Kilovolts"},to_anchor:1e3}};var Xr={metric:xo,_anchors:{metric:{unit:"V",ratio:1}}},vo;vo={W:{name:{singular:"Watt",plural:"Watts"},to_anchor:1},mW:{name:{singular:"Milliwatt",plural:"Milliwatts"},to_anchor:.001},kW:{name:{singular:"Kilowatt",plural:"Kilowatts"},to_anchor:1e3},MW:{name:{singular:"Megawatt",plural:"Megawatts"},to_anchor:1e6},GW:{name:{singular:"Gigawatt",plural:"Gigawatts"},to_anchor:1e9}};var Dr={metric:vo,_anchors:{metric:{unit:"W",ratio:1}}},yo;yo={VAR:{name:{singular:"Volt-Ampere Reactive",plural:"Volt-Amperes Reactive"},to_anchor:1},mVAR:{name:{singular:"Millivolt-Ampere Reactive",plural:"Millivolt-Amperes Reactive"},to_anchor:.001},kVAR:{name:{singular:"Kilovolt-Ampere Reactive",plural:"Kilovolt-Amperes Reactive"},to_anchor:1e3},MVAR:{name:{singular:"Megavolt-Ampere Reactive",plural:"Megavolt-Amperes Reactive"},to_anchor:1e6},GVAR:{name:{singular:"Gigavolt-Ampere Reactive",plural:"Gigavolt-Amperes Reactive"},to_anchor:1e9}};var Jr={metric:yo,_anchors:{metric:{unit:"VAR",ratio:1}}},Co;Co={VA:{name:{singular:"Volt-Ampere",plural:"Volt-Amperes"},to_anchor:1},mVA:{name:{singular:"Millivolt-Ampere",plural:"Millivolt-Amperes"},to_anchor:.001},kVA:{name:{singular:"Kilovolt-Ampere",plural:"Kilovolt-Amperes"},to_anchor:1e3},MVA:{name:{singular:"Megavolt-Ampere",plural:"Megavolt-Amperes"},to_anchor:1e6},GVA:{name:{singular:"Gigavolt-Ampere",plural:"Gigavolt-Amperes"},to_anchor:1e9}};var Zr={metric:Co,_anchors:{metric:{unit:"VA",ratio:1}}},Mo;Mo={Wh:{name:{singular:"Watt-hour",plural:"Watt-hours"},to_anchor:3600},mWh:{name:{singular:"Milliwatt-hour",plural:"Milliwatt-hours"},to_anchor:3.6},kWh:{name:{singular:"Kilowatt-hour",plural:"Kilowatt-hours"},to_anchor:36e5},MWh:{name:{singular:"Megawatt-hour",plural:"Megawatt-hours"},to_anchor:36e8},GWh:{name:{singular:"Gigawatt-hour",plural:"Gigawatt-hours"},to_anchor:36e11},J:{name:{singular:"Joule",plural:"Joules"},to_anchor:1},kJ:{name:{singular:"Kilojoule",plural:"Kilojoules"},to_anchor:1e3}};var en={metric:Mo,_anchors:{metric:{unit:"J",ratio:1}}},So;So={VARh:{name:{singular:"Volt-Ampere Reactive Hour",plural:"Volt-Amperes Reactive Hour"},to_anchor:1},mVARh:{name:{singular:"Millivolt-Ampere Reactive Hour",plural:"Millivolt-Amperes Reactive Hour"},to_anchor:.001},kVARh:{name:{singular:"Kilovolt-Ampere Reactive Hour",plural:"Kilovolt-Amperes Reactive Hour"},to_anchor:1e3},MVARh:{name:{singular:"Megavolt-Ampere Reactive Hour",plural:"Megavolt-Amperes Reactive Hour"},to_anchor:1e6},GVARh:{name:{singular:"Gigavolt-Ampere Reactive Hour",plural:"Gigavolt-Amperes Reactive Hour"},to_anchor:1e9}};var tn={metric:So,_anchors:{metric:{unit:"VARh",ratio:1}}},Po,jo;Po={"mm3/s":{name:{singular:"Cubic Millimeter per second",plural:"Cubic Millimeters per second"},to_anchor:1/1e6},"cm3/s":{name:{singular:"Cubic Centimeter per second",plural:"Cubic Centimeters per second"},to_anchor:1/1e3},"ml/s":{name:{singular:"Millilitre per second",plural:"Millilitres per second"},to_anchor:1/1e3},"cl/s":{name:{singular:"Centilitre per second",plural:"Centilitres per second"},to_anchor:1/100},"dl/s":{name:{singular:"Decilitre per second",plural:"Decilitres per second"},to_anchor:1/10},"l/s":{name:{singular:"Litre per second",plural:"Litres per second"},to_anchor:1},"l/min":{name:{singular:"Litre per minute",plural:"Litres per minute"},to_anchor:1/60},"l/h":{name:{singular:"Litre per hour",plural:"Litres per hour"},to_anchor:1/3600},"kl/s":{name:{singular:"Kilolitre per second",plural:"Kilolitres per second"},to_anchor:1e3},"kl/min":{name:{singular:"Kilolitre per minute",plural:"Kilolitres per minute"},to_anchor:50/3},"kl/h":{name:{singular:"Kilolitre per hour",plural:"Kilolitres per hour"},to_anchor:5/18},"m3/s":{name:{singular:"Cubic meter per second",plural:"Cubic meters per second"},to_anchor:1e3},"m3/min":{name:{singular:"Cubic meter per minute",plural:"Cubic meters per minute"},to_anchor:50/3},"m3/h":{name:{singular:"Cubic meter per hour",plural:"Cubic meters per hour"},to_anchor:5/18},"km3/s":{name:{singular:"Cubic kilometer per second",plural:"Cubic kilometers per second"},to_anchor:1e12}};jo={"tsp/s":{name:{singular:"Teaspoon per second",plural:"Teaspoons per second"},to_anchor:1/6},"Tbs/s":{name:{singular:"Tablespoon per second",plural:"Tablespoons per second"},to_anchor:1/2},"in3/s":{name:{singular:"Cubic inch per second",plural:"Cubic inches per second"},to_anchor:.55411},"in3/min":{name:{singular:"Cubic inch per minute",plural:"Cubic inches per minute"},to_anchor:.55411/60},"in3/h":{name:{singular:"Cubic inch per hour",plural:"Cubic inches per hour"},to_anchor:.55411/3600},"fl-oz/s":{name:{singular:"Fluid Ounce per second",plural:"Fluid Ounces per second"},to_anchor:1},"fl-oz/min":{name:{singular:"Fluid Ounce per minute",plural:"Fluid Ounces per minute"},to_anchor:1/60},"fl-oz/h":{name:{singular:"Fluid Ounce per hour",plural:"Fluid Ounces per hour"},to_anchor:1/3600},"cup/s":{name:{singular:"Cup per second",plural:"Cups per second"},to_anchor:8},"pnt/s":{name:{singular:"Pint per second",plural:"Pints per second"},to_anchor:16},"pnt/min":{name:{singular:"Pint per minute",plural:"Pints per minute"},to_anchor:4/15},"pnt/h":{name:{singular:"Pint per hour",plural:"Pints per hour"},to_anchor:1/225},"qt/s":{name:{singular:"Quart per second",plural:"Quarts per second"},to_anchor:32},"gal/s":{name:{singular:"Gallon per second",plural:"Gallons per second"},to_anchor:128},"gal/min":{name:{singular:"Gallon per minute",plural:"Gallons per minute"},to_anchor:32/15},"gal/h":{name:{singular:"Gallon per hour",plural:"Gallons per hour"},to_anchor:8/225},"ft3/s":{name:{singular:"Cubic foot per second",plural:"Cubic feet per second"},to_anchor:957.506},"ft3/min":{name:{singular:"Cubic foot per minute",plural:"Cubic feet per minute"},to_anchor:957.506/60},"ft3/h":{name:{singular:"Cubic foot per hour",plural:"Cubic feet per hour"},to_anchor:957.506/3600},"yd3/s":{name:{singular:"Cubic yard per second",plural:"Cubic yards per second"},to_anchor:25852.7},"yd3/min":{name:{singular:"Cubic yard per minute",plural:"Cubic yards per minute"},to_anchor:25852.7/60},"yd3/h":{name:{singular:"Cubic yard per hour",plural:"Cubic yards per hour"},to_anchor:25852.7/3600}};var on={metric:Po,imperial:jo,_anchors:{metric:{unit:"l/s",ratio:33.8140227},imperial:{unit:"fl-oz/s",ratio:1/33.8140227}}},ko,Oo;ko={lx:{name:{singular:"Lux",plural:"Lux"},to_anchor:1}};Oo={"ft-cd":{name:{singular:"Foot-candle",plural:"Foot-candles"},to_anchor:1}};var an={metric:ko,imperial:Oo,_anchors:{metric:{unit:"lx",ratio:1/10.76391},imperial:{unit:"ft-cd",ratio:10.76391}}},Ao;Ao={mHz:{name:{singular:"millihertz",plural:"millihertz"},to_anchor:1/1e3},Hz:{name:{singular:"hertz",plural:"hertz"},to_anchor:1},kHz:{name:{singular:"kilohertz",plural:"kilohertz"},to_anchor:1e3},MHz:{name:{singular:"megahertz",plural:"megahertz"},to_anchor:1e3*1e3},GHz:{name:{singular:"gigahertz",plural:"gigahertz"},to_anchor:1e3*1e3*1e3},THz:{name:{singular:"terahertz",plural:"terahertz"},to_anchor:1e3*1e3*1e3*1e3},rpm:{name:{singular:"rotation per minute",plural:"rotations per minute"},to_anchor:1/60},"deg/s":{name:{singular:"degree per second",plural:"degrees per second"},to_anchor:1/360},"rad/s":{name:{singular:"radian per second",plural:"radians per second"},to_anchor:1/(Math.PI*2)}};var rn={metric:Ao,_anchors:{frequency:{unit:"hz",ratio:1}}},No;No={rad:{name:{singular:"radian",plural:"radians"},to_anchor:180/Math.PI},deg:{name:{singular:"degree",plural:"degrees"},to_anchor:1},grad:{name:{singular:"gradian",plural:"gradians"},to_anchor:9/10},arcmin:{name:{singular:"arcminute",plural:"arcminutes"},to_anchor:1/60},arcsec:{name:{singular:"arcsecond",plural:"arcseconds"},to_anchor:1/3600}};var nn={metric:No,_anchors:{metric:{unit:"deg",ratio:1}}},wo,Ke=Ht,Te=Rr,He={length:zr,area:Qr,mass:Wr,volume:_r,each:Ur,temperature:Hr,time:qr,digital:Er,partsPer:Gr,speed:Yr,pace:Vr,pressure:$r,current:Kr,voltage:Xr,power:Dr,reactivePower:Jr,apparentPower:Zr,energy:en,reactiveEnergy:tn,volumeFlowRate:on,illuminance:an,frequency:rn,angle:nn},Be;Be=function(r,i){i?this.val=r/i:this.val=r};Be.prototype.from=function(r){if(this.destination)throw new Error(".from must be called before .to");return this.origin=this.getUnit(r),this.origin||this.throwUnsupportedUnitError(r),this};Be.prototype.to=function(r){if(!this.origin)throw new Error(".to must be called after .from");this.destination=this.getUnit(r);var i,C;if(this.destination||this.throwUnsupportedUnitError(r),this.origin.abbr===this.destination.abbr)return this.val;if(this.destination.measure!=this.origin.measure)throw new Error("Cannot convert incompatible measures of "+this.destination.measure+" and "+this.origin.measure);return i=this.val*this.origin.unit.to_anchor,this.origin.unit.anchor_shift&&(i-=this.origin.unit.anchor_shift),this.origin.system!=this.destination.system&&(C=He[this.origin.measure]._anchors[this.origin.system].transform,typeof C=="function"?i=C(i):i*=He[this.origin.measure]._anchors[this.origin.system].ratio),this.destination.unit.anchor_shift&&(i+=this.destination.unit.anchor_shift),i/this.destination.unit.to_anchor};Be.prototype.toBest=function(i){if(!this.origin)throw new Error(".toBest must be called after .from");var i=Object.assign({exclude:[],cutOffNumber:1},i),C;return Te(this.possibilities(),(function(j){var g=this.describe(j),t=i.exclude.indexOf(j)===-1;if(t&&g.system===this.origin.system){var f=this.to(j);(!C||f>=i.cutOffNumber&&f<C.val)&&(C={val:f,unit:j,singular:g.singular,plural:g.plural})}}).bind(this)),C};Be.prototype.getUnit=function(r){var i;return Te(He,function(C,j){if(Te(C,function(g,t){if(t=="_anchors"||(Te(g,function(f,n){if(n==r)return i={abbr:r,measure:j,system:t,unit:f},!1}),i))return!1}),i)return!1}),i};var Lo=function(r){return{abbr:r.abbr,measure:r.measure,system:r.system,singular:r.unit.name.singular,plural:r.unit.name.plural}};Be.prototype.describe=function(r){var i=Be.prototype.getUnit(r),C=null;try{C=Lo(i)}catch{this.throwUnsupportedUnitError(r)}return C};Be.prototype.list=function(r){var i=[];return Te(He,function(C,j){r&&r!==j||Te(C,function(g,t){if(t=="_anchors")return!1;Te(g,function(f,n){i=i.concat(Lo({abbr:n,measure:j,system:t,unit:f}))})})}),i};Be.prototype.throwUnsupportedUnitError=function(r){var i=[];throw Te(He,function(C,j){Te(C,function(g,t){if(t=="_anchors")return!1;i=i.concat(Ke(g))})}),new Error("Unsupported unit "+r+", use one of: "+i.join(", "))};Be.prototype.possibilities=function(r){var i=[];return!this.origin&&!r?Te(Ke(He),function(C){Te(He[C],function(j,g){if(g=="_anchors")return!1;i=i.concat(Ke(j))})}):(r=r||this.origin.measure,Te(He[r],function(C,j){if(j=="_anchors")return!1;i=i.concat(Ke(C))})),i};Be.prototype.measures=function(){return Ke(He)};wo=function(r){return new Be(r)};var sn=wo;const De=Jo(sn),Je=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services","Summary"];function vn(){const[r,i]=o.useState(0),[C,j]=o.useState(new Set),[g,t]=o.useState(null),[f,n]=o.useState(null),[I,l]=o.useState([]),{enqueueSnackbar:S}=We(),{data:W,refetch:b}=_e(),[P,p]=o.useState({}),[T,m]=o.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),[O,ee]=o.useState({fromUnit:"m",toUnit:"cm",inputValue:"",outputValue:""}),X=w=>{t(w.currentTarget)},G=w=>{n(w.currentTarget)},z=()=>{t(null),n(null),ee({fromUnit:"m",toUnit:"cm",inputValue:"",outputValue:""})},Y=w=>w===1,ae=w=>C.has(w),B=()=>{let w=C;ae(r)&&(w=new Set(w.values()),w.delete(r)),i(te=>te+1),j(w)},v=()=>{i(w=>w-1)},H=()=>{if(!Y(r))throw new Error("You can't skip a step that isn't optional.");i(w=>w+1),j(w=>{const te=new Set(w.values());return te.add(r),te})},oe=()=>{i(0)};o.useEffect(()=>{(async()=>{try{const te=await Me.get("http://100.42.177.77:83/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",te),l(te.data.result)}catch(te){console.error("Error fetching design options:",te)}})()},[]);const pe=async()=>{if(!T.lookUpDomain||!T.lookUpName){S("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const w=await Me.get(`http://100.42.177.77:83/api/Common/SaveLookUp?lookupDomain=${T.lookUpDomain}&LookUpName=${T.lookUpName}&appId=1`);return S("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),m({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),b(),w.data}catch(w){throw S("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),w}},h=w=>{m({...T,[w.target.name]:w.target.value})},U=w=>{const{name:te,value:k}=w.target;ee(q=>{const F={...q,[te]:k};return(te==="inputValue"?"L2R":"R2L")==="L2R"?F.outputValue=De(k).from(F.fromUnit).to(F.toUnit):F.inputValue=De(k).from(F.toUnit).to(F.fromUnit),F})};o.useEffect(()=>{(async()=>{try{const te=await Me.get("http://100.42.177.77:83/api/Common/GetLookUpDomains?appId=1");l(te.data.result)}catch(te){console.error("Error fetching design options:",te)}})()},[]);const E=!!g,D=!!f,be=E?"simple-popover":void 0,se=D?"convert-popover":void 0;return e.jsxs(Re,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(ye,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(ge,{"aria-describedby":be,variant:"outlined",size:"small",onClick:X,sx:{marginRight:"8px"},children:"+Lookup"}),e.jsx(ge,{"aria-describedby":se,variant:"outlined",size:"small",onClick:G,children:"Convertor"}),e.jsx(St,{id:se,open:D,anchorEl:f,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(c,{fullWidth:!0,select:!0,label:"From",size:"small",name:"fromUnit",value:O.fromUnit,onChange:U,children:De().possibilities("length").map(w=>e.jsx(Q,{value:w,children:w},w))})}),e.jsx(a,{item:!0,sm:6,children:e.jsx(c,{fullWidth:!0,select:!0,label:"To",size:"small",name:"toUnit",value:O.toUnit,onChange:U,children:De().possibilities("length").map(w=>e.jsx(Q,{value:w,children:w},w))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,label:O.fromUnit,size:"small",name:"inputValue",value:O.inputValue,onChange:U,type:"number"})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,label:O.toUnit,size:"small",name:"outputValue",value:O.outputValue,onChange:U,type:"number"})})]})}),e.jsx(St,{id:"mouse-over-popover",open:E,anchorEl:g,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,select:!0,label:"Select Lookup",size:"small",value:T.lookUpDomain,name:"lookUpDomain",onChange:h,children:I.map(w=>e.jsx(Q,{value:w.lookUpDomain,children:w.lookUpDomain},w.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(c,{fullWidth:!0,label:"Add Lookup Description",value:T.lookUpName,onChange:h,name:"lookUpName",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(ge,{variant:"contained",size:"small",onClick:pe,children:"Save"})})]})})]})]}),e.jsx(Zo,{activeStep:r,children:Je.map((w,te)=>{const k={},q={};return Y(te)&&(q.optional=e.jsx(ye,{variant:"caption"})),ae(te)&&(k.completed=!1),e.jsx(ea,{...k,children:e.jsxs(ta,{...q,onClick:()=>i(te),style:{cursor:"pointer"},children:[" ",w]})},w)})}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ge,{color:"inherit",disabled:r===0,onClick:v,sx:{mr:1},children:"Back"}),e.jsx(Re,{sx:{flex:"1 1 auto"}}),Y(r)&&e.jsx(ge,{color:"inherit",onClick:H,sx:{mr:1},children:"Skip"}),e.jsx(ge,{onClick:B,children:r===Je.length-1?"Finish":"Next"})]}),r===Je.length?e.jsxs(o.Fragment,{children:[e.jsx(jt,{setActiveStep:i}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Re,{sx:{flex:"1 1 auto"}}),e.jsx(ge,{onClick:oe,children:"Reset"})]})]}):e.jsxs(o.Fragment,{children:[r===0&&e.jsx(ga,{setInitialValues:p,initialValues:P}),r===1&&e.jsx(oa,{setInitialValues:p,initialValues:P}),r===2&&e.jsx(Ia,{initialValues:P}),r===3&&e.jsx(ma,{initialValues:P}),r===4&&e.jsx(va,{initialValues:P}),r===5&&e.jsx(Ma,{initialValues:P}),r===6&&e.jsx(Sa,{initialValues:P}),r===7&&e.jsx(jt,{setActiveStep:i,setInitialValues:p,initialValues:P}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ge,{color:"inherit",disabled:r===0,onClick:v,sx:{mr:1},children:"Back"}),e.jsx(Re,{sx:{flex:"1 1 auto"}}),Y(r)&&e.jsx(ge,{color:"inherit",onClick:H,sx:{mr:1},children:"Skip"}),e.jsx(ge,{onClick:B,children:r===Je.length-1?"Finish":"Next"})]})]})]})}export{vn as default};
