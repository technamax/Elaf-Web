import{u as B,c as A,x as H,y as O,b as q,z as M,A as V,j as e,G as s,T as Y}from"./index-k9GWQJOu.js";import{r as l}from"./vendor-BXCbSo2_.js";import{R as $}from"./ReuseableDataGrid-D6KGNruf.js";import{B as X,a as J}from"./axios-CaswPiu6.js";import{S as K}from"./StatusChip-DQNIzaKK.js";import{T as i}from"./TextField-Bw61L3Ab.js";import{M as p}from"./MenuItem-BJ2KxKJk.js";const ne=({iss:a,handleClose:b,refetchData:k,isRejected:D})=>{var v,g;const{user:Q}=B(),[n,L]=l.useState({poId:a.poId,issuanceId:a.issuanceId,rejectionId:a.rejectionId||null,processTypeId:a.processTypeId||1223,dispatchedQuantity:"",dispatchFrom:"",destination:"",isRejectedOGP:D?"Y":"N",remarks:"",truckId:"",driverId:"",createdBy:Q.empId}),{enqueueSnackbar:o}=A(),[I,m]=l.useState([]),[N,S]=l.useState([]),[j,R]=l.useState([]),[z,G]=l.useState([]),[T,W]=l.useState([]),{data:d,refetch:y}=H({poId:a.poId,issuanceId:a.issuanceId},{skip:!a.poId||!a.issuanceId}),{data:u,refetch:C}=O(a.issuanceId,{skip:!a.issuanceId}),{data:h,refetch:Z}=q(),{data:x,refetch:F}=M(),{data:f,refetch:E}=V();console.log("rejectionDetailsData",u),l.useEffect(()=>{if(D){if((u==null?void 0:u.result)===null){m([]);return}u&&m(u.result.map((t,r)=>({id:r+1,...t})))}else{if((d==null?void 0:d.result)===null){m([]);return}d&&m(d.result.map((t,r)=>({id:r+1,...t})))}},[d,y,u,C]),l.useEffect(()=>{x&&G(x.result.map((t,r)=>({id:r+1,...t})))},[x,F]),l.useEffect(()=>{f&&W(f.result.map((t,r)=>({id:r+1,...t})))},[f,E]),l.useEffect(()=>{h&&(S(h.result[0].destination.map((t,r)=>({id:r+1,...t}))),R(h.result[0].dispatchFrom.map((t,r)=>({id:r+1,...t}))))},[h,y]),console.log("iss",a),console.log("formData",n),console.log("issuanceDetails",I),console.log("dispatchFromList",j);const c=t=>{const{name:r,value:w}=t.target;L({...n,[r]:w})},P=[{field:"id",headerName:"Sr#"},{field:"fabricName",headerName:"Fabric"},{field:"designNo",headerName:"Design"},{field:"colorName",headerName:"Color"},{field:"rejectedQty",headerName:"Rejected Quantity",renderCell:t=>e.jsx(K,{label:t.value.toLocaleString(),status:"Rejected"})}],U=async()=>{if(n.dispatchedQuantity>a.issuanceQuantity-a.dispatchedQuantity){o("Error: DisPatched quantity cannot be greater than issuance quantity!",{variant:"error",autoHideDuration:5e3});return}try{const t=await J.post("http://100.42.177.77:8091/api/Issuance/GenerateOGP",n);k(),t.data.success?o(`${t.data.message} !`,{variant:"success",autoHideDuration:5e3}):(o(`${t.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",t.data.message)),console.log("Save response:",t.data),b()}catch(t){console.error("Error saving data:",t),o("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};return e.jsxs("div",{children:[e.jsxs(s,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,disabled:!0,label:"Production",name:"productionId",value:a.collectionName,size:"small"})}),e.jsx(s,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,disabled:!0,label:"Vendor",name:"vendorId",value:a.vendorName,size:"small"})}),e.jsx(s,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,disabled:!0,label:"Process Type",name:"processTypeName",value:a.processTypeName,size:"small"})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{size:"small",type:a.issuanceDate?null:"Date",label:"Issuance Date",name:"issuanceDate",value:a.issuanceDate?new Date(a.issuanceDate).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"}):n.issuanceDate,fullWidth:!0,disabled:a.issuanceDate,InputLabelProps:{shrink:!0,sx:{color:"black"}}})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{size:"small",type:a.issuanceDate?null:"Date",label:"ExpectedReturn Date",name:"expectedReturnDate",value:a.expectedReturnDate?new Date(a.expectedReturnDate).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"}):n.expectedReturnDate,fullWidth:!0,disabled:a.expectedReturnDate,InputLabelProps:{shrink:!0,sx:{color:"black"}}})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Dispatch From",name:"dispatchFrom",value:n.dispatchFrom,onChange:c,size:"small",children:j.map(t=>e.jsx(p,{value:t.lookUpId,children:t.lookUpName},t.lookUpId))})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Destination",name:"destination",value:n.destination,onChange:c,size:"small",children:N.map(t=>e.jsx(p,{value:t.lookUpId,children:t.lookUpName},t.lookUpId))})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Drivers",name:"driverId",value:n.driverId,onChange:c,size:"small",children:z.map(t=>e.jsx(p,{value:t.driverId,children:t.driverName},t.driverId))})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,select:!0,label:"Trucks",name:"truckId",value:n.truckId,onChange:c,size:"small",children:T.map(t=>e.jsx(p,{value:t.truckId,children:t.truckNumber},t.truckId))})}),e.jsx(s,{item:!0,xs:12,md:3,children:e.jsx(i,{fullWidth:!0,label:"Remarks",name:"remarks",value:n.remarks,onChange:c,size:"small"})}),e.jsx(s,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,disabled:!0,label:"Issuance Quantity",name:"issuanceQuantity",value:((v=a.issuanceQuantity)==null?void 0:v.toLocaleString())||((g=a.rejectedQty)==null?void 0:g.toLocaleString()),size:"small"})}),e.jsx(s,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,disabled:!0,label:"Remaining Quantity",name:"issuanceQuantity",value:a.issuanceQuantity-a.dispatchedQuantity,size:"small"})}),e.jsx(s,{item:!0,xs:12,md:1.5,children:e.jsx(i,{fullWidth:!0,type:"Number",label:"DispatchedQuantity",name:"dispatchedQuantity",value:n.dispatchedQuantity,onChange:c,size:"small"})})]}),e.jsxs(s,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(Y,{variant:"h2",children:"Details"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx($,{initialRows:I,iColumns:P,hideAction:!0})}),e.jsx(s,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(X,{variant:"contained",size:"small",onClick:U,children:"Generate OGP"})})]})]})};export{ne as D};
