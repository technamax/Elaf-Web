import{u as Z,c as ee,ab as se,b as re,y as oe,z as ie,j as e,G as l,e as le,ac as de,n as ne,L as ce,B as F,C as ue,d as me,T as U,P as pe,M as fe}from"./index-39l8sM5Y.js";import{r as s}from"./vendor-BXCbSo2_.js";import{d as he}from"./CategoryOutlined-BFUgLYEY.js";import{d as Q}from"./AssignmentOutlined-gcmYWm7Z.js";import"./ReceivingDetails-CuQLLjUI.js";import{R as te,a as V,b as X,c as Y,d as _,B as xe}from"./ReuseableDataGrid-BPyget6h.js";import{d as q}from"./Close-wcyf3mqg.js";import ge from"./Reports-J93Kn4dG.js";import{B as O,a as je,I as J}from"./axios-BWUwFnln.js";import{T as m}from"./TextField-B7IP_ndE.js";import{S as E}from"./StatusChip-CqVTwn9e.js";import{M as K}from"./MenuItem-qJMJ5sWO.js";import{T as be,a as ye,b as D,c as I}from"./TabPanel-BsG9cIUb.js";import"./Skeleton-_4TR0oIL.js";const Ie=({iss:r,handleClose:d,refetchData:u})=>{const{user:x}=Z(),[c,p]=s.useState({grnHeader:{grnId:0,grnNumber:"",...r,createdBy:x.empId,remarks:"",totalQuantity:r.gradeAQty,totalValue:r.gradeAQty*r.rate}}),{enqueueSnackbar:f}=ee(),[g,j]=s.useState([]),[i,R]=s.useState([]),[H,G]=s.useState([]),[S,B]=s.useState([]),[k,L]=s.useState([]),{data:h,refetch:w}=se(r.inspectionId,{skip:!r.inspectionId}),{data:b,refetch:M}=re(),{data:y,refetch:A}=oe(),{data:N,refetch:P}=ie();s.useEffect(()=>{if((h==null?void 0:h.result)===null){j([]);return}h&&j(h.result.map((t,o)=>({id:o+1,...t})))},[h,w]),s.useEffect(()=>{y&&B(y.result.map((t,o)=>({id:o+1,...t})))},[y,A]),s.useEffect(()=>{N&&L(N.result.map((t,o)=>({id:o+1,...t})))},[N,P]),s.useEffect(()=>{b&&(R(b.result[0].destination.map((t,o)=>({id:o+1,...t}))),G(b.result[0].dispatchFrom.map((t,o)=>({id:o+1,...t}))))},[b]),console.log("iss",r),console.log("formData",c),console.log("GRNList",g),console.log("dispatchFromList",H);const z=t=>{const{name:o,value:a}=t.target;p(n=>({...n,grnHeader:{...n.grnHeader,[o]:a}}))},v=g.map(t=>({...t,grnId:0,grnItemId:0,total:t.gradeAQty*t.rate,acceptedQty:t.gradeAQty,grnaQty:t.gradeAQty,grnbQty:t.gradeBQty,grncpQty:t.gradeCPQty,bGradetotal:t.gradeBQty*t.rate*t.bGradeRate}));console.log("calRows",v),s.useEffect(()=>{p({...c,grnDetailsList:[...v]})},[g]),console.log("formData",c);const C=[{field:"id",headerName:"Sr#"},{field:"designNo",headerName:"Design"},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"gradeAQty",headerName:"Grade A"},{field:"rate",headerName:"Rate"},{field:"total",headerName:"Total"},{field:"gradeBQty",headerName:"Grade B"},{field:"bGradeRate",headerName:"BGrade Rate",valueGetter:(t,o)=>t*o.rate},{field:"bGradetotal",headerName:"BGradeTotal"},{field:"gradeCPQty",headerName:"GradeCP"},{field:"rejectedQty",headerName:"Rejected",renderCell:t=>{const o="error.dark";if(t.value!==0)return e.jsx(le,{label:t.value,sx:{backgroundColor:o,color:"white"},color:void 0})}},{field:"remarks",headerName:"Remarks"},{field:"shortageQty",headerName:"Shortage"}],T=async()=>{try{const t=await je.post("http://100.42.177.77:83/api/GRN/SaveGRN",c);u(),t.data.success?f(`${t.data.message} !`,{variant:"success",autoHideDuration:5e3}):(f(`${t.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",t.data.message)),console.log("Save response:",t.data),d()}catch(t){console.error("Error saving data:",t),f("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};return e.jsxs("div",{children:[e.jsxs(l,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(m,{fullWidth:!0,disabled:!0,label:"Production",name:"productionId",value:r.collectionName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(m,{fullWidth:!0,disabled:!0,label:"PO",name:"poName",value:r.poName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(m,{fullWidth:!0,disabled:!0,label:"Issuance",name:"issuanceId",value:r.issuanceId,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(m,{fullWidth:!0,disabled:!0,label:"IGP",name:"igpNumber",value:r.igpNumber,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(m,{fullWidth:!0,disabled:!0,label:"Proces Type",name:"processTypeName",value:r.processTypeName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(m,{fullWidth:!0,disabled:!0,label:"Vendor",name:"vendorName",value:r.vendorName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(m,{label:"Remarks",fullWidth:!0,size:"small",name:"remarks",onChange:z,value:c.grnHeader.remarks,required:!0})})]}),e.jsxs(l,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(te,{initialRows:v,iColumns:C,hideAction:!0})}),e.jsx(l,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(O,{variant:"contained",size:"small",onClick:T,disabled:r.status===9,children:"Save"})})]})]})},Ne=()=>{ee();const{user:r}=Z(),[d,u]=s.useState({issuanceId:"",poId:"",productionId:"",ogpNumber:"",appId:r.appId,createdOn:new Date().toISOString(),createdBy:r.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:r.empId}),[x,c]=s.useState([]),[p,f]=s.useState([]),[g,j]=s.useState([]),{data:i,error:R,isLoading:H,refetch:G}=de(d.poId,{skip:!d.poId}),{data:S,refetch:B}=ne(),{data:k,refetch:L}=ce(d.productionId,{skip:!d.productionId}),[h,w]=s.useState([]);s.useEffect(()=>{S&&w(S.result.map((a,n)=>({id:n,...a})))},[S,B]),s.useEffect(()=>{i&&c(i.result.map((a,n)=>({id:n+1,...a})))},[i,G]),s.useEffect(()=>{k&&f(k.result.map((a,n)=>({id:n+1,...a})))},[k,L]),console.log("polist",p),console.log("initialRows",x);const b=a=>{const{name:n,value:W}=a.target;if(n==="poId"){const $=p.find(ae=>ae.poId===parseInt(W));u({...d,poId:W,issuanceId:$?$.issuanceId:""})}else u({...d,[n]:W})};console.log("formData",d);const[M,y]=s.useState(!1),[A,N]=s.useState(!1),[P,z]=s.useState(!1),v=async a=>{z(a),y(!0)},C=()=>{y(!1)},T=()=>{N(!1)},t=async a=>{j(a.issuanceId)},o=[{field:"id",headerName:"Sr#"},{field:"issuanceId",headerName:"issuance#"},{field:"poName",headerName:"PO#"},{field:"igpNumber",headerName:"IGP#"},{field:"collectionName",headerName:"Production"},{field:"processTypeName",headerName:"Process"},{field:"rate",headerName:"Rate",renderCell:a=>e.jsx(E,{label:a.row.rate,status:"Pending"})},{field:"gradeAQty",headerName:"GradeA",renderCell:a=>e.jsx(E,{label:a.row.gradeAQty,status:"Received"})},{field:"statusName",headerName:"Status",renderCell:a=>e.jsx(E,{label:a.value,status:a.value})},{field:"Actions",headerName:"Actions",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(xe,{variant:"text",size:"small",sx:{mt:1},children:[e.jsx(O,{size:"small",color:"primary",onClick:()=>v(a.row),disabled:a.row.status===3,children:"Receive"}),e.jsx(O,{size:"small",color:"primary",onClick:()=>t(a.row),children:"POST"})]})})}];return e.jsx(F,{sx:{width:"100%",typography:"body1"},children:e.jsxs(ue,{variant:"outlined",children:[e.jsx(me,{className:"css-4rfrnx-MuiCardHeader-root",title:"GRN",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(l,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(m,{fullWidth:!0,select:!0,label:"Production",name:"productionId",value:d.productionId,onChange:b,size:"small",children:h.map(a=>e.jsx(K,{value:a.productionId,children:a.collectionName},a.productionId))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(m,{fullWidth:!0,select:!0,label:"PO#",name:"poId",value:d.poId,onChange:b,size:"small",children:p.map(a=>e.jsx(K,{value:a.poId,children:a.poIdName},a.poId))})}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx(te,{initialRows:x,iColumns:o,hideAction:!0}),e.jsxs(V,{open:M,onClose:C,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(X,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(U,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Details"}),e.jsx(J,{onClick:C,sx:{color:"#ffffff"},children:e.jsx(q,{})})]}),e.jsxs(Y,{children:[e.jsx(_,{id:"alert-dialog-slide-description"}),e.jsx(Ie,{iss:P,handleClose:C,refetchData:G})]})]}),e.jsxs(V,{open:A,onClose:T,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(X,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(U,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx(J,{onClick:T,sx:{color:"#ffffff"},children:e.jsx(q,{})})]}),e.jsxs(Y,{children:[e.jsx(_,{id:"alert-dialog-slide-description"}),e.jsx(ge,{rId:14,OGPNumber:P.igpNumber})]})]})]})]})]})})},ze=()=>{var f,g,j;const r=pe(),d=(f=r.state)==null?void 0:f.data,u=(j=(g=r.state)==null?void 0:g.tab)==null?void 0:j.toString();console.log("rowData",d),console.log("tab",u);const[x,c]=s.useState("1"),p=(i,R)=>{c(R),console.log("value",x)};return s.useEffect(()=>{u&&c(u)},[u]),e.jsx(fe,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(F,{sx:{width:"100%",typography:"body1"},children:e.jsxs(be,{value:x,children:[e.jsx(F,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(ye,{onChange:p,children:[e.jsx(D,{icon:e.jsx(he,{}),label:"Dyeing GRN",value:"1",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(D,{icon:e.jsx(Q,{}),label:"Embroidery GRN",value:"2",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(D,{icon:e.jsx(Q,{}),label:"Schiffili GRN",value:"3",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(D,{icon:e.jsx(Q,{}),label:"Additional Process GRN",value:"4",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(D,{icon:e.jsx(Q,{}),label:"Additional Services GRN",value:"5",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})})]})}),e.jsx(I,{value:"1",children:e.jsx(Ne,{})}),e.jsx(I,{value:"2"}),e.jsx(I,{value:"3"}),e.jsx(I,{value:"4"}),e.jsx(I,{value:"5"}),e.jsx(I,{value:"6"})]})})})};export{ze as default};
