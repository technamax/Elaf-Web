import{r,j as e,_ as ve,Y as ie,a as ce,Z as re,$ as ue,a0 as pe,a1 as xe,a2 as me,a3 as ge,M as ae,F as oe,G as a,T as H,D as le,a4 as je,a5 as Ie,B as ee}from"./index-QV_izsA6.js";import{a as Y}from"./axios-dN3qa5E9.js";import{S as Se,a as Ce,b as Pe,F as Ne}from"./Fabrication-B6dojTfu.js";import{F as de}from"./EditAbleDataGrid-eOQlKHmf.js";import{B,T as l,P as ye}from"./TextField-CPLw8Kp8.js";import{M as f}from"./Skeleton-BeUP2jfQ.js";import{A as Fe,C as ze,D as fe}from"./DataGrid-LBF-WdiM.js";import{G as be}from"./GridToolbar-Rb_lwWXw.js";let he=!1;const ke=r.forwardRef(function(u,C){return he||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),he=!0),e.jsx(Fe,ve({ref:C},u))}),Ae=()=>{const[t,u]=r.useState({designId:"",batchNo:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHeads:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStitches:"",threadRate:"",threadAmount:"",tillaStitches:"",tillaRate:"",tillaAmount:"",sequenceStitches:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:"",solvingInMeters:"",solvingRate:"",solvingAmount:"",additional:"",costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:C}=ie(),[I,E]=r.useState(""),{data:z}=ce(),{data:D,refetch:X}=re(I,{skip:!I}),{data:x,refetch:te}=ue(t.designId,{skip:!t.designId}),{data:k}=pe({batchNo:t.batchNo,componentId:t.componentId},{skip:!t.batchNo||!t.componentId}),{data:T}=xe({batchNo:t.batchNo,componentId:t.componentId,fabricId:t.fabricId},{skip:!t.batchNo||!t.componentId||!t.fabricId}),{data:R,refetch:$}=me(t.batchNo,{skip:!t.batchNo}),{data:U}=ge(t.batchNo,{skip:!t.batchNo});console.log("colorData",T);const[w,M]=r.useState([]),[q,j]=r.useState([]),[A,V]=r.useState([]),[G,o]=r.useState([]),[L,y]=r.useState([]),[Z,K]=r.useState([]),[_,W]=r.useState([]),[d,P]=r.useState([]);r.useEffect(()=>{D&&M(D.result)},[D]),r.useEffect(()=>{x&&j(x.result)},[x]),r.useEffect(()=>{k&&V(k.result)},[k]),r.useEffect(()=>{T&&K(k.result)},[T]),r.useEffect(()=>{U&&P(U.result)},[U]),r.useEffect(()=>{R&&W(R.result.map((s,c)=>({id:c,...s})))},[R]),r.useEffect(()=>{if(z){const s=z.result[0];o(s.vendorList),y(s.noOfHeadsList)}},[z]);const v=(C==null?void 0:C.result)||[];r.useEffect(()=>{const s=()=>{const p=parseFloat(t.repeats)||0,N=parseFloat(t.itemsPerRepeat)||0;return p*N};u(p=>({...p,totalPcs:s()}));const c=()=>{const p=parseFloat(t.threadStitches)||0,N=parseFloat(t.threadRate)||0,O=parseFloat(t.noOfHeads)||0,J=parseFloat(t.repeats)||0;return p/1e3*(N*J*O)};u(p=>({...p,threadAmount:c()}));const h=()=>{const p=parseFloat(t.tillaStitches)||0,N=parseFloat(t.tillaRate)||0,O=parseFloat(t.noOfHeads)||0,J=parseFloat(t.repeats)||0;return p/1e3*(N*J*O)};u(p=>({...p,tillaAmount:h()}));const g=()=>{const p=parseFloat(t.sequenceStitches)||0,N=parseFloat(t.sequenceRate)||0,O=parseFloat(t.noOfHeads)||0,J=parseFloat(t.repeats)||0;return p/1e3*(N*J*O)};u(p=>({...p,sequenceAmount:g()}));const F=()=>{const p=parseFloat(t.repeats)||0,N=parseFloat(t.noOfHeads)||0,O=parseFloat(t.solvingLayers)||0;return p*N*13/39.37*O};u(p=>({...p,solvingInMeters:F()}));const se=()=>{const p=parseFloat(t.solvingInMeters)||0,N=parseFloat(t.solvingRate)||0;return parseFloat(t.solvingLayers),p*N};u(p=>({...p,solvingAmount:se()}));const Q=()=>{const p=parseFloat(t.threadAmount)||0,N=parseFloat(t.tillaAmount)||0,O=parseFloat(t.sequenceAmount)||0,J=parseFloat(t.solvingAmount)||0;return p+N+O+J};u(p=>({...p,totalAmount:Q()}));const b=()=>{const p=parseFloat(t.totalAmount)||0,N=parseFloat(t.totalPcs)||0;return p/N};u(p=>({...p,costPerComponent:b()}))},[t.threadAmount,t.totalAmount,t.sequenceAmount,t.solvingAmount,t.repeats,t.tillaAmount,t.itemsPerRepeat,t.threadRate,t.threadStitches,t.noOfHeads,t.tillaRate,t.tillaStitches,t.sequenceRate,t.sequenceStitches,t.solvingLayers,t.solvingInMeters,t.solvingRate]);const m=s=>{const{name:c,checked:h}=s.target;u(g=>({...g,[c]:h}))},n=s=>{const{name:c,value:h}=s.target;if(c==="collectionId"){const g=v.find(F=>F.collectionId===parseInt(h));E(h),u({...t,collectionId:h,poPcs:g?g.poPcs:""})}else if(c==="designId"){const g=w.find(F=>F.designId===parseInt(h));u({...t,designId:h,baseColorId:g?g.colorId:"",baseColorName:g?g.colorName:""})}else if(c==="batchNo"){const g=q.find(F=>F.batchNo===h);u({...t,batchNo:h,planningHeaderId:g?g.planningHeaderId:""})}else if(c==="fabricId"){const g=A.find(F=>F.fabricId===h);u({...t,fabricId:h,quantity:g?g.total:""})}else u({...t,[c]:h})},S=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:w.map(s=>({value:s.designId,label:s.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"vendorId",headerName:"Vendor",editable:!0,flex:1,type:"singleSelect",valueOptions:G.map(s=>({value:s.lookUpId,label:s.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(s,c)=>{const h=c.quantity??0,g=c.rate??0,F=h*g;return console.log("total",F),{...c,total:F}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(s,c)=>{const h=c.total??0,g=c.poPcs??0,F=h/g;return console.log("unitPrice",F),{...c,unitPrice:F}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(s,c)=>{const h=c.total??0,g=c.gst??0,F=h*(1+g/100);return console.log("totalInclGst",F),{...c,totalInclGst:F}}}],i=async()=>{try{const s=await Y.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",t);console.log("Save response:",s.data),u({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(s){console.error("Error saving data:",s)}};return console.log("formData",t),e.jsxs(ae,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(oe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Embroidery"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(B,{variant:"contained",size:"small",onClick:i,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:I,onChange:n,size:"small",children:v.map(s=>e.jsx(f,{value:s.collectionId,children:s.collectionName},s.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:n,size:"small",children:w.map(s=>e.jsx(f,{value:s.designId,children:s.designNo},s.designId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:n,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:n,size:"small",children:q.map(s=>e.jsx(f,{value:s.batchNo,children:s.batchNo},s.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:t.componentId,onChange:n,size:"small",children:d.map(s=>e.jsx(f,{value:s.componentId,children:s.componentName},s.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:n,children:A.map(s=>e.jsx(f,{value:s.fabricId,children:s.fabric},s.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:t.vendorId,onChange:n,children:G.map(s=>e.jsx(f,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:t.colorId,onChange:n,children:Z.map(s=>e.jsx(f,{value:s.colorId,children:s.color},s.colorId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:t.availableQty,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:t.repeats,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHeads",value:t.noOfHeads,onChange:n,children:L.map(s=>e.jsx(f,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:t.cuttingSize,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"itemsPerRepeat",fullWidth:!0,size:"small",name:"itemsPerRepeat",value:t.itemsPerRepeat,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",name:"totalPcs",value:t.totalPcs,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",name:"totalAmount",value:t.totalAmount,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:t.costPerComponent,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(je,{control:e.jsx(ze,{checked:t.isSolving,onChange:m,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",name:"threadStitches",value:t.threadStitches,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"threadRate",value:t.threadRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"threadAmount",value:t.threadAmount,onChange:n})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",name:"tillaStitches",value:t.tillaStitches,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"tillaRate",value:t.tillaRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"tillaAmount",value:t.tillaAmount,onChange:n})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",name:"sequenceStitches",value:t.sequenceStitches,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"sequenceRate",value:t.sequenceRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:t.sequenceAmount,onChange:n})})]})}),t.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Layers",fullWidth:!0,size:"small",name:"solvingLayers",value:t.solvingLayers,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Meters",fullWidth:!0,size:"small",name:"solvingInMeters",value:t.solvingInMeters,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"solvingRate",value:t.solvingRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"solvingAmount",value:t.solvingAmount,onChange:n})})]})}):null]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(de,{ncolumns:S,initialRows:_,formData:t,disableAddRecord:!0})})})]})},We=Ae,De=()=>{const{data:t}=ie(),[u,C]=r.useState(""),{data:I,refetch:E}=re(u,{skip:!u}),[z,D]=r.useState([]);r.useEffect(()=>{I&&(D(I.result),E())},[I]),console.log("designList",z),console.log("collectionData",t);const X=(t==null?void 0:t.result)||[],[x,te]=r.useState([]),[k,T]=r.useState([]),[R,$]=r.useState([]),[U,w]=r.useState([]),[M,q]=r.useState([]),[j,A]=r.useState([]),[V,G]=r.useState([]),[o,L]=r.useState({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()});r.useEffect(()=>{(async()=>{try{const v=(await Y.get("https://gecxc.com:4041/API/Common/GetPrePlanningLookUp?appID=1")).data.result[0];te(v.componentList),$(v.colorList),T(v.fabricList),q(v.noOfHeadsList),w(v.uom)}catch(P){console.error("Error fetching pre-planning lookup data:",P)}})()},[]),r.useEffect(()=>{const d=async v=>{try{const m=await Y.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${v}`);console.log(m.data),A(m.data.result)}catch(m){console.error("Error fetching pre-planning lookup data:",m)}},P=async v=>{try{const m=await Y.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningByPlanningHeaderId?planningHeaderId=${v}`);console.log("GetPrePlanningByPlanningHeaderI",m.data.result),G(m.data.result.map((n,S)=>({...n,id:S})))}catch(m){console.error("Error fetching pre-planning lookup data:",m)}};o.designId&&d(o.designId),o.designId&&P(o.planningHeaderId)},[o.designId,o.planningHeaderId]),r.useEffect(()=>{const d=()=>{const v=parseFloat(o.repeats)||0,m=parseFloat(o.repeatSize)||0;return v*m};L(v=>({...v,totalFabric:d()}));const P=()=>{const v=parseFloat(o.totalFabric)||0,m=parseFloat(o.shrinkage)||0,n=parseFloat(o.wastage)||0;return v*(100+(m+n))/100};L(v=>({...v,total:P()}))},[o.repeats,o.repeatSize,o.totalFabric,o.shrinkage,o.wastage]);const y=d=>{const{name:P,value:v}=d.target;if(P==="collectionId"){const m=X.find(n=>n.collectionId===parseInt(v));C(v),L({...o,collectionId:v,noOfDesigns:m?m.noOfDesigns:"",noOfColors:m?m.noOfColors:""})}else if(P==="designId"){const m=z.find(n=>n.designId===parseInt(v));L({...o,designId:v,baseColorId:m?m.colorId:"",baseColorName:m?m.colorName:""})}else if(P==="batchNo"){const m=j.find(n=>n.batchNo===v);L({...o,batchNo:v,planningHeaderId:m?m.planningHeaderId:""})}else L({...o,[P]:v})},Z=async()=>{try{const d=await Y.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",{designId:parseInt(o.designId),planningHeaderId:parseInt(o.planningHeaderId),componentId:parseInt(o.componentId),colorId:parseInt(o.colorId),batchNo:o.batchNo,baseColorId:parseInt(o.baseColorId),cuttingSize:parseFloat(o.cuttingSize),fabricId:parseInt(o.fabricId),noOfHeads:parseInt(o.noOfHeads),repeats:parseFloat(o.repeats),repeatSize:parseFloat(o.repeatSize),uomId:parseInt(o.uomId),totalFabric:parseFloat(o.totalFabric),shrinkage:parseFloat(o.shrinkage),wastage:parseFloat(o.wastage),total:parseFloat(o.total),appId:o.appId,createdOn:o.createdOn,createdBy:o.createdBy,lastUpdatedBy:o.lastUpdatedBy,lastUpdatedOn:o.lastUpdatedOn});console.log("Data saved successfully:",d.data),L({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()}),G([])}catch(d){console.error("Error saving data:",d)}},K=[{field:"componentId",headerName:"Component",editable:!0,flex:1,type:"singleSelect",valueOptions:x.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"colorId",headerName:"Color",editable:!0,flex:1,type:"singleSelect",valueOptions:R.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"cuttingSize",headerName:"Cutting Size",flex:1,editable:!0},{field:"fabricId",headerName:"Fabrication",editable:!0,flex:1,type:"singleSelect",valueOptions:k.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"noOfHeads",headerName:"No. Of Heads",editable:!0,flex:1,type:"singleSelect",valueOptions:M.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"repeats",headerName:"Repeats",flex:1,editable:!0},{field:"repeatSize",headerName:"Repeat Size",flex:1,editable:!0},{field:"totalFabric",headerName:"Total Fabric",flex:1,editable:!0,valueSetter:(d,P)=>{const v=P.repeats??0,m=P.repeatSize??0,n=v*m;return console.log("totalFabric",n),{...P,totalFabric:n}}},{field:"uomId",headerName:"UOM",editable:!0,flex:1,type:"singleSelect",valueOptions:U.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"shrinkage",headerName:"Shrinkage",flex:1,editable:!0},{field:"wastage",headerName:"Wastage",flex:1,editable:!0},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(d,P)=>{const v=P.shrinkage??0,m=P.wastage??0,n=P.totalFabric??0,S=n*(100-(v+m))/100;return console.log("totalFabric",n),{...P,total:S}}}];return console.log("batchList:",j),e.jsxs(ae,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(oe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Pre Planning"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(B,{variant:"contained",size:"small",onClick:Z,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:4,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:o.collectionId,onChange:y,size:"small",children:X.map(d=>e.jsx(f,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"No of Design",fullWidth:!0,size:"small",name:"noOfDesigns",value:o.noOfDesigns,onChange:y,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"No of Color",fullWidth:!0,size:"small",name:"noOfColors",value:o.noOfColors,onChange:y,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:o.designId,onChange:y,size:"small",children:z.map(d=>e.jsx(f,{value:d.designId,children:d.designNo},d.designId))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:o.baseColorName,onChange:y,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:4,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:o.batchNo,onChange:y,size:"small",children:j.map(d=>e.jsx(f,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Component",defaultValue:"",size:"small",name:"componentId",value:o.componentId,onChange:y,children:x.map(d=>e.jsx(f,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Color",fullWidth:!0,select:!0,size:"small",name:"colorId",value:o.colorId,onChange:y,children:R.map(d=>e.jsx(f,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:o.cuttingSize,onChange:y})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Fabrication",defaultValue:"",size:"small",name:"fabricId",value:o.fabricId,onChange:y,children:k.map(d=>e.jsx(f,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"No of Heads",defaultValue:"",size:"small",name:"noOfHeads",value:o.noOfHeads,onChange:y,children:M.map(d=>e.jsx(f,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:o.repeats,onChange:y})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeat Size",fullWidth:!0,size:"small",name:"repeatSize",value:o.repeatSize,onChange:y})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:o.totalFabric,onChange:y})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:o.uomId,onChange:y,children:U.map(d=>e.jsx(f,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Shrinkage %",fullWidth:!0,size:"small",name:"shrinkage",value:o.shrinkage,onChange:y})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Wastage %",fullWidth:!0,size:"small",name:"wastage",value:o.wastage,onChange:y})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total",fullWidth:!0,size:"small",name:"total",value:o.total,onChange:y})})]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(de,{ncolumns:K,initialRows:V,formData:o,editAPi:"https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",deleteApi:"https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",deleteBy:"planningId",disableAddRecord:!0})})})]})},Oe=De,Re=()=>{const[t,u]=r.useState({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:"",baseColorName:""});console.log("Dyeing form data to send",t);const{data:C}=ie(),[I,E]=r.useState(""),{data:z}=ce(),{data:D,refetch:X}=re(I,{skip:!I}),{data:x,refetch:te}=ue(t.designId,{skip:!t.designId}),{data:k}=Ie(t.batchNo,{skip:!t.batchNo}),{data:T,refetch:R}=me(t.batchNo,{skip:!t.batchNo}),[$,U]=r.useState([]),[w,M]=r.useState([]),[q,j]=r.useState([]),[A,V]=r.useState([]),[G,o]=r.useState([]),[L,y]=r.useState([]),[Z,K]=r.useState([]);r.useEffect(()=>{D&&U(D.result)},[D]),r.useEffect(()=>{x&&M(x.result)},[x]),r.useEffect(()=>{k&&j(k.result)},[k]),r.useEffect(()=>{z&&K(z.result[0].vendorList)},[k]),console.log(Z),r.useEffect(()=>{T&&o(T.result.map((n,S)=>({id:S,...n})))},[T]),r.useEffect(()=>{if(z){const n=z.result[0];V(n.uomList)}},[z]);const _=(C==null?void 0:C.result)||[],W=n=>{const{name:S,value:i}=n.target;if(S==="collectionId"){const s=_.find(c=>c.collectionId===parseInt(i));E(i),u({...t,collectionId:i,poPcs:s?s.poPcs:""})}else if(S==="designId"){const s=$.find(c=>c.designId===parseInt(i));u({...t,designId:i,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:""})}else if(S==="batchNo"){const s=w.find(c=>c.batchNo===i);u({...t,batchNo:i,planningHeaderId:s?s.planningHeaderId:""})}else if(S==="fabricId"){const s=q.find(c=>c.fabricId===i);console.log("Selected Fabric:",q),u({...t,fabricId:i,OutputQty:s?s.total:""}),d(i)}else u(S==="processType"?{...t,processType:i}:S==="vendorId"?{...t,vendorId:i}:{...t,[S]:i})},d=async n=>{try{const i=(await Y.get(`https://gecxc.com:4041/api/DyeingPrinting/GetFabricColorFromPrePlanningByFabricId?fabricId=${n}`)).data.result;if(console.log("Dyeing Color Data",i),i.length>0){const c=i[0];u(h=>({...h,Shrinkage:c.shrinkage.toFixed(2),Wastage:c.wastage.toFixed(2),UOM:c.uom,AvailableQty:c.total.toString()}))}const s=i.map(c=>({label:c.color,value:c.colorId}));if(y(s),s.length>0){const c=s[0];u(h=>({...h,ColorId:c.value,color:c.label}))}}catch(S){console.error("Error fetching fabric color data:",S)}};r.useEffect(()=>{const n=()=>{const Q=parseFloat(t.AvailableQty)||0,b=parseFloat(t.Shrinkage)||0,p=parseFloat(t.Wastage)||0;return Q*(100-(b+p))/100},S=()=>{const Q=parseFloat(t.AvailableQty)||0,b=parseFloat(t.RatePerUOM)||0;return Q*b},i=(Q,b)=>Q*(1+b/100),s=n(),c=S(),h=parseFloat(t.GST)||0,g=i(c,h),F=parseFloat(t.poPcs)||0,se=F?g/F:0;u(Q=>({...Q,OutputQty:s,TotalExclGst:c.toFixed(2),TotalIncludingGst:g.toFixed(2),UnitRatePerPo:se.toFixed(2)}))},[t.AvailableQty,t.Shrinkage,t.Wastage,t.RatePerUOM,t.GST,t.poPcs,t.UnitRatePerPo]);const P=async()=>{console.log("Form Data:",t);const n={dpId:parseInt(t.DPId)||0,designId:parseInt(t.designId),batchNo:t.batchNo,fabricId:parseInt(t.fabricId),colorId:parseInt(t.ColorId)||0,vendorId:t.vendorId||0,processType:t.processType,availableQty:parseFloat(t.AvailableQty)||0,shrinkage:parseFloat(t.Shrinkage)||0,wastage:parseFloat(t.Wastage)||0,outputQty:parseFloat(t.OutputQty)||0,uomId:parseInt(t.UOM)||0,ratePerUOM:parseFloat(t.RatePerUOM)||0,unitRatePerPo:parseFloat(t.UnitRatePerPo)||0,totalExclGst:parseFloat(t.TotalExclGst)||0,gst:parseFloat(t.GST)||0,gstAmount:parseFloat(t.GSTAmount)||0,totalIncludingGst:parseFloat(t.TotalIncludingGst)||0,createdBy:t.createdBy};console.log("Payload:",n);try{const S=await Y.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",n);S.status===200?(console.log("Data saved successfully:",S.data),u({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:""})):console.error("Failed to save data:",S.data)}catch(S){console.error("Error saving data:",S)}},v=[{field:"name",headerName:"Order Number",editable:!0,flex:2},{field:"DesignId",headerName:"Design",type:"number",flex:1,align:"left",headerAlign:"left",editable:!0},{field:"FabricId",headerName:"Fabric",type:"date",flex:1,editable:!0},{field:"ProcessType",headerName:"Process",flex:1,editable:!0},{field:"ColorId",headerName:"Color",flex:1,editable:!0},{field:"role",headerName:"Po Pcs",flex:1,editable:!0},{field:"AvailableQty",headerName:"Qty",flex:1,editable:!0},{field:"UOM",headerName:"UOM",flex:1,editable:!0},{field:"RatePerUOM",headerName:"Rate",flex:1,editable:!0},{field:"UnitRatePerPo",headerName:"Unit Price",flex:1,editable:!0},{field:"TotalIncludingGst",headerName:"Total W/ GST",flex:1,editable:!0}],m=[{value:"D",label:"Dyeing"},{value:"P",label:"Printing"}];return e.jsx(ae,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(oe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Dyeing/Printing"})}),e.jsx(a,{item:!0,xs:3,md:3,textAlign:"right",children:e.jsx(B,{variant:"contained",color:"primary",size:"small",onClick:P,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:I,onChange:W,size:"small",children:_.map(n=>e.jsx(f,{value:n.collectionId,children:n.collectionName},n.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:W,size:"small",children:$.map(n=>e.jsx(f,{value:n.designId,children:n.designNo},n.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:W,size:"small",children:w.map(n=>e.jsx(f,{value:n.batchNo,children:n.batchNo},n.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:W,children:q.map(n=>e.jsx(f,{value:n.fabricId,children:n.fabric},n.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(ke,{fullWidth:!0,options:L,getOptionLabel:n=>n.label||"",renderInput:n=>e.jsx(l,{...n,label:"Color",name:"ColorId",size:"small"}),value:L.find(n=>n.value===t.ColorId)||null,onChange:(n,S)=>{u(i=>({...i,ColorId:S?S.value:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:t.vendorId,onChange:W,children:Z.map(n=>e.jsx(f,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:W,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:t.processType,onChange:W,children:m.map(n=>e.jsx(f,{value:n.value,children:n.label},n.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:W})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:t.UOM})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"AvailableQty",fullWidth:!0,size:"small",name:"AvailableQty",value:t.AvailableQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Shrinkage%",fullWidth:!0,size:"small",name:"Shrinkage",value:t.Shrinkage})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Wastage%",fullWidth:!0,size:"small",name:"Wastage",value:t.Wastage})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",value:t.OutputQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"RatePerUOM",value:t.RatePerUOM,onChange:W})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Excluding GST",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalExclGst,onChange:W})}),e.jsxs(a,{item:!0,xs:12,md:1.5,children:[e.jsx(l,{label:"GST",fullWidth:!0,size:"small",name:"GST",value:t.GST,onChange:W})," "]}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalIncludingGst,onChange:W})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:t.UnitRatePerPo,onChange:W})}),e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%",mt:2}}),e.jsx(a,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(de,{initialRows:G,ncolumns:v})})]})})})},Te=Re,Ue=()=>{const[t,u]=r.useState({designId:"",batchNo:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHeads:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStitches:"",threadRate:"",threadAmount:"",tillaStitches:"",tillaRate:"",tillaAmount:"",sequenceStitches:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:"",solvingInMeters:"",solvingRate:"",solvingAmount:"",additional:"",costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:C}=ie(),[I,E]=r.useState(""),{data:z}=ce(),{data:D,refetch:X}=re(I,{skip:!I}),{data:x,refetch:te}=ue(t.designId,{skip:!t.designId}),{data:k}=pe({batchNo:t.batchNo,componentId:t.componentId},{skip:!t.batchNo||!t.componentId}),{data:T}=xe({batchNo:t.batchNo,componentId:t.componentId,fabricId:t.fabricId},{skip:!t.batchNo||!t.componentId||!t.fabricId}),{data:R,refetch:$}=me(t.batchNo,{skip:!t.batchNo}),{data:U}=ge(t.batchNo,{skip:!t.batchNo});console.log("colorData",T);const[w,M]=r.useState([]),[q,j]=r.useState([]),[A,V]=r.useState([]),[G,o]=r.useState([]),[L,y]=r.useState([]),[Z,K]=r.useState([]),[_,W]=r.useState([]),[d,P]=r.useState([]);r.useEffect(()=>{D&&M(D.result)},[D]),r.useEffect(()=>{x&&j(x.result)},[x]),r.useEffect(()=>{k&&V(k.result)},[k]),r.useEffect(()=>{T&&K(k.result)},[T]),r.useEffect(()=>{U&&P(U.result)},[U]),r.useEffect(()=>{R&&W(R.result.map((i,s)=>({id:s,...i})))},[R]),r.useEffect(()=>{if(z){const i=z.result[0];o(i.vendorList),y(i.noOfHeadsList)}},[z]);const v=(C==null?void 0:C.result)||[];r.useEffect(()=>{const i=()=>{const b=parseFloat(t.repeats)||0,p=parseFloat(t.itemsPerRepeat)||0;return b*p};u(b=>({...b,totalPcs:i()}));const s=()=>{const b=parseFloat(t.threadStitches)||0,p=parseFloat(t.threadRate)||0,N=parseFloat(t.noOfHeads)||0,O=parseFloat(t.repeats)||0;return b/1e3*(p*O*N)};u(b=>({...b,threadAmount:s()}));const c=()=>{const b=parseFloat(t.tillaStitches)||0,p=parseFloat(t.tillaRate)||0,N=parseFloat(t.noOfHeads)||0,O=parseFloat(t.repeats)||0;return b/1e3*(p*O*N)};u(b=>({...b,tillaAmount:c()}));const h=()=>{const b=parseFloat(t.sequenceStitches)||0,p=parseFloat(t.sequenceRate)||0,N=parseFloat(t.noOfHeads)||0,O=parseFloat(t.repeats)||0;return b/1e3*(p*O*N)};u(b=>({...b,sequenceAmount:h()}));const g=()=>{const b=parseFloat(t.repeats)||0,p=parseFloat(t.noOfHeads)||0,N=parseFloat(t.solvingLayers)||0;return b*p*13/39.37*N};u(b=>({...b,solvingInMeters:g()}));const F=()=>{const b=parseFloat(t.solvingInMeters)||0,p=parseFloat(t.solvingRate)||0;return parseFloat(t.solvingLayers),b*p};u(b=>({...b,solvingAmount:F()}));const se=()=>{const b=parseFloat(t.threadAmount)||0,p=parseFloat(t.tillaAmount)||0,N=parseFloat(t.sequenceAmount)||0,O=parseFloat(t.solvingAmount)||0;return b+p+N+O};u(b=>({...b,totalAmount:se()}));const Q=()=>{const b=parseFloat(t.totalAmount)||0,p=parseFloat(t.totalPcs)||0;return b/p};u(b=>({...b,costPerComponent:Q()}))},[t.threadAmount,t.totalAmount,t.sequenceAmount,t.solvingAmount,t.repeats,t.tillaAmount,t.itemsPerRepeat,t.threadRate,t.threadStitches,t.noOfHeads,t.tillaRate,t.tillaStitches,t.sequenceRate,t.sequenceStitches,t.solvingLayers,t.solvingInMeters,t.solvingRate]);const m=i=>{const{name:s,value:c}=i.target;if(s==="collectionId"){const h=v.find(g=>g.collectionId===parseInt(c));E(c),u({...t,collectionId:c,poPcs:h?h.poPcs:""})}else if(s==="designId"){const h=w.find(g=>g.designId===parseInt(c));u({...t,designId:c,baseColorId:h?h.colorId:"",baseColorName:h?h.colorName:""})}else if(s==="batchNo"){const h=q.find(g=>g.batchNo===c);u({...t,batchNo:c,planningHeaderId:h?h.planningHeaderId:""})}else if(s==="colorId"){const h=Z.find(g=>g.colorId===c);u({...t,colorId:c,availableQty:h?h.total:"",cuttingSize:h?h.cuttingSize:"",repeats:h?h.repeats:""})}else u({...t,[s]:c})},n=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:w.map(i=>({value:i.designId,label:i.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"vendorId",headerName:"Vendor",editable:!0,flex:1,type:"singleSelect",valueOptions:G.map(i=>({value:i.lookUpId,label:i.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(i,s)=>{const c=s.quantity??0,h=s.rate??0,g=c*h;return console.log("total",g),{...s,total:g}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(i,s)=>{const c=s.total??0,h=s.poPcs??0,g=c/h;return console.log("unitPrice",g),{...s,unitPrice:g}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(i,s)=>{const c=s.total??0,h=s.gst??0,g=c*(1+h/100);return console.log("totalInclGst",g),{...s,totalInclGst:g}}}],S=async()=>{try{const i=await Y.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",t);console.log("Save response:",i.data),u({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(i){console.error("Error saving data:",i)}};return console.log("formData",t),e.jsxs(ae,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(oe,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Schiffli"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(B,{variant:"contained",size:"small",onClick:S,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:I,onChange:m,size:"small",children:v.map(i=>e.jsx(f,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:m,size:"small",children:w.map(i=>e.jsx(f,{value:i.designId,children:i.designNo},i.designId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:m,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:m,size:"small",children:q.map(i=>e.jsx(f,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:t.componentId,onChange:m,size:"small",children:d.map(i=>e.jsx(f,{value:i.componentId,children:i.componentName},i.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:m,children:A.map(i=>e.jsx(f,{value:i.fabricId,children:i.fabric},i.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:t.vendorId,onChange:m,children:G.map(i=>e.jsx(f,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:t.colorId,onChange:m,children:Z.map(i=>e.jsx(f,{value:i.colorId,children:i.color},i.colorId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:t.availableQty,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:t.repeats,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHeads",value:t.noOfHeads,onChange:m,children:L.map(i=>e.jsx(f,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:t.cuttingSize,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"itemsPerRepeat",fullWidth:!0,size:"small",name:"itemsPerRepeat",value:t.itemsPerRepeat,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",name:"totalPcs",value:t.totalPcs,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",name:"totalAmount",value:t.totalAmount,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:t.costPerComponent,onChange:m})})]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(de,{ncolumns:n,initialRows:_,formData:t,disableAddRecord:!0})})})]})},we=Ue;function Be(){const t=[{value:"D# 01-A",label:"D# 01-A"},{value:"D# 01-A",label:"D# 01-A"}],u=[{value:"D# 01-A-MM-Y",label:"D# 01-A-MM-Y"},{value:"No",label:"No"}],C=[{value:"Front",label:"Front"},{value:"Back",label:"Back"}],I=[{value:"Lawn 102/88",label:"Lawn 102/88"},{value:"Lawn 99/88",label:"Lawn 99/88"}],E=[{value:"Khuram",label:"Khuram"},{value:"Ramia",label:"Ramia"}],z=[{value:"Auto Fetch",label:"Auto Fetch"},{value:"No",label:"No"}],D=[{value:"Black",label:"Black"},{value:"Red",label:"Red"}],X=[{value:"Hand Work",label:"Hand Work"},{value:"Patch Work",label:"Patch Work"}];return e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Additional Process"})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Select Design",defaultValue:"D# 01-A",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:t.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Select Batch#",defaultValue:"D# 01-A-MM-Y",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:u.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Components",defaultValue:"Front",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:C.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Fabric",defaultValue:"Lawn 102/88",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:I.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Vendor Name",defaultValue:"Haneef",variant:"outlined",size:"small",fullWidth:!0,children:E.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Select Design Color",defaultValue:"Auto Fetch",variant:"outlined",size:"small",fullWidth:!0,children:z.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:" Color",defaultValue:"Black",variant:"outlined",size:"small",fullWidth:!0,children:D.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:" Process Type",defaultValue:"Hand Work",variant:"outlined",size:"small",fullWidth:!0,children:X.map(x=>e.jsx(f,{value:x.value,children:x.label},x.value))})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Pcs per component",name:"Pcs per component",size:"small",required:!0})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC'S",name:"PO PC'S",size:"small",disabled:!0})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:" Quantity",name:"Quantity",size:"small",required:!0})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"Rate",size:"small",required:!0})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Component",name:"Cost per Component",size:"small",required:!0})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"Total Amount",size:"small",required:!0})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(B,{variant:"contained",color:"primary",size:"small",children:"Add"})})]})}function Le(){const[t,u]=r.useState([]),C=[{field:"Order No.",headerName:"Order No",width:150},{field:"Design",headerName:"Design",width:200},{field:"Design Color",headerName:"Design Color",minWidth:120},{field:"Component",headerName:"Component",minWidth:120},{field:"Fabric",headerName:"Fabric",minWidth:120},{field:"Vendor Name",headerName:"Vendor Name",minWidth:120},{field:"Process",headerName:"Process",minWidth:120},{field:"Color",headerName:"Color",minWidth:120},{field:"Po Pcs",headerName:"Po Pcs",minWidth:120},{field:"Qty",headerName:"Qty",minWidth:120},{field:"Rate",headerName:"Rate",minWidth:120},{field:"Cost per Component",headerName:"Cost per Component",minWidth:120},{field:"Total Amount",headerName:"Total Amount",minWidth:120}];return e.jsx("div",{style:{height:"auto",width:"100%"},children:e.jsx(fe,{rows:t,columns:C,autoHeight:!0,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10,15],localeText:{toolbarDensity:"Size",toolbarDensityLabel:"Size",toolbarDensityCompact:"Small",toolbarDensityStandard:"Medium",toolbarDensityComfortable:"Large"},components:{Toolbar:be}})})}function He(){return e.jsxs(ae,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23"},children:[e.jsx(Be,{}),e.jsx(le,{}),e.jsx(Le,{})]})}function qe(){const t=[{value:"Card Printing",label:"Card Printing"},{value:"Additional Service",label:"Additional Service"}],u=[{value:"Elaf PVC Zipper Bag",label:"Elaf PVC Zipper Bag"},{value:"No",label:"No"}],C=[{value:"Mudassir Hussain Packaging Service",label:"Mudassir Hussain Packaging Service"},{value:"No",label:"No"}];return e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Additional Services"})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service Type",defaultValue:"Card Printing",helperText:"Service Type",variant:"outlined",size:"small",fullWidth:!0,children:t.map(I=>e.jsx(f,{value:I.value,children:I.label},I.value))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service List",defaultValue:"Elaf PVC Zipper Bag",helperText:"Service List",variant:"outlined",size:"small",fullWidth:!0,children:u.map(I=>e.jsx(f,{value:I.value,children:I.label},I.value))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Vendor Name",defaultValue:"Mudassir Hussain Packaging Service",helperText:"Service List",variant:"outlined",size:"small",fullWidth:!0,children:C.map(I=>e.jsx(f,{value:I.value,children:I.label},I.value))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC's",name:"PO PC's",size:"small",disabled:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Qty",name:"Qty",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"UOM",name:"UOM",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"Rate",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"Total Amount",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Piece",name:"Cost per Piece",size:"small",required:!0})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(B,{variant:"contained",color:"primary",size:"small",children:"Add"})})]})}function Ge(){const[t,u]=r.useState([]),C=[{field:"Service Type",headerName:"Service Type",width:150},{field:"Service List",headerName:"Service List",width:200},{field:"Vendor",headerName:"Vendor",minWidth:120},{field:"Qty",headerName:"Qty",minWidth:120},{field:"UOM",headerName:"UOM",minWidth:120},{field:"Rate",headerName:"Rate",minWidth:120},{field:"Total Amount",headerName:"Total Amount",minWidth:120}];return e.jsx("div",{style:{height:"auto",width:"100%"},children:e.jsx(fe,{rows:t,columns:C,autoHeight:!0,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10,15],localeText:{toolbarDensity:"Size",toolbarDensityLabel:"Size",toolbarDensityCompact:"Small",toolbarDensityStandard:"Medium",toolbarDensityComfortable:"Large"},components:{Toolbar:be}})})}function Ee(){return e.jsxs(ae,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23"},children:[e.jsx(qe,{}),e.jsx(le,{}),e.jsx(Ge,{})]})}const ne=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function _e(){const[t,u]=r.useState(0),[C,I]=r.useState(new Set),[E,z]=r.useState(null),[D,X]=r.useState([]),x=j=>{z(j.currentTarget)},te=()=>{z(null)},k=!!E,T=k?"simple-popover":void 0,R=j=>j===1,$=j=>C.has(j),U=()=>{let j=C;$(t)&&(j=new Set(j.values()),j.delete(t)),u(A=>A+1),I(j)},w=()=>{u(j=>j-1)},M=()=>{if(!R(t))throw new Error("You can't skip a step that isn't optional.");u(j=>j+1),I(j=>{const A=new Set(j.values());return A.add(t),A})},q=()=>{u(0)};return r.useEffect(()=>{(async()=>{try{const A=await Y.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",A),X(A.data.result)}catch(A){console.error("Error fetching design options:",A)}console.log("LookupData",response)})()},[]),e.jsxs(ee,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(H,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(B,{"aria-describedby":T,variant:"outlined",size:"small",onClick:x,children:"+Lookup"}),e.jsx(ye,{id:"mouse-over-popover",open:k,anchorEl:E,onClose:te,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Design",size:"small",children:D.map(j=>e.jsx(f,{value:j.lookUpDomain,children:j.lookUpDomain},j.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,label:"Add Lookup Description",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(B,{variant:"contained",size:"small",children:"Save"})})]})})]})]}),e.jsx(Se,{activeStep:t,children:ne.map((j,A)=>{const V={},G={};return R(A)&&(G.optional=e.jsx(H,{variant:"caption",children:"Optional"})),$(A)&&(V.completed=!1),e.jsx(Ce,{...V,children:e.jsx(Pe,{...G,children:j})},j)})}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(B,{color:"inherit",disabled:t===0,onClick:w,sx:{mr:1},children:"Back"}),e.jsx(ee,{sx:{flex:"1 1 auto"}}),R(t)&&e.jsx(B,{color:"inherit",onClick:M,sx:{mr:1},children:"Skip"}),e.jsx(B,{onClick:U,children:t===ne.length-1?"Finish":"Next"})]}),t===ne.length?e.jsxs(r.Fragment,{children:[e.jsx(H,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ee,{sx:{flex:"1 1 auto"}}),e.jsx(B,{onClick:q,children:"Reset"})]})]}):e.jsxs(r.Fragment,{children:[e.jsxs(H,{sx:{mt:2,mb:1},children:["Step ",t+1]}),t===0&&e.jsx(Oe,{}),t===1&&e.jsx(Ne,{}),t===2&&e.jsx(Te,{}),t===3&&e.jsx(We,{}),t===4&&e.jsx(we,{}),t===5&&e.jsx(He,{}),t===6&&e.jsx(Ee,{}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(B,{color:"inherit",disabled:t===0,onClick:w,sx:{mr:1},children:"Back"}),e.jsx(ee,{sx:{flex:"1 1 auto"}}),R(t)&&e.jsx(B,{color:"inherit",onClick:M,sx:{mr:1},children:"Skip"}),e.jsx(B,{onClick:U,children:t===ne.length-1?"Finish":"Next"})]})]})]})}export{_e as default};
