import{c as oe,u as ne,K as le,L as de,N as ce,j as e,B as D,C as B,d as L,G as d,T as O,e as A,I as ue,M as me}from"./index-D1tX9wrp.js";import{r as s}from"./vendor-BXCbSo2_.js";import{d as pe}from"./CategoryOutlined-BxyD4p3X.js";import{d as g}from"./AssignmentOutlined-DGXH1XTh.js";import{B as v,I as M,a as he}from"./axios-Cxh9UTPd.js";import{d as $}from"./Close-tPnCrOwd.js";import{R as fe}from"./ReceivingDetails-A53riUMj.js";import{R as E,a as z,b as W,c as H,d as Q,B as F}from"./ReuseableDataGrid-Dv91oMQ6.js";import xe from"./Reports-Dx6oYbTb.js";import{T as ge}from"./TextField-DuUhpNBk.js";import{M as ve}from"./MenuItem-DQgeQNjY.js";import{T as je,a as ye,b as f,c}from"./TabPanel-CY2eq3Z6.js";import"./Skeleton-CzlzLFeS.js";const Ce=()=>{const{enqueueSnackbar:o}=oe(),{user:n}=ne();s.useState([]),s.useState(!1);const[i,u]=s.useState({issuanceId:"",poId:"",ogpNumber:"",appId:n.appId,createdOn:new Date().toISOString(),createdBy:n.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:n.empId}),[l,j]=s.useState([]),[m,x]=s.useState([]),[p,r]=s.useState([]),[S,V]=s.useState([]),[U,X]=s.useState([]);s.useState(!1);const{data:y,error:be,isLoading:Ie,refetch:N}=le(),{data:C,refetch:Y}=de(i.poId,{skip:!i.poId}),{data:b,refetch:_}=ce({issuanceId:p,processTypename:"Dyeing"},{skip:!p});s.useEffect(()=>{y&&x(y.result.map((a,t)=>({id:t+1,...a})))},[y,N]),s.useEffect(()=>{b&&X(b.result.map((a,t)=>({id:t+1,...a})))},[b,_]),console.log("initialRows",l),s.useEffect(()=>{C&&V(C.result.map((a,t)=>({id:t,...a})))},[C,Y]),console.log("initialRows",l);const q=a=>{const{name:t,value:h}=a.target;if(t==="poId"){const P=m.find(re=>re.poId===parseInt(h));u({...i,poId:h,issuanceId:P?P.issuanceId:""})}else u({...i,[t]:h})},K=async()=>{console.log("formData",i);try{const a=await he.get(`http://100.42.177.77:83/api/Receiving/GetIssuanceByPoIdAndOGPNumber?poId=${i.poId}&issuanceId=${i.issuanceId}`);console.log("Save response:",a.data),a.data.success?(o(`${a.data.message} !`,{variant:"success",autoHideDuration:5e3}),j(a.data.result.map((t,h)=>({id:h+1,...t})))):(o(`${a.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",a.data.message))}catch(a){console.error("Error saving data:",a),o("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};console.log("formData",i);const[J,R]=s.useState(!1),[Z,w]=s.useState(!1),[G,k]=s.useState(!1),ee=async a=>{k(a),R(!0)},ae=async a=>{w(!0),k(a)},I=()=>{R(!1)},T=()=>{w(!1)},te=async a=>{r(a.issuanceId)},se=[{field:"id",headerName:"Sr#"},{field:"issuanceId",headerName:"issuance#"},{field:"vendorName",headerName:"Vendor"},{field:"issuanceQuantity",headerName:"Total",valueGetter:a=>a.toLocaleString()},{field:"receivedQty",headerName:"Received",valueGetter:(a,t)=>a-t.shortageQty},{field:"issuanceDate",headerName:"Issuance Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"expectedReturnDate",headerName:"Expected Return Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"fabricCount",headerName:"Fabrics"},{field:"statusName",headerName:"Status",renderCell:a=>e.jsx(A,{label:a.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"Actions",headerName:"Actions",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(F,{variant:"text",size:"small",sx:{mt:1},children:[e.jsx(v,{size:"small",color:"primary",onClick:()=>ee(a.row),children:"Generate IGP"}),e.jsx(v,{size:"small",color:"primary",onClick:()=>te(a.row),children:"Get Receivings"})]})})}],ie=[{field:"id",headerName:"Sr #"},{field:"collectionName",headerName:"Collection Name"},{field:"poName",headerName:"PO"},{field:"ogpNumber",headerName:"OGP Number",renderCell:a=>{a.value}},{field:"igpNumber",headerName:"IGP Number"},{field:"igpDate",headerName:"IGP Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"receivingDate",headerName:"Receiving Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"receivedQty",headerName:"Received"},{field:"processTypename",headerName:"Process Type"},{field:"statusName",headerName:"Status",renderCell:a=>{const t="primary.dark";if(a.value!==null)return e.jsx(A,{label:a.value,sx:{backgroundColor:t,color:"white"},color:void 0})}},{field:"Actions",headerName:"Actions",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(F,{variant:"text",size:"small",sx:{mt:1},children:e.jsx(v,{size:"small",color:"primary",onClick:()=>ae(a.row),children:"IGP"})})})}];return e.jsxs(D,{sx:{width:"100%",typography:"body1"},children:[e.jsxs(B,{variant:"outlined",children:[e.jsx(L,{className:"css-4rfrnx-MuiCardHeader-root",title:"Receiving",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(d,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(d,{item:!0,xs:12,md:3,children:e.jsx(ge,{fullWidth:!0,select:!0,label:"PO#",name:"poId",value:i.poId,onChange:q,size:"small",children:m.map(a=>e.jsx(ve,{value:a.poId,children:a.poName},a.poId))})}),e.jsx(d,{item:!0,xs:12,md:3,sx:{mt:.5},children:e.jsx(v,{variant:"contained",size:"small",onClick:K,children:"Search"})}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx(E,{initialRows:l,iColumns:se,onRowDoubleClick:a=>r(a.row.issuanceId),hideAction:!0}),e.jsxs(z,{open:J,onClose:I,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(W,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(O,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Receiving Details"}),e.jsx(M,{onClick:I,sx:{color:"#ffffff"},children:e.jsx($,{})})]}),e.jsxs(H,{children:[e.jsx(Q,{id:"alert-dialog-slide-description"}),e.jsx(fe,{iss:G,handleClose:I,refetchIssuanceData:N})]})]}),e.jsxs(z,{open:Z,onClose:T,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(W,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(O,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx(M,{onClick:T,sx:{color:"#ffffff"},children:e.jsx($,{})})]}),e.jsxs(H,{children:[e.jsx(Q,{id:"alert-dialog-slide-description"}),e.jsx(xe,{rId:14,OGPNumber:G.igpNumber})]})]})]})]})]}),e.jsxs(B,{variant:"outlined",sx:{marginTop:2},children:[e.jsx(L,{className:"css-4rfrnx-MuiCardHeader-root",title:"View All",titleTypographyProps:{style:{color:"white"}}}),e.jsx(d,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(d,{item:!0,xs:12,children:e.jsx(E,{initialRows:U,iColumns:ie,hideAction:!0})})})]})]})},Me=()=>{var m,x,p;const o=ue(),n=(m=o.state)==null?void 0:m.data,i=(p=(x=o.state)==null?void 0:x.tab)==null?void 0:p.toString();console.log("rowData",n),console.log("tab",i);const[u,l]=s.useState("1"),j=(r,S)=>{l(S),console.log("value",u)};return s.useEffect(()=>{i&&l(i)},[i]),e.jsx(me,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(D,{sx:{width:"100%",typography:"body1"},children:e.jsxs(je,{value:u,children:[e.jsx(D,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(ye,{onChange:j,children:[e.jsx(f,{icon:e.jsx(pe,{}),label:"Dyeing Receiving",value:"1",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(g,{}),label:"Embroidery Receiving",value:"2",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(g,{}),label:"Schiffili Receiving",value:"3",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(g,{}),label:"Additional Process Receiving",value:"4",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(g,{}),label:"Additional Services Receiving",value:"5",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})})]})}),e.jsx(c,{value:"1",children:e.jsx(Ce,{rowData:n})}),e.jsx(c,{value:"2"}),e.jsx(c,{value:"3"}),e.jsx(c,{value:"4"}),e.jsx(c,{value:"5"}),e.jsx(c,{value:"6"})]})})})};export{Me as default};
