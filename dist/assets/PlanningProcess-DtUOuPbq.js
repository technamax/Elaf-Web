import{r as o,j as e,_ as Se,Y as oe,a as ue,Z as re,$ as me,a0 as xe,a1 as fe,a2 as he,a3 as be,M as ae,F as de,G as a,T as H,D as le,a4 as Ce,a5 as Pe,a6 as Ne,C as ye,d as ke,a7 as Fe,b as ze,B as ee}from"./index-UoeC-e26.js";import{a as _}from"./axios-D07O1bWV.js";import{S as Ae,a as De,b as We,F as Oe}from"./Fabrication-CnixpMS4.js";import{F as ce}from"./EditAbleDataGrid-D5o07o2-.js";import{B as w,T as l,P as Ue}from"./TextField-dRB4SJvn.js";import{M as v}from"./Skeleton-DxWEYmQ_.js";import{A as ie,C as Re,D as ve}from"./DataGrid-BiLKzzfV.js";import{G as Ie}from"./GridToolbar-D6gzvUEf.js";let ge=!1;const Te=o.forwardRef(function(u,N){return ge||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),ge=!0),e.jsx(ie,Se({ref:N},u))}),we=()=>{const[t,u]=o.useState({designId:"",batchNo:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHeads:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStitches:"",threadRate:"",threadAmount:"",tillaStitches:"",tillaRate:"",tillaAmount:"",sequenceStitches:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:"",solvingInMeters:"",solvingRate:"",solvingAmount:"",additional:"",costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:N}=oe(),[C,q]=o.useState(""),{data:F}=ue(),{data:D,refetch:Y}=re(C,{skip:!C}),{data:p,refetch:te}=me(t.designId,{skip:!t.designId}),{data:z}=xe({batchNo:t.batchNo,componentId:t.componentId},{skip:!t.batchNo||!t.componentId}),{data:O}=fe({batchNo:t.batchNo,componentId:t.componentId,fabricId:t.fabricId},{skip:!t.batchNo||!t.componentId||!t.fabricId}),{data:B,refetch:M}=he(t.batchNo,{skip:!t.batchNo}),{data:U}=be(t.batchNo,{skip:!t.batchNo});console.log("colorData",O);const[R,Q]=o.useState([]),[L,V]=o.useState([]),[T,$]=o.useState([]),[G,r]=o.useState([]),[x,j]=o.useState([]),[E,Z]=o.useState([]),[K,A]=o.useState([]),[d,S]=o.useState([]);o.useEffect(()=>{D&&Q(D.result)},[D]),o.useEffect(()=>{p&&V(p.result)},[p]),o.useEffect(()=>{z&&$(z.result)},[z]),o.useEffect(()=>{O&&Z(z.result)},[O]),o.useEffect(()=>{U&&S(U.result)},[U]),o.useEffect(()=>{B&&A(B.result.map((s,c)=>({id:c,...s})))},[B]),o.useEffect(()=>{if(F){const s=F.result[0];r(s.vendorList),j(s.noOfHeadsList)}},[F]);const I=(N==null?void 0:N.result)||[];o.useEffect(()=>{const s=()=>{const g=parseFloat(t.repeats)||0,y=parseFloat(t.itemsPerRepeat)||0;return g*y};u(g=>({...g,totalPcs:s()}));const c=()=>{const g=parseFloat(t.threadStitches)||0,y=parseFloat(t.threadRate)||0,W=parseFloat(t.noOfHeads)||0,J=parseFloat(t.repeats)||0;return g/1e3*(y*J*W)};u(g=>({...g,threadAmount:c()}));const h=()=>{const g=parseFloat(t.tillaStitches)||0,y=parseFloat(t.tillaRate)||0,W=parseFloat(t.noOfHeads)||0,J=parseFloat(t.repeats)||0;return g/1e3*(y*J*W)};u(g=>({...g,tillaAmount:h()}));const f=()=>{const g=parseFloat(t.sequenceStitches)||0,y=parseFloat(t.sequenceRate)||0,W=parseFloat(t.noOfHeads)||0,J=parseFloat(t.repeats)||0;return g/1e3*(y*J*W)};u(g=>({...g,sequenceAmount:f()}));const k=()=>{const g=parseFloat(t.repeats)||0,y=parseFloat(t.noOfHeads)||0,W=parseFloat(t.solvingLayers)||0;return g*y*13/39.37*W};u(g=>({...g,solvingInMeters:k()}));const se=()=>{const g=parseFloat(t.solvingInMeters)||0,y=parseFloat(t.solvingRate)||0;return parseFloat(t.solvingLayers),g*y};u(g=>({...g,solvingAmount:se()}));const X=()=>{const g=parseFloat(t.threadAmount)||0,y=parseFloat(t.tillaAmount)||0,W=parseFloat(t.sequenceAmount)||0,J=parseFloat(t.solvingAmount)||0;return g+y+W+J};u(g=>({...g,totalAmount:X()}));const b=()=>{const g=parseFloat(t.totalAmount)||0,y=parseFloat(t.totalPcs)||0;return g/y};u(g=>({...g,costPerComponent:b()}))},[t.threadAmount,t.totalAmount,t.sequenceAmount,t.solvingAmount,t.repeats,t.tillaAmount,t.itemsPerRepeat,t.threadRate,t.threadStitches,t.noOfHeads,t.tillaRate,t.tillaStitches,t.sequenceRate,t.sequenceStitches,t.solvingLayers,t.solvingInMeters,t.solvingRate]);const m=s=>{const{name:c,checked:h}=s.target;u(f=>({...f,[c]:h}))},n=s=>{const{name:c,value:h}=s.target;if(c==="collectionId"){const f=I.find(k=>k.collectionId===parseInt(h));q(h),u({...t,collectionId:h,poPcs:f?f.poPcs:""})}else if(c==="designId"){const f=R.find(k=>k.designId===parseInt(h));u({...t,designId:h,baseColorId:f?f.colorId:"",baseColorName:f?f.colorName:""})}else if(c==="batchNo"){const f=L.find(k=>k.batchNo===h);u({...t,batchNo:h,planningHeaderId:f?f.planningHeaderId:""})}else if(c==="fabricId"){const f=T.find(k=>k.fabricId===h);u({...t,fabricId:h,quantity:f?f.total:""})}else u({...t,[c]:h})},P=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:R.map(s=>({value:s.designId,label:s.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"vendorId",headerName:"Vendor",editable:!0,flex:1,type:"singleSelect",valueOptions:G.map(s=>({value:s.lookUpId,label:s.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(s,c)=>{const h=c.quantity??0,f=c.rate??0,k=h*f;return console.log("total",k),{...c,total:k}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(s,c)=>{const h=c.total??0,f=c.poPcs??0,k=h/f;return console.log("unitPrice",k),{...c,unitPrice:k}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(s,c)=>{const h=c.total??0,f=c.gst??0,k=h*(1+f/100);return console.log("totalInclGst",k),{...c,totalInclGst:k}}}],i=async()=>{try{const s=await _.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",t);console.log("Save response:",s.data),u({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(s){console.error("Error saving data:",s)}};return console.log("formData",t),e.jsxs(ae,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(de,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Embroidery"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(w,{variant:"contained",size:"small",onClick:i,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:C,onChange:n,size:"small",children:I.map(s=>e.jsx(v,{value:s.collectionId,children:s.collectionName},s.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:n,size:"small",children:R.map(s=>e.jsx(v,{value:s.designId,children:s.designNo},s.designId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:n,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:n,size:"small",children:L.map(s=>e.jsx(v,{value:s.batchNo,children:s.batchNo},s.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:t.componentId,onChange:n,size:"small",children:d.map(s=>e.jsx(v,{value:s.componentId,children:s.componentName},s.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:n,children:T.map(s=>e.jsx(v,{value:s.fabricId,children:s.fabric},s.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:t.vendorId,onChange:n,children:G.map(s=>e.jsx(v,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:t.colorId,onChange:n,children:E.map(s=>e.jsx(v,{value:s.colorId,children:s.color},s.colorId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:t.availableQty,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:t.repeats,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHeads",value:t.noOfHeads,onChange:n,children:x.map(s=>e.jsx(v,{value:s.lookUpId,children:s.lookUpName},s.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:t.cuttingSize,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"itemsPerRepeat",fullWidth:!0,size:"small",name:"itemsPerRepeat",value:t.itemsPerRepeat,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",name:"totalPcs",value:t.totalPcs,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",name:"totalAmount",value:t.totalAmount,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:t.costPerComponent,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(Ce,{control:e.jsx(Re,{checked:t.isSolving,onChange:m,name:"isSolving"}),label:"isSolving"})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",name:"threadStitches",value:t.threadStitches,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"threadRate",value:t.threadRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"threadAmount",value:t.threadAmount,onChange:n})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",name:"tillaStitches",value:t.tillaStitches,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"tillaRate",value:t.tillaRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"tillaAmount",value:t.tillaAmount,onChange:n})})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",name:"sequenceStitches",value:t.sequenceStitches,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"sequenceRate",value:t.sequenceRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:t.sequenceAmount,onChange:n})})]})}),t.isSolving?e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(H,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Layers",fullWidth:!0,size:"small",name:"solvingLayers",value:t.solvingLayers,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Meters",fullWidth:!0,size:"small",name:"solvingInMeters",value:t.solvingInMeters,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"solvingRate",value:t.solvingRate,onChange:n})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"solvingAmount",value:t.solvingAmount,onChange:n})})]})}):null]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ce,{ncolumns:P,initialRows:K,formData:t,disableAddRecord:!0})})})]})},Be=we;var pe={},Le=Ne;Object.defineProperty(pe,"__esModule",{value:!0});var je=pe.default=void 0,He=Le(Pe()),qe=e;je=pe.default=(0,He.default)((0,qe.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const Ge=()=>{const{data:t}=oe(),[u,N]=o.useState(""),{data:C,refetch:q}=re(u,{skip:!u}),[F,D]=o.useState([]);o.useEffect(()=>{C&&(D(C.result),q())},[C]),console.log("designList",F),console.log("collectionData",t);const Y=(t==null?void 0:t.result)||[],[p,te]=o.useState([]),[z,O]=o.useState([]),[B,M]=o.useState([]),[U,R]=o.useState([]),[Q,L]=o.useState([]),[V,T]=o.useState([]),[$,G]=o.useState([]),[r,x]=o.useState({collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()});o.useEffect(()=>{(async()=>{try{const I=(await _.get("https://gecxc.com:4041/API/Common/GetPrePlanningLookUp?appID=1")).data.result[0];te(I.componentList),M(I.colorList),O(I.fabricList),L(I.noOfHeadsList),R(I.uom)}catch(S){console.error("Error fetching pre-planning lookup data:",S)}})()},[]),o.useEffect(()=>{const d=async I=>{try{const m=await _.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${I}`);console.log(m.data),T(m.data.result)}catch(m){console.error("Error fetching pre-planning lookup data:",m)}},S=async I=>{try{const m=await _.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningByPlanningHeaderId?planningHeaderId=${I}`);console.log("GetPrePlanningByPlanningHeaderI",m.data.result),G(m.data.result.map((n,P)=>({...n,id:P})))}catch(m){console.error("Error fetching pre-planning lookup data:",m)}};r.designId&&d(r.designId),r.designId&&S(r.planningHeaderId)},[r.designId,r.planningHeaderId]),o.useEffect(()=>{const d=()=>{const I=parseFloat(r.repeats)||0,m=parseFloat(r.repeatSize)||0;return I*m};x(I=>({...I,totalFabric:d()}));const S=()=>{const I=parseFloat(r.totalFabric)||0,m=parseFloat(r.shrinkage)||0,n=parseFloat(r.wastage)||0;return I*(100+(m+n))/100};x(I=>({...I,total:S()}))},[r.repeats,r.repeatSize,r.totalFabric,r.shrinkage,r.wastage]);const j=d=>{const{name:S,value:I}=d.target;if(S==="collectionId"){const m=Y.find(n=>n.collectionId===parseInt(I));N(I),x({...r,collectionId:I,noOfDesigns:m?m.noOfDesigns:"",noOfColors:m?m.noOfColors:""})}else if(S==="designId"){const m=F.find(n=>n.designId===parseInt(I));x({...r,designId:I,baseColorId:m?m.colorId:"",baseColorName:m?m.colorName:""})}else if(S==="batchNo"){const m=V.find(n=>n.batchNo===I);x({...r,batchNo:I,planningHeaderId:m?m.planningHeaderId:""})}else x({...r,[S]:I})},E=async()=>{try{const d=await _.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",{designId:parseInt(r.designId),planningHeaderId:parseInt(r.planningHeaderId),componentId:parseInt(r.componentId),colorId:parseInt(r.colorId),batchNo:r.batchNo,baseColorId:parseInt(r.baseColorId),cuttingSize:parseFloat(r.cuttingSize),fabricId:parseInt(r.fabricId),noOfHeads:parseInt(r.noOfHeads),repeats:parseFloat(r.repeats),repeatSize:parseFloat(r.repeatSize),uomId:parseInt(r.uomId),totalFabric:parseFloat(r.totalFabric),shrinkage:parseFloat(r.shrinkage),wastage:parseFloat(r.wastage),total:parseFloat(r.total),appId:r.appId,createdOn:r.createdOn,createdBy:r.createdBy,lastUpdatedBy:r.lastUpdatedBy,lastUpdatedOn:r.lastUpdatedOn});console.log("Data saved successfully:",d.data),x({collectionId:r.collectionId,designId:r.designId,batchNo:r.batchNo,baseColorName:r.baseColorName,componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:0,lastUpdatedBy:0,lastUpdatedOn:new Date().toISOString()}),G([])}catch(d){console.error("Error saving data:",d)}},Z=[{field:"componentId",headerName:"Component",editable:!0,flex:1,type:"singleSelect",valueOptions:p.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"colorId",headerName:"Color",editable:!0,flex:1,type:"singleSelect",valueOptions:B.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"cuttingSize",headerName:"Cutting Size",flex:1,editable:!0},{field:"fabricId",headerName:"Fabrication",editable:!0,flex:1,type:"singleSelect",valueOptions:z.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"noOfHeads",headerName:"No. Of Heads",editable:!0,flex:1,type:"singleSelect",valueOptions:Q.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"repeats",headerName:"Repeats",flex:1,editable:!0},{field:"repeatSize",headerName:"Repeat Size",flex:1,editable:!0},{field:"totalFabric",headerName:"Total Fabric",flex:1,editable:!0,valueSetter:(d,S)=>{const I=S.repeats??0,m=S.repeatSize??0,n=I*m;return console.log("totalFabric",n),{...S,totalFabric:n}}},{field:"uomId",headerName:"UOM",editable:!0,flex:1,type:"singleSelect",valueOptions:U.map(d=>({value:d.lookUpId,label:d.lookUpName}))},{field:"shrinkage",headerName:"Shrinkage",flex:1,editable:!0},{field:"wastage",headerName:"Wastage",flex:1,editable:!0},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(d,S)=>{const I=S.shrinkage??0,m=S.wastage??0,n=S.totalFabric??0,P=n*(100-(I+m))/100;return console.log("totalFabric",n),{...S,total:P}}}];return console.log("batchList:",V),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(ye,{variant:"outlined",children:[e.jsx(ke,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(je,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(a,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(a,{item:!0,xs:12,md:4,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:r.collectionId,onChange:j,size:"small",children:Y.map(d=>e.jsx(v,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:r.designId,onChange:j,size:"small",children:F.map(d=>e.jsx(v,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(a,{item:!0,xs:12,md:4,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:r.batchNo,onChange:j,size:"small",children:V.map(d=>e.jsx(v,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"No of Design",fullWidth:!0,size:"small",name:"noOfDesigns",value:r.noOfDesigns,onChange:j,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"No of Color",fullWidth:!0,size:"small",name:"noOfColors",value:r.noOfColors,onChange:j,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:r.baseColorName,onChange:j,disabled:!0})})]})]})}),e.jsxs(ae,{className:"MainCard",children:[" ",e.jsx(de,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(ie,{fullWidth:!0,options:p,getOptionLabel:d=>d.lookUpName,value:p.find(d=>d.lookUpId===r.componentId)||null,onChange:(d,S)=>{j({target:{name:"componentId",value:S?S.lookUpId:""}})},renderInput:d=>e.jsx(l,{...d,label:"Select Component",size:"small",name:"componentId",value:r.componentId})})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[" ",e.jsx(ie,{fullWidth:!0,options:B,getOptionLabel:d=>d.lookUpName,value:B.find(d=>d.lookUpId===r.colorId)||null,onChange:(d,S)=>{j({target:{name:"colorId",value:S?S.lookUpId:""}})},renderInput:d=>e.jsx(l,{...d,label:"Color",size:"small",value:r.colorId,name:"colorId"})})]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:r.cuttingSize,onChange:j})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(ie,{fullWidth:!0,options:z,getOptionLabel:d=>d.lookUpName,value:z.find(d=>d.lookUpId===r.fabricId)||null,onChange:(d,S)=>{j({target:{name:"fabricId",value:S?S.lookUpId:""}})},renderInput:d=>e.jsx(l,{...d,label:"Fabrication",size:"small",name:"fabricId",value:r.fabricId})})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"No of Heads",defaultValue:"",size:"small",name:"noOfHeads",value:r.noOfHeads,onChange:j,children:Q.map(d=>e.jsx(v,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:r.repeats,onChange:j})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeat Size",fullWidth:!0,size:"small",name:"repeatSize",value:r.repeatSize,onChange:j})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:r.totalFabric,onChange:j})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:r.uomId,onChange:j,children:U.map(d=>e.jsx(v,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Shrinkage %",fullWidth:!0,size:"small",name:"shrinkage",value:r.shrinkage,onChange:j})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Wastage %",fullWidth:!0,size:"small",name:"wastage",value:r.wastage,onChange:j})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total",fullWidth:!0,size:"small",name:"total",value:r.total,onChange:j})}),e.jsx(a,{item:!0,xs:12,textAlign:"right",children:e.jsx(w,{variant:"contained",size:"small",onClick:E,children:"Save"})})]})}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%",marginTop:2}})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ce,{ncolumns:Z,initialRows:$,formData:r,editAPi:"https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",deleteApi:"https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",deleteBy:"planningId",disableAddRecord:!0})})})]})]})},Ee=Ge,Me=()=>{const[t,u]=o.useState({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:"",baseColorName:"",planningHeaderId:""});console.log("Dyeing form data to send",t);const{data:N}=oe(),[C,q]=o.useState(""),{data:F}=ue(),{data:D,refetch:Y}=re(C,{skip:!C}),{data:p,refetch:te}=me(t.designId,{skip:!t.designId}),{data:z}=Fe(t.planningHeaderId,{skip:!t.planningHeaderId}),{data:O,refetch:B}=he(t.planningHeaderId,{skip:!t.planningHeaderId}),[M,U]=o.useState([]),[R,Q]=o.useState([]),[L,V]=o.useState([]),[T,$]=o.useState([]),[G,r]=o.useState([]),[x,j]=o.useState([]),[E,Z]=o.useState([]);o.useEffect(()=>{D&&U(D.result)},[D]),o.useEffect(()=>{p&&Q(p.result)},[p]),o.useEffect(()=>{z&&V(z.result)},[z]),o.useEffect(()=>{F&&Z(F.result[0].vendorList)},[z]),console.log(E),o.useEffect(()=>{O&&r(O.result.map((n,P)=>({id:P,...n})))},[O]),o.useEffect(()=>{if(F){const n=F.result[0];$(n.uomList)}},[F]);const K=(N==null?void 0:N.result)||[],A=n=>{const{name:P,value:i}=n.target;if(P==="collectionId"){const s=K.find(c=>c.collectionId===parseInt(i));q(i),u({...t,collectionId:i,poPcs:s?s.poPcs:""})}else if(P==="designId"){const s=M.find(c=>c.designId===parseInt(i));u({...t,designId:i,baseColorId:s?s.colorId:"",baseColorName:s?s.colorName:""})}else if(P==="batchNo"){const s=R.find(c=>c.batchNo===i);u({...t,batchNo:i,planningHeaderId:s?s.planningHeaderId:""})}else if(P==="fabricId"){const s=L.find(c=>c.fabricId===i);console.log("Selected Fabric:",L),u({...t,fabricId:i,OutputQty:s?s.total:""}),d(i)}else u(P==="processType"?{...t,processType:i}:P==="vendorId"?{...t,vendorId:i}:{...t,[P]:i})},d=async n=>{try{const i=(await _.get(`https://gecxc.com:4041/api/DyeingPrinting/GetFabricColorFromPrePlanningByFabricId?fabricId=${n}`)).data.result;if(console.log("Dyeing Color Data",i),i.length>0){const c=i[0];u(h=>({...h,Shrinkage:c.shrinkage.toFixed(2),Wastage:c.wastage.toFixed(2),UOM:c.uom,AvailableQty:c.total.toString()}))}const s=i.map(c=>({label:c.color,value:c.colorId}));if(j(s),s.length>0){const c=s[0];u(h=>({...h,ColorId:c.value,color:c.label}))}}catch(P){console.error("Error fetching fabric color data:",P)}};o.useEffect(()=>{const n=()=>{const X=parseFloat(t.AvailableQty)||0,b=parseFloat(t.Shrinkage)||0,g=parseFloat(t.Wastage)||0;return X*(100-(b+g))/100},P=()=>{const X=parseFloat(t.AvailableQty)||0,b=parseFloat(t.RatePerUOM)||0;return X*b},i=(X,b)=>X*(1+b/100),s=n(),c=P(),h=parseFloat(t.GST)||0,f=i(c,h),k=parseFloat(t.poPcs)||0,se=k?f/k:0;u(X=>({...X,OutputQty:s,TotalExclGst:c.toFixed(2),TotalIncludingGst:f.toFixed(2),UnitRatePerPo:se.toFixed(2)}))},[t.AvailableQty,t.Shrinkage,t.Wastage,t.RatePerUOM,t.GST,t.poPcs,t.UnitRatePerPo]);const S=async()=>{console.log("Form Data:",t);const n={dpId:parseInt(t.DPId)||0,designId:parseInt(t.designId),batchNo:t.batchNo,fabricId:parseInt(t.fabricId),colorId:parseInt(t.ColorId)||0,vendorId:t.vendorId||0,processType:t.processType,availableQty:parseFloat(t.AvailableQty)||0,shrinkage:parseFloat(t.Shrinkage)||0,wastage:parseFloat(t.Wastage)||0,outputQty:parseFloat(t.OutputQty)||0,uomId:parseInt(t.UOM)||0,ratePerUOM:parseFloat(t.RatePerUOM)||0,unitRatePerPo:parseFloat(t.UnitRatePerPo)||0,totalExclGst:parseFloat(t.TotalExclGst)||0,gst:parseFloat(t.GST)||0,gstAmount:parseFloat(t.GSTAmount)||0,totalIncludingGst:parseFloat(t.TotalIncludingGst)||0,createdBy:t.createdBy};console.log("Payload:",n);try{const P=await _.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",n);P.status===200?(console.log("Data saved successfully:",P.data),u({DPId:"",designId:"",batchNo:"",fabricId:"",ColorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",GSTAmount:"",TotalIncludingGst:"",createdBy:0,poPcs:""})):console.error("Failed to save data:",P.data)}catch(P){console.error("Error saving data:",P)}},I=[{field:"name",headerName:"Order Number",editable:!0,flex:2},{field:"DesignId",headerName:"Design",type:"number",flex:1,align:"left",headerAlign:"left",editable:!0},{field:"FabricId",headerName:"Fabric",type:"date",flex:1,editable:!0},{field:"ProcessType",headerName:"Process",flex:1,editable:!0},{field:"ColorId",headerName:"Color",flex:1,editable:!0},{field:"role",headerName:"Po Pcs",flex:1,editable:!0},{field:"AvailableQty",headerName:"Qty",flex:1,editable:!0},{field:"UOM",headerName:"UOM",flex:1,editable:!0},{field:"RatePerUOM",headerName:"Rate",flex:1,editable:!0},{field:"UnitRatePerPo",headerName:"Unit Price",flex:1,editable:!0},{field:"TotalIncludingGst",headerName:"Total W/ GST",flex:1,editable:!0}],m=[{value:"D",label:"Dyeing"},{value:"P",label:"Printing"}];return e.jsx(ae,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(de,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Dyeing/Printing"})}),e.jsx(a,{item:!0,xs:3,md:3,textAlign:"right",children:e.jsx(w,{variant:"contained",color:"primary",size:"small",onClick:S,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:C,onChange:A,size:"small",children:K.map(n=>e.jsx(v,{value:n.collectionId,children:n.collectionName},n.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:A,size:"small",children:M.map(n=>e.jsx(v,{value:n.designId,children:n.designNo},n.designId))})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:A,size:"small",children:R.map(n=>e.jsx(v,{value:n.batchNo,children:n.batchNo},n.batchNo))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:A,children:L.map(n=>e.jsx(v,{value:n.fabricId,children:n.fabric},n.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(Te,{fullWidth:!0,options:x,getOptionLabel:n=>n.label||"",renderInput:n=>e.jsx(l,{...n,label:"Color",name:"ColorId",size:"small"}),value:x.find(n=>n.value===t.ColorId)||null,onChange:(n,P)=>{u(i=>({...i,ColorId:P?P.value:""}))}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:t.vendorId,onChange:A,children:E.map(n=>e.jsx(v,{value:n.lookUpId,children:n.lookUpName},n.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:A,disabled:!0})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:t.processType,onChange:A,children:m.map(n=>e.jsx(v,{value:n.value,children:n.label},n.value))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:t.UOM})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"AvailableQty",fullWidth:!0,size:"small",name:"AvailableQty",value:t.AvailableQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Shrinkage%",fullWidth:!0,size:"small",name:"Shrinkage",value:t.Shrinkage})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Wastage%",fullWidth:!0,size:"small",name:"Wastage",value:t.Wastage})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",value:t.OutputQty})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",name:"RatePerUOM",value:t.RatePerUOM,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Excluding GST",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalExclGst,onChange:A})}),e.jsxs(a,{item:!0,xs:12,md:1.5,children:[e.jsx(l,{label:"GST",fullWidth:!0,size:"small",name:"GST",value:t.GST,onChange:A})," "]}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalIncludingGst,onChange:A})}),e.jsx(a,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:t.UnitRatePerPo,onChange:A})}),e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%",mt:2}}),e.jsx(a,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(ce,{initialRows:G,ncolumns:I})})]})})})},Qe=Me,Ve=()=>{const[t,u]=o.useState({designId:"",batchNo:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHeads:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStitches:"",threadRate:"",threadAmount:"",tillaStitches:"",tillaRate:"",tillaAmount:"",sequenceStitches:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:"",solvingInMeters:"",solvingRate:"",solvingAmount:"",additional:"",costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0}),{data:N}=oe(),[C,q]=o.useState(""),{data:F}=ue(),{data:D,refetch:Y}=re(C,{skip:!C}),{data:p,refetch:te}=me(t.designId,{skip:!t.designId}),{data:z}=xe({batchNo:t.batchNo,componentId:t.componentId},{skip:!t.batchNo||!t.componentId}),{data:O}=fe({batchNo:t.batchNo,componentId:t.componentId,fabricId:t.fabricId},{skip:!t.batchNo||!t.componentId||!t.fabricId}),{data:B,refetch:M}=he(t.batchNo,{skip:!t.batchNo}),{data:U}=be(t.batchNo,{skip:!t.batchNo});console.log("colorData",O);const[R,Q]=o.useState([]),[L,V]=o.useState([]),[T,$]=o.useState([]),[G,r]=o.useState([]),[x,j]=o.useState([]),[E,Z]=o.useState([]),[K,A]=o.useState([]),[d,S]=o.useState([]);o.useEffect(()=>{D&&Q(D.result)},[D]),o.useEffect(()=>{p&&V(p.result)},[p]),o.useEffect(()=>{z&&$(z.result)},[z]),o.useEffect(()=>{O&&Z(z.result)},[O]),o.useEffect(()=>{U&&S(U.result)},[U]),o.useEffect(()=>{B&&A(B.result.map((i,s)=>({id:s,...i})))},[B]),o.useEffect(()=>{if(F){const i=F.result[0];r(i.vendorList),j(i.noOfHeadsList)}},[F]);const I=(N==null?void 0:N.result)||[];o.useEffect(()=>{const i=()=>{const b=parseFloat(t.repeats)||0,g=parseFloat(t.itemsPerRepeat)||0;return b*g};u(b=>({...b,totalPcs:i()}));const s=()=>{const b=parseFloat(t.threadStitches)||0,g=parseFloat(t.threadRate)||0,y=parseFloat(t.noOfHeads)||0,W=parseFloat(t.repeats)||0;return b/1e3*(g*W*y)};u(b=>({...b,threadAmount:s()}));const c=()=>{const b=parseFloat(t.tillaStitches)||0,g=parseFloat(t.tillaRate)||0,y=parseFloat(t.noOfHeads)||0,W=parseFloat(t.repeats)||0;return b/1e3*(g*W*y)};u(b=>({...b,tillaAmount:c()}));const h=()=>{const b=parseFloat(t.sequenceStitches)||0,g=parseFloat(t.sequenceRate)||0,y=parseFloat(t.noOfHeads)||0,W=parseFloat(t.repeats)||0;return b/1e3*(g*W*y)};u(b=>({...b,sequenceAmount:h()}));const f=()=>{const b=parseFloat(t.repeats)||0,g=parseFloat(t.noOfHeads)||0,y=parseFloat(t.solvingLayers)||0;return b*g*13/39.37*y};u(b=>({...b,solvingInMeters:f()}));const k=()=>{const b=parseFloat(t.solvingInMeters)||0,g=parseFloat(t.solvingRate)||0;return parseFloat(t.solvingLayers),b*g};u(b=>({...b,solvingAmount:k()}));const se=()=>{const b=parseFloat(t.threadAmount)||0,g=parseFloat(t.tillaAmount)||0,y=parseFloat(t.sequenceAmount)||0,W=parseFloat(t.solvingAmount)||0;return b+g+y+W};u(b=>({...b,totalAmount:se()}));const X=()=>{const b=parseFloat(t.totalAmount)||0,g=parseFloat(t.totalPcs)||0;return b/g};u(b=>({...b,costPerComponent:X()}))},[t.threadAmount,t.totalAmount,t.sequenceAmount,t.solvingAmount,t.repeats,t.tillaAmount,t.itemsPerRepeat,t.threadRate,t.threadStitches,t.noOfHeads,t.tillaRate,t.tillaStitches,t.sequenceRate,t.sequenceStitches,t.solvingLayers,t.solvingInMeters,t.solvingRate]);const m=i=>{const{name:s,value:c}=i.target;if(s==="collectionId"){const h=I.find(f=>f.collectionId===parseInt(c));q(c),u({...t,collectionId:c,poPcs:h?h.poPcs:""})}else if(s==="designId"){const h=R.find(f=>f.designId===parseInt(c));u({...t,designId:c,baseColorId:h?h.colorId:"",baseColorName:h?h.colorName:""})}else if(s==="batchNo"){const h=L.find(f=>f.batchNo===c);u({...t,batchNo:c,planningHeaderId:h?h.planningHeaderId:""})}else if(s==="colorId"){const h=E.find(f=>f.colorId===c);u({...t,colorId:c,availableQty:h?h.total:"",cuttingSize:h?h.cuttingSize:"",repeats:h?h.repeats:""})}else u({...t,[s]:c})},n=[{field:"designId",headerName:"Design",editable:!0,flex:1,type:"singleSelect",valueOptions:R.map(i=>({value:i.designId,label:i.designNo}))},{field:"poPcs",headerName:"PO. Pieces",flex:1,editable:!0},{field:"quantity",headerName:"Quantity",flex:1,editable:!0},{field:"rate",headerName:"Rate",editable:!0,flex:1},{field:"vendorId",headerName:"Vendor",editable:!0,flex:1,type:"singleSelect",valueOptions:G.map(i=>({value:i.lookUpId,label:i.lookUpName}))},{field:"total",headerName:"Total",flex:1,editable:!0,valueSetter:(i,s)=>{const c=s.quantity??0,h=s.rate??0,f=c*h;return console.log("total",f),{...s,total:f}}},{field:"unitPrice",headerName:"Unit Price",flex:1,editable:!0,valueSetter:(i,s)=>{const c=s.total??0,h=s.poPcs??0,f=c/h;return console.log("unitPrice",f),{...s,unitPrice:f}}},{field:"gst",headerName:"GST",flex:1,editable:!0},{field:"totalInclGst",headerName:"Total Inc. GST",flex:1,editable:!0,valueSetter:(i,s)=>{const c=s.total??0,h=s.gst??0,f=c*(1+h/100);return console.log("totalInclGst",f),{...s,totalInclGst:f}}}],P=async()=>{try{const i=await _.post("https://gecxc.com:4041/api/Fabrication/SaveFabrication",t);console.log("Save response:",i.data),u({designId:"",batchNo:"",baseColorId:"",baseColorName:"",fabricId:"",poPcs:"",quantity:"",rate:"",uomId:"string",total:"",unitPrice:"",gst:"",totalInclGst:"",createdOn:"2024-05-29T09:56:23.916Z",createdBy:0,lastUpdatedOn:"2024-05-29T09:56:23.916Z",LastUpdatedBy:0})}catch(i){console.error("Error saving data:",i)}};return console.log("formData",t),e.jsxs(ae,{style:{borderWidth:2,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:[e.jsx(de,{children:e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,xs:9,md:9,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Schiffli"})}),e.jsx(a,{item:!0,xs:3,textAlign:"right",children:e.jsx(w,{variant:"contained",size:"small",onClick:P,children:"Save"})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:C,onChange:m,size:"small",children:I.map(i=>e.jsx(v,{value:i.collectionId,children:i.collectionName},i.collectionId))})," "]}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:m,size:"small",children:R.map(i=>e.jsx(v,{value:i.designId,children:i.designNo},i.designId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:m,disabled:!0})}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:m,size:"small",children:L.map(i=>e.jsx(v,{value:i.batchNo,children:i.batchNo},i.batchNo))})," "]}),e.jsxs(a,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:t.componentId,onChange:m,size:"small",children:d.map(i=>e.jsx(v,{value:i.componentId,children:i.componentName},i.componentId))})," "]}),e.jsx(a,{item:!0,xs:12,md:12,children:e.jsx(le,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:m,children:T.map(i=>e.jsx(v,{value:i.fabricId,children:i.fabric},i.fabricId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:t.vendorId,onChange:m,children:G.map(i=>e.jsx(v,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:t.colorId,onChange:m,children:E.map(i=>e.jsx(v,{value:i.colorId,children:i.color},i.colorId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:t.availableQty,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:t.repeats,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHeads",value:t.noOfHeads,onChange:m,children:x.map(i=>e.jsx(v,{value:i.lookUpId,children:i.lookUpName},i.lookUpId))})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",value:t.cuttingSize,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"itemsPerRepeat",fullWidth:!0,size:"small",name:"itemsPerRepeat",value:t.itemsPerRepeat,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",name:"totalPcs",value:t.totalPcs,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",name:"totalAmount",value:t.totalAmount,onChange:m})}),e.jsx(a,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:t.costPerComponent,onChange:m})})]})}),e.jsx(a,{container:!0,spacing:2,width:"Inherit",children:e.jsx(a,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ce,{ncolumns:n,initialRows:K,formData:t,disableAddRecord:!0})})})]})},Xe=Ve;function $e(){const t=[{value:"D# 01-A",label:"D# 01-A"},{value:"D# 01-A",label:"D# 01-A"}],u=[{value:"D# 01-A-MM-Y",label:"D# 01-A-MM-Y"},{value:"No",label:"No"}],N=[{value:"Front",label:"Front"},{value:"Back",label:"Back"}],C=[{value:"Lawn 102/88",label:"Lawn 102/88"},{value:"Lawn 99/88",label:"Lawn 99/88"}],q=[{value:"Khuram",label:"Khuram"},{value:"Ramia",label:"Ramia"}],F=[{value:"Auto Fetch",label:"Auto Fetch"},{value:"No",label:"No"}],D=[{value:"Black",label:"Black"},{value:"Red",label:"Red"}],Y=[{value:"Hand Work",label:"Hand Work"},{value:"Patch Work",label:"Patch Work"}];return e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Additional Process"})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Select Design",defaultValue:"D# 01-A",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:t.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Select Batch#",defaultValue:"D# 01-A-MM-Y",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:u.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Components",defaultValue:"Front",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:N.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Fabric",defaultValue:"Lawn 102/88",helperText:"Design",variant:"outlined",size:"small",fullWidth:!0,children:C.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Vendor Name",defaultValue:"Haneef",variant:"outlined",size:"small",fullWidth:!0,children:q.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Select Design Color",defaultValue:"Auto Fetch",variant:"outlined",size:"small",fullWidth:!0,children:F.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:" Color",defaultValue:"Black",variant:"outlined",size:"small",fullWidth:!0,children:D.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:" Process Type",defaultValue:"Hand Work",variant:"outlined",size:"small",fullWidth:!0,children:Y.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Pcs per component",name:"Pcs per component",size:"small",required:!0})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC'S",name:"PO PC'S",size:"small",disabled:!0})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:" Quantity",name:"Quantity",size:"small",required:!0})}),e.jsx(a,{item:!0,md:1.5,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"Rate",size:"small",required:!0})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Component",name:"Cost per Component",size:"small",required:!0})}),e.jsx(a,{item:!0,md:3,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"Total Amount",size:"small",required:!0})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(w,{variant:"contained",color:"primary",size:"small",children:"Add"})})]})}function Ze(){const[t,u]=o.useState([]),N=[{field:"Order No.",headerName:"Order No",width:150},{field:"Design",headerName:"Design",width:200},{field:"Design Color",headerName:"Design Color",minWidth:120},{field:"Component",headerName:"Component",minWidth:120},{field:"Fabric",headerName:"Fabric",minWidth:120},{field:"Vendor Name",headerName:"Vendor Name",minWidth:120},{field:"Process",headerName:"Process",minWidth:120},{field:"Color",headerName:"Color",minWidth:120},{field:"Po Pcs",headerName:"Po Pcs",minWidth:120},{field:"Qty",headerName:"Qty",minWidth:120},{field:"Rate",headerName:"Rate",minWidth:120},{field:"Cost per Component",headerName:"Cost per Component",minWidth:120},{field:"Total Amount",headerName:"Total Amount",minWidth:120}];return e.jsx("div",{style:{height:"auto",width:"100%"},children:e.jsx(ve,{rows:t,columns:N,autoHeight:!0,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10,15],localeText:{toolbarDensity:"Size",toolbarDensityLabel:"Size",toolbarDensityCompact:"Small",toolbarDensityStandard:"Medium",toolbarDensityComfortable:"Large"},components:{Toolbar:Ie}})})}function _e(){return e.jsxs(ae,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23"},children:[e.jsx($e,{}),e.jsx(le,{}),e.jsx(Ze,{})]})}function Ye(){const t=[{value:"Card Printing",label:"Card Printing"},{value:"Additional Service",label:"Additional Service"}],u=[{value:"Elaf PVC Zipper Bag",label:"Elaf PVC Zipper Bag"},{value:"No",label:"No"}],N=[{value:"Mudassir Hussain Packaging Service",label:"Mudassir Hussain Packaging Service"},{value:"No",label:"No"}];return e.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,children:e.jsx(H,{variant:"h3",gutterBottom:!0,children:"Additional Services"})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service Type",defaultValue:"Card Printing",helperText:"Service Type",variant:"outlined",size:"small",fullWidth:!0,children:t.map(C=>e.jsx(v,{value:C.value,children:C.label},C.value))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service List",defaultValue:"Elaf PVC Zipper Bag",helperText:"Service List",variant:"outlined",size:"small",fullWidth:!0,children:u.map(C=>e.jsx(v,{value:C.value,children:C.label},C.value))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Vendor Name",defaultValue:"Mudassir Hussain Packaging Service",helperText:"Service List",variant:"outlined",size:"small",fullWidth:!0,children:N.map(C=>e.jsx(v,{value:C.value,children:C.label},C.value))})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC's",name:"PO PC's",size:"small",disabled:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Qty",name:"Qty",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"UOM",name:"UOM",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"Rate",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"Total Amount",size:"small",required:!0})}),e.jsx(a,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Piece",name:"Cost per Piece",size:"small",required:!0})}),e.jsx(a,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(w,{variant:"contained",color:"primary",size:"small",children:"Add"})})]})}function Ke(){const[t,u]=o.useState([]),N=[{field:"Service Type",headerName:"Service Type",width:150},{field:"Service List",headerName:"Service List",width:200},{field:"Vendor",headerName:"Vendor",minWidth:120},{field:"Qty",headerName:"Qty",minWidth:120},{field:"UOM",headerName:"UOM",minWidth:120},{field:"Rate",headerName:"Rate",minWidth:120},{field:"Total Amount",headerName:"Total Amount",minWidth:120}];return e.jsx("div",{style:{height:"auto",width:"100%"},children:e.jsx(ve,{rows:t,columns:N,autoHeight:!0,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10,15],localeText:{toolbarDensity:"Size",toolbarDensityLabel:"Size",toolbarDensityCompact:"Small",toolbarDensityStandard:"Medium",toolbarDensityComfortable:"Large"},components:{Toolbar:Ie}})})}function Je(){return e.jsxs(ae,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23"},children:[e.jsx(Ye,{}),e.jsx(le,{}),e.jsx(Ke,{})]})}const ne=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function rt(){const[t,u]=o.useState(0),[N,C]=o.useState(new Set),[q,F]=o.useState(null),[D,Y]=o.useState([]),{enqueueSnackbar:p}=ze(),te=x=>{F(x.currentTarget)},z=()=>{F(null)},O=!!q,B=O?"simple-popover":void 0,M=x=>x===1,U=x=>N.has(x),R=()=>{let x=N;U(t)&&(x=new Set(x.values()),x.delete(t)),u(j=>j+1),C(x)},Q=()=>{u(x=>x-1)},L=()=>{if(!M(t))throw new Error("You can't skip a step that isn't optional.");u(x=>x+1),C(x=>{const j=new Set(x.values());return j.add(t),j})},V=()=>{u(0)},[T,$]=o.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),G=async()=>{if(!T.lookUpDomain||!T.lookUpName){p("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const x=await _.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${T.lookUpDomain}&LookUpName=${T.lookUpName}&appId=1`);return console.log("Form data saved:",x.data),p("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),$({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),x.data}catch(x){throw console.error("Error saving data:",x),p("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),x}},r=x=>{$({...T,[x.target.name]:x.target.value})};return o.useEffect(()=>{(async()=>{try{const j=await _.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",j),Y(j.data.result)}catch(j){console.error("Error fetching design options:",j)}})()},[]),e.jsxs(ee,{sx:{width:"100%"},children:[e.jsxs(a,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(a,{item:!0,sm:6,children:e.jsx(H,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(a,{item:!0,sm:6,textAlign:"right",children:[e.jsx(w,{"aria-describedby":B,variant:"outlined",size:"small",onClick:te,children:"+Lookup"}),e.jsx(Ue,{id:"mouse-over-popover",open:O,anchorEl:q,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(a,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:T.lookUpDomain,name:"lookUpDomain",onChange:r,children:D.map(x=>e.jsx(v,{value:x.lookUpDomain,children:x.lookUpDomain},x.lookUpDomain))})}),e.jsx(a,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,label:"Add Lookup Description",value:T.lookUpName,onChange:r,name:"lookUpName",size:"small"})}),e.jsx(a,{item:!0,sm:3,textAlign:"right",children:e.jsx(w,{variant:"contained",size:"small",onClick:G,children:"Save"})})]})})]})]}),e.jsx(Ae,{activeStep:t,children:ne.map((x,j)=>{const E={},Z={};return M(j)&&(Z.optional=e.jsx(H,{variant:"caption",children:"Optional"})),U(j)&&(E.completed=!1),e.jsx(De,{...E,children:e.jsx(We,{...Z,children:x})},x)})}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(w,{color:"inherit",disabled:t===0,onClick:Q,sx:{mr:1},children:"Back"}),e.jsx(ee,{sx:{flex:"1 1 auto"}}),M(t)&&e.jsx(w,{color:"inherit",onClick:L,sx:{mr:1},children:"Skip"}),e.jsx(w,{onClick:R,children:t===ne.length-1?"Finish":"Next"})]}),t===ne.length?e.jsxs(o.Fragment,{children:[e.jsx(H,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ee,{sx:{flex:"1 1 auto"}}),e.jsx(w,{onClick:V,children:"Reset"})]})]}):e.jsxs(o.Fragment,{children:[e.jsxs(H,{sx:{mt:2,mb:1},children:["Step ",t+1]}),t===0&&e.jsx(Ee,{}),t===1&&e.jsx(Oe,{}),t===2&&e.jsx(Qe,{}),t===3&&e.jsx(Be,{}),t===4&&e.jsx(Xe,{}),t===5&&e.jsx(_e,{}),t===6&&e.jsx(Je,{}),e.jsxs(ee,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(w,{color:"inherit",disabled:t===0,onClick:Q,sx:{mr:1},children:"Back"}),e.jsx(ee,{sx:{flex:"1 1 auto"}}),M(t)&&e.jsx(w,{color:"inherit",onClick:L,sx:{mr:1},children:"Skip"}),e.jsx(w,{onClick:R,children:t===ne.length-1?"Finish":"Next"})]})]})]})}export{rt as default};
