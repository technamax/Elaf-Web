import{u as H,a as $,d as Q,c as _,j as t,M as V,B as N,G as a,T as P,D as S}from"./index-DuzC95fe.js";import{r as s}from"./vendor-BXCbSo2_.js";import{a as O}from"./axios-B0b4r6rC.js";import{T as J,a as K,b as w,d as X,c as Y,e as B,F as T}from"./EditAbleDataGrid-CaBIStsk.js";import{B as k,T as i}from"./TextField-D3nO1ftf.js";import{M as U}from"./Skeleton-Cr70XX44.js";import"./DataGrid-DEjeA-50.js";import"./ExcelExport-CmjamEmv.js";import"./dayjs.min-DO4_1a-m.js";const ie=()=>{const{user:c}=H(),{data:u}=$(),[p,z]=s.useState(""),{data:m,refetch:x}=Q(p,{skip:!p}),{enqueueSnackbar:f}=_(),[l,F]=s.useState({}),[I,j]=s.useState([]),[v,R]=s.useState([]),[q,L]=s.useState("1"),W=(e,r)=>{L(r)};s.useEffect(()=>{m&&(j(m.result),x())},[m]),s.useEffect(()=>{(async()=>{try{const d=(await O.get(" https://gecxc.com:4041/api/Common/GetLookUpByDomain?lookupDomain=COLOURS")).data.result;R(d)}catch(r){console.error("Error fetching pre-planning lookup data:",r)}})()},[]);const h=(u==null?void 0:u.result)||[],[n,g]=s.useState({collectionId:"",designNo:"",designerName:"",poPcs:"",dateOfPlanning:"",colorId:"",appId:1,createdBy:c.empId,createdOn:new Date().toISOString(),lastUpdatedBy:c.empId,lastUpdatedOn:new Date().toISOString()}),o=e=>{const{name:r,value:d}=e.target;if(r==="collectionId"){const C=h.find(M=>M.collectionId===parseInt(d));z(d),g({...n,collectionId:d,poPcs:C?C.poPcs:"",designNo:"",designerName:"",dateOfPlanning:"",colorId:""})}else g({...n,[r]:d})},D=I.map((e,r)=>({id:r+1,designId:e.designId,collectionId:e.collectionId,designNo:e.designNo,designerName:e.designerName,poPcs:e.poPcs,dateOfPlanning:e.dateOfPlanning,colorId:e.colorId,appId:e.appId,createdBy:e.createdBy,createdOn:e.createdOn,lastUpdatedBy:e.lastUpdatedBy,lastUpdatedOn:e.lastUpdatedOn}));console.log("initialRows",D);const b=[{field:"collectionId",headerName:"Collection ID",editable:!0,flex:2,type:"singleSelect",valueOptions:h.map(e=>({value:e.collectionId,label:e.collectionName}))},{field:"designNo",headerName:"Design No",flex:1,editable:!0},{field:"designerName",headerName:"Designer Name",flex:1,editable:!0},{field:"poPcs",headerName:"Po PCs",flex:1,editable:!0},{field:"dateOfPlanning",headerName:"Date of Planning",type:"date",flex:1,editable:!0,valueGetter:e=>e?new Date(e):null,valueFormatter:e=>{const r=e;return r?r.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"}):""}},{field:"colorId",headerName:"Color",flex:1,editable:!0,type:"singleSelect",valueOptions:v.map(e=>({value:e.lookUpId,label:e.lookUpName}))}],E=async()=>{console.log(n);const e=G();if(Object.keys(e).length>0){F(e);return}try{const r=await O.post("https://gecxc.com:4041/API/DesignRegistration/SaveDesign",n);f("Design saved successfully!",{variant:"success",autoHideDuration:5e3}),console.log("Form data saved:",r.data),j([...I,r.data]),g({collectionId:"",designNo:"",designerName:"",poPcs:"",dateOfPlanning:"",colorId:"",createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId}),x()}catch(r){console.error("Error saving data:",r),f("Design not saved successfully!",{variant:"error",autoHideDuration:5e3})}},G=()=>{const e={};return n.collectionId||(e.collectionId="collectionId is required"),n.designNo||(e.designNo="designNo is required"),n.dateOfPlanning||(e.dateOfPlanning="dateOfPlanning is required"),n.colorId||(e.colorId="colorId is required"),e},y="https://gecxc.com:4041/API/DesignRegistration/SaveDesign",A=()=>{};return t.jsx(V,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:t.jsx(N,{sx:{width:"100%",typography:"body1"},children:t.jsxs(J,{value:q,children:[t.jsx(N,{sx:{borderBottom:1,borderColor:"divider"},children:t.jsxs(K,{onChange:W,children:[t.jsx(w,{icon:t.jsx(X,{}),label:"Add Design",value:"1",sx:e=>({"& .MuiTouchRipple-child":{backgroundColor:`${e.palette.primary.main} !important`}})}),t.jsx(w,{icon:t.jsx(Y,{}),label:"Search Design",value:"2",sx:e=>({"& .MuiTouchRipple-child":{backgroundColor:`${e.palette.primary.main} !important`}})})]})}),t.jsxs(B,{value:"1",children:[t.jsxs(a,{container:!0,spacing:2,width:"Inherit",children:[t.jsx(a,{item:!0,xs:9,md:9,children:t.jsx(P,{variant:"h3",gutterBottom:!0,children:"Create New Design"})}),t.jsx(a,{item:!0,xs:3,md:3,textAlign:"right",children:t.jsx(k,{variant:"contained",size:"small",onClick:E,children:"Save"})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:n.collectionId,onChange:o,size:"small",required:!0,error:!!l.collectionId,helperText:l.collectionId,children:h.map(e=>t.jsx(U,{value:e.collectionId,children:e.collectionName},e.collectionId))})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{label:"Design No.",name:"designNo",fullWidth:!0,size:"small",value:n.designNo,onChange:o,error:!!l.designNo,helperText:l.designNo,required:!0})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{label:"Designer Name",fullWidth:!0,size:"small",name:"designerName",value:n.designerName,onChange:o})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{size:"small",type:"date",label:"Planning Date",name:"dateOfPlanning",value:n.dateOfPlanning,error:!!l.dateOfPlanning,helperText:l.dateOfPlanning,onChange:o,fullWidth:!0,focused:!0,required:!0})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{label:"Po PCs",fullWidth:!0,size:"small",name:"poPcs",type:"number",value:n.poPcs,disabled:!0,onChange:o})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:o,error:!!l.colorId,helperText:l.colorId,required:!0,children:v.map(e=>t.jsx(U,{value:e.lookUpId,children:e.lookUpName},e.lookUpId))})})]}),t.jsx(S,{}),t.jsx(a,{container:!0,spacing:2,width:"inherit",paddingTop:2,children:t.jsx(a,{item:!0,xs:12,md:12,children:t.jsx(T,{initialRows:D,ncolumns:b,formData:n,editAPi:y})})})]}),t.jsxs(B,{value:"2",children:[t.jsxs(a,{container:!0,spacing:2,width:"inherit",children:[t.jsx(a,{item:!0,xs:9,md:9,children:t.jsx(P,{variant:"h3",gutterBottom:!0,children:"Search Design"})}),t.jsx(a,{item:!0,xs:3,textAlign:"right",children:t.jsx(k,{variant:"contained",size:"small",onClick:A,children:"Search"})}),t.jsx(a,{item:!0,xs:12,md:6,children:t.jsx(i,{size:"small",type:"date",label:"Date From",name:"planningDate",value:n.planningDate,onChange:o,fullWidth:!0,focused:!0})}),t.jsx(a,{item:!0,xs:12,md:6,children:t.jsx(i,{size:"small",type:"date",label:"Date to",name:"launchDate",value:n.launchDate,onChange:o,fullWidth:!0,focused:!0})}),t.jsx(a,{item:!0,sm:12,children:t.jsx(S,{color:"#cc8587",sx:{height:2,width:"100%"}})})]}),t.jsx(a,{container:!0,spacing:2,width:"inherit",paddingTop:2,children:t.jsx(a,{item:!0,xs:12,children:t.jsx(T,{initialRows:[],ncolumns:b,formData:n,editAPi:y,disableAddRecord:!0})})})]})]})})})};export{ie as default};
