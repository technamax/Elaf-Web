import{j as e,_ as Ba,F as Fa,H as Ra,u as We,c as ze,b as _e,bg as za,B as Re,G as r,T as Ce,D as ge,aC as ct,bh as Qa,aU as $e,aV as Xe,aW as ot,bi as ut,bj as pt,bk as Wa,bl as mt,C as Pe,d as Me,aZ as rt,e as Ye,bm as _a,aX as Ua,bn as Ha,bo as qa,bp as Ea,bq as Ga,br as Ya,bs as Va,bt as Bt,be as $a,M as Ka,bu as Xa}from"./index-BQnKJm_U.js";import{r as o,g as Da}from"./vendor-BXCbSo2_.js";import{B as fe,a as Se,I as Qe}from"./axios-CIHeZEXI.js";import{d as Ft,c as et,A as Rt,e as zt,f as Qt,S as Ja,a as Za,b as eo,F as to}from"./Fabrication-D4EH97q1.js";import{d as Ve}from"./VisibilityOutlined-DhBBgDuL.js";import{A as Ze,R as qe,F as Wt,C as _t,a as nt,b as ht,c as st,d as gt,B as bt,u as ao,D as Ge,g as Mt,h as oo}from"./ReuseableDataGrid-DM_ExMFu.js";import{d as ft}from"./Close-BQnbGXeb.js";import{d as It}from"./PersonAddAlt1Outlined-BgvGphrR.js";import{T as u,P as St}from"./TextField-B9bDqCXW.js";import{M as _}from"./MenuItem-CqoynPPu.js";import"./dayjs.min-DO4_1a-m.js";import"./Skeleton-B93ZyZJN.js";let Pt=!1;const ro=o.forwardRef(function(d,v){return Pt||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),Pt=!0),e.jsx(Ze,Ba({ref:v},d))});var xt={},no=Ra;Object.defineProperty(xt,"__esModule",{value:!0});var Ut=xt.default=void 0,so=no(Fa()),lo=e;Ut=xt.default=(0,so.default)((0,lo.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const io="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",co=({initialFormData:n,setAdditionalProcessData:d,refetchDyeingPrintingData:v,handleClickOpen:j,showUpperDiv:h,productionStatus:t})=>{const{user:b}=We(),[s,F]=o.useState([]),[a,T]=o.useState([]),{enqueueSnackbar:k}=ze(),[K,m]=o.useState({}),y=s.reduce((I,q)=>I+(q.assignedQty??0),0).toFixed(2);console.log("Quantity",y);const[g,D]=o.useState({dpIdDet:0,dpId:n.dpId||0,designId:n.designId||"",batchNo:n.batchNo||"",planningHeaderId:n.planningHeaderId||0,fabricId:n.fabricId||"",fabricName:n.fabricName||"",colorId:n.colorId||"",colorName:n.colorName||"",uomId:n.uomId||"",uom:n.uom||"",poPcs:n.poPcs||"",vendorId:"",processType:n.processType||"",availableQty:n.availableQty||"",remainingQty:n.availableQty-y||"",shrinkage:n.allowedWastage||"",wastage:n.allowedWastage||"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",createdOn:new Date().toISOString(),createdBy:b.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:b.empId});o.useEffect(()=>{D(I=>({...g,dpIdDet:a.dpIdDet||0,dpId:a.dpId||0,designId:(a==null?void 0:a.designId)||"",planningHeaderId:(a==null?void 0:a.planningHeaderId)||0,batchNo:(a==null?void 0:a.batchNo)||"",vendorId:(a==null?void 0:a.vendorId)||"",shrinkage:(a==null?void 0:a.shrinkage)||"",wastage:(a==null?void 0:a.wastage)||"",outputQty:(a==null?void 0:a.outputQty)||0,remainingQty:I.remainingQty+(a==null?void 0:a.assignedQty)||"",assignedQty:(a==null?void 0:a.assignedQty)||"",rate:(a==null?void 0:a.rate)||0,unitRatePerPo:(a==null?void 0:a.unitRatePerPo)||"",totalExcGst:(a==null?void 0:a.totalExcGst)||"",gst:(a==null?void 0:a.gst)||0,TotalIncludingGst:(a==null?void 0:a.totalIncludingGst)||"",createdOn:(a==null?void 0:a.createdOn)||new Date().toISOString(),createdBy:(a==null?void 0:a.createdBy)||b.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:b.empId}))},[a]),o.useEffect(()=>{D({...g,remainingQty:n.availableQty-y>=0?n.availableQty-y:""})},[s,n.availableQty,y]);const{data:i}=_e(),{data:G,refetch:J}=za(g.dpId,{skip:!g.dpId}),[B,W]=o.useState([]);o.useEffect(()=>{if(i){const I=i.result[0];W(I.vendorList)}},[i]),o.useEffect(()=>{G&&F(G.result.map((I,q)=>({id:q+1,...I})))},[G,J]),console.log("initialRows",s);const z=I=>{const{name:q,value:oe}=I.target;D({...g,[q]:oe}),D(ie=>{const S={...ie,[q]:oe};if(q==="assignedQty"||q==="remainingQty"){const ue=S.assignedQty,re=S.remainingQty;ue>re?m(he=>({...he,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):m(he=>({...he,assignedQty:""}))}return S})};o.useEffect(()=>{const I=()=>{const M=parseFloat(g.assignedQty)||0,R=parseFloat(g.shrinkage)||0,ee=parseFloat(g.wastage)||0,P=R+ee;return(M*100/(100+P)).toFixed(2)},q=()=>{const M=parseFloat(g.assignedQty)||0,R=parseFloat(g.rate)||0;return(M*R).toFixed(2)},oe=(M,R)=>(M*(1+R/100)).toFixed(2),ie=I(),S=q(),ue=parseFloat(g.gst)||0,re=oe(S,ue),he=parseFloat(g.poPcs)||0,O=he?re/he:0;D(M=>({...M,outputQty:ie,totalExcGst:S,TotalIncludingGst:re,unitRatePerPo:O.toFixed(2)}))},[g.availableQty,g.assignedQty,g.shrinkage,g.wastage,g.rate,g.gst,g.poPcs,g.unitRatePerPo]),console.log("formData",g);const Z=async()=>{console.log(g);try{if(g.assignedQty>g.remainingQty){k("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}const I=await Se.post("http://100.42.177.77:83/api/DyeingPrinting/SaveDyeingPrintingDetails",g);console.log("Save response:",I.data),D(q=>({...q,dpIdDet:0,vendorId:"",availableQty:n.availableQty||"",shrinkage:"",wastage:"",assignedQty:"",rate:"",unitRatePerPo:0,totalExcGst:0,gst:"",TotalIncludingGst:"",remainingQty:n.availableQty-y||"",createdOn:new Date().toISOString(),createdBy:b.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:b.empId})),J(),v()}catch(I){console.error("Error saving data:",I)}},X=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"assignedQty",headerName:"Assigned Quantity",valueGetter:I=>I.toLocaleString()},{field:"rate",headerName:"Rate",flex:1},{field:"totalExcGst",headerName:"Total Excl Gst.",valueGetter:I=>I.toLocaleString()},{field:"gst",headerName:"Gst.",flex:1},{field:"totalIncludingGst",headerName:"TotalIncludingGst",valueGetter:I=>I.toLocaleString()},{field:"outputQty",headerName:"Output Qty",flex:1}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!h,children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"Fabric",name:"fabricName",value:g.fabricName,onChange:z,size:"small",disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Process Type",name:"processType",value:g.processType,onChange:z,size:"small",disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"Color",name:"colorName",value:g.colorName,onChange:z,size:"small",disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"UOM",name:"uom",value:g.uom,onChange:z,size:"small",disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"PO Pcs",size:"small",name:"poPcs",value:g.poPcs,onChange:z,disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total AvailableQty",fullWidth:!0,size:"small",name:"availableQty",value:g.availableQty,onChange:z,disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:g.remainingQty,onChange:z,disabled:!0,sx:I=>({...g.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:g.vendorId,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}},children:B.map(I=>e.jsx(_,{value:I.lookUpId,children:I.lookUpName},I.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Assign Quantity",fullWidth:!0,type:"number",size:"small",name:"assignedQty",value:g.assignedQty,onChange:z,disabled:!g.remainingQty,error:!!K.assignedQty,helperText:K.assignedQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Rate Per uom",type:"number",fullWidth:!0,size:"small",name:"rate",value:g.rate,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Shrinkage",fullWidth:!0,type:"number",size:"small",name:"shrinkage",value:g.shrinkage,onChange:z,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Wastage",fullWidth:!0,type:"number",size:"small",name:"wastage",value:g.wastage,onChange:z,disabled:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Output Qty",fullWidth:!0,type:"number",size:"small",name:"outputQty",value:g.outputQty,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Total Excl. Gst",fullWidth:!0,type:"number",size:"small",name:"totalExcGst",value:g.totalExcGst,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"GST",fullWidth:!0,size:"small",name:"gst",value:g.gst,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Total Including Gst",fullWidth:!0,size:"small",name:"TotalIncludingGst",value:g.TotalIncludingGst,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"UnitRate Per PO.",fullWidth:!0,size:"small",name:"unitRatePerPo",value:g.unitRatePerPo,onChange:z,disabled:!g.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(fe,{variant:"contained",size:"small",onClick:Z,disabled:t===3,children:"Save"})})]})]}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(r,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:X,initialRows:s,disableDelete:t===3,disableEdit:t===3,setInitialData:T,deleteApi:"http://100.42.177.77:83/api/DyeingPrinting/DeleteDyeingPrintingDetailByDetId?dpIdDet=",deleteBy:"dpIdDet",refetch:J})})]})]})},uo=({initialFormData:n,setAdditionalProcessData:d,refetchDyeingPrintingData:v,handleClickOpen:j,showUpperDiv:h,productionStatus:t})=>{const b=ct(),{enqueueSnackbar:s}=ze(),[F,a]=o.useState({}),{user:T}=We(),[k,K]=o.useState([]),[m,y]=o.useState([]),g=k.reduce((P,N)=>P+(N.assignedQty??0),0).toFixed(2);console.log("Quantity",g);const D=k.reduce((P,N)=>P+(N.requiredPcs??0),0).toFixed(2);console.log("totalRepeats",D);const[i,G]=o.useState({embroideryIdDet:0,embroideryId:n.embroideryId||0,designId:n.designId||"",batchNo:n.batchNo||"",planningHeaderId:n.planningHeaderId||0,componentId:n.componentId||"",componentName:n.componentName||"",fabricId:n.fabricId||"",fabricName:n.fabricName||"",vendorId:"",colorId:n.colorId||"",colourName:n.colourName||"",availableQty:n.availableQty||"",assignedQty:0,remainingQty:(n.availableQty-g).toFixed(2)||0,remainingRepeats:n.repeats-D||"",noOfHead:n.noOfHead||"",noOfHeadsName:n.noOfHeadsName||"",repeats:n.repeats||"",assignedRepeats:"",cuttingSize:n.cuttingSize||"",itemsPerRepeat:n.itemsPerRepeat||"",poPcs:n.poPcs||"",totalPcs:n.totalPcs||"",remainingPcs:(n.totalPcs-D).toFixed(2)||0,requiredPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],costPerComponent:0,createdOn:new Date().toISOString(),createdBy:T.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:T.empId});o.useEffect(()=>{G(P=>({...i,embroideryIdDet:m.embroideryIdDet||0,embroideryId:m.embroideryId||0,vendorId:(m==null?void 0:m.vendorId)||"",assignedQty:(m==null?void 0:m.assignedQty)||0,requiredPcs:(m==null?void 0:m.requiredPcs)||0,remainingQty:P.remainingQty+(m==null?void 0:m.assignedQty)||0,remainingPcs:P.remainingPcs+(m==null?void 0:m.requiredPcs)||0,totalAmount:(m==null?void 0:m.totalAmount)||0,threadStiches:(m==null?void 0:m.threadStiches)||0,threadRate:(m==null?void 0:m.threadRate)||0,threadAmount:(m==null?void 0:m.threadAmount)||0,tillaStiches:(m==null?void 0:m.tillaStiches)||0,tilaRate:(m==null?void 0:m.tilaRate)||0,tilaAmount:(m==null?void 0:m.tilaAmount)||0,sequence:(m==null?void 0:m.sequence)||0,sequenceRate:(m==null?void 0:m.sequenceRate)||0,sequenceAmount:(m==null?void 0:m.sequenceAmount)||0,isSolving:(m==null?void 0:m.isSolving)||!1,solvingLayers:(m==null?void 0:m.solvingLayers)||0,solvingInMeters:(m==null?void 0:m.solvingInMeters)||0,solvingRate:(m==null?void 0:m.solvingRate)||0,solvingAmount:(m==null?void 0:m.solvingAmount)||0,additional:(m==null?void 0:m.additional)||0,costPerComponent:(m==null?void 0:m.costPerComponent)||0,createdOn:(m==null?void 0:m.createdOn)||new Date().toISOString(),createdBy:(m==null?void 0:m.createdBy)||T.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:T.empId}))},[m]);const J=["Boring","Pooni","Laser","Doori","Dissolving"];function B(P,N,E){return{fontWeight:N.indexOf(P)===-1?E.typography.fontWeightRegular:E.typography.fontWeightMedium}}o.useEffect(()=>{G({...i,remainingQty:(n.availableQty-g).toFixed(2)||0,remainingPcs:n.totalPcs-D||0})},[k]);const{data:W}=_e(),{data:z,refetch:Z}=Qa(i.embroideryId,{skip:!i.embroideryId}),[X,Q]=o.useState([]);o.useEffect(()=>{if(W){const P=W.result[0];Q(P.vendorList)}},[W]),o.useEffect(()=>{z&&K(z.result.map((P,N)=>({id:N+1,...P})))},[z,Z]),console.log("initialRows",k);const I=P=>{const{name:N,value:E}=P.target;G({...i,[N]:E})},q=P=>{const{name:N,checked:E}=P.target;G(ne=>({...ne,[N]:E}))};console.log("formData",i);const[oe,ie]=o.useState(null),[S,ue]=o.useState(i);o.useEffect(()=>{const P=setTimeout(()=>{ue(i)},10);return()=>{clearTimeout(P)}},[i]);const re=P=>new Intl.NumberFormat("en-US").format(P);o.useEffect(()=>{const P=()=>{const L=parseFloat(S.repeats)||0,le=parseFloat(S.itemsPerRepeat)||0;return(L*le).toFixed(2)},N=()=>{const L=parseFloat(S.threadStiches)||0,le=parseFloat(S.threadRate)||0,me=parseFloat(S.noOfHeadsName)||0,be=parseFloat(S.repeats)||0;return(L/1e3*(le*be*me)).toFixed(2)},E=()=>{const L=parseFloat(S.tillaStiches)||0,le=parseFloat(S.tilaRate)||0,me=parseFloat(S.noOfHeadsName)||0,be=parseFloat(S.repeats)||0;return(L/1e3*(le*be*me)).toFixed(2)},ne=()=>{const L=parseFloat(S.sequence)||0,le=parseFloat(S.sequenceRate)||0,me=parseFloat(S.noOfHeadsName)||0,be=parseFloat(S.repeats)||0;return(L/1e3*(le*be*me)).toFixed(2)},se=()=>{const L=parseFloat(S.repeats)||0,le=parseFloat(S.noOfHeadsName)||0,me=parseFloat(S.solvingLayers)||0;return(L*le*13/39.37*me).toFixed(2)},Ie=()=>{const L=parseFloat(S.solvingInMeters)||0,le=parseFloat(S.solvingRate)||0;return(L*le).toFixed(2)},te=()=>{const L=parseFloat(S.threadAmount)||0,le=parseFloat(S.tilaAmount)||0,me=parseFloat(S.sequenceAmount)||0,be=parseFloat(S.solvingAmount)||0;return(L+le+me+be).toFixed(2)},U=()=>{const L=parseFloat(String(S.totalAmount).replace(/,/g,""))||0,le=parseFloat(S.requiredPcs)||0;return(L/le).toFixed(2)},de=te(),$=U();N(),G(L=>({...L,totalPcs:P(),threadAmount:N(),tilaAmount:E(),sequenceAmount:ne(),solvingInMeters:se(),solvingAmount:Ie(),totalAmount:re(de),costPerComponent:re($)}))},[S.threadAmount,S.totalAmount,S.sequenceAmount,S.solvingAmount,S.repeats,S.tilaAmount,S.itemsPerRepeat,S.threadRate,S.threadStiches,S.noOfHeadsName,S.tilaRate,S.tillaStiches,S.sequenceRate,S.sequence,S.solvingLayers,S.solvingInMeters,S.solvingRate,S.requiredPcs]),o.useEffect(()=>{if(oe==="assignedQty"){const P=()=>{const N=parseFloat(S.assignedQty)||0,E=parseFloat(S.availableQty)||0,ne=parseFloat(S.totalPcs)||0;return Math.round(N*(ne/E))};G(N=>({...N,requiredPcs:P()}))}else if(oe==="requiredPcs"){const P=()=>{const N=parseFloat(S.requiredPcs)||0,E=parseFloat(S.availableQty)||0,ne=parseFloat(S.totalPcs)||0;return(N*E/ne).toFixed(2)};G(N=>({...N,assignedQty:P()}))}},[S.assignedQty,S.requiredPcs,oe]);const he=P=>{const N=P.target.value,E=P.target.name;ie("assignedQty"),G(ne=>({...ne,assignedQty:N})),G(ne=>{const se={...ne,[E]:N};if(E==="assignedQty"||E==="remainingQty"){const Ie=parseFloat(se.assignedQty),te=parseFloat(se.remainingQty);Ie>te?a(U=>({...U,assignedQty:"Assigned Quantity cannot be greater than Remaining Quantity"})):a(U=>({...U,assignedQty:""}))}return se})},O=P=>{const N=P.target.value,E=P.target.name;ie("requiredPcs"),G(ne=>({...ne,requiredPcs:N})),G(ne=>{const se={...ne,[E]:N};if(E==="requiredPcs"||E==="remainingPcs"){const Ie=parseFloat(se.requiredPcs),te=parseFloat(se.remainingPcs);Ie>te?(console.log(),a(U=>({...U,requiredPcs:"Required Pcs cannot be greater than Remaining Pcs"}))):a(U=>({...U,requiredPcs:""}))}return se})},M=async()=>{if(console.log(i),i.totalAmount==0||i.costPerComponent==0){s("Please Enter Thread, Tilla or Sequnce values , Total Amount cannot be zero",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(i.assignedQty)>parseFloat(i.remainingQty)){s("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}if(parseFloat(i.requiredPcs)>parseFloat(i.remainingPcs)){s("Required Pcs can not be greater then Remaining Pcs !",{variant:"error",autoHideDuration:5e3});return}try{const P=await Se.post("http://100.42.177.77:83/api/Embroidery/SaveEmbroideryDetails",{...i,additional:i.additional.join(", ")});P.data.success?s("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(s(`${P.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",P.data.message)),console.log("Save response:",P.data),G(N=>({...N,vendorId:"",embroideryIdDet:0,totalPcs:0,totalAmount:0,threadStiches:0,threadRate:0,threadAmount:0,tillaStiches:0,tilaRate:0,tilaAmount:0,sequence:0,sequenceRate:0,sequenceAmount:0,isSolving:!1,solvingLayers:0,solvingInMeters:0,solvingRate:0,solvingAmount:0,additional:[],requiredPcs:0,assignedQty:0,remainingQty:(n.availableQty-g).toFixed(2)||0,remainingRepeats:n.repeats-D||"",costPerComponent:0,createdOn:new Date().toISOString(),createdBy:T.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:T.empId})),Z(),v()}catch(P){console.error("Error saving data:",P),s("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}},R=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor"},{field:"assignedQty",headerName:"Assigned Quantity"},{field:"requiredPcs",headerName:"Required Pcs"},{field:"additional",headerName:"Additional"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs("div",{hidden:!h,children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h4",gutterBottom:!0,children:"Assign Vendor"})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"Fabric",name:"fabricName",value:i.fabricName,onChange:I,size:"small",disabled:!0,sx:P=>({...i.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Component",name:"componentName",value:i.componentName,onChange:I,size:"small",disabled:!0,sx:P=>({...i.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"Color",name:"colourName",value:i.colourName,onChange:I,size:"small",disabled:!0,sx:P=>({...i.colourName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"PO Pcs",name:"poPcs",value:i.poPcs,onChange:I,size:"small",disabled:!0,sx:P=>({...i.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Heads",size:"small",name:"noOfHeadsName",value:i.noOfHeadsName,onChange:I,disabled:!0,sx:P=>({...i.noOfHeadsName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Cutting Size",size:"small",name:"cuttingSize",value:i.cuttingSize,onChange:I,disabled:!0,sx:P=>({...i.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Items Per Repeat",size:"small",name:"itemsPerRepeat",value:i.itemsPerRepeat,onChange:I,disabled:!0,sx:P=>({...i.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total Available Qty",fullWidth:!0,size:"small",name:"availableQty",value:i.availableQty,onChange:I,disabled:!0,sx:P=>({...i.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Remaining Qty",fullWidth:!0,size:"small",name:"remainingQty",value:i.remainingQty,type:"number",error:!!F.remainingQty,helperText:F.remainingQty,onChange:I,disabled:!0,sx:P=>({...i.remainingQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",value:i.repeats,onChange:I,disabled:!0,sx:P=>({...i.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:i.totalPcs,onChange:I,disabled:!0,sx:P=>({...i.totalPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Remaining Pcs",fullWidth:!0,size:"small",name:"remainingPcs",value:i.remainingPcs,onChange:I,disabled:!0,sx:P=>({...i.remainingPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:i.vendorId,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}},children:X.map(P=>e.jsx(_,{value:P.lookUpId,children:P.lookUpName},P.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Assigned Qty",fullWidth:!0,size:"small",type:"number",name:"assignedQty",value:i.assignedQty,onChange:he,error:!!F.assignedQty,helperText:F.assignedQty,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Required Pcs",fullWidth:!0,disabled:!i.remainingPcs&&!i.remainingQty,size:"small",type:"number",name:"requiredPcs",value:i.requiredPcs,error:!!F.requiredPcs,helperText:F.requiredPcs,onChange:O,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{select:!0,label:"Additional",value:i.additional,name:"additional",size:"small",onChange:I,fullWidth:!0,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}},SelectProps:{multiple:!0},children:J.map(P=>e.jsx(_,{value:P,style:B(P,i.additional,b),children:P},P))})}),e.jsx(r,{item:!0,xs:12,md:1,children:e.jsx(Wt,{control:e.jsx(_t,{checked:i.isSolving,onChange:q,disabled:!i.remainingPcs&&!i.remainingQty,name:"isSolving"}),label:"isSolving"})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:i.threadStiches,onChange:I,required:!0,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:i.threadRate,onChange:I,required:!0,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:i.threadAmount,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:i.tillaStiches,onChange:I,required:!0,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:i.tilaRate,onChange:I,required:!0,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:i.tilaAmount,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:i.sequence,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:i.sequenceRate,onChange:I,required:!0,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:i.sequenceAmount,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})})]})," "]}),i.isSolving?e.jsx(r,{item:!0,xs:12,md:6,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:i.solvingLayers,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:i.solvingInMeters,disabled:!i.remainingPcs&&!i.remainingQty,onChange:I,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:i.solvingRate,onChange:I,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:i.solvingAmount,disabled:!i.remainingPcs&&!i.remainingQty,onChange:I,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(r,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(u,{label:"Total Amount",fullWidth:!0,size:"small",disabled:!i.remainingPcs&&!i.remainingQty,name:"totalAmount",value:i.totalAmount,onChange:I,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,sx:{mt:4},children:e.jsx(u,{label:"Cost Per Component",fullWidth:!0,type:"number",size:"small",name:"costPerComponent",value:i.costPerComponent,onChange:I,disabled:!i.remainingPcs&&!i.remainingQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(fe,{variant:"contained",size:"small",onClick:M,disabled:t===3,children:"Save"})})]})]}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx("div",{children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Ce,{variant:"h4",gutterBottom:!0,children:"View Vendor"})}),e.jsx(r,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:R,initialRows:k,disableDelete:t===3,disableEdit:t===3,setInitialData:y,deleteApi:"http://100.42.177.77:83/api/Embroidery/DeleteEmbroideryDetailsByDetId?embroideryDetId=",deleteBy:"embroideryIdDet",refetch:Z})})]})})]})},po=({initialValues:n})=>{ct();const{user:d}=We(),[v,j]=o.useState(!0),{enqueueSnackbar:h}=ze(),[t,b]=o.useState([]),[s,F]=o.useState(!1),[a,T]=o.useState({embroideryId:0,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdBy:d.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId});o.useEffect(()=>{T({...a,embroideryId:(t==null?void 0:t.embroideryId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})},[t]);const{data:k}=$e(),[K,m]=o.useState("");o.useEffect(()=>{m(n.collectionId)},[]);const{data:y}=_e(),{data:g,refetch:D}=Xe(K,{skip:!K}),{data:i,refetch:G}=ot(a.designId,{skip:!a.designId}),{data:J,refetch:B}=ut({batchNo:a.planningHeaderId,componentId:a.componentId},{skip:!a.planningHeaderId||!a.componentId}),{data:W}=pt({batchNo:a.planningHeaderId,componentId:a.componentId,fabricId:a.fabricId},{skip:!a.planningHeaderId||!a.componentId||!a.fabricId}),{data:z,refetch:Z}=Wa(a.planningHeaderId,{skip:!a.planningHeaderId}),{data:X}=mt(a.planningHeaderId,{skip:!a.planningHeaderId});console.log("formData.planningHeaderId",a.planningHeaderId),console.log("collectionData",k);const[Q,I]=o.useState(!1),[q,oe]=o.useState([]),[ie,S]=o.useState([]),[ue,re]=o.useState([]),[he,O]=o.useState([]),[M,R]=o.useState([]),[ee,P]=o.useState([]),[N,E]=o.useState([]),[ne,se]=o.useState([]);console.log("batchList",ie),console.log("formData",a),o.useEffect(()=>{g&&oe(g.result)},[g]),o.useEffect(()=>{i&&S(i.result)},[i]),o.useEffect(()=>{J&&(B(),re(J.result))},[J,B]),o.useEffect(()=>{W&&P(J.result)},[W]),o.useEffect(()=>{X&&se(X.result)},[X]),o.useEffect(()=>{z&&(j(!1),E(z.result.map((x,Y)=>({id:Y+1,...x}))))},[z,Z]),console.log("embroideryList",z),console.log("initialRows",N),o.useEffect(()=>{if(y){const x=y.result[0];O(x.vendorList),R(x.noOfHeadsList)}},[y]);const Ie=(k==null?void 0:k.result)||[];o.useEffect(()=>{const x=()=>{const ce=parseFloat(a.repeats)||0,Le=parseFloat(a.itemsPerRepeat)||0;return(ce*Le).toFixed(2)};T(ce=>({...ce,totalPcs:x()}));const Y=()=>{const ce=parseFloat(a.threadStiches)||0,Le=parseFloat(a.threadRate)||0,Ue=parseFloat(a.noOfHead)||0,Ee=parseFloat(a.repeats)||0;return(ce/1e3*(Le*Ee*Ue)).toFixed(2)};T(ce=>({...ce,threadAmount:Y()}));const ve=()=>{const ce=parseFloat(a.tillaStiches)||0,Le=parseFloat(a.tilaRate)||0,Ue=parseFloat(a.noOfHead)||0,Ee=parseFloat(a.repeats)||0;return(ce/1e3*(Le*Ee*Ue)).toFixed(2)};T(ce=>({...ce,tilaAmount:ve()}));const ae=()=>{const ce=parseFloat(a.sequence)||0,Le=parseFloat(a.sequenceRate)||0,Ue=parseFloat(a.noOfHead)||0,Ee=parseFloat(a.repeats)||0;return(ce/1e3*(Le*Ee*Ue)).toFixed(2)};T(ce=>({...ce,sequenceAmount:ae()}));const ye=()=>{const ce=parseFloat(a.repeats)||0,Le=parseFloat(a.noOfHead)||0,Ue=parseFloat(a.solvingLayers)||0;return(ce*Le*13/39.37*Ue).toFixed(2)};T(ce=>({...ce,solvingInMeters:ye()}));const Fe=()=>{const ce=parseFloat(a.solvingInMeters)||0,Le=parseFloat(a.solvingRate)||0;return parseFloat(a.solvingLayers),(ce*Le).toFixed(2)};T(ce=>({...ce,solvingAmount:Fe()}));const Ta=()=>{const ce=parseFloat(a.threadAmount)||0,Le=parseFloat(a.tilaAmount)||0,Ue=parseFloat(a.sequenceAmount)||0,Ee=parseFloat(a.solvingAmount)||0;return(ce+Le+Ue+Ee).toFixed(2)};T(ce=>({...ce,totalAmount:Ta()||0}))},[a.threadAmount,a.totalAmount,a.sequenceAmount,a.solvingAmount,a.repeats,a.tilaAmount,a.itemsPerRepeat,a.threadRate,a.threadStiches,a.noOfHead,a.tilaRate,a.tillaStiches,a.sequenceRate,a.sequence,a.solvingLayers,a.solvingInMeters,a.solvingRate]),o.useEffect(()=>{a.productionStatus===3&&h("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[a.productionStatus]);const te=x=>{const{name:Y,value:ve}=x.target;if(Y==="collectionId"){const ae=Ie.find(ye=>ye.collectionId===parseInt(ve));m(ve),F(!0),E([]),j(!0),T({...a,collectionId:ve,designId:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",baseColorId:"",baseColorName:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",productionStatus:ae?ae.productionStatus:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(Y==="designId"){const ae=q.find(ye=>ye.designId===parseInt(ve));E([]),j(!0),T({...a,designId:ve,baseColorId:ae?ae.colorId:"",baseColorName:ae?ae.colorName:"",batchNo:"",planningHeaderId:"",componentId:"",fabricId:"",vendorId:"",poPcs:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]})}else if(Y==="colorId"){const ae=ee.find(ye=>ye.colorId===ve);T({...a,colorId:ve,availableQty:ae?ae.total:"",cuttingSize:ae?ae.cuttingSize:"",repeats:ae?ae.repeats:"",noOfHead:ae?ae.noOfHeads:""})}else if(Y==="batchNo"){const ae=ie.find(ye=>ye.batchNo===ve);T({...a,batchNo:ve,planningHeaderId:ae?ae.planningHeaderId:"",poPcs:ae?ae.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[]}),I(!0),F(!1)}else T({...a,[Y]:ve}),de(ae=>({...ae,[Y]:""}))},[U,de]=o.useState({}),$=async()=>{try{const x=await Se.post("http://100.42.177.77:83/api/Embroidery/SaveEmbroidery",{...a,threadAdditional:a.threadAdditional.join(", ")});console.log("Save response:",x.data),x.data.success?h("Embroidery saved successfully!",{variant:"success",autoHideDuration:5e3}):(h(`${x.data.message}!`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",x.data.message)),T(Y=>({embroideryId:0,designId:Y.designId,batchNo:Y.batchNo,planningHeaderId:Y.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:Y.poPcs,baseColorId:Y.baseColorId,baseColorName:Y.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})),Z()}catch(x){console.error("Error saving data:",x),h("Embroidery not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("initialRows",N);const[L,le]=o.useState({}),[me,be]=o.useState(!1),ke=x=>{le(x),be(!0)},[Oe,je]=o.useState(!0),Ae=x=>{le(x),be(!0),je(!1)},Ne=()=>{je(!0),be(!1),le({}),refetchDyeingPrintingData()};console.log("show div",Oe);const[we,C]=o.useState(0),[V,xe]=o.useState(0),[p,c]=o.useState(0),[A,l]=o.useState(0);o.useEffect(()=>{const x=N.reduce((ye,Fe)=>ye+(Fe.availableQty??0),0).toFixed(2),Y=N.reduce((ye,Fe)=>ye+(Fe.assignedQty??0),0).toFixed(2),ve=N.reduce((ye,Fe)=>ye+(Fe.totalPcs??0),0).toFixed(2),ae=N.reduce((ye,Fe)=>ye+(Fe.requiredPcs??0),0).toFixed(2);C(parseFloat(x).toLocaleString()),xe(parseFloat(Y).toLocaleString()),c(parseFloat(ve).toLocaleString()),l(parseFloat(ae).toLocaleString())},[N]);const f=[...N,{id:"TOTAL_SUMMARY",availableQty:we,assignedQty:V,totalPcs:p,requiredPcs:A}],H={sortable:!1,pinnable:!1,hideable:!1},w=[{field:"id",headerName:"Sr#",...H,colSpan:(x,Y)=>Y.id==="TOTAL_SUMMARY"?4:void 0,renderCell:x=>x.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):x.value},{field:"designNo",headerName:"Design",...H,colSpan:(x,Y)=>Y.id==="TOTAL_SUMMARY"?3:void 0,renderCell:x=>x.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):x.value},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component ",renderCell:x=>e.jsx(Ye,{label:x.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric "},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"availableQty",headerName:"Available Qty",...H,valueGetter:x=>x.toLocaleString(),renderCell:x=>x.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:x.value}):x.value},{field:"assignedQty",headerName:"Assigned Qty",...H,valueGetter:x=>x,renderCell:x=>x.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:x.value}):x.value},{field:"totalPcs",headerName:"Total Pcs",renderCell:x=>x.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:x.value}):x.value},{field:"requiredPcs",headerName:"Assigned Pcs",colSpan:(x,Y)=>Y.id==="TOTAL_SUMMARY"?4:void 0,renderCell:x=>x.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:x.value}):x.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:x=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(bt,{variant:"text",size:"small",children:[e.jsx(Qe,{color:"primary",onClick:()=>ke(x.row),children:e.jsx(It,{})}),e.jsx(Qe,{color:"primary",onClick:()=>Ae(x.row),children:e.jsx(Ve,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:io,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:K,onChange:te,size:"small",InputLabelProps:{sx:{color:"black"}},children:Ie.map(x=>e.jsx(_,{value:x.collectionId,children:x.collectionName},x.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:a.designId,onChange:te,size:"small",InputLabelProps:{sx:{color:"black"}},children:q.map(x=>e.jsx(_,{value:x.designId,children:x.designNo},x.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:a.batchNo,onChange:te,size:"small",InputLabelProps:{sx:{color:"black"}},children:ie.map(x=>e.jsx(_,{value:x.batchNo,children:x.batchNo},x.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:a.baseColorName,onChange:te,disabled:!0,sx:x=>({...a.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsxs(r,{item:!0,xs:12,md:12,children:[e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:a.componentId,onChange:te,size:"small",required:!0,error:!!U.componentId,helperText:U.componentId,InputLabelProps:{sx:{color:"black"}},children:ne.map(x=>e.jsx(_,{value:x.componentId,children:x.componentName},x.componentId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:a.fabricId,onChange:te,required:!0,error:!!U.fabricId,helperText:U.fabricId,InputLabelProps:{sx:{color:"black"}},children:ue.map(x=>e.jsx(_,{value:x.fabricId,children:x.fabric},x.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:a.colorId,onChange:te,required:!0,error:!!U.colorId,helperText:U.colorId,InputLabelProps:{sx:{color:"black"}},children:ee.map(x=>e.jsx(_,{value:x.colorId,children:x.color},x.colorId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:a.poPcs,onChange:te,disabled:!0,sx:x=>({...a.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:a.availableQty,onChange:te,InputLabelProps:{sx:{color:"black"}},sx:x=>({...a.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:a.repeats,onChange:te,InputLabelProps:{sx:{color:"black"}},sx:x=>({...a.repeats!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:a.noOfHead,onChange:te,required:!0,error:!!U.noOfHead,helperText:U.noOfHead,InputLabelProps:{sx:{color:"black"}},sx:x=>({...a.noOfHead!==""&&{".css-9ngl8c-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),children:M.map(x=>e.jsx(_,{value:x.lookUpId,children:x.lookUpName},x.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:a.cuttingSize,onChange:te,InputLabelProps:{sx:{color:"black"}},sx:x=>({...a.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Items Per Repeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:a.itemsPerRepeat,onChange:te,required:!0,error:!!U.itemsPerRepeat,helperText:U.itemsPerRepeat,InputLabelProps:{sx:{color:"black"}},sx:x=>({...a.itemsPerRepeat!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:a.totalPcs,onChange:te})}),e.jsx(r,{item:!0,xs:12,md:4.5,textAlign:"right",sx:{mt:2},children:e.jsx(fe,{variant:"contained",size:"small",disabled:a.productionStatus===3,onClick:$,children:"Save"})})]})]}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ge,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ge,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(r,{sx:{marginTop:2},item:!0,xs:12,children:[" ",e.jsx(qe,{iColumns:w,initialRows:f,disableDelete:a.productionStatus===3,disableEdit:a.productionStatus===3,setInitialData:b,deleteApi:"http://100.42.177.77:83/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:Z,setAccordionExpanded:I,fileName:"Embroidery List",isLoading:v}),e.jsxs(nt,{open:me,onClose:Ne,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(Ce,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:" Embroidery > Assign Vendors "}),e.jsx(Qe,{onClick:Ne,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(uo,{initialFormData:L,productionStatus:a.productionStatus,setInitialFormData:le,refetchDyeingPrintingData:Z,handleClickOpen:ke,showUpperDiv:Oe})]})]})]})})]})]})},mo=po,ho=({setInitialValues:n,initialValues:d})=>{const{user:v}=We();console.log("user",v);const[j,h]=o.useState(!0),[t,b]=o.useState([]),[s,F]=o.useState([]),[a,T]=o.useState({processType:"MultiHead",planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,planningProcessTypeName:"",repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",poPcs:"",planningProcessTypeId:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:v.empId,lastUpdatedBy:v.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",a),o.useEffect(()=>{T({...a,processType:(t==null?void 0:t.processType)||"MultiHead",planningId:(t==null?void 0:t.planningId)||0,baseColorId:(t==null?void 0:t.baseColorId)||"",componentId:(t==null?void 0:t.componentId)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",colorId:(t==null?void 0:t.colorId)||"",fabricId:(t==null?void 0:t.fabricId)||"",noOfHeads:(t==null?void 0:t.noOfHeads)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,repeats:(t==null?void 0:t.repeats)||0,repeatSize:(t==null?void 0:t.repeatSize)||0,uomId:(t==null?void 0:t.uomId)||"",totalFabric:(t==null?void 0:t.totalFabric)||"",shrinkage:(t==null?void 0:t.shrinkage)||"",wastage:(t==null?void 0:t.wastage)||"",total:(t==null?void 0:t.total)||"",appId:1,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||v.empId,lastUpdatedBy:v.empId,lastUpdatedOn:new Date().toISOString(),repeatsInMtr:(t==null?void 0:t.repeatsInMtr)||""})},[t]);const{data:k}=$e(),[K,m]=o.useState(""),{data:y,refetch:g}=Xe(K,{skip:!K}),{data:D,refetch:i}=_a(a.planningHeaderId,{skip:!a.planningHeaderId}),{data:G}=_e(),[J,B]=o.useState([]),{enqueueSnackbar:W}=ze();console.log("lookupData",G);const[z,Z]=o.useState([]);o.useEffect(()=>{k&&Z(k.result)},[k]),o.useEffect(()=>{y&&(B(y.result),g())},[y]),o.useEffect(()=>{D&&(h(!1),F(D.result.map((l,f)=>({id:f+1,...l}))))},[D,i]),console.log("designList",J),console.log("collectionData",k);const[X,Q]=o.useState(!1),[I,q]=o.useState([]),[oe,ie]=o.useState([]),[S,ue]=o.useState([]),[re,he]=o.useState([]),[O,M]=o.useState([]),[R,ee]=o.useState([]),[P,N]=o.useState([]),[E,ne]=o.useState([]);console.log("components:",S),console.log("Fabrications:",re),console.log("colors:",O),console.log("uoms:",R),console.log("heads:",P),console.log("lookupData",G),o.useEffect(()=>{if(G){const l=G.result[0];ue(l.componentList),M(l.colorList),he(l.fabricList),N(l.noOfHeadsList),ee(l.uomList),q(l.planningTypeProcessList),ie(l.operatingMachineList)}},[G]),o.useEffect(()=>{const l=async f=>{try{const H=await Se.get(`http://100.42.177.77:83/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${f}`);console.log(H.data),ne(H.data.result)}catch(H){console.error("Error fetching pre-planning lookup data:",H)}};a.designId&&l(a.designId)},[a.designId,a.planningHeaderId]);const se=a.planningProcessTypeId===212||a.planningProcessTypeId===1219;console.log("initialValues",d),console.log("selectedCollectionId",K),o.useEffect(()=>{m((d==null?void 0:d.collectionId)||""),T({...a,designId:(d==null?void 0:d.designId)||"",planningHeaderId:(d==null?void 0:d.planningHeaderId)||"",batchNo:(d==null?void 0:d.batchNo)||""})},[d]),o.useEffect(()=>{const l=()=>{const Y=parseFloat(a.poPcs)||0,ve=parseFloat(a.cuttingSize)||0,ae=(Y*ve).toFixed(2);return parseFloat(ae).toLocaleString()},f=()=>{const Y=parseFloat(a.repeats)||0,ve=parseFloat(a.repeatSize)||0,ae=(Y*ve).toFixed(2);return parseFloat(ae).toLocaleString()},H=Y=>{const ve=Y||0,ae=parseFloat(a.shrinkage)||0,ye=parseFloat(a.wastage)||0,Fe=(ve*(100+(ae+ye))/100).toFixed(2);return parseFloat(Fe).toLocaleString()},w=()=>(.9144*(parseFloat(a.repeatSize)||0)).toFixed(2),pe=()=>{const Y=parseFloat(a.repeats)||0;return((parseFloat(a.repeatsInMtr)||0)*Y).toFixed(2)};let x=0;se?x=parseFloat(l().replace(/,/g,""))||0:x=parseFloat(f().replace(/,/g,""))||0,T(Y=>({...Y,totalFabric:x.toLocaleString(),total:H(x),repeatsInMtr:w()})),!se&&a.isSchiffili&&T(Y=>({...Y,totalFabric:pe()}))},[a.poPcs,a.cuttingSize,a.repeats,a.repeatSize,a.totalFabric,a.shrinkage,a.wastage,a.repeatsInMtr,a.isSchiffili,se]);const[Ie,te]=o.useState(!1);o.useState(!1),o.useEffect(()=>{a.productionStatus===3&&W("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[a.productionStatus]);const U=l=>{const{name:f,value:H}=l.target;if(f==="collectionId"){const w=z.find(pe=>pe.collectionId===parseInt(H));Q(!0),F([]),h(!0),m(H),T({...a,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",collectionId:H,noOfDesigns:w?w.noOfDesigns:"",productionStatus:w?w.productionStatus:"",noOfColors:w?w.noOfColors:""})}else if(f==="designId"){const w=J.find(pe=>pe.designId===parseInt(H));F([]),h(!0),T({...a,processType:"MultiHead",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",designId:H,baseColorId:w?w.colorId:"",baseColorName:w?w.colorName:""})}else if(f==="batchNo"){const w=E.find(pe=>pe.batchNo===H);T({...a,componentId:"",processType:"MultiHead",poPcs:w?w.poPcs:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",batchNo:H,planningHeaderId:w?w.planningHeaderId:""}),te(!0),Q(!1)}else if(f==="planningProcessTypeId"){const w=I.find(pe=>pe.lookUpId===H);console.log("selectedProcess",w),T({...a,planningProcessTypeId:H,planningProcessTypeName:w?w.lookUpName:"",noOfHeads:0,operatingMachineId:0}),te(!0),Q(!1)}else T({...a,[f]:H})},[de,$]=o.useState({}),[L,le]=o.useState(!1),me=()=>{le(!L)},be=async()=>{const l=ke();if(Object.keys(l).length>0){$(l);return}try{const f={...a,totalFabric:parseFloat(a.totalFabric.replace(/,/g,"")),total:parseFloat(a.total.replace(/,/g,""))},H=await Se.post("http://100.42.177.77:83/api/PrePlanning/SavePrePlanning",f);console.log("Data saved successfully:",H.data),console.log("Save response:",H.data),H.data.success?H.data.success&&W("PrePlanning saved successfully!",{variant:"success",autoHideDuration:5e3}):(W(`${H.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",H.data.message)),T(w=>({processType:"MultiHead",planningId:0,collectionId:w.collectionId,designId:w.designId,batchNo:w.batchNo,planningHeaderId:w.planningHeaderId,baseColorId:w.baseColorId,baseColorName:w.baseColorName,noOfDesigns:w.noOfDesigns,noOfColors:w.noOfColors,poPcs:w.poPcs,fabricId:w.fabricId,shrinkage:w.shrinkage,wastage:w.wastage,componentId:"",cuttingSize:"",colorId:"",noOfHeads:0,operatingMachineId:0,repeats:0,repeatSize:0,uomId:"",totalFabric:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:v.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:v.empId,isSchiffili:!1,repeatsInMtr:""})),i()}catch(f){console.error("Error saving data:",f),W("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ke=()=>{const l={};return a.componentId||(l.componentId="componentId is required"),a.colorId||(l.colorId="colorId is required"),a.fabricId||(l.fabricId="fabricId is required"),a.cuttingSize||(l.cuttingSize="cuttingSize is required"),a.uomId||(l.uomId="uomId is required"),a.shrinkage||(l.shrinkage="shrinkage is required"),a.wastage||(l.wastage="wastage is required"),l};console.log("initialRows",s);const Oe=s.reduce((l,f)=>l+(f.totalFabric??0),0).toFixed(2),je=parseFloat(Oe).toLocaleString();console.log("localizedTotalFabric",je);const Ae=s.reduce((l,f)=>l+(f.total??0),0).toFixed(2),Ne=parseFloat(Ae).toLocaleString(),we=[...s,{id:"TOTAL_SUMMARY",label:"Total Fabric",totalFabric:je,total:Ne}],C={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",we);const V=[{field:"id",headerName:"Sr#",...C,colSpan:(l,f)=>{if(f.id==="TOTAL_SUMMARY")return 10},valueGetter:(l,f)=>f.id==="TOTAL_SUMMARY"?f.label:l,renderCell:l=>e.jsx("div",{style:{color:l.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:l.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:l.value})},{field:"componentName",headerName:"Component",...C},{field:"planningProcessTypeName",headerName:"Process Type",...C,renderCell:l=>{const f=l.value==="MultiHead"?"primary.dark":l.value==="Schiffili"?theme.palette.grey[900]:l.value==="Dyeing"?"success.dark":"default";return e.jsx(Ye,{label:l.value,sx:{backgroundColor:f==="primary"||f==="default"?void 0:f,color:f==="primary"||f==="default"?void 0:"white"},color:f==="primary"?"primary":f==="default"?"default":void 0})}},{field:"color",headerName:"Color",...C},{field:"cuttingSize",headerName:"Cutting Size",...C},{field:"fabric",headerName:"Fabrication",...C},{field:"noOfHeadName",headerName:"No. Of Heads",...C},{field:"operatingMachineName",headerName:"Operating Machine",...C},{field:"repeats",headerName:"Repeats",valueGetter:l=>l.toLocaleString(),...C},{field:"repeatSize",headerName:"Repeat Size",valueGetter:l=>l.toLocaleString(),...C},{field:"totalFabric",headerName:"Total Fabric",valueGetter:l=>l.toLocaleString(),renderCell:l=>e.jsx("div",{style:{color:l.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:l.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:l.value}),...C},{field:"uom",headerName:"UOM",colSpan:(l,f)=>f.id==="TOTAL_SUMMARY"?2:void 0,valueGetter:(l,f)=>f.id==="TOTAL_SUMMARY"?"OverAll Total":l,renderCell:l=>e.jsx("div",{style:{color:l.row.id==="TOTAL_SUMMARY"?"black":void 0,fontWeight:l.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:l.value}),...C},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total",valueGetter:l=>l.toLocaleString(),colSpan:(l,f)=>f.id==="TOTAL_SUMMARY"?2:void 0,renderCell:l=>e.jsx("div",{style:{color:l.row.id==="TOTAL_SUMMARY"?"#a11f23":void 0,fontWeight:l.row.id==="TOTAL_SUMMARY"?"bold":void 0},children:l.value}),...C}],xe=a.planningProcessTypeId===198;o.useEffect(()=>{xe&&T({...a,uomId:139})},[xe]),console.log("formData",a);const p=({row:l,field:f})=>l.id==="TOTAL_SUMMARY"&&(f==="componentName"||f==="uom")?"bold":"";console.log("batchList:",E);const c="http://100.42.177.77:83/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",A=(l,f)=>{te(!Ie)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ut,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:2.4,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:K,onChange:U,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:z.map(l=>e.jsx(_,{value:l.collectionId,children:l.collectionName},l.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:2.4,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:a.designId,onChange:U,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:J.map(l=>e.jsx(_,{value:l.designId,children:l.designNo},l.designId))})}),e.jsxs(r,{item:!0,xs:12,md:2.4,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:a.batchNo,onChange:U,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:E.map(l=>e.jsx(_,{value:l.batchNo,children:l.batchNo},l.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:2.4,children:e.jsx(u,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:a.poPcs,onChange:U,disabled:!0,sx:l=>({...a.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:2.4,children:e.jsx(u,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:a.baseColorName,onChange:U,disabled:!0,sx:l=>({...a.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"MainCard",avatar:e.jsx(Ft,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Qe,{onClick:A,sx:{mt:"-18px"},children:e.jsx(et,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(Rt,{expanded:Ie,onChange:A,sx:{},children:[e.jsx(zt,{expandIcon:e.jsx(et,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Qt,{children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(Ze,{fullWidth:!0,disabled:L,options:re,getOptionLabel:l=>l.lookUpName,value:re.find(l=>l.lookUpId===a.fabricId)||null,onChange:(l,f)=>{U({target:{name:"fabricId",value:f?f.lookUpId:""}})},renderInput:l=>e.jsx(u,{...l,label:"Fabrication",size:"small",name:"fabricId",value:a.fabricId,required:!0,error:!!de.fabricId,helperText:de.fabricId,disabled:L,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:l})=>e.jsx("div",{style:{backgroundColor:"white"},children:l})})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:a.shrinkage,onChange:U,error:!!de.shrinkage,helperText:de.shrinkage,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:a.wastage,onChange:U,error:!!de.wastage,helperText:de.wastage,required:!0,disabled:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(fe,{variant:"contained",size:"small",onClick:me,children:L||L?"Unlock":"Lock"})}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ge,{color:"#cc8587",sx:{height:2,width:"100%"}})}),e.jsxs(r,{item:!0,xs:12,md:2,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Process Type",name:"planningProcessTypeId",value:a.planningProcessTypeId,onChange:U,size:"small",required:!0,InputLabelProps:{sx:{color:"black"}},children:I.map(l=>e.jsx(_,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})," "]}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(Ze,{fullWidth:!0,options:S,getOptionLabel:l=>l.lookUpName,value:S.find(l=>l.lookUpId===a.componentId)||null,onChange:(l,f)=>{U({target:{name:"componentId",value:f?f.lookUpId:""}})},renderOption:(l,f)=>{const{lookUpName:H}=f;return e.jsx("span",{...l,children:H})},renderInput:l=>e.jsx(u,{...l,label:"Select Component",size:"small",name:"componentId",value:a.componentId,required:!0,error:!!de.componentId,helperText:de.componentId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:l})=>e.jsx("div",{style:{backgroundColor:"white"},children:l})})}),e.jsxs(r,{item:!0,xs:12,md:2,children:[" ",e.jsx(Ze,{fullWidth:!0,options:O,getOptionLabel:l=>l.lookUpName,value:O.find(l=>l.lookUpId===a.colorId)||null,onChange:(l,f)=>{U({target:{name:"colorId",value:f?f.lookUpId:""}})},renderInput:l=>e.jsx(u,{...l,label:"Color",size:"small",value:a.colorId,name:"colorId",required:!0,error:!!de.colorId,helperText:de.colorId,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:l})=>e.jsx("div",{style:{backgroundColor:"white"},children:l})})]}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:a.cuttingSize,onChange:U,required:!0,error:!!de.cuttingSize,helperText:de.cuttingSize,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:xe?e.jsx(u,{fullWidth:!0,select:!0,label:"Operating Machine",size:"small",name:"operatingMachineId",value:a.operatingMachineId,onChange:U,required:!0,disabled:se,InputLabelProps:{sx:{color:"black"}},children:oe.map(l=>e.jsx(_,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))}):e.jsx(u,{fullWidth:!0,select:!0,label:"No of Heads",size:"small",name:"noOfHeads",value:a.noOfHeads,onChange:U,required:!0,disabled:se,InputLabelProps:{sx:{color:"black"}},children:P.map(l=>e.jsx(_,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:a.repeatSize,onChange:U,disabled:se,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"No. of Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:a.repeats,onChange:U,required:!0,disabled:se,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:a.totalFabric,onChange:U,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:a.uomId,onChange:U,error:!!de.uomId,helperText:de.uomId,required:!0,disabled:xe,InputLabelProps:{sx:{color:"black"}},children:R.map(l=>e.jsx(_,{value:l.lookUpId,children:l.lookUpName},l.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Repeats in Meter",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:a.repeatsInMtr,onChange:U,sx:l=>({...a.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(u,{label:"Total",fullWidth:!0,size:"small",name:"total",value:a.total,onChange:U,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(r,{container:!0,spacing:1,width:"Inherit"})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",children:e.jsx(fe,{variant:"contained",size:"small",onClick:be,disabled:a.productionStatus===3,children:"Save"})})]})})]})]}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ge,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"MainCard",avatar:e.jsx(Ve,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(r,{sx:{paddingY:1,paddingX:1},children:e.jsx(r,{sx:{},item:!0,xs:12,children:e.jsx(qe,{iColumns:V,initialRows:we,disableDelete:a.productionStatus===3,disableEdit:a.productionStatus===3,setInitialData:b,deleteApi:c,deleteBy:"planningId",refetch:i,getCellClassName:p,setAccordionExpanded:te,fileName:"PrePlanningList",isLoading:j})})})]})]})},go=ho,bo="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",fo=({initialValues:n})=>{const{user:d}=We();console.log("user",d);const[v,j]=o.useState(!0),[h,t]=o.useState([]),[b,s]=o.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:"",baseColorName:"",createdBy:d.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId});o.useEffect(()=>{s({...b,dpId:h.dpId||0,fabricId:(h==null?void 0:h.fabricId)||"",colorId:(h==null?void 0:h.colorId)||"",color:(h==null?void 0:h.color)||"",processType:(h==null?void 0:h.processType)||"",availableQty:(h==null?void 0:h.availableQty)||"",Shrinkage:(h==null?void 0:h.shrinkage)||"",Wastage:(h==null?void 0:h.wastage)||"",outputQty:(h==null?void 0:h.outputQty)||0,UOM:(h==null?void 0:h.uom)||0,uomId:(h==null?void 0:h.uomId)||"",poPcs:(h==null?void 0:h.poPcs)||0,createdOn:(h==null?void 0:h.createdOn)||new Date().toISOString(),createdBy:(h==null?void 0:h.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})},[h]);const{enqueueSnackbar:F}=ze(),[a,T]=o.useState(!1);console.log("Dyeing form data to send",b);const{data:k}=$e(),[K,m]=o.useState("");o.useEffect(()=>{m(n.collectionId)},[]);const{data:y}=_e(),{data:g,refetch:D}=Xe(K,{skip:!K}),{data:i,refetch:G}=ot(b.designId,{skip:!b.designId}),{data:J}=Ua({batchNo:b.planningHeaderId,processType:"Fabrication"},{skip:!b.planningHeaderId}),{data:B}=Ha({fabricId:b.fabricId,planningHeaderId:b.planningHeaderId},{skip:!b.fabricId||!b.planningHeaderId}),{data:W,refetch:z}=qa(b.planningHeaderId,{skip:!b.planningHeaderId}),[Z,X]=o.useState([]),[Q,I]=o.useState([]),[q,oe]=o.useState([]),[ie,S]=o.useState([]),[ue,re]=o.useState([]),[he,O]=o.useState([]);o.useState([]);const[M,R]=o.useState(!1);console.log("batchList",Q),console.log("formData",b),o.useEffect(()=>{g&&X(g.result)},[g]),o.useEffect(()=>{i&&I(i.result)},[i]),o.useEffect(()=>{J&&oe(J.result)},[J]),o.useEffect(()=>{B&&O(B.result)},[B]),o.useEffect(()=>{W&&(j(!1),re(W.result.map((p,c)=>({id:c+1,...p}))))},[W,z]),o.useEffect(()=>{if(y){const p=y.result[0];S(p.uomList)}},[y]);const[ee,P]=o.useState([]);o.useEffect(()=>{k&&P(k.result)},[k]),o.useEffect(()=>{b.productionStatus===3&&F("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[b.productionStatus]);const N=p=>{const{name:c,value:A}=p.target;if(c==="collectionId"){const l=ee.find(f=>f.collectionId===parseInt(A));m(A),T(!0),re([]),j(!0),s({...b,collectionId:A,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",productionStatus:l?l.productionStatus:"",poPcs:"",baseColorName:""})}else if(c==="designId"){const l=Z.find(f=>f.designId===parseInt(A));re([]),j(!0),s({...b,designId:A,baseColorId:l?l.colorId:"",baseColorName:l?l.colorName:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:""})}else if(c==="batchNo"){const l=Q.find(f=>f.batchNo===A);s({...b,batchNo:A,planningHeaderId:l?l.planningHeaderId:"",poPcs:l?l.poPcs:"",fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:""}),R(!0),T(!1)}else if(c==="fabricId")q.find(l=>l.fabricId===A),console.log("Selected Fabric:",q),s({...b,fabricId:A});else if(c==="ColorId"){const l=he.find(f=>f.colorId===A.colorId);s({...b,ColorId:A.colorId,color:l.color,availableQty:l.total,UOM:l.uom,Shrinkage:l.shrinkage,Wastage:l.wastage})}else c==="processType"?s({...b,processType:A}):c==="vendorId"?s({...b,vendorId:A}):(s({...b,[c]:A}),ne(l=>({...l,[c]:""})))};o.useEffect(()=>{const p=()=>{const w=parseFloat(b.availableQty)||0,pe=parseFloat(b.Shrinkage)||0,x=parseFloat(b.Wastage)||0;return(w*(100-(pe+x))/100).toFixed(2)},c=()=>{const w=parseFloat(b.availableQty)||0,pe=parseFloat(b.RatePerUOM)||0;return(w*pe).toFixed(2)},A=(w,pe)=>(w*(1+pe/100)).toFixed(2),l=p(),f=c(),H=parseFloat(b.GST)||0;A(f,H),parseFloat(b.poPcs),s(w=>({...w,outputQty:l}))},[b.availableQty,b.Shrinkage,b.Wastage,b.RatePerUOM,b.GST,b.poPcs,b.UnitRatePerPo]);const[E,ne]=o.useState({}),se=async()=>{try{const p=await Se.post("http://100.42.177.77:83/api/DyeingPrinting/SaveDyeingPrinting",b);console.log("Save response:",p.data),p.data.success?F("Dyeing saved successfully!",{variant:"success",autoHideDuration:5e3}):(F(`${p.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",p.data.message)),s(c=>({designId:c.designId,planningHeaderId:c.planningHeaderId,batchNo:c.batchNo,dpId:0,fabricId:"",colorId:"",color:"",processType:"",availableQty:"",Shrinkage:"",Wastage:"",outputQty:"",UOM:"",uomId:"",poPcs:c.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})),z()}catch(p){console.error("Error saving data:",p),F("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Ie=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],[te,U]=o.useState(!0),[de,$]=o.useState({}),[L,le]=o.useState(!1),me=p=>{$(p),le(!0)},be=p=>{$(p),le(!0),U(!1)},ke=()=>{U(!0),le(!1),$({}),z()},[Oe,je]=o.useState(0),[Ae,Ne]=o.useState(0);o.useEffect(()=>{const p=ue.reduce((A,l)=>A+(l.availableQty??0),0).toFixed(2),c=ue.reduce((A,l)=>A+(l.assignedQty??0),0).toFixed(2);je(parseFloat(p).toLocaleString()),Ne(parseFloat(c).toLocaleString())},[ue]);const we=[...ue,{id:"TOTAL_SUMMARY",componentName:"Total Summary",availableQty:Oe,assignedQty:Ae}],C={sortable:!1,pinnable:!1,hideable:!1},V=[{field:"id",headerName:"Sr#",...C,renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):p.value},{field:"fabricName",headerName:"Fabric",...C},{field:"colorName",headerName:"Color",...C,colSpan:(p,c)=>c.id==="TOTAL_SUMMARY"?2:void 0},{field:"processType",headerName:"Process Type",...C,renderCell:p=>{const c=p.value==="Dyeing"?"primary.dark":p.value==="Printing"?"success.dark":"default";return e.jsx(Ye,{label:p.value,sx:{backgroundColor:c==="primary"||c==="default"?void 0:c,color:c==="primary"||c==="default"?void 0:"white"},color:c==="primary"?"primary":c==="default"?"default":void 0})}},{field:"uom",headerName:" UOM",...C},{field:"poPcs",headerName:" PO PCS.",...C},{field:"availableQty",headerName:"Available Quantitity",...C,valueGetter:p=>p.toLocaleString(),renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:p.value}):p.value},{field:"assignedQty",headerName:"Assigned Qty",...C,valueGetter:p=>p.toLocaleString(),colSpan:(p,c)=>c.id==="TOTAL_SUMMARY"?4:void 0,renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:p.value}):p.value},{field:"AddVendor",headerName:"Add Vendor",...C,renderCell:p=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(bt,{variant:"text",size:"small",children:[e.jsx(Qe,{color:"primary",onClick:()=>me(p.row),children:e.jsx(It,{})}),e.jsx(Qe,{color:"primary",onClick:()=>be(p.row),children:e.jsx(Ve,{})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:bo,sx:{background:"transparent"}}),title:"Add Dyeing and Printing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:K,onChange:N,size:"small",InputLabelProps:{sx:{color:"black"}},children:ee.map(p=>e.jsx(_,{value:p.collectionId,children:p.collectionName},p.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:b.designId,onChange:N,size:"small",InputLabelProps:{sx:{color:"black"}},children:Z.map(p=>e.jsx(_,{value:p.designId,children:p.designNo},p.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:b.batchNo,onChange:N,size:"small",InputLabelProps:{sx:{color:"black"}},children:Q.map(p=>e.jsx(_,{value:p.batchNo,children:p.batchNo},p.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:b.baseColorName,onChange:N,disabled:!0,sx:p=>({...b.repeatsInMtr!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})," ",e.jsxs(r,{item:!0,xs:12,md:12,children:[e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:b.fabricId,onChange:N,error:!!E.fabricId,helperText:E.fabricId,required:!0,InputLabelProps:{sx:{color:"black"}},children:q.map(p=>e.jsx(_,{value:p.fabricId,children:p.fabric},p.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(ro,{fullWidth:!0,options:he,getOptionLabel:p=>p.color||"",renderInput:p=>e.jsx(u,{...p,label:"Color",name:"colorId",size:"small",error:!!E.colorId,helperText:E.colorId,required:!0,InputLabelProps:{sx:{color:"black"}},sx:{"& input":{backgroundColor:"white"}}}),PaperComponent:({children:p})=>e.jsx("div",{style:{backgroundColor:"white",boxShadow:"0 3px 5px rgba(0, 0, 0, 0.2)"},children:p}),value:he.find(p=>p.colorId===b.colorId)||null,onChange:(p,c)=>{s(A=>({...A,colorId:c?c.colorId:"",color:c?c.color:"",availableQty:c?c.total:"",UOM:c?c.uom:"",uomId:c?c.uomId:"",Shrinkage:c?c.shrinkage:"",Wastage:c?c.wastage:""}))}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:b.processType,onChange:N,error:!!E.processType,helperText:E.processType,required:!0,InputLabelProps:{sx:{color:"black"}},children:Ie.map(p=>e.jsx(_,{value:p.value,children:p.label},p.value))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:b.poPcs,onChange:N,disabled:!0,sx:p=>({...b.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:b.UOM,onChange:N,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Available Qty",fullWidth:!0,size:"small",type:"number",name:"availableQty",value:b.availableQty,onChange:N,disabled:!0,sx:p=>({...b.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{borderColor:"gray"},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})}),e.jsx(r,{item:!0,xs:12,md:9,sx:{marginTop:2},textAlign:"right",children:e.jsx(fe,{variant:"contained",color:"primary",size:"small",disabled:b.productionStatus===3,onClick:se,children:"Save"})})]})]}),e.jsx(ge,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})," ",e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ge,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(r,{item:!0,xs:12,md:12,paddingTop:1,children:[e.jsx(qe,{iColumns:V,initialRows:we,disableDelete:b.productionStatus===3,disableEdit:b.productionStatus===3,setInitialData:t,deleteApi:"http://100.42.177.77:83/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:z,setAccordionExpanded:R,fileName:"Dyeing&PrintingList",isLoading:v}),e.jsxs(nt,{open:L,onClose:ke,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(Ce,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Dyeing and Printing > Assign Vendors "}),e.jsx(Qe,{onClick:ke,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(co,{initialFormData:de,productionStatus:b.productionStatus,setInitialFormData:$,refetchDyeingPrintingData:z,handleClickOpen:me,showUpperDiv:te})]})]})]})})]})]})},Io=fo,Ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",xo=({initialValues:n})=>{const{user:d}=We(),{enqueueSnackbar:v}=ze(),[j,h]=o.useState(!0),[t,b]=o.useState([]),[s,F]=o.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:d.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId});o.useEffect(()=>{F({...s,schiffiliId:t.schiffiliId||0,componentId:(t==null?void 0:t.componentId)||"",poPcs:(t==null?void 0:t.poPcs)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",thaanQty:(t==null?void 0:t.thaanQty)||0,operatingMachineId:(t==null?void 0:t.operatingMachineId)||0,operatingMachine:(t==null?void 0:t.operatingMachineName)||"",workingHeadId:(t==null?void 0:t.workingHeadId)||0,cuttingSize:(t==null?void 0:t.cuttingSize)||"",rate:(t==null?void 0:t.rate)||"",costPerComponent:(t==null?void 0:t.costPerComponent)||"",totalEmbroidry:(t==null?void 0:t.totalEmbroidry)||0,noOfItemPerThaan:(t==null?void 0:t.noOfItemPerThaan)||0,noOfStichesPerYard:(t==null?void 0:t.noOfStichesPerYard)||0,amountPerYard:(t==null?void 0:t.amountPerYard)||0,totalPcs:(t==null?void 0:t.totalPcs)||0,laserCut:!!(t!=null&&t.laserCutRate||t!=null&&t.pcsForLaserCut),laserCutRate:(t==null?void 0:t.laserCutRate)||0,pcsForLaserCut:(t==null?void 0:t.pcsForLaserCut)||0,totalAmount:(t==null?void 0:t.totalAmount)||0,createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})},[t]);const[a,T]=o.useState(!1),k=(c,A)=>{T(!a)},[K,m]=o.useState(!1),{data:y}=$e(),[g,D]=o.useState("");o.useEffect(()=>{D(n.collectionId)},[]);const{data:i}=_e(),{data:G,refetch:J}=Xe(g,{skip:!g}),{data:B,refetch:W}=ot(s.designId,{skip:!s.designId}),{data:z}=ut({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:Z}=pt({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:X,refetch:Q}=Ea(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:I}=mt(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("formData.planningHeaderId",s.planningHeaderId),console.log("collectionData",y),console.log("schiffliList",X);const[q,oe]=o.useState([]),[ie,S]=o.useState([]),[ue,re]=o.useState([]),[he,O]=o.useState([]),[M,R]=o.useState([]),[ee,P]=o.useState([]),[N,E]=o.useState([]),[ne,se]=o.useState([]),[Ie,te]=o.useState([]);o.useEffect(()=>{G&&oe(G.result)},[G]),o.useEffect(()=>{B&&S(B.result)},[B]),o.useEffect(()=>{z&&re(z.result)},[z]),o.useEffect(()=>{Z&&E(z.result)},[Z]),o.useEffect(()=>{I&&te(I.result)},[I]),o.useEffect(()=>{X&&(h(!1),se(X.result.map((c,A)=>({id:A+1,...c}))))},[X,Q]),o.useEffect(()=>{if(i){const c=i.result[0];O(c.vendorList),R(c.operatingMachineList),P(c.workingHeadList)}},[i]),console.log("initialRows",ne);const U=(y==null?void 0:y.result)||[];o.useEffect(()=>{const c=()=>{const w=parseFloat(s.thaanQty)||0,pe=parseFloat(s.operatingMachine)||0;return(w*pe).toFixed(2)};F(w=>({...w,totalEmbroidry:c()}));const A=()=>{const w=parseFloat(s.thaanQty)||0,pe=parseFloat(s.noOfItemPerThaan)||0;return(w*pe).toFixed(2)};F(w=>({...w,totalPcs:A()}));const l=()=>{const w=parseFloat(s.noOfStichesPerYard)||0,pe=parseFloat(s.rate)||0;return(w/1e3*pe).toFixed(2)};F(w=>({...w,amountPerYard:l()}));const f=()=>{const w=parseFloat(s.totalAmount)||0,pe=parseFloat(s.totalPcs)||0;return(w/pe).toFixed(2)};F(w=>({...w,costPerComponent:f()}));const H=()=>{const w=parseFloat(s.amountPerYard)||0,pe=parseFloat(s.totalEmbroidry)||0,x=parseFloat(s.laserCutRate)||0,Y=parseFloat(s.pcsForLaserCut)||0;return(w*pe+Y*x).toFixed(2)};F(w=>({...w,totalAmount:H()}))},[s.thaanQty,s.operatingMachine,s.noOfStichesPerYard,s.rate,s.totalAmount,s.totalPcs,s.amountPerYard,s.totalEmbroidry,s.laserCutRate,s.pcsForLaserCut]);const de=c=>{const{name:A,checked:l}=c.target;F(f=>({...f,[A]:l}))};o.useEffect(()=>{s.productionStatus===3&&v("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[s.productionStatus]);const $=c=>{const{name:A,value:l}=c.target;if(A==="collectionId"){const f=U.find(H=>H.collectionId===parseInt(l));D(l),m(!0),se([]),h(!0),F({...s,collectionId:l,designId:"",planningHeaderId:0,productionStatus:f?f.productionStatus:"",batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(A==="designId"){const f=q.find(H=>H.designId===parseInt(l));se([]),h(!0),F({...s,designId:l,baseColorId:f?f.colorId:"",baseColorName:f?f.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0})}else if(A==="batchNo"){const f=ie.find(H=>H.batchNo===l);F({...s,batchNo:l,planningHeaderId:f?f.planningHeaderId:"",poPcs:f?f.poPcs:"",componentId:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0}),T(!0),m(!1)}else if(A==="colorId"){const f=N.find(H=>H.colorId===l);F({...s,colorId:l,availableQty:f?f.total:"",cuttingSize:f?f.cuttingSize:"",repeats:f?f.repeats:""})}else if(A==="operatingMachineId"){const f=M.find(H=>H.lookUpId===l);F({...s,operatingMachineId:l,operatingMachine:f?f.lookUpName:""})}else F({...s,[A]:l})};console.log("colors",N);const[L,le]=o.useState({}),me=async()=>{const c=be();if(Object.keys(c).length>0){le(c);return}try{const A=await Se.post("http://100.42.177.77:83/api/Schiffli/SaveSchiffili",s);console.log("Save response:",A.data),A.data.success?v("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(v(`${A.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",A.data.message)),F(l=>({designId:l.designId,planningHeaderId:l.planningHeaderId,batchNo:l.batchNo,baseColorName:l.baseColorName,schiffiliId:0,componentId:"",poPcs:l.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:d.empId})),Q()}catch(A){console.error("Error saving data:",A),v("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},be=()=>{const c={};return s.fabricId||(c.fabricId="fabricId is required"),s.colorId||(c.colorId="colorId is required"),s.vendorId||(c.vendorId="vendorId is required"),s.componentId||(c.componentId="componentId is required"),s.thaanQty||(c.thaanQty="thaanQty is required"),s.workingHeadId||(c.workingHeadId="workingHeadId is required"),s.rate||(c.rate="rate is required"),s.operatingMachineId||(c.operatingMachineId="operatingMachineId is required"),s.noOfStichesPerYard||(c.noOfStichesPerYard="noOfStichesPerYard is required"),s.noOfItemPerThaan||(c.noOfItemPerThaan="noOfItemPerThaan is required"),c};console.log("formData",s);const[ke,Oe]=o.useState(0),[je,Ae]=o.useState(0),[Ne,we]=o.useState(0);o.useEffect(()=>{const c=ne.reduce((f,H)=>f+(H.totalAmount??0),0).toFixed(2),A=ne.reduce((f,H)=>f+(H.totalEmbroidry??0),0).toFixed(2),l=ne.reduce((f,H)=>f+(H.totalPcs??0),0).toFixed(2);Oe(parseFloat(c).toLocaleString()),Ae(parseFloat(A).toLocaleString()),we(parseFloat(l).toLocaleString())},[ne]);const C={id:"TOTAL_SUMMARY",fabricName:"Total Summary",totalAmount:ke,totalEmbroidry:je,totalPcs:Ne},V=[...ne,C],xe=[{field:"id",headerName:"Sr#",colSpan:(c,A)=>A.id==="TOTAL_SUMMARY"?3:void 0,renderCell:c=>c.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):c.value},{field:"fabricName",headerName:"Fabric",colSpan:(c,A)=>A.id==="TOTAL_SUMMARY"?2:void 0,renderCell:c=>c.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):c.value},{field:"componentName",headerName:"Component",renderCell:c=>e.jsx(Ye,{label:c.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry",renderCell:c=>c.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:c.value}):c.value},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs",renderCell:c=>c.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:c.value}):c.value},{field:"totalAmount",headerName:"Total Amount",renderCell:c=>c.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:c.value}):c.value},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Laser Cut Pcs."}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:Ht,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g,onChange:$,size:"small",InputLabelProps:{sx:{color:"black"}},children:U.map(c=>e.jsx(_,{value:c.collectionId,children:c.collectionName},c.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:$,size:"small",InputLabelProps:{sx:{color:"black"}},children:q.map(c=>e.jsx(_,{value:c.designId,children:c.designNo},c.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:$,size:"small",InputLabelProps:{sx:{color:"black"}},children:ie.map(c=>e.jsx(_,{value:c.batchNo,children:c.batchNo},c.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,disabled:!0,InputLabelProps:{sx:{color:"black"}},sx:c=>({...s.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}})})})]})]}),e.jsx(ge,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ft,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Qe,{onClick:k,sx:{mt:"-18px"},children:e.jsx(et,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(Rt,{expanded:a,onChange:k,sx:{},children:[e.jsx(zt,{expandIcon:e.jsx(et,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Qt,{children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:$,size:"small",required:!0,error:!!L.componentId,helperText:L.componentId,InputLabelProps:{sx:{color:"black"}},children:Ie.map(c=>e.jsx(_,{value:c.componentId,children:c.componentName},c.componentId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:$,required:!0,error:!!L.fabricId,helperText:L.fabricId,InputLabelProps:{sx:{color:"black"}},children:ue.map(c=>e.jsx(_,{value:c.fabricId,children:c.fabric},c.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:s.vendorId,onChange:$,required:!0,error:!!L.vendorId,helperText:L.vendorId,InputLabelProps:{sx:{color:"black"}},children:he.map(c=>e.jsx(_,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:$,required:!0,error:!!L.colorId,helperText:L.colorId,InputLabelProps:{sx:{color:"black"}},children:N.map(c=>e.jsx(_,{value:c.colorId,children:c.color},c.colorId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,disabled:!0,onChange:$,sx:c=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:s.availableQty,onChange:$,sx:c=>({...s.availableQty!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:s.thaanQty,onChange:$,required:!0,error:!!L.thaanQty,helperText:L.thaanQty,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Operating Machine",defaultValue:"",size:"small",name:"operatingMachineId",value:s.operatingMachineId,onChange:$,required:!0,error:!!L.operatingMachineId,helperText:L.operatingMachineId,InputLabelProps:{sx:{color:"black"}},children:M.map(c=>e.jsx(_,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Working Head",defaultValue:"",size:"small",name:"workingHeadId",value:s.workingHeadId,onChange:$,required:!0,error:!!L.workingHeadId,helperText:L.workingHeadId,InputLabelProps:{sx:{color:"black"}},children:ee.map(c=>e.jsx(_,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:s.cuttingSize,onChange:$,sx:c=>({...s.cuttingSize!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:s.rate,onChange:$,required:!0,error:!!L.rate,helperText:L.rate,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:s.noOfStichesPerYard,onChange:$,required:!0,error:!!L.noOfStichesPerYard,helperText:L.noOfStichesPerYard,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:s.noOfItemPerThaan,onChange:$,required:!0,error:!!L.noOfItemPerThaan,helperText:L.noOfItemPerThaan,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:s.totalEmbroidry,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:s.amountPerYard,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:s.totalPcs,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:s.costPerComponent,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:s.totalAmount,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(Wt,{control:e.jsx(_t,{checked:s.laserCut,onChange:de,name:"laserCut"}),label:"Laser Cut"})}),s.laserCut?e.jsx(r,{item:!0,xs:12,md:4.5,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(u,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:s.laserCutRate,onChange:$,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(u,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:s.pcsForLaserCut,onChange:$,InputLabelProps:{sx:{color:"black"}}})})]})}):null,e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(fe,{variant:"contained",size:"small",onClick:me,disabled:s.productionStatus===3,children:"Save"})})]})})]})]}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ge,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(r,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:xe,initialRows:V,disableDelete:s.productionStatus===3,disableEdit:s.productionStatus===3,setInitialData:b,deleteApi:"http://100.42.177.77:83/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:Q,setAccordionExpanded:T,fileName:"Schffili List",isLoading:j})})})]})]})},vo=xo,yo=({additionalProcessData:n,setAdditionalProcessData:d,refetchAdditionalProcessList:v,handleClickOpen:j,productionStatus:h})=>{const{user:t}=We(),[b,s]=o.useState([]),{enqueueSnackbar:F}=ze(),[a,T]=o.useState({}),[k,K]=o.useState([]),m=b.reduce((Q,I)=>Q+(I.quantity??0),0).toFixed(2);console.log("Quantity",m);const[y,g]=o.useState({additionalProcessDetId:0,additionalProcessId:n.additionalProcessId||0,designId:n.designNo||"",planningHeaderId:n.planningHeaderId||0,batchNo:n.batchNo||"",componentName:n.componentName||"",componentId:n.componentId||"",colorName:n.colorName||"",colorId:n.colorId||"",fabricName:n.fabricName||"",fabricId:n.fabricId||"",uomId:n.uomId||"",uom:n.uom||"",vendorId:"",pcsPerComponent:n.pcsPerComponent||"",remainingPcsPerComponent:n.pcsPerComponent-m||"",processTypeName:n.processTypeName||"",processTypeId:n.processTypeId||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId});o.useEffect(()=>{g(Q=>({...Q,additionalProcessDetId:k.additionalProcessDetId||0,vendorId:(k==null?void 0:k.vendorId)||"",quantity:(k==null?void 0:k.quantity)||"",ratePerPcs:(k==null?void 0:k.ratePerPcs)||"",remainingPcsPerComponent:Q.remainingPcsPerComponent+(k==null?void 0:k.quantity)||"",totalAmount:(k==null?void 0:k.totalAmount)||"",costPerComponent:(k==null?void 0:k.costPerComponent)||0,createdOn:(k==null?void 0:k.createdOn)||new Date().toISOString(),createdBy:(k==null?void 0:k.createdBy)||t.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:t.empId}))},[k]),o.useEffect(()=>{g({...y,remainingPcsPerComponent:n.pcsPerComponent-m>=0?n.pcsPerComponent-m:""})},[b,n.pcsPerComponent,m]);const{data:D}=_e(),{data:i,refetch:G}=Ga(y.additionalProcessId,{skip:!y.additionalProcessId}),[J,B]=o.useState([]);o.useEffect(()=>{if(D){const Q=D.result[0];B(Q.vendorList)}},[D]),o.useEffect(()=>{i&&s(i.result.map((Q,I)=>({id:I+1,...Q})))},[i,G]),console.log("initialRows",b);const W=Q=>{const{name:I,value:q}=Q.target;g({...y,[I]:q}),g(oe=>{const ie={...oe,[I]:q};if(I==="quantity"||I==="remainingPcsPerComponent"){const S=ie.quantity,ue=ie.remainingPcsPerComponent;S>ue?T(re=>({...re,quantity:"Assigned Quantity cannot be greater than Remaining Quantity"})):T(re=>({...re,quantity:""}))}return ie})};o.useEffect(()=>{const Q=()=>{const q=parseFloat(y.quantity)||0,oe=parseFloat(y.ratePerPcs)||0;return(q*oe).toFixed(2)};g(q=>({...q,totalAmount:Q()}));const I=()=>{const q=parseFloat(y.totalAmount)||0,oe=parseFloat(y.poPcs)||0;return(q/oe).toFixed(2)};g(q=>({...q,costPerComponent:I()}))},[y.quantity,y.ratePerPcs,y.totalAmount]);const z=async()=>{if(console.log(y),y.quantity>y.remainingPcsPerComponent){F("Assigned quantity can not be greater then Remaining Quantity !",{variant:"error",autoHideDuration:5e3});return}try{const Q=await Se.post("http://100.42.177.77:83/api/AdditionalProcess/SaveAdditionalProcessDetails",y);console.log("Save response:",Q.data),Q.data.success?F("Schiffili saved successfully!",{variant:"success",autoHideDuration:5e3}):(F(`${Q.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",Q.data.message)),G(),g(I=>({...I,vendorId:"",pcsPerComponent:n.pcsPerComponent||"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",remainingPcsPerComponent:n.pcsPerComponent-m||"",createdOn:new Date().toISOString(),createdBy:t.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:t.empId})),v()}catch(Q){console.error("Error saving data:",Q),F("Schiffili not saved successfully!",{variant:"error",autoHideDuration:5e3})}},Z=[{field:"id",headerName:"Sr#"},{field:"vendorName",headerName:"Vendor",flex:2},{field:"processType",headerName:"Process Type",flex:2},{field:"pcsPerComponent",headerName:" Pcs. Per Component",flex:1},{field:"quantity",headerName:"Quantitity",flex:1},{field:"ratePerPcs",headerName:"Rate Per Pcs.",flex:1},{field:"totalAmount",headerName:"Total Amount",flex:1}];return e.jsxs(Re,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"Inherit"},children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Select Design",name:"designId",value:y.designId,onChange:W,size:"small",disabled:!0,sx:Q=>({...y.designId!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"Batch No.",name:"batchNo",value:y.batchNo,onChange:W,size:"small",disabled:!0,sx:Q=>({...y.batchNo!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,label:"Components",name:"componentName",value:y.componentName,onChange:W,size:"small",disabled:!0,sx:Q=>({...y.componentName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricName",value:y.fabricName,onChange:W,disabled:!0,sx:Q=>({...y.fabricName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Color",size:"small",name:"colorName",value:y.colorName,onChange:W,disabled:!0,sx:Q=>({...y.colorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeName",value:y.processTypeName,onChange:W,disabled:!0,sx:Q=>({...y.processTypeName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:y.pcsPerComponent,onChange:W,disabled:!0,sx:Q=>({...y.pcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Remaining Pcs. Per Component",fullWidth:!0,size:"small",name:"remainingPcsPerComponent",value:y.remainingPcsPerComponent,onChange:W,disabled:!0,sx:Q=>({...y.remainingPcsPerComponent!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"UOM",fullWidth:!0,size:"small",name:"uom",value:y.uom,onChange:W,disabled:!0,sx:Q=>({...y.uom!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})})]}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Vendors",size:"small",name:"vendorId",value:y.vendorId,onChange:W,disabled:!y.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}},children:J.map(Q=>e.jsx(_,{value:Q.lookUpId,children:Q.lookUpName},Q.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:y.quantity,onChange:W,disabled:!y.remainingPcsPerComponent,error:!!a.quantity,helperText:a.quantity,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:y.ratePerPcs,onChange:W,disabled:!y.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:y.totalAmount,onChange:W,disabled:!y.remainingPcsPerComponent,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(fe,{variant:"contained",size:"small",onClick:z,disabled:!y.remainingPcsPerComponent||h===3,children:"Save"})})]}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}}),e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(r,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(qe,{iColumns:Z,initialRows:b,disableDelete:h===3,disableEdit:h===3,setInitialData:K,deleteApi:"http://100.42.177.77:83/api/AdditionalProcess/DeleteAdditionalProcessDetails?apdId=",deleteBy:"additionalProcessDetId",refetch:G})})})]})},Co=({initialValues:n})=>{const{user:d}=We(),{enqueueSnackbar:v}=ze(),[j,h]=o.useState(!0),[t,b]=o.useState([]),[s,F]=o.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId});console.log("initialData",t),o.useEffect(()=>{F({...s,additionalProcessId:(t==null?void 0:t.additionalProcessId)||0,componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",colorId:(t==null?void 0:t.colorId)||"",pcsPerComponent:(t==null?void 0:t.pcsPerComponent)||"",uomId:(t==null?void 0:t.uomId)||"",processTypeId:(t==null?void 0:t.processTypeId)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})},[t]);const[a,T]=o.useState(!1),{data:k}=$e(),[K,m]=o.useState("");o.useEffect(()=>{m(n.collectionId)},[]);const{data:y}=_e(),{data:g,refetch:D}=Xe(K,{skip:!K}),{data:i,refetch:G}=ot(s.designId,{skip:!s.designId}),{data:J}=ut({batchNo:s.planningHeaderId,componentId:s.componentId},{skip:!s.planningHeaderId||!s.componentId}),{data:B}=pt({batchNo:s.planningHeaderId,componentId:s.componentId,fabricId:s.fabricId},{skip:!s.planningHeaderId||!s.componentId||!s.fabricId}),{data:W,refetch:z}=Ya(s.planningHeaderId,{skip:!s.planningHeaderId}),{data:Z}=mt(s.planningHeaderId,{skip:!s.planningHeaderId});console.log("lookupData",y),console.log("collectionData",k),console.log("colorData",B);const[X,Q]=o.useState([]),[I,q]=o.useState([]),[oe,ie]=o.useState([]),[S,ue]=o.useState([]),[re,he]=o.useState([]),[O,M]=o.useState([]),[R,ee]=o.useState([]),[P,N]=o.useState([]),[E,ne]=o.useState([]),[se,Ie]=o.useState([]),[te,U]=o.useState([]);console.log("batchData",i);const[de,$]=o.useState([]);o.useEffect(()=>{k&&$(k.result)},[k]),o.useEffect(()=>{g&&Q(g.result)},[g]),o.useEffect(()=>{i&&q(i.result)},[i]),o.useEffect(()=>{J&&ie(J.result)},[J]),o.useEffect(()=>{B&&ne(B.result)},[B]),o.useEffect(()=>{Z&&U(Z.result)},[Z]),o.useEffect(()=>{if(y){const p=y.result[0];he(p.uomList),M(p.processList)}},[y]),o.useEffect(()=>{W&&(h(!1),Ie(W.result.map((p,c)=>({id:c+1,...p}))))},[W,z]),o.useEffect(()=>{if(y){const p=y.result[0];ue(p.vendorList),ee(p.operatingMachineList),N(p.workingHeadList)}},[y]),console.log("initialRows",se),o.useEffect(()=>{s.productionStatus===3&&v("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[s.productionStatus]);const L=p=>{const{name:c,value:A}=p.target;if(c==="collectionId"){const l=de.find(f=>f.collectionId===parseInt(A));m(A),Ie([]),h(!0),F({...s,collectionId:A,designId:"",planningHeaderId:0,productionStatus:l?l.productionStatus:"",batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})}else if(c==="designId"){const l=X.find(f=>f.designId===parseInt(A));Ie([]),h(!0),F({...s,designId:A,baseColorId:l?l.colorId:"",baseColorName:l?l.colorName:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",uomId:"",poPcs:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})}else if(c==="batchNo"){const l=I.find(f=>f.batchNo===A);F({...s,batchNo:A,planningHeaderId:l?l.planningHeaderId:"",poPcs:l?l.poPcs:"",componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId}),T(!0)}else F({...s,[c]:A})};console.log("colors",E);const le=async()=>{console.log("formData",s);try{const p=await Se.post("http://100.42.177.77:83/api/AdditionalProcess/SaveAdditionalProcess",s);console.log("Save response:",p.data),p.data.success?v("Process saved successfully!",{variant:"success",autoHideDuration:5e3}):(v(`${p.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",p.data.message)),F(c=>({additionalProcessId:0,designId:c.designId,planningHeaderId:c.planningHeaderId,batchNo:c.batchNo,baseColorName:c.baseColorName,poPcs:c.poPcs,componentId:"",colorId:"",fabricId:"",uomId:"",pcsPerComponent:"",processTypeId:"",createdOn:new Date().toISOString(),createdBy:d.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:d.empId})),z()}catch(p){console.error("Error saving data:",p),v("Process not saved successfully!",{variant:"error",autoHideDuration:5e3})}};console.log("formData",s),o.forwardRef(function(c,A){return e.jsx(Va,{direction:"up",ref:A,...c})});const[me,be]=o.useState({}),[ke,Oe]=o.useState(!1),je=p=>{be(p),Oe(!0)},Ae=()=>{Oe(!1),be({}),z()},[Ne,we]=o.useState(0);o.useEffect(()=>{const p=se.reduce((c,A)=>c+(A.assignedQty??0),0).toFixed(2);we(parseFloat(p).toLocaleString())},[se]);const C=[...se,{id:"TOTAL_SUMMARY",assignedQty:Ne}],V=[{field:"id",headerName:"Sr#",colSpan:(p,c)=>c.id==="TOTAL_SUMMARY"?4:void 0,renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):p.value},{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch"},{field:"componentName",headerName:"Component",renderCell:p=>e.jsx(Ye,{label:p.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"processTypeName",headerName:"Process Type"},{field:"pcsPerComponent",headerName:"Pcs Per Component"},{field:"assignedQty",headerName:"Assigned Quantity",colSpan:(p,c)=>c.id==="TOTAL_SUMMARY"?3:void 0,valueGetter:p=>p,renderCell:p=>p.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:p.value}):p.value},{field:"AddVendor",headerName:"Add Vendor",renderCell:p=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(Qe,{color:"primary",onClick:()=>je(p.row),children:e.jsx(It,{})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(rt,{src:Ht,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:K,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:de.map(p=>e.jsx(_,{value:p.collectionId,children:p.collectionName},p.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:s.designId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:X.map(p=>e.jsx(_,{value:p.designId,children:p.designNo},p.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:s.batchNo,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:I.map(p=>e.jsx(_,{value:p.batchNo,children:p.batchNo},p.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:s.baseColorName,onChange:L,disabled:!0,sx:p=>({...s.baseColorName!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsxs(r,{item:!0,xs:12,md:12,children:[e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%"}})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:s.componentId,onChange:L,size:"small",InputLabelProps:{sx:{color:"black"}},children:te.map(p=>e.jsx(_,{value:p.componentId,children:p.componentName},p.componentId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:s.fabricId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:oe.map(p=>e.jsx(_,{value:p.fabricId,children:p.fabric},p.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:s.colorId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:E.map(p=>e.jsx(_,{value:p.colorId,children:p.color},p.colorId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:s.poPcs,onChange:L,disabled:!0,sx:p=>({...s.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(u,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:s.pcsPerComponent,onChange:L,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:140,size:"small",name:"uomId",value:s.uomId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:re.map(p=>e.jsx(_,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processTypeId",value:s.processTypeId,onChange:L,InputLabelProps:{sx:{color:"black"}},children:O.map(p=>e.jsx(_,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:0},children:e.jsx(fe,{variant:"contained",size:"small",onClick:le,disabled:s.productionStatus===3,children:"Save"})})]})]}),e.jsx(ge,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ve,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(r,{sx:{marginTop:2},item:!0,xs:12,children:[e.jsx(qe,{iColumns:V,initialRows:C,disableDelete:s.productionStatus===3,disableEdit:s.productionStatus===3,setInitialData:b,deleteApi:"http://100.42.177.77:83/api/AdditionalProcess/DeleteAdditionalProcess?adId=",deleteBy:"additionalProcessId",refetch:z,setAccordionExpanded:T,fileName:"AdditionalProcess",isLoading:j}),e.jsxs(nt,{open:ke,onClose:Ae,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(ht,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(Ce,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Additional Process > Assign Vendors "}),e.jsx(Qe,{onClick:Ae,sx:{color:"#ffffff"},children:e.jsx(ft,{})})]}),e.jsxs(st,{children:[e.jsx(gt,{id:"alert-dialog-slide-description"}),e.jsx(yo,{additionalProcessData:me,productionStatus:s.productionStatus,setAdditionalProcessData:be,refetchAdditionalProcessList:z,handleClickOpen:je})]})]})]})})]})]})},Mo=Co;function So({initialValues:n}){const[d,v]=o.useState(!0),{enqueueSnackbar:j}=ze(),{data:h}=_e(),[t,b]=o.useState([]),[s,F]=o.useState([]),[a,T]=o.useState([]),[k,K]=o.useState([]),[m,y]=o.useState([]),[g,D]=o.useState([]),[i,G]=o.useState([]),{user:J}=We();o.useEffect(()=>{h&&(K(h.result[0].vendorList),T(h.result[0].serviceList),b(h.result[0].serviceTypeList),D(h.result[0].uomList))},[h]);const[B,W]=o.useState({additionalServiceId:0,collectionId:"",batchNo:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()});o.useEffect(()=>{W({...B,additionalServiceId:i.additionalServiceId||0,collectionId:(i==null?void 0:i.collectionId)||"",serviceTypeId:(i==null?void 0:i.serviceTypeId)||"",serviceListId:(i==null?void 0:i.serviceListId)||"",vendorId:(i==null?void 0:i.vendorId)||"",qty:(i==null?void 0:i.qty)||"",uomId:(i==null?void 0:i.uomId)||"",rate:(i==null?void 0:i.rate)||"",totalAmount:(i==null?void 0:i.totalAmount)||0,UOM:(i==null?void 0:i.uom)||0,uom:(i==null?void 0:i.uom)||"",createdOn:(i==null?void 0:i.createdOn)||new Date().toISOString(),createdBy:(i==null?void 0:i.createdBy)||J.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:J.empId})},[i]);const{data:z,refetch:Z}=Bt(B.collectionId,{skip:!B.collectionId});o.useEffect(()=>{W({...B,collectionId:(n==null?void 0:n.collectionId)||""})},[W]),o.useEffect(()=>{z&&F(z)},[z,Z]),o.useEffect(()=>{B.productionStatus===3&&j("Production Staus is completed. Select other Collection!",{variant:"warning",autoHideDuration:5e3})},[B.productionStatus]);const X=async O=>{const{name:M,value:R}=O.target;if(console.log(`Updating ${M} to ${R}`),W({...B,[M]:R}),M==="collectionId"){const ee=m.find(P=>P.collectionId===R);W({...B,collectionId:R,productionStatus:ee?ee.productionStatus:"",poPcs:""})}else if(M==="batchNo"){const ee=s.find(P=>P.distinctId===R);W({...B,batchNo:R,poPcs:ee?ee.poPcsSum:"",createdOn:new Date().toISOString(),createdBy:J.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:J.empId}),setAccordionExpanded(!0)}};o.useEffect(()=>{const O=()=>{const R=parseFloat(B.qty)||0,ee=parseFloat(B.rate)||0;return(R*ee).toFixed(2)};W(R=>({...R,totalAmount:O()}));const M=()=>{const R=parseFloat(B.poPcs)||0,ee=parseFloat(B.totalAmount)||0;return(R/ee).toFixed(2)};W(R=>({...R,costperPiece:M()}))},[B.qty,B.rate,B.totalAmount,B.costperPiece]);const Q=async()=>{try{const O=await Se.post("http://100.42.177.77:83/api/AdditionalServices/SaveAdditionalServices",B);console.log("Form data saved:",O.data),W({additionalServiceId:0,collectionId:"",serviceTypeId:"",serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),onSaveSuccess&&onSaveSuccess()}catch(O){console.error("Error saving data:",O)}};o.useEffect(()=>{(async()=>{try{const M=await Se.get("http://100.42.177.77:83/api/PrePlanning/GetCollectionListFromPlanningHeader");console.log("GetCollectionFromPlanningHeader",M),y(M.data.result)}catch(M){console.error("Error fetching design options:",M)}})()},[]);const[I,q]=o.useState([]),oe=o.useCallback(async()=>{try{const O=await Se.get(`http://100.42.177.77:83/api/AdditionalServices/GetAdditionalServicesListByCollectionId?collectionId=${B.collectionId}`);Array.isArray(O.data.result)?(v(!1),q(O.data.result.map((M,R)=>({id:R+1,...M})))):(console.error("API returned unexpected data format:",O.data.result),q([]))}catch(O){console.error("Error fetching data:",O),q([])}},[B.collectionId]);o.useEffect(()=>{oe()},[oe]);const[ie,S]=o.useState(0);o.useEffect(()=>{const O=I.reduce((M,R)=>M+(R.totalAmount??0),0).toFixed(2);S(parseFloat(O).toLocaleString())},[I]);const ue=[...I,{id:"TOTAL_SUMMARY",totalAmount:ie}],re=[{field:"id",headerName:"Sr#",colSpan:(O,M)=>M.id==="TOTAL_SUMMARY"?4:void 0,renderCell:O=>O.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"black",fontWeight:"bold"},children:"Total Summary"}):O.value},{field:"collectionName",headerName:"Collection Name"},{field:"serviceType",headerName:"Service Type",renderCell:O=>e.jsx(Ye,{label:O.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"serviceListName",headerName:"Service List Name",renderCell:O=>e.jsx(Ye,{label:O.value,sx:{backgroundColor:"success.dark",color:"white"},color:void 0})},{field:"vendor",headerName:"Vendor"},{field:"poPcs",headerName:"PO Pieces"},{field:"qty",headerName:"Quantity"},{field:"uom",headerName:"UOM"},{field:"rate",headerName:"Rate"},{field:"totalAmount",headerName:"Total Amount",colSpan:(O,M)=>M.id==="TOTAL_SUMMARY"?3:void 0,renderCell:O=>O.row.id==="TOTAL_SUMMARY"?e.jsx("span",{style:{color:"#a11f23",fontWeight:"bold"},children:O.value}):O.value},{field:"costperPiece",headerName:"Cost per Piece"}];return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:B.collectionId,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:m.length>0?m.map(O=>e.jsx(_,{id:"collectionId",value:O.collectionId,children:O.collectionName},O.collectionId)):e.jsx(_,{disabled:!0,children:"No Collections Available"})})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(u,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:B.batchNo,onChange:X,size:"small",InputLabelProps:{sx:{color:"black"}},children:s.map(O=>e.jsx(_,{value:O.distinctId,children:O.distinctId},O.distinctId))})," "]}),e.jsx(r,{item:!0,md:3,width:"inherit",children:e.jsx(u,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:B.serviceTypeId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:t.map(O=>e.jsx(_,{value:O.lookUpId,children:O.lookUpName},O.lookUpId))})}),e.jsx(r,{item:!0,md:3,width:"inherit",children:e.jsx(u,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:B.serviceListId,onChange:X,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{sx:{color:"black"}},children:a.map(O=>e.jsx(_,{value:O.lookUpId,children:O.lookUpName},O.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:B.vendorId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:k.map(O=>e.jsx(_,{value:O.lookUpId,children:O.lookUpName},O.lookUpId))})}),e.jsx(r,{item:!0,md:1.5,width:"inherit",children:e.jsx(u,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:B.poPcs,onChange:X,type:"number",size:"small",fullWidth:!0,disabled:!0,sx:O=>({...B.poPcs!==""&&{".css-4a5t8g-MuiInputBase-input-MuiOutlinedInput-input":{backgroundColor:"#c9c9c9 !important"}},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"black"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:"#f9f9f9"},"& .MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline":{},"& .MuiInputLabel-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.87)"}}),InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,md:1.5,width:"inherit",children:e.jsx(u,{id:"outlined-required",label:"Qty",name:"qty",value:B.qty,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,md:1.5,width:"inherit",children:e.jsx(u,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:B.uomId,onChange:X,InputLabelProps:{sx:{color:"black"}},children:g.map(O=>e.jsx(_,{value:O.lookUpId,children:O.lookUpName},O.lookUpId))})}),e.jsx(r,{item:!0,md:1.5,width:"inherit",children:e.jsx(u,{id:"outlined-required",label:"Rate",name:"rate",value:B.rate,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,md:1.5,width:"inherit",children:e.jsx(u,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:B.totalAmount,onChange:X,type:"number",size:"small",fullWidth:!0,required:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,md:1.5,width:"inherit",children:e.jsx(u,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:B.costperPiece,onChange:X,type:"number",size:"small",required:!0,fullWidth:!0,InputLabelProps:{sx:{color:"black"}}})}),e.jsx(r,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(fe,{variant:"contained",color:"primary",size:"small",disabled:B.productionStatus===3,onClick:Q,children:"Save"})})]})]}),e.jsx(ge,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services",titleTypographyProps:{style:{color:"white"}}}),e.jsx(qe,{iColumns:re,initialRows:ue,disableDelete:B.productionStatus===3,disableEdit:B.productionStatus===3,isLoading:d,setInitialData:G,deleteApi:"http://100.42.177.77:83/api/AdditionalServices/DeleteAdditionalProcess?servicesId=",refetch:oe,deleteBy:"additionalServiceId"})]})]})}$a(Ka)(({theme:n})=>({backgroundColor:n.palette.primary.main,color:n.palette.primary.light,overflow:"hidden",position:"relative","&:after":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(210.04deg, ${n.palette.grey[400]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,borderRadius:"50%",top:-30,right:-180},"&:before":{content:'""',position:"absolute",width:210,height:210,background:`linear-gradient(140.9deg, ${n.palette.grey[400]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,borderRadius:"50%",top:-160,right:-130}}));const Po=({initialValues:n,setActiveStep:d,collectionId:v,setInitialValues:j})=>{var ke,Oe,je,Ae,Ne,we;const{user:h}=We(),{enqueueSnackbar:t}=ze();o.useState([]);const{data:b}=$e(),[s,F]=o.useState(null),[a,T]=o.useState(!1);ct();const[k,K]=o.useState(!1),[m,y]=o.useState(v||""),[g,D]=o.useState({designId:"",planningHeaderId:"",batchNo:"",distinctId:"",collectionBatchId:"",collectionId:m||""}),i=C=>{me.current&&me.current.autosizeColumns&&me.current.autosizeColumns({includeOutliers:!0,includeHeaders:!0})},[G,J]=o.useState([]),B=C=>{J(C),console.log("New Selection:",C)},{data:W,refetch:z}=Bt(m,{skip:!m}),[Z,X]=o.useState([]),[Q,I]=o.useState([]),[q,oe]=o.useState([]);console.log("distinctData",W),o.useEffect(()=>{b&&oe(b.result)},[b]),o.useEffect(()=>{W&&(console.log("Distinct Data:",W.result),I(W||[]))},[W]);const ie=C=>{const{name:V,value:xe}=C.target;if(console.log(`handleChange called with name: ${V}, value: ${xe}`),V==="collectionId")y(xe),D({...g,collectionId:xe,collectionBatchId:""}),z(v);else if(V==="collectionBatchId")D({...g,collectionBatchId:xe,planningHeaderId:g.planningHeaderId});else{const p={...g,[V]:xe};D(p)}},{data:S,refetch:ue}=Xa({collectionId:g.collectionId,collectionBatchId:g.collectionBatchId},{skip:!g.collectionId||!g.collectionBatchId});o.useEffect(()=>{S&&S.length>0&&X(S)},[S]),console.log("Selected collection ID:",m),console.log("distinctCollectionList data:",Q);const re=async C=>{T(!0);try{console.log("Fetching Summary Data for ID:",C);const V=await Se.get(`http://100.42.177.77:83/api/PrePlanning/GetPrePlanningSummaryByBatchId?planningHeaderId=${C}`);V.data.success?F(V.data.result):console.error(V.data.message)}catch(V){console.error("Failed to fetch summary data",V)}finally{T(!1)}};console.log("formData",g);const he=C=>{console.log("Selected PlanningHeaderId:",C),re(C),K(!0)},O=()=>{K(!1)},M=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"planningProcessTypeName",headerName:"Process Type"},{field:"componentsCount",headerName:"Components Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalFabricSum",headerName:"Total Fabric Sum",valueGetter:C=>C.toLocaleString()},{field:"totalFabricRequiredSum",headerName:"Total Fabric Required Sum",valueGetter:C=>C.toLocaleString()}],R=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"fabricCount",headerName:"Fabric Count"},{field:"totalExcGst",headerName:"Total Excluding GST",valueGetter:C=>C.toLocaleString()},{field:"totalIncGst",headerName:"Total Including GST",valueGetter:C=>C.toLocaleString()}],ee=[{field:"designNo",headerName:"Design No"},{field:"batchNo",headerName:"Batch No"},{field:"processType",headerName:"Process Type"},{field:"assignedQtySum",headerName:"Assigned Qty Sum"},{field:"availableQtySum",headerName:"Available Qty Sum",valueGetter:C=>C.toLocaleString()},{field:"colorCount",headerName:"Color Count"},{field:"fabricCount",headerName:"Fabric Count"},{field:"outputQtySum",headerName:"Output Qty Sum"},{field:"totalIncGst",headerName:"Total Including GST",valueGetter:C=>C.toLocaleString()}],P=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150},{field:"availableQtySum",headerName:"Available Qty Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150},{field:"requiredPcsSum",headerName:"Required Pcs Sum",width:150},{field:"totalAmountSum",headerName:"Total Amount Sum",valueGetter:C=>C.toLocaleString(),width:150}],N=[{field:"availableQtySum",headerName:"Available Qty Sum",valueGetter:C=>C.toLocaleString(),width:150},{field:"totalPcsSum",headerName:"Total Pcs Sum",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"componentCount",headerName:"Component Count",width:150}],E=[{field:"designNo",headerName:"Design No",width:150},{field:"batchNo",headerName:"Batch No",width:150},{field:"fabricCount",headerName:"Fabric Count",width:150},{field:"pcsPerComponent",headerName:"Pcs Per Component",width:150},{field:"assignedQtySum",headerName:"Assigned Qty Sum",width:150}],ne=[{field:"collectionName",headerName:"Collection Name"},{field:"batchNo",headerName:"Batch No"},{field:"designNo",headerName:"Design No"},{field:"orderNumber",headerName:"Order Number"},{field:"designerName",headerName:"Designer Name"},{field:"colorName",headerName:"Color Name"},{field:"poPcs",headerName:"PO Pieces"},{field:"batchStatusName",headerName:"Batch Status"},{field:"planningDate",headerName:"Planning Date",valueGetter:C=>new Date(C).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"action",headerName:"Action",renderCell:C=>e.jsx(bt,{variant:"outlined",size:"small","aria-label":"outlined primary button group",children:e.jsx(fe,{onClick:()=>he(C.row.planningHeaderId),children:"View"})}),sortable:!1,filterable:!1}],[se,Ie]=o.useState([]);o.useEffect(()=>{const C=(Z==null?void 0:Z.map((V,xe)=>({id:V.planningHeaderId||xe,...V})))||[];Ie(C)},[Z]);const te=((ke=s==null?void 0:s.prePlanningList)==null?void 0:ke.map((C,V)=>({id:V,...C})))||[],U=((Oe=s==null?void 0:s.fabricationList)==null?void 0:Oe.map((C,V)=>({id:V,...C})))||[],de=((je=s==null?void 0:s.dyeingPrintingList)==null?void 0:je.map((C,V)=>({id:V,...C})))||[],$=((Ae=s==null?void 0:s.embroideryList)==null?void 0:Ae.map((C,V)=>({id:V,...C})))||[],L=((Ne=s==null?void 0:s.schiffiliList)==null?void 0:Ne.map((C,V)=>({id:V,...C})))||[],le=((we=s==null?void 0:s.additionalProcessList)==null?void 0:we.map((C,V)=>({id:V,...C})))||[],me=ao(),be=async()=>{if(G.length===0){t("No rows selected",{variant:"warning"});return}const C=G,V={planningHeaderId:C,collectionBatchId:g.collectionBatchId,createdBy:h.empId,batchStatus:3};try{(await Se.post("http://100.42.177.77:83/api/PrePlanning/FinalizePrePlanningBatch",V)).data===!0?(t("Pre Planning Finalized successfully",{variant:"success"}),console.log("requestbody",V),Ie(p=>p.filter(c=>!C.includes(c.id)))):t("Failed to save data",{variant:"error"})}catch(xe){console.error("Failed to save data",xe),t("Failed to save data",{variant:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:g.collectionId,onChange:ie,size:"small",InputLabelProps:{sx:{color:"black"}},children:q.map(C=>e.jsx(_,{value:C.collectionId,children:C.collectionName},C.collectionId))})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Collection Batch",name:"collectionBatchId",value:g.collectionBatchId,onChange:ie,size:"small",InputLabelProps:{sx:{color:"black"}},children:Q.length>0?Q.map(C=>e.jsx(_,{value:C.collectionBatchId,children:C.distinctId},C.collectionBatchId)):e.jsx(_,{disabled:!0,children:"No batches available"})})}),e.jsx(r,{item:!0,xs:4,textAlign:"right",sx:{mt:1},children:e.jsx(fe,{variant:"contained",size:"small",onClick:be,color:"success",children:"Finalize"})})]})]}),e.jsx(r,{item:!0,xs:12,md:12,mb:1}),e.jsxs(Pe,{variant:"outlined",children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:1,width:"inherit",sx:{paddingY:1,paddingX:1},children:[e.jsx(r,{item:!0,xs:12,md:12,paddingTop:1,children:e.jsx(Ge,{rows:se,columns:ne,checkboxSelection:!0,getRowId:C=>C.id,disableRowSelectionOnClick:!0,isRowSelectable:C=>C.row.statusId!==3,autosizeOnMount:!0,apiRef:me,onStateChange:i,onRowSelectionModelChange:C=>B(C)})}),e.jsxs(nt,{open:k,onClose:O,maxWidth:"lg",fullWidth:!0,children:[e.jsx(Me,{className:"css-4rfrnx-MuiCardHeader-root",title:"Summary Details",titleTypographyProps:{style:{color:"white"}}}),e.jsx(st,{children:a?e.jsx(Re,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(Mt,{})}):s?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>d(0),children:"Pre Planning"}),e.jsx(Ge,{rows:te,columns:M,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,onStateChange:i,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ge,{color:"#921e22",sx:{height:3,width:"100%",mb:1}}),e.jsx(Ce,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>d(1),children:"Fabrication"}),e.jsx(Ge,{rows:U,columns:R,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%",mt:1,mb:1}}),e.jsx(Ce,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>d(2),children:"Dyeing"}),e.jsx(Ge,{rows:de,columns:ee,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(Ce,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>d(3),children:"Embroidery"}),e.jsx(Ge,{rows:$,columns:P,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(Ce,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>d(4),children:"Schiffli"}),e.jsx(Ge,{rows:L,columns:N,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}}),e.jsx(ge,{color:"#921e22",sx:{height:2,width:"100%",mb:1}}),e.jsx(Ce,{variant:"h3",gutterBottom:!0,sx:{color:"#9f1d22",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>d(5),children:"Additional Process"}),e.jsx(Ge,{rows:le,columns:E,pageSize:5,rowsPerPageOptions:[5],autoHeight:!0,hideFooter:!0,sx:{"--DataGrid-rowBorderColor":"rgb(255 255 255)","& .css-1kyxv1r-MuiDataGrid-root":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-container--top [role=row]":{color:"white",backgroundColor:"#323232"},"& .MuiDataGrid-columnSeparator":{color:"white"},"& .MuiDataGrid-iconButtonContainer":{color:"white"},"& .MuiDataGrid-sortIcon":{color:"white"},"& .css-ptiqhd-MuiSvgIcon-root ":{color:"white"},"& .MuiDataGrid-row":{"&.total-summary-row":{backgroundColor:"darkgray"}}}})]}):e.jsx(Mt,{})}),e.jsx(oo,{children:e.jsx(fe,{onClick:O,children:"Close"})})]})]})]})]})},jt=Po;var jo={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},vt=jo,ko=vt;function Oo(n){return!!(n&&ko[typeof n])}var lt=Oo,Ao=Object.prototype,No=Ao.toString,wo=RegExp("^"+String(No).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),it=wo,Lo=vt,To=Object.prototype,Bo=To.hasOwnProperty,Fo=function(n){var d,v=n,j=[];if(!v||!Lo[typeof n])return j;for(d in v)Bo.call(v,d)&&j.push(d);return j},Ro=Fo,zo=lt,Qo=it,Wo=Ro,tt=Qo.test(tt=Object.keys)&&tt,_o=tt?function(n){return zo(n)?tt(n):[]}:Wo,qt=_o;function Uo(){}var Ho=Uo,Et=lt,qo=it,at=qo.test(at=Object.create)&&at;function Gt(n,d){return Et(n)?at(n):{}}at||(Gt=function(){function n(){}return function(d){if(Et(d)){n.prototype=d;var v=new n;n.prototype=null}return v||window.Object()}}());var Yt=Gt,Eo=Ho,Go=it,kt={configurable:!1,enumerable:!1,value:null,writable:!1},Ot=function(){try{var n={},d=Go.test(d=Object.defineProperty)&&d,v=d(n,n,n)&&d}catch{}return v}(),Yo=Ot?function(n,d){kt.value=d,Ot(n,"__bindData__",kt)}:Eo,yt=Yo,Vo=Yt,$o=lt,Ko=yt,Xo=[],Do=Xo.push;function Jo(n){var d=n[0],v=n[2],j=n[4];function h(){if(v){var t=v.slice();Do.apply(t,arguments)}if(this instanceof h){var b=Vo(d.prototype),s=d.apply(b,t||arguments);return $o(s)?s:b}return d.apply(j,t||arguments)}return Ko(h,n),h}var Zo=Jo;function er(n,d,v){d||(d=0),typeof v>"u"&&(v=n?n.length:0);for(var j=-1,h=v-d||0,t=Array(h<0?0:h);++j<h;)t[j]=n[d+j];return t}var Vt=er,tr=Yt,ar=lt,or=yt,rr=Vt,nr=[],At=nr.push;function $t(n){var d=n[0],v=n[1],j=n[2],h=n[3],t=n[4],b=n[5],s=v&1,F=v&2,a=v&4,T=v&8,k=d;function K(){var m=s?t:this;if(j){var y=j.slice();At.apply(y,arguments)}if((h||a)&&(y||(y=rr(arguments)),h&&At.apply(y,h),a&&y.length<b))return v|=16,$t([d,T?v:v&-4,y,null,t,b]);if(y||(y=arguments),F&&(d=m[k]),this instanceof K){m=tr(d.prototype);var g=d.apply(m,y);return ar(g)?g:m}return d.apply(m,y)}return or(K,n),K}var sr=$t;function lr(n){return typeof n=="function"}var ir=lr,dr=Zo,cr=sr,ur=ir,pr=[],Nt=pr.push;function Kt(n,d,v,j,h,t){var b=d&1,s=d&2,F=d&4,a=d&16,T=d&32;if(!s&&!ur(n))throw new TypeError;a&&!v.length&&(d&=-17,a=v=!1),T&&!j.length&&(d&=-33,T=j=!1);var k=n&&n.__bindData__;if(k&&k!==!0)return k=k.slice(),b&&!(k[1]&1)&&(k[4]=h),!b&&k[1]&1&&(d|=8),F&&!(k[1]&4)&&(k[5]=t),a&&Nt.apply(k[2]||(k[2]=[]),v),T&&Nt.apply(k[3]||(k[3]=[]),j),k[1]|=d,Kt.apply(null,k);var K=d==1||d===17?dr:cr;return K([n,d,v,j,h,t])}var mr=Kt,wt=mr,hr=Vt;function gr(n,d){return arguments.length>2?wt(n,17,hr(arguments,2),null,d):wt(n,1,null,null,d)}var br=gr;function fr(n){return n}var Ir=fr,xr=it,vr=/\bthis\b/,Ct={};Ct.funcDecomp=!xr.test(window.WinRTError)&&vr.test(function(){return this});Ct.funcNames=typeof Function.name=="string";var yr=Ct,Cr=br,Mr=Ir,Sr=yt,dt=yr,Pr=/^\s*function[ \n\r\t]+\w/,jr=/\bthis\b/,kr=Function.prototype.toString;function Or(n,d,v){if(typeof n!="function")return Mr;if(typeof d>"u"||!("prototype"in n))return n;var j=n.__bindData__;if(typeof j>"u"&&(dt.funcNames&&(j=!n.name),j=j||!dt.funcDecomp,!j)){var h=kr.call(n);dt.funcNames||(j=!Pr.test(h)),j||(j=jr.test(h),Sr(n,j))}if(j===!1||j!==!0&&j[1]&1)return n;switch(v){case 1:return function(t){return n.call(d,t)};case 2:return function(t,b){return n.call(d,t,b)};case 3:return function(t,b,s){return n.call(d,t,b,s)};case 4:return function(t,b,s,F){return n.call(d,t,b,s,F)}}return Cr(n,d)}var Xt=Or,Ar=Xt,Nr=qt,Lt=vt,wr=function(n,d,v){var j,h=n,t=h;if(!h||!Lt[typeof h])return t;d=d&&typeof v>"u"?d:Ar(d,v,3);for(var b=-1,s=Lt[typeof h]&&Nr(h),F=s?s.length:0;++b<F;)if(j=s[b],d(h[j],j,n)===!1)return t;return t},Lr=wr,Tr=Xt,Br=Lr;function Fr(n,d,v){var j=-1,h=n?n.length:0;if(d=d&&typeof v>"u"?d:Tr(d,v,3),typeof h=="number")for(;++j<h&&d(n[j],j,n)!==!1;);else Br(n,d);return n}var Rr=Fr,Dt,Jt;Dt={mm:{name:{singular:"Millimeter",plural:"Millimeters"},to_anchor:1/1e3},cm:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1/100},m:{name:{singular:"Meter",plural:"Meters"},to_anchor:1},km:{name:{singular:"Kilometer",plural:"Kilometers"},to_anchor:1e3}};Jt={in:{name:{singular:"Inch",plural:"Inches"},to_anchor:1/12},yd:{name:{singular:"Yard",plural:"Yards"},to_anchor:3},"ft-us":{name:{singular:"US Survey Foot",plural:"US Survey Feet"},to_anchor:1.000002},ft:{name:{singular:"Foot",plural:"Feet"},to_anchor:1},mi:{name:{singular:"Mile",plural:"Miles"},to_anchor:5280}};var zr={metric:Dt,imperial:Jt,_anchors:{metric:{unit:"m",ratio:3.28084},imperial:{unit:"ft",ratio:1/3.28084}}},Zt,ea;Zt={mm2:{name:{singular:"Square Millimeter",plural:"Square Millimeters"},to_anchor:1/1e6},cm2:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1/1e4},m2:{name:{singular:"Square Meter",plural:"Square Meters"},to_anchor:1},ha:{name:{singular:"Hectare",plural:"Hectares"},to_anchor:1e4},km2:{name:{singular:"Square Kilometer",plural:"Square Kilometers"},to_anchor:1e6}};ea={in2:{name:{singular:"Square Inch",plural:"Square Inches"},to_anchor:1/144},yd2:{name:{singular:"Square Yard",plural:"Square Yards"},to_anchor:9},ft2:{name:{singular:"Square Foot",plural:"Square Feet"},to_anchor:1},ac:{name:{singular:"Acre",plural:"Acres"},to_anchor:43560},mi2:{name:{singular:"Square Mile",plural:"Square Miles"},to_anchor:27878400}};var Qr={metric:Zt,imperial:ea,_anchors:{metric:{unit:"m2",ratio:10.7639},imperial:{unit:"ft2",ratio:1/10.7639}}},ta,aa;ta={mcg:{name:{singular:"Microgram",plural:"Micrograms"},to_anchor:1/1e6},mg:{name:{singular:"Milligram",plural:"Milligrams"},to_anchor:1/1e3},g:{name:{singular:"Gram",plural:"Grams"},to_anchor:1},kg:{name:{singular:"Kilogram",plural:"Kilograms"},to_anchor:1e3},mt:{name:{singular:"Metric Tonne",plural:"Metric Tonnes"},to_anchor:1e6}};aa={oz:{name:{singular:"Ounce",plural:"Ounces"},to_anchor:1/16},lb:{name:{singular:"Pound",plural:"Pounds"},to_anchor:1},t:{name:{singular:"Ton",plural:"Tons"},to_anchor:2e3}};var Wr={metric:ta,imperial:aa,_anchors:{metric:{unit:"g",ratio:1/453.592},imperial:{unit:"lb",ratio:453.592}}},oa,ra;oa={mm3:{name:{singular:"Cubic Millimeter",plural:"Cubic Millimeters"},to_anchor:1/1e6},cm3:{name:{singular:"Cubic Centimeter",plural:"Cubic Centimeters"},to_anchor:1/1e3},ml:{name:{singular:"Millilitre",plural:"Millilitres"},to_anchor:1/1e3},cl:{name:{singular:"Centilitre",plural:"Centilitres"},to_anchor:1/100},dl:{name:{singular:"Decilitre",plural:"Decilitres"},to_anchor:1/10},l:{name:{singular:"Litre",plural:"Litres"},to_anchor:1},kl:{name:{singular:"Kilolitre",plural:"Kilolitres"},to_anchor:1e3},m3:{name:{singular:"Cubic meter",plural:"Cubic meters"},to_anchor:1e3},km3:{name:{singular:"Cubic kilometer",plural:"Cubic kilometers"},to_anchor:1e12},krm:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:1/1e3},tsk:{name:{singular:"Tesked",plural:"Teskedar"},to_anchor:5/1e3},msk:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:15/1e3},kkp:{name:{singular:"Kaffekopp",plural:"Kaffekoppar"},to_anchor:150/1e3},glas:{name:{singular:"Glas",plural:"Glas"},to_anchor:200/1e3},kanna:{name:{singular:"Kanna",plural:"Kannor"},to_anchor:2.617}};ra={tsp:{name:{singular:"Teaspoon",plural:"Teaspoons"},to_anchor:1/6},Tbs:{name:{singular:"Tablespoon",plural:"Tablespoons"},to_anchor:1/2},in3:{name:{singular:"Cubic inch",plural:"Cubic inches"},to_anchor:.55411},"fl-oz":{name:{singular:"Fluid Ounce",plural:"Fluid Ounces"},to_anchor:1},cup:{name:{singular:"Cup",plural:"Cups"},to_anchor:8},pnt:{name:{singular:"Pint",plural:"Pints"},to_anchor:16},qt:{name:{singular:"Quart",plural:"Quarts"},to_anchor:32},gal:{name:{singular:"Gallon",plural:"Gallons"},to_anchor:128},ft3:{name:{singular:"Cubic foot",plural:"Cubic feet"},to_anchor:957.506},yd3:{name:{singular:"Cubic yard",plural:"Cubic yards"},to_anchor:25852.7}};var _r={metric:oa,imperial:ra,_anchors:{metric:{unit:"l",ratio:33.8140226},imperial:{unit:"fl-oz",ratio:1/33.8140226}}},na;na={ea:{name:{singular:"Each",plural:"Each"},to_anchor:1},dz:{name:{singular:"Dozen",plural:"Dozens"},to_anchor:12}};var Ur={metric:na,imperial:{},_anchors:{metric:{unit:"ea",ratio:1}}},sa,la;sa={C:{name:{singular:"degree Celsius",plural:"degrees Celsius"},to_anchor:1,anchor_shift:0},K:{name:{singular:"degree Kelvin",plural:"degrees Kelvin"},to_anchor:1,anchor_shift:273.15}};la={F:{name:{singular:"degree Fahrenheit",plural:"degrees Fahrenheit"},to_anchor:1},R:{name:{singular:"degree Rankine",plural:"degrees Rankine"},to_anchor:1,anchor_shift:459.67}};var Hr={metric:sa,imperial:la,_anchors:{metric:{unit:"C",transform:function(n){return n/(5/9)+32}},imperial:{unit:"F",transform:function(n){return(n-32)*(5/9)}}}},ia,Tt=365.25;ia={ns:{name:{singular:"Nanosecond",plural:"Nanoseconds"},to_anchor:1/1e9},mu:{name:{singular:"Microsecond",plural:"Microseconds"},to_anchor:1/1e6},ms:{name:{singular:"Millisecond",plural:"Milliseconds"},to_anchor:1/1e3},s:{name:{singular:"Second",plural:"Seconds"},to_anchor:1},min:{name:{singular:"Minute",plural:"Minutes"},to_anchor:60},h:{name:{singular:"Hour",plural:"Hours"},to_anchor:60*60},d:{name:{singular:"Day",plural:"Days"},to_anchor:60*60*24},week:{name:{singular:"Week",plural:"Weeks"},to_anchor:60*60*24*7},month:{name:{singular:"Month",plural:"Months"},to_anchor:60*60*24*Tt/12},year:{name:{singular:"Year",plural:"Years"},to_anchor:60*60*24*Tt}};var qr={metric:ia,_anchors:{metric:{unit:"s",ratio:1}}},da,ca;da={b:{name:{singular:"Bit",plural:"Bits"},to_anchor:1},Kb:{name:{singular:"Kilobit",plural:"Kilobits"},to_anchor:1024},Mb:{name:{singular:"Megabit",plural:"Megabits"},to_anchor:1048576},Gb:{name:{singular:"Gigabit",plural:"Gigabits"},to_anchor:1073741824},Tb:{name:{singular:"Terabit",plural:"Terabits"},to_anchor:1099511627776}};ca={B:{name:{singular:"Byte",plural:"Bytes"},to_anchor:1},KB:{name:{singular:"Kilobyte",plural:"Kilobytes"},to_anchor:1024},MB:{name:{singular:"Megabyte",plural:"Megabytes"},to_anchor:1048576},GB:{name:{singular:"Gigabyte",plural:"Gigabytes"},to_anchor:1073741824},TB:{name:{singular:"Terabyte",plural:"Terabytes"},to_anchor:1099511627776}};var Er={bits:da,bytes:ca,_anchors:{bits:{unit:"b",ratio:1/8},bytes:{unit:"B",ratio:8}}},ua;ua={ppm:{name:{singular:"Part-per Million",plural:"Parts-per Million"},to_anchor:1},ppb:{name:{singular:"Part-per Billion",plural:"Parts-per Billion"},to_anchor:.001},ppt:{name:{singular:"Part-per Trillion",plural:"Parts-per Trillion"},to_anchor:1e-6},ppq:{name:{singular:"Part-per Quadrillion",plural:"Parts-per Quadrillion"},to_anchor:1e-9}};var Gr={metric:ua,imperial:{},_anchors:{metric:{unit:"ppm",ratio:1e-6}}},pa,ma;pa={"m/s":{name:{singular:"Metre per second",plural:"Metres per second"},to_anchor:3.6},"km/h":{name:{singular:"Kilometre per hour",plural:"Kilometres per hour"},to_anchor:1}};ma={"m/h":{name:{singular:"Mile per hour",plural:"Miles per hour"},to_anchor:1},knot:{name:{singular:"Knot",plural:"Knots"},to_anchor:1.150779},"ft/s":{name:{singular:"Foot per second",plural:"Feet per second"},to_anchor:.681818}};var Yr={metric:pa,imperial:ma,_anchors:{metric:{unit:"km/h",ratio:1/1.609344},imperial:{unit:"m/h",ratio:1.609344}}},ha,ga;ha={"min/km":{name:{singular:"Minute per kilometre",plural:"Minutes per kilometre"},to_anchor:.06},"s/m":{name:{singular:"Second per metre",plural:"Seconds per metre"},to_anchor:1}};ga={"min/mi":{name:{singular:"Minute per mile",plural:"Minutes per mile"},to_anchor:.0113636},"s/ft":{name:{singular:"Second per foot",plural:"Seconds per foot"},to_anchor:1}};var Vr={metric:ha,imperial:ga,_anchors:{metric:{unit:"s/m",ratio:.3048},imperial:{unit:"s/ft",ratio:1/.3048}}},ba,fa;ba={Pa:{name:{singular:"pascal",plural:"pascals"},to_anchor:1/1e3},kPa:{name:{singular:"kilopascal",plural:"kilopascals"},to_anchor:1},MPa:{name:{singular:"megapascal",plural:"megapascals"},to_anchor:1e3},hPa:{name:{singular:"hectopascal",plural:"hectopascals"},to_anchor:1/10},bar:{name:{singular:"bar",plural:"bar"},to_anchor:100},torr:{name:{singular:"torr",plural:"torr"},to_anchor:101325/76e4}};fa={psi:{name:{singular:"pound per square inch",plural:"pounds per square inch"},to_anchor:1/1e3},ksi:{name:{singular:"kilopound per square inch",plural:"kilopound per square inch"},to_anchor:1}};var $r={metric:ba,imperial:fa,_anchors:{metric:{unit:"kPa",ratio:.00014503768078},imperial:{unit:"psi",ratio:1/.00014503768078}}},Ia;Ia={A:{name:{singular:"Ampere",plural:"Amperes"},to_anchor:1},mA:{name:{singular:"Milliampere",plural:"Milliamperes"},to_anchor:.001},kA:{name:{singular:"Kiloampere",plural:"Kiloamperes"},to_anchor:1e3}};var Kr={metric:Ia,_anchors:{metric:{unit:"A",ratio:1}}},xa;xa={V:{name:{singular:"Volt",plural:"Volts"},to_anchor:1},mV:{name:{singular:"Millivolt",plural:"Millivolts"},to_anchor:.001},kV:{name:{singular:"Kilovolt",plural:"Kilovolts"},to_anchor:1e3}};var Xr={metric:xa,_anchors:{metric:{unit:"V",ratio:1}}},va;va={W:{name:{singular:"Watt",plural:"Watts"},to_anchor:1},mW:{name:{singular:"Milliwatt",plural:"Milliwatts"},to_anchor:.001},kW:{name:{singular:"Kilowatt",plural:"Kilowatts"},to_anchor:1e3},MW:{name:{singular:"Megawatt",plural:"Megawatts"},to_anchor:1e6},GW:{name:{singular:"Gigawatt",plural:"Gigawatts"},to_anchor:1e9}};var Dr={metric:va,_anchors:{metric:{unit:"W",ratio:1}}},ya;ya={VAR:{name:{singular:"Volt-Ampere Reactive",plural:"Volt-Amperes Reactive"},to_anchor:1},mVAR:{name:{singular:"Millivolt-Ampere Reactive",plural:"Millivolt-Amperes Reactive"},to_anchor:.001},kVAR:{name:{singular:"Kilovolt-Ampere Reactive",plural:"Kilovolt-Amperes Reactive"},to_anchor:1e3},MVAR:{name:{singular:"Megavolt-Ampere Reactive",plural:"Megavolt-Amperes Reactive"},to_anchor:1e6},GVAR:{name:{singular:"Gigavolt-Ampere Reactive",plural:"Gigavolt-Amperes Reactive"},to_anchor:1e9}};var Jr={metric:ya,_anchors:{metric:{unit:"VAR",ratio:1}}},Ca;Ca={VA:{name:{singular:"Volt-Ampere",plural:"Volt-Amperes"},to_anchor:1},mVA:{name:{singular:"Millivolt-Ampere",plural:"Millivolt-Amperes"},to_anchor:.001},kVA:{name:{singular:"Kilovolt-Ampere",plural:"Kilovolt-Amperes"},to_anchor:1e3},MVA:{name:{singular:"Megavolt-Ampere",plural:"Megavolt-Amperes"},to_anchor:1e6},GVA:{name:{singular:"Gigavolt-Ampere",plural:"Gigavolt-Amperes"},to_anchor:1e9}};var Zr={metric:Ca,_anchors:{metric:{unit:"VA",ratio:1}}},Ma;Ma={Wh:{name:{singular:"Watt-hour",plural:"Watt-hours"},to_anchor:3600},mWh:{name:{singular:"Milliwatt-hour",plural:"Milliwatt-hours"},to_anchor:3.6},kWh:{name:{singular:"Kilowatt-hour",plural:"Kilowatt-hours"},to_anchor:36e5},MWh:{name:{singular:"Megawatt-hour",plural:"Megawatt-hours"},to_anchor:36e8},GWh:{name:{singular:"Gigawatt-hour",plural:"Gigawatt-hours"},to_anchor:36e11},J:{name:{singular:"Joule",plural:"Joules"},to_anchor:1},kJ:{name:{singular:"Kilojoule",plural:"Kilojoules"},to_anchor:1e3}};var en={metric:Ma,_anchors:{metric:{unit:"J",ratio:1}}},Sa;Sa={VARh:{name:{singular:"Volt-Ampere Reactive Hour",plural:"Volt-Amperes Reactive Hour"},to_anchor:1},mVARh:{name:{singular:"Millivolt-Ampere Reactive Hour",plural:"Millivolt-Amperes Reactive Hour"},to_anchor:.001},kVARh:{name:{singular:"Kilovolt-Ampere Reactive Hour",plural:"Kilovolt-Amperes Reactive Hour"},to_anchor:1e3},MVARh:{name:{singular:"Megavolt-Ampere Reactive Hour",plural:"Megavolt-Amperes Reactive Hour"},to_anchor:1e6},GVARh:{name:{singular:"Gigavolt-Ampere Reactive Hour",plural:"Gigavolt-Amperes Reactive Hour"},to_anchor:1e9}};var tn={metric:Sa,_anchors:{metric:{unit:"VARh",ratio:1}}},Pa,ja;Pa={"mm3/s":{name:{singular:"Cubic Millimeter per second",plural:"Cubic Millimeters per second"},to_anchor:1/1e6},"cm3/s":{name:{singular:"Cubic Centimeter per second",plural:"Cubic Centimeters per second"},to_anchor:1/1e3},"ml/s":{name:{singular:"Millilitre per second",plural:"Millilitres per second"},to_anchor:1/1e3},"cl/s":{name:{singular:"Centilitre per second",plural:"Centilitres per second"},to_anchor:1/100},"dl/s":{name:{singular:"Decilitre per second",plural:"Decilitres per second"},to_anchor:1/10},"l/s":{name:{singular:"Litre per second",plural:"Litres per second"},to_anchor:1},"l/min":{name:{singular:"Litre per minute",plural:"Litres per minute"},to_anchor:1/60},"l/h":{name:{singular:"Litre per hour",plural:"Litres per hour"},to_anchor:1/3600},"kl/s":{name:{singular:"Kilolitre per second",plural:"Kilolitres per second"},to_anchor:1e3},"kl/min":{name:{singular:"Kilolitre per minute",plural:"Kilolitres per minute"},to_anchor:50/3},"kl/h":{name:{singular:"Kilolitre per hour",plural:"Kilolitres per hour"},to_anchor:5/18},"m3/s":{name:{singular:"Cubic meter per second",plural:"Cubic meters per second"},to_anchor:1e3},"m3/min":{name:{singular:"Cubic meter per minute",plural:"Cubic meters per minute"},to_anchor:50/3},"m3/h":{name:{singular:"Cubic meter per hour",plural:"Cubic meters per hour"},to_anchor:5/18},"km3/s":{name:{singular:"Cubic kilometer per second",plural:"Cubic kilometers per second"},to_anchor:1e12}};ja={"tsp/s":{name:{singular:"Teaspoon per second",plural:"Teaspoons per second"},to_anchor:1/6},"Tbs/s":{name:{singular:"Tablespoon per second",plural:"Tablespoons per second"},to_anchor:1/2},"in3/s":{name:{singular:"Cubic inch per second",plural:"Cubic inches per second"},to_anchor:.55411},"in3/min":{name:{singular:"Cubic inch per minute",plural:"Cubic inches per minute"},to_anchor:.55411/60},"in3/h":{name:{singular:"Cubic inch per hour",plural:"Cubic inches per hour"},to_anchor:.55411/3600},"fl-oz/s":{name:{singular:"Fluid Ounce per second",plural:"Fluid Ounces per second"},to_anchor:1},"fl-oz/min":{name:{singular:"Fluid Ounce per minute",plural:"Fluid Ounces per minute"},to_anchor:1/60},"fl-oz/h":{name:{singular:"Fluid Ounce per hour",plural:"Fluid Ounces per hour"},to_anchor:1/3600},"cup/s":{name:{singular:"Cup per second",plural:"Cups per second"},to_anchor:8},"pnt/s":{name:{singular:"Pint per second",plural:"Pints per second"},to_anchor:16},"pnt/min":{name:{singular:"Pint per minute",plural:"Pints per minute"},to_anchor:4/15},"pnt/h":{name:{singular:"Pint per hour",plural:"Pints per hour"},to_anchor:1/225},"qt/s":{name:{singular:"Quart per second",plural:"Quarts per second"},to_anchor:32},"gal/s":{name:{singular:"Gallon per second",plural:"Gallons per second"},to_anchor:128},"gal/min":{name:{singular:"Gallon per minute",plural:"Gallons per minute"},to_anchor:32/15},"gal/h":{name:{singular:"Gallon per hour",plural:"Gallons per hour"},to_anchor:8/225},"ft3/s":{name:{singular:"Cubic foot per second",plural:"Cubic feet per second"},to_anchor:957.506},"ft3/min":{name:{singular:"Cubic foot per minute",plural:"Cubic feet per minute"},to_anchor:957.506/60},"ft3/h":{name:{singular:"Cubic foot per hour",plural:"Cubic feet per hour"},to_anchor:957.506/3600},"yd3/s":{name:{singular:"Cubic yard per second",plural:"Cubic yards per second"},to_anchor:25852.7},"yd3/min":{name:{singular:"Cubic yard per minute",plural:"Cubic yards per minute"},to_anchor:25852.7/60},"yd3/h":{name:{singular:"Cubic yard per hour",plural:"Cubic yards per hour"},to_anchor:25852.7/3600}};var an={metric:Pa,imperial:ja,_anchors:{metric:{unit:"l/s",ratio:33.8140227},imperial:{unit:"fl-oz/s",ratio:1/33.8140227}}},ka,Oa;ka={lx:{name:{singular:"Lux",plural:"Lux"},to_anchor:1}};Oa={"ft-cd":{name:{singular:"Foot-candle",plural:"Foot-candles"},to_anchor:1}};var on={metric:ka,imperial:Oa,_anchors:{metric:{unit:"lx",ratio:1/10.76391},imperial:{unit:"ft-cd",ratio:10.76391}}},Aa;Aa={mHz:{name:{singular:"millihertz",plural:"millihertz"},to_anchor:1/1e3},Hz:{name:{singular:"hertz",plural:"hertz"},to_anchor:1},kHz:{name:{singular:"kilohertz",plural:"kilohertz"},to_anchor:1e3},MHz:{name:{singular:"megahertz",plural:"megahertz"},to_anchor:1e3*1e3},GHz:{name:{singular:"gigahertz",plural:"gigahertz"},to_anchor:1e3*1e3*1e3},THz:{name:{singular:"terahertz",plural:"terahertz"},to_anchor:1e3*1e3*1e3*1e3},rpm:{name:{singular:"rotation per minute",plural:"rotations per minute"},to_anchor:1/60},"deg/s":{name:{singular:"degree per second",plural:"degrees per second"},to_anchor:1/360},"rad/s":{name:{singular:"radian per second",plural:"radians per second"},to_anchor:1/(Math.PI*2)}};var rn={metric:Aa,_anchors:{frequency:{unit:"hz",ratio:1}}},Na;Na={rad:{name:{singular:"radian",plural:"radians"},to_anchor:180/Math.PI},deg:{name:{singular:"degree",plural:"degrees"},to_anchor:1},grad:{name:{singular:"gradian",plural:"gradians"},to_anchor:9/10},arcmin:{name:{singular:"arcminute",plural:"arcminutes"},to_anchor:1/60},arcsec:{name:{singular:"arcsecond",plural:"arcseconds"},to_anchor:1/3600}};var nn={metric:Na,_anchors:{metric:{unit:"deg",ratio:1}}},wa,Ke=qt,Te=Rr,He={length:zr,area:Qr,mass:Wr,volume:_r,each:Ur,temperature:Hr,time:qr,digital:Er,partsPer:Gr,speed:Yr,pace:Vr,pressure:$r,current:Kr,voltage:Xr,power:Dr,reactivePower:Jr,apparentPower:Zr,energy:en,reactiveEnergy:tn,volumeFlowRate:an,illuminance:on,frequency:rn,angle:nn},Be;Be=function(n,d){d?this.val=n/d:this.val=n};Be.prototype.from=function(n){if(this.destination)throw new Error(".from must be called before .to");return this.origin=this.getUnit(n),this.origin||this.throwUnsupportedUnitError(n),this};Be.prototype.to=function(n){if(!this.origin)throw new Error(".to must be called after .from");this.destination=this.getUnit(n);var d,v;if(this.destination||this.throwUnsupportedUnitError(n),this.origin.abbr===this.destination.abbr)return this.val;if(this.destination.measure!=this.origin.measure)throw new Error("Cannot convert incompatible measures of "+this.destination.measure+" and "+this.origin.measure);return d=this.val*this.origin.unit.to_anchor,this.origin.unit.anchor_shift&&(d-=this.origin.unit.anchor_shift),this.origin.system!=this.destination.system&&(v=He[this.origin.measure]._anchors[this.origin.system].transform,typeof v=="function"?d=v(d):d*=He[this.origin.measure]._anchors[this.origin.system].ratio),this.destination.unit.anchor_shift&&(d+=this.destination.unit.anchor_shift),d/this.destination.unit.to_anchor};Be.prototype.toBest=function(d){if(!this.origin)throw new Error(".toBest must be called after .from");var d=Object.assign({exclude:[],cutOffNumber:1},d),v;return Te(this.possibilities(),(function(j){var h=this.describe(j),t=d.exclude.indexOf(j)===-1;if(t&&h.system===this.origin.system){var b=this.to(j);(!v||b>=d.cutOffNumber&&b<v.val)&&(v={val:b,unit:j,singular:h.singular,plural:h.plural})}}).bind(this)),v};Be.prototype.getUnit=function(n){var d;return Te(He,function(v,j){if(Te(v,function(h,t){if(t=="_anchors"||(Te(h,function(b,s){if(s==n)return d={abbr:n,measure:j,system:t,unit:b},!1}),d))return!1}),d)return!1}),d};var La=function(n){return{abbr:n.abbr,measure:n.measure,system:n.system,singular:n.unit.name.singular,plural:n.unit.name.plural}};Be.prototype.describe=function(n){var d=Be.prototype.getUnit(n),v=null;try{v=La(d)}catch{this.throwUnsupportedUnitError(n)}return v};Be.prototype.list=function(n){var d=[];return Te(He,function(v,j){n&&n!==j||Te(v,function(h,t){if(t=="_anchors")return!1;Te(h,function(b,s){d=d.concat(La({abbr:s,measure:j,system:t,unit:b}))})})}),d};Be.prototype.throwUnsupportedUnitError=function(n){var d=[];throw Te(He,function(v,j){Te(v,function(h,t){if(t=="_anchors")return!1;d=d.concat(Ke(h))})}),new Error("Unsupported unit "+n+", use one of: "+d.join(", "))};Be.prototype.possibilities=function(n){var d=[];return!this.origin&&!n?Te(Ke(He),function(v){Te(He[v],function(j,h){if(h=="_anchors")return!1;d=d.concat(Ke(j))})}):(n=n||this.origin.measure,Te(He[n],function(v,j){if(j=="_anchors")return!1;d=d.concat(Ke(v))})),d};Be.prototype.measures=function(){return Ke(He)};wa=function(n){return new Be(n)};var sn=wa;const De=Da(sn),Je=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services","Summary"];function vn(){const[n,d]=o.useState(0),[v,j]=o.useState(new Set),[h,t]=o.useState(null),[b,s]=o.useState(null),[F,a]=o.useState([]),{enqueueSnackbar:T}=ze(),{data:k,refetch:K}=_e(),[m,y]=o.useState({}),[g,D]=o.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),[i,G]=o.useState({fromUnit:"m",toUnit:"cm",inputValue:"",outputValue:""}),J=M=>{t(M.currentTarget)},B=M=>{s(M.currentTarget)},W=()=>{t(null),s(null),G({fromUnit:"m",toUnit:"cm",inputValue:"",outputValue:""})},z=M=>M===1,Z=M=>v.has(M),X=()=>{let M=v;Z(n)&&(M=new Set(M.values()),M.delete(n)),d(R=>R+1),j(M)},Q=()=>{d(M=>M-1)},I=()=>{if(!z(n))throw new Error("You can't skip a step that isn't optional.");d(M=>M+1),j(M=>{const R=new Set(M.values());return R.add(n),R})},q=()=>{d(0)};o.useEffect(()=>{(async()=>{try{const R=await Se.get("http://100.42.177.77:83/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",R),a(R.data.result)}catch(R){console.error("Error fetching design options:",R)}})()},[]);const oe=async()=>{if(!g.lookUpDomain||!g.lookUpName){T("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const M=await Se.get(`http://100.42.177.77:83/api/Common/SaveLookUp?lookupDomain=${g.lookUpDomain}&LookUpName=${g.lookUpName}&appId=1`);return T("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),D({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),K(),M.data}catch(M){throw T("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),M}},ie=M=>{D({...g,[M.target.name]:M.target.value})},S=M=>{const{name:R,value:ee}=M.target;G(P=>{const N={...P,[R]:ee};return(R==="inputValue"?"L2R":"R2L")==="L2R"?N.outputValue=De(ee).from(N.fromUnit).to(N.toUnit):N.inputValue=De(ee).from(N.toUnit).to(N.fromUnit),N})};o.useEffect(()=>{(async()=>{try{const R=await Se.get("http://100.42.177.77:83/api/Common/GetLookUpDomains?appId=1");a(R.data.result)}catch(R){console.error("Error fetching design options:",R)}})()},[]);const ue=!!h,re=!!b,he=ue?"simple-popover":void 0,O=re?"convert-popover":void 0;return e.jsxs(Re,{sx:{width:"100%"},children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,sm:6,children:e.jsx(Ce,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(r,{item:!0,sm:6,textAlign:"right",children:[e.jsx(fe,{"aria-describedby":he,variant:"outlined",size:"small",onClick:J,sx:{marginRight:"8px"},children:"+Lookup"}),e.jsx(fe,{"aria-describedby":O,variant:"outlined",size:"small",onClick:B,children:"Convertor"}),e.jsx(St,{id:O,open:re,anchorEl:b,onClose:W,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,sm:6,children:e.jsx(u,{fullWidth:!0,select:!0,label:"From",size:"small",name:"fromUnit",value:i.fromUnit,onChange:S,children:De().possibilities("length").map(M=>e.jsx(_,{value:M,children:M},M))})}),e.jsx(r,{item:!0,sm:6,children:e.jsx(u,{fullWidth:!0,select:!0,label:"To",size:"small",name:"toUnit",value:i.toUnit,onChange:S,children:De().possibilities("length").map(M=>e.jsx(_,{value:M,children:M},M))})}),e.jsx(r,{item:!0,sm:12,children:e.jsx(u,{fullWidth:!0,label:i.fromUnit,size:"small",name:"inputValue",value:i.inputValue,onChange:S,type:"number"})}),e.jsx(r,{item:!0,sm:12,children:e.jsx(u,{fullWidth:!0,label:i.toUnit,size:"small",name:"outputValue",value:i.outputValue,onChange:S,type:"number"})})]})}),e.jsx(St,{id:"mouse-over-popover",open:ue,anchorEl:h,onClose:W,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(r,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(r,{item:!0,sm:12,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Select Lookup",size:"small",value:g.lookUpDomain,name:"lookUpDomain",onChange:ie,children:F.map(M=>e.jsx(_,{value:M.lookUpDomain,children:M.lookUpDomain},M.lookUpDomain))})}),e.jsx(r,{item:!0,sm:12,children:e.jsx(u,{fullWidth:!0,label:"Add Lookup Description",value:g.lookUpName,onChange:ie,name:"lookUpName",size:"small"})}),e.jsx(r,{item:!0,sm:3,textAlign:"right",children:e.jsx(fe,{variant:"contained",size:"small",onClick:oe,children:"Save"})})]})})]})]}),e.jsx(Ja,{activeStep:n,children:Je.map((M,R)=>{const ee={},P={};return z(R)&&(P.optional=e.jsx(Ce,{variant:"caption"})),Z(R)&&(ee.completed=!1),e.jsx(Za,{...ee,children:e.jsxs(eo,{...P,onClick:()=>d(R),style:{cursor:"pointer"},children:[" ",M]})},M)})}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(fe,{color:"inherit",disabled:n===0,onClick:Q,sx:{mr:1},children:"Back"}),e.jsx(Re,{sx:{flex:"1 1 auto"}}),z(n)&&e.jsx(fe,{color:"inherit",onClick:I,sx:{mr:1},children:"Skip"}),e.jsx(fe,{onClick:X,children:n===Je.length-1?"Finish":"Next"})]}),n===Je.length?e.jsxs(o.Fragment,{children:[e.jsx(jt,{setActiveStep:d}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(Re,{sx:{flex:"1 1 auto"}}),e.jsx(fe,{onClick:q,children:"Reset"})]})]}):e.jsxs(o.Fragment,{children:[n===0&&e.jsx(go,{setInitialValues:y,initialValues:m}),n===1&&e.jsx(to,{setInitialValues:y,initialValues:m}),n===2&&e.jsx(Io,{initialValues:m}),n===3&&e.jsx(mo,{initialValues:m}),n===4&&e.jsx(vo,{initialValues:m}),n===5&&e.jsx(Mo,{initialValues:m}),n===6&&e.jsx(So,{initialValues:m}),n===7&&e.jsx(jt,{setActiveStep:d,setInitialValues:y,initialValues:m}),e.jsxs(Re,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(fe,{color:"inherit",disabled:n===0,onClick:Q,sx:{mr:1},children:"Back"}),e.jsx(Re,{sx:{flex:"1 1 auto"}}),z(n)&&e.jsx(fe,{color:"inherit",onClick:I,sx:{mr:1},children:"Skip"}),e.jsx(fe,{onClick:X,children:n===Je.length-1?"Finish":"Next"})]})]})]})}export{vn as default};
