import{c as oe,u as ne,N as le,P as de,Q as ce,j as e,B as S,C as L,d as O,G as o,T as g,e as A,L as ue,M as me}from"./index-BQnKJm_U.js";import{r as s}from"./vendor-BXCbSo2_.js";import{d as pe}from"./CategoryOutlined-Bcv7mrwf.js";import{d as v}from"./AssignmentOutlined-CvXohB2J.js";import{B as j,I as M,a as he}from"./axios-CIHeZEXI.js";import{d as $}from"./Close-BQnbGXeb.js";import{R as fe}from"./ReceivingDetails-COipxSuI.js";import{R as E,a as z,b as W,c as H,d as Q,B as F}from"./ReuseableDataGrid-DM_ExMFu.js";import xe from"./Reports-hRs1Vcia.js";import{T as ge}from"./TextField-B9bDqCXW.js";import{M as ve}from"./MenuItem-CqoynPPu.js";import{T as je,a as ye,b as f,c}from"./TabPanel-eD93EyWL.js";import"./Skeleton-B93ZyZJN.js";const Ce=()=>{const{enqueueSnackbar:n}=oe(),{user:l}=ne();s.useState([]),s.useState(!1);const[i,u]=s.useState({issuanceId:"",poId:"",ogpNumber:"",appId:l.appId,createdOn:new Date().toISOString(),createdBy:l.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:l.empId}),[d,y]=s.useState([]),[m,x]=s.useState([]),[p,r]=s.useState([]),[N,V]=s.useState([]),[U,X]=s.useState([]);s.useState(!1);const{data:C,error:be,isLoading:Ie,refetch:R}=le(),{data:b,refetch:Y}=de(i.poId,{skip:!i.poId}),{data:I,refetch:_}=ce({issuanceId:p,processTypename:"Dyeing"},{skip:!p});s.useEffect(()=>{C&&x(C.result.map((a,t)=>({id:t+1,...a})))},[C,R]),s.useEffect(()=>{I&&X(I.result.map((a,t)=>({id:t+1,...a})))},[I,_]),console.log("initialRows",d),s.useEffect(()=>{b&&V(b.result.map((a,t)=>({id:t,...a})))},[b,Y]),console.log("initialRows",d);const q=a=>{const{name:t,value:h}=a.target;if(t==="poId"){const B=m.find(re=>re.poId===parseInt(h));u({...i,poId:h,issuanceId:B?B.issuanceId:""})}else u({...i,[t]:h})},J=async()=>{console.log("formData",i);try{const a=await he.get(`http://100.42.177.77:83/api/Receiving/GetIssuanceByPoIdAndOGPNumber?poId=${i.poId}&issuanceId=${i.issuanceId}`);console.log("Save response:",a.data),a.data.success?(n(`${a.data.message} !`,{variant:"success",autoHideDuration:5e3}),y(a.data.result.map((t,h)=>({id:h+1,...t})))):(n(`${a.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",a.data.message))}catch(a){console.error("Error saving data:",a),n("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};console.log("formData",i);const[K,w]=s.useState(!1),[Z,G]=s.useState(!1),[k,T]=s.useState(!1),ee=async a=>{T(a),w(!0)},ae=async a=>{G(!0),T(a)},D=()=>{w(!1)},P=()=>{G(!1)},te=async a=>{r(a.issuanceId)},se=[{field:"id",headerName:"Sr#"},{field:"issuanceId",headerName:"issuance#"},{field:"vendorName",headerName:"Vendor"},{field:"issuanceQuantity",headerName:"Total",valueGetter:a=>a.toLocaleString()},{field:"receivedQty",headerName:"Received",valueGetter:(a,t)=>a-t.shortageQty},{field:"issuanceDate",headerName:"Issuance Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"expectedReturnDate",headerName:"Expected Return Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"fabricCount",headerName:"Fabrics"},{field:"statusName",headerName:"Status",renderCell:a=>e.jsx(A,{label:a.value,sx:{backgroundColor:"primary.dark",color:"white"},color:void 0})},{field:"Actions",headerName:"Actions",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(F,{variant:"text",size:"small",sx:{mt:1},children:[e.jsx(j,{size:"small",color:"primary",onClick:()=>ee(a.row),children:"Generate IGP"}),e.jsx(j,{size:"small",color:"primary",onClick:()=>te(a.row),children:"View Receivings"})]})})}],ie=[{field:"id",headerName:"Sr #"},{field:"collectionName",headerName:"Collection Name"},{field:"poName",headerName:"PO"},{field:"ogpNumber",headerName:"OGP Number",renderCell:a=>{a.value}},{field:"igpNumber",headerName:"IGP Number"},{field:"igpDate",headerName:"IGP Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"receivingDate",headerName:"Receiving Date",valueGetter:a=>new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"receivedQty",headerName:"Received"},{field:"processTypename",headerName:"Process Type"},{field:"statusName",headerName:"Status",renderCell:a=>{const t="primary.dark";if(a.value!==null)return e.jsx(A,{label:a.value,sx:{backgroundColor:t,color:"white"},color:void 0})}},{field:"Actions",headerName:"Actions",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsx(F,{variant:"text",size:"small",sx:{mt:1},children:e.jsx(j,{size:"small",color:"primary",onClick:()=>ae(a.row),children:"IGP"})})})}];return e.jsxs(S,{sx:{width:"100%",typography:"body1"},children:[e.jsxs(L,{variant:"outlined",children:[e.jsx(O,{className:"css-4rfrnx-MuiCardHeader-root",title:"Receiving",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(ge,{fullWidth:!0,select:!0,label:"PO#",name:"poId",value:i.poId,onChange:q,size:"small",children:m.map(a=>e.jsx(ve,{value:a.poId,children:a.poName},a.poId))})}),e.jsx(o,{item:!0,xs:12,md:3,sx:{mt:.5},children:e.jsx(j,{variant:"contained",size:"small",onClick:J,children:"Search"})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(g,{variant:"h3",children:"Issuances"})}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(E,{initialRows:d,iColumns:se,onRowDoubleClick:a=>r(a.row.issuanceId),hideAction:!0}),e.jsxs(z,{open:K,onClose:D,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(W,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(g,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Receiving Details"}),e.jsx(M,{onClick:D,sx:{color:"#ffffff"},children:e.jsx($,{})})]}),e.jsxs(H,{children:[e.jsx(Q,{id:"alert-dialog-slide-description"}),e.jsx(fe,{iss:k,handleClose:D,refetchIssuanceData:R})]})]}),e.jsxs(z,{open:Z,onClose:P,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(W,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(g,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx(M,{onClick:P,sx:{color:"#ffffff"},children:e.jsx($,{})})]}),e.jsxs(H,{children:[e.jsx(Q,{id:"alert-dialog-slide-description"}),e.jsx(xe,{rId:14,OGPNumber:k.igpNumber})]})]})]})]})]}),e.jsxs(L,{variant:"outlined",sx:{marginTop:2},children:[e.jsx(O,{className:"css-4rfrnx-MuiCardHeader-root",title:"View All",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(o,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(g,{variant:"h3",children:"Receivings"})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(E,{initialRows:U,iColumns:ie,hideAction:!0})})]})]})]})},Me=()=>{var m,x,p;const n=ue(),l=(m=n.state)==null?void 0:m.data,i=(p=(x=n.state)==null?void 0:x.tab)==null?void 0:p.toString();console.log("rowData",l),console.log("tab",i);const[u,d]=s.useState("1"),y=(r,N)=>{d(N),console.log("value",u)};return s.useEffect(()=>{i&&d(i)},[i]),e.jsx(me,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(S,{sx:{width:"100%",typography:"body1"},children:e.jsxs(je,{value:u,children:[e.jsx(S,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(ye,{onChange:y,children:[e.jsx(f,{icon:e.jsx(pe,{}),label:"Dyeing Receiving",value:"1",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(v,{}),label:"Embroidery Receiving",value:"2",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(v,{}),label:"Schiffili Receiving",value:"3",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(v,{}),label:"Additional Process Receiving",value:"4",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})}),e.jsx(f,{icon:e.jsx(v,{}),label:"Additional Services Receiving",value:"5",sx:r=>({"& .MuiTouchRipple-child":{backgroundColor:`${r.palette.primary.main} !important`}})})]})}),e.jsx(c,{value:"1",children:e.jsx(Ce,{rowData:l})}),e.jsx(c,{value:"2"}),e.jsx(c,{value:"3"}),e.jsx(c,{value:"4"}),e.jsx(c,{value:"5"}),e.jsx(c,{value:"6"})]})})})};export{Me as default};
