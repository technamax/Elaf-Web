import{r as a,j as e,_ as Ke,$ as $e,a0 as _e,Q as De,u as Fe,c as je,a1 as ye,b as Ce,a2 as Se,a3 as Re,a4 as Ee,a5 as Be,a6 as et,a7 as Me,C as V,e as J,a8 as We,G as r,D as me,V as Pe,T as ve,a9 as Qe,aa as tt,ab as st,ac as rt,ad as ot,ae as Ve,B as be}from"./index-7mdCI5AO.js";import{a as ie}from"./axios-BilD9Akj.js";import{d as Ne,c as he,A as Ae,e as ke,f as Oe,g as Te,l as qe,R as ze,S as nt,a as at,b as lt,F as dt}from"./Fabrication-B_rJ9AsJ.js";import{T as l,B as ee,P as ct}from"./TextField-BQWcWP_b.js";import{M as C}from"./Skeleton-D0EipdCo.js";import{A as He,C as Ge,D as it}from"./DataGrid-B0JDEeH2.js";import"./dayjs.min-Vz5l8yyd.js";import"./ExcelExport-BG4snXb9.js";import{G as ut}from"./GridToolbar-BVL0SYS8.js";let Xe=!1;const mt=a.forwardRef(function(s,o){return Xe||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),Xe=!0),e.jsx(He,Ke({ref:o},s))});var Ye={},ht=_e;Object.defineProperty(Ye,"__esModule",{value:!0});var Je=Ye.default=void 0,pt=ht($e()),gt=e;Je=Ye.default=(0,pt.default)((0,gt.jsx)("path",{d:"M21 10h-3L2 3v7l9 2-9 2v7l8-3.5V21c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2m0 11h-9v-9h9zm-4.5-1L13 16h2v-3h3v3h2z"}),"SendAndArchive");const ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR4nO2WzU4UQRSFe14CgoiMKPIqolEiIQq+gEFgFPHnFVyILI3GnQIbxxhG3IkaYxT8iUZFoxuDbokoIaNE/czNnE6KSjdT07Yb40kqqa6qW+dW3XNvdRT9R4MAHgD3640Dh/MkHQTOqMWIv9PGydOBUeCsWoz4O208PwdcxCz1xoGBKG8Abc5JPwBrataP0fY3iLcCk8C6SF4DV4HzatZf1Ny6vrfkRd4PrABV4BywE9huKpc2rA0ARaATGAe+yebgn5IfB34BD0XQCzwlHU+AA1r7CPgJlLKS94n8GtAM3CIcFaAJKGuPviwxX9XJjfxlCtGMyJLwQrbzwNeGNEFNRFVdZdrJb2ttAbizyU10SBNXQslbgR8SnMXcxagEOGyxdmxs3ZDmxjybHmWKZUdriAOnZWhqf+ZtVgyw3+HZPAZ2qX8yxIGbwCudxsdwgH3JszERtqtOVEIc+ARMKbc3xNy79r1a+xHodsYtDec8W6sl01YxQxxYVfzdWM4krDPiGEveXMHLjhMqUGshDlQTHLDNCg06MJvgwJcQB96lhMBSrddZ1y0nloDdXkbc9WwPKQSLIQ7M6rGxGuBjKMB+JEGE24A3tnfUgIo7E+p+1jTsUn8wxIEWFaJxKdrFmBwrJRSiEc2d8mz2AxPas6WuAwbgkspncZNaPyexWbuXsuaGbuQ7cDEKBbVHZEVParMeliRUPLW7eK4XcUF7NQU7YAD26NrKciLtJtJObuTXtce+KAuAI9pgXq9aj0SVhgXFvEN9y4Cjmci9kvtZmpjQw9KuOhH/kvUr1bq0xmK+bLZRHqB2nZd1Gyinp5yfUuu/1ZyRX7CfmlzIXUgLx6SH93o3ltUv6z8hf+LoX8ZvSFCuNiG5hzcAAAAASUVORK5CYII=",xt=()=>{const u=De(),{user:s}=Fe(),{enqueueSnackbar:o}=je(),[t,i]=a.useState([]),[m,R]=a.useState(!1),[n,N]=a.useState({embroideryId:(t==null?void 0:t.embroideryId)||0,designId:(t==null?void 0:t.designId)||"",batchNo:(t==null?void 0:t.batchNo)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorId:(t==null?void 0:t.baseColorId)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],costPerComponent:(t==null?void 0:t.costPerComponent)||"",createdBy:s.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:s.empId});a.useEffect(()=>{N({embroideryId:(t==null?void 0:t.embroideryId)||0,designId:(t==null?void 0:t.designId)||"",batchNo:(t==null?void 0:t.batchNo)||"",planningHeaderId:(t==null?void 0:t.planningHeaderId)||"",componentId:(t==null?void 0:t.componentId)||"",fabricId:(t==null?void 0:t.fabricId)||"",vendorId:(t==null?void 0:t.vendorId)||"",poPcs:(t==null?void 0:t.poPcs)||"",baseColorId:(t==null?void 0:t.baseColorId)||"",baseColorName:(t==null?void 0:t.baseColorName)||"",colorId:(t==null?void 0:t.colorId)||"",availableQty:(t==null?void 0:t.availableQty)||"",noOfHead:(t==null?void 0:t.noOfHead)||"",repeats:(t==null?void 0:t.repeats)||"",cuttingSize:(t==null?void 0:t.cuttingSize)||"",itemsPerRepeat:(t==null?void 0:t.itemsPerRepeat)||"",totalPcs:(t==null?void 0:t.totalPcs)||"",totalAmount:(t==null?void 0:t.totalAmount)||"",threadStiches:(t==null?void 0:t.threadStiches)||"",threadRate:(t==null?void 0:t.threadRate)||"",threadAmount:(t==null?void 0:t.threadAmount)||"",tillaStiches:(t==null?void 0:t.tillaStiches)||"",tilaRate:(t==null?void 0:t.tilaRate)||"",tilaAmount:(t==null?void 0:t.tilaAmount)||"",sequence:(t==null?void 0:t.sequence)||"",sequenceRate:(t==null?void 0:t.sequenceRate)||"",sequenceAmount:(t==null?void 0:t.sequenceAmount)||"",isSolving:(t==null?void 0:t.isSolving)||!1,solvingLayers:(t==null?void 0:t.solvingLayers)||0,solvingInMeters:(t==null?void 0:t.solvingInMeters)||"",solvingRate:(t==null?void 0:t.solvingRate)||0,solvingAmount:(t==null?void 0:t.solvingAmount)||"",threadAdditional:(t==null?void 0:t.threadAdditional)||[],costPerComponent:(t==null?void 0:t.costPerComponent)||"",createdOn:(t==null?void 0:t.createdOn)||new Date().toISOString(),createdBy:(t==null?void 0:t.createdBy)||s.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:s.empId})},[t]);const $=["Boring","Pooni","Laser","Doori","Dissolving"];function Y(c,v,b){return{fontWeight:v.indexOf(c)===-1?b.typography.fontWeightRegular:b.typography.fontWeightMedium}}const{data:U}=ye(),[O,E]=a.useState(""),{data:H}=Ce(),{data:Q,refetch:S}=Se(O,{skip:!O}),{data:A,refetch:Z}=Re(n.designId,{skip:!n.designId}),{data:T}=Ee({batchNo:n.planningHeaderId,componentId:n.componentId},{skip:!n.planningHeaderId||!n.componentId}),{data:M}=Be({batchNo:n.planningHeaderId,componentId:n.componentId,fabricId:n.fabricId},{skip:!n.planningHeaderId||!n.componentId||!n.fabricId}),{data:X,refetch:G}=et(n.planningHeaderId,{skip:!n.planningHeaderId}),{data:j}=Me(n.planningHeaderId,{skip:!n.planningHeaderId});console.log("formData.planningHeaderId",n.planningHeaderId),console.log("collectionData",U);const[W,_]=a.useState(!1),te=(c,v)=>{_(!W)},[ue,pe]=a.useState([]),[le,oe]=a.useState([]),[ge,se]=a.useState([]),[ne,F]=a.useState([]),[z,ae]=a.useState([]),[de,q]=a.useState([]),[B,L]=a.useState([]),[fe,ce]=a.useState([]);console.log("batchList",le),console.log("formData",n),a.useEffect(()=>{Q&&pe(Q.result)},[Q]),a.useEffect(()=>{A&&oe(A.result)},[A]),a.useEffect(()=>{T&&se(T.result)},[T]),a.useEffect(()=>{M&&q(T.result)},[M]),a.useEffect(()=>{j&&ce(j.result)},[j]),a.useEffect(()=>{X&&L(X.result.map((c,v)=>({id:v,...c})))},[X,G]),console.log("embroideryList",X),console.log("initialRows",B),a.useEffect(()=>{if(H){const c=H.result[0];F(c.vendorList),ae(c.noOfHeadsList)}},[H]);const K=(U==null?void 0:U.result)||[];a.useEffect(()=>{const c=()=>{const w=parseFloat(n.repeats)||0,D=parseFloat(n.itemsPerRepeat)||0;return(w*D).toFixed(2)};N(w=>({...w,totalPcs:c()}));const v=()=>{const w=parseFloat(n.threadStiches)||0,D=parseFloat(n.threadRate)||0,xe=parseFloat(n.noOfHead)||0,Ie=parseFloat(n.repeats)||0;return(w/1e3*(D*Ie*xe)).toFixed(2)};N(w=>({...w,threadAmount:v()}));const b=()=>{const w=parseFloat(n.tillaStiches)||0,D=parseFloat(n.tilaRate)||0,xe=parseFloat(n.noOfHead)||0,Ie=parseFloat(n.repeats)||0;return(w/1e3*(D*Ie*xe)).toFixed(2)};N(w=>({...w,tilaAmount:b()}));const P=()=>{const w=parseFloat(n.sequence)||0,D=parseFloat(n.sequenceRate)||0,xe=parseFloat(n.noOfHead)||0,Ie=parseFloat(n.repeats)||0;return(w/1e3*(D*Ie*xe)).toFixed(2)};N(w=>({...w,sequenceAmount:P()}));const k=()=>{const w=parseFloat(n.repeats)||0,D=parseFloat(n.noOfHead)||0,xe=parseFloat(n.solvingLayers)||0;return(w*D*13/39.37*xe).toFixed(2)};N(w=>({...w,solvingInMeters:k()}));const re=()=>{const w=parseFloat(n.solvingInMeters)||0,D=parseFloat(n.solvingRate)||0;return parseFloat(n.solvingLayers),(w*D).toFixed(2)};N(w=>({...w,solvingAmount:re()}));const Ue=()=>{const w=parseFloat(n.threadAmount)||0,D=parseFloat(n.tilaAmount)||0,xe=parseFloat(n.sequenceAmount)||0,Ie=parseFloat(n.solvingAmount)||0;return(w+D+xe+Ie).toFixed(2)};N(w=>({...w,totalAmount:Ue()}));const Le=()=>{const w=parseFloat(n.totalAmount)||0,D=parseFloat(n.totalPcs)||0;return(w/D).toFixed(2)};N(w=>({...w,costPerComponent:Le()}))},[n.threadAmount,n.totalAmount,n.sequenceAmount,n.solvingAmount,n.repeats,n.tilaAmount,n.itemsPerRepeat,n.threadRate,n.threadStiches,n.noOfHead,n.tilaRate,n.tillaStiches,n.sequenceRate,n.sequence,n.solvingLayers,n.solvingInMeters,n.solvingRate]);const f=c=>{const{name:v,checked:b}=c.target;N(P=>({...P,[v]:b}))},I=c=>{const{name:v,value:b}=c.target;if(v==="collectionId")K.find(P=>P.collectionId===parseInt(b)),E(b),R(!0),N({...n,collectionId:b});else if(v==="designId"){const P=ue.find(k=>k.designId===parseInt(b));N({...n,designId:b,baseColorId:P?P.colorId:"",baseColorName:P?P.colorName:""})}else if(v==="colorId"){const P=de.find(k=>k.colorId===b);N({...n,colorId:b,availableQty:P?P.total:"",cuttingSize:P?P.cuttingSize:"",repeats:P?P.repeats:""})}else if(v==="batchNo"){const P=le.find(k=>k.batchNo===b);N({...n,batchNo:b,planningHeaderId:P?P.planningHeaderId:"",poPcs:P?P.poPcs:""}),_(!0),R(!1)}else N({...n,[v]:b})},[h,x]=a.useState({}),d=async()=>{const c=g();if(Object.keys(c).length>0){x(c);return}try{const v=await ie.post("https://gecxc.com:4041/api/Embroidery/SaveEmbroidery",{...n,threadAdditional:n.threadAdditional.join(", ")});console.log("Save response:",v.data),v.data.success?o("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(o(`${v.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",v.data.message)),_(!1),N(b=>({embroideryId:0,designId:b.designId,batchNo:b.batchNo,planningHeaderId:b.planningHeaderId,componentId:"",fabricId:"",vendorId:"",poPcs:b.poPcs,baseColorId:b.baseColorId,baseColorName:b.baseColorName,colorId:"",availableQty:"",noOfHead:"",repeats:"",cuttingSize:"",itemsPerRepeat:"",totalPcs:"",totalAmount:"",threadStiches:"",threadRate:"",threadAmount:"",tillaStiches:"",tilaRate:"",tilaAmount:"",sequence:"",sequenceRate:"",sequenceAmount:"",isSolving:!1,solvingLayers:0,solvingInMeters:"",solvingRate:0,solvingAmount:"",threadAdditional:[],costPerComponent:"",createdOn:new Date().toISOString(),createdBy:s.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:s.empId})),G()}catch(v){console.error("Error saving data:",v),o("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},g=()=>{const c={};return n.fabricId||(c.fabricId="fabricId is required"),n.colorId||(c.colorId="colorId is required"),n.vendorId||(c.vendorId="vendorId is required"),n.componentId||(c.componentId="componentId is required"),n.noOfHead||(c.noOfHead="noOfHead is required"),n.itemsPerRepeat||(c.itemsPerRepeat="itemsPerRepeat is required"),n.threadStiches||(c.threadStiches="threadStiches is required"),n.threadRate||(c.threadRate="threadRate is required"),n.tillaStiches||(c.tillaStiches="tillaStiches is required"),n.tilaRate||(c.tilaRate="tilaRate is required"),n.sequence||(c.sequence="sequence is required"),n.sequenceRate||(c.sequenceRate="sequenceRate is required"),c};console.log("initialRows",B);const y=[{field:"designNo",headerName:"Design"},{field:"batchNo",headerName:"Batch No."},{field:"componentName",headerName:"Component "},{field:"fabricName",headerName:"Fabric "},{field:"vendorId",headerName:"Vendor"},{field:"poPcs",headerName:"Po Pcs"},{field:"colourName",headerName:"Color"},{field:"availableQty",headerName:"Available Qty"},{field:"noOfHeadsName",headerName:"No. Of Heads"},{field:"repeats",headerName:"Repeats"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"itemsPerRepeat",headerName:"Items Per Repeat"},{field:"totalPcs",headerName:"Total Pcs"},{field:"threadStiches",headerName:"Thread Stitches"},{field:"threadRate",headerName:"Thread Rate"},{field:"threadAmount",headerName:"Thread Amount"},{field:"tillaStiches",headerName:"Tilla Stitches"},{field:"tilaRate",headerName:"Tilla Rate"},{field:"tilaAmount",headerName:"Tilla Amount"},{field:"sequence",headerName:"sequence"},{field:"sequenceRate",headerName:"Sequence Rate"},{field:"sequenceAmount",headerName:"Sequence Amount"},{field:"isSolving",headerName:"Is Solving"},{field:"solvingLayers",headerName:"Solving Layers"},{field:"solvingInMeters",headerName:"Solving In Meters"},{field:"solvingRate",headerName:"Solving Rate"},{field:"solvingAmount",headerName:"Solving Amount"},{field:"threadAdditional",headerName:"ThreadAdditional"},{field:"costPerComponent",headerName:"Cost Per Component"}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:ft,sx:{background:"transparent"}}),title:"Embroidery  ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:O,onChange:I,size:"small",children:K.map(c=>e.jsx(C,{value:c.collectionId,children:c.collectionName},c.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:n.designId,onChange:I,size:"small",children:ue.map(c=>e.jsx(C,{value:c.designId,children:c.designNo},c.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:n.batchNo,onChange:I,size:"small",children:le.map(c=>e.jsx(C,{value:c.batchNo,children:c.batchNo},c.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:n.baseColorName,onChange:I,disabled:!0})})]})]}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ne,{}),title:"Add Embroidery",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Pe,{onClick:te,children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(Ae,{expanded:W,onChange:te,sx:{},children:[e.jsx(ke,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsxs(Oe,{children:[e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[" ",e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:n.componentId,onChange:I,size:"small",required:!0,error:!!h.componentId,helperText:h.componentId,children:fe.map(c=>e.jsx(C,{value:c.componentId,children:c.componentName},c.componentId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:n.fabricId,onChange:I,required:!0,error:!!h.fabricId,helperText:h.fabricId,children:ge.map(c=>e.jsx(C,{value:c.fabricId,children:c.fabric},c.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:n.vendorId,onChange:I,required:!0,error:!!h.vendorId,helperText:h.vendorId,children:ne.map(c=>e.jsx(C,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:n.colorId,onChange:I,required:!0,error:!!h.colorId,helperText:h.colorId,children:de.map(c=>e.jsx(C,{value:c.colorId,children:c.color},c.colorId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:n.poPcs,onChange:I,disabled:!0})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",type:"number",value:n.availableQty,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Repeats",type:"number",fullWidth:!0,size:"small",name:"repeats",value:n.repeats,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Heads",defaultValue:"",size:"small",name:"noOfHead",value:n.noOfHead,onChange:I,required:!0,error:!!h.noOfHead,helperText:h.noOfHead,children:z.map(c=>e.jsx(C,{value:c.lookUpId,children:c.lookUpName},c.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:n.cuttingSize,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"itemsPerRepeat",fullWidth:!0,type:"number",size:"small",name:"itemsPerRepeat",value:n.itemsPerRepeat,onChange:I,required:!0,error:!!h.itemsPerRepeat,helperText:h.itemsPerRepeat})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"total Pcs.",fullWidth:!0,size:"small",type:"number",name:"totalPcs",value:n.totalPcs,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:n.totalAmount,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:n.costPerComponent,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{select:!0,label:"Additional",value:n.threadAdditional,name:"threadAdditional",size:"small",onChange:I,fullWidth:!0,SelectProps:{multiple:!0},children:$.map(c=>e.jsx(C,{value:c,style:Y(c,n.threadAdditional,u),children:c},c))})}),e.jsx(r,{item:!0,xs:12,md:4}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Thread"})})," ",e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"threadStiches",value:n.threadStiches,onChange:I,required:!0,error:!!h.threadStiches,helperText:h.threadStiches})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"threadRate",value:n.threadRate,onChange:I,required:!0,error:!!h.threadRate,helperText:h.threadRate})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"threadAmount",value:n.threadAmount,onChange:I})})]})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Tilla"})})," ",e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Stitches",fullWidth:!0,size:"small",type:"number",name:"tillaStiches",value:n.tillaStiches,onChange:I,required:!0,error:!!h.tillaStiches,helperText:h.tillaStiches})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"tilaRate",value:n.tilaRate,onChange:I,required:!0,error:!!h.tilaRate,helperText:h.tilaRate})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"tilaAmount",value:n.tilaAmount,onChange:I})})]})}),e.jsxs(r,{item:!0,xs:12,md:6,children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Sequence"})})," ",e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Sequence",fullWidth:!0,size:"small",name:"sequence",type:"number",value:n.sequence,onChange:I,required:!0,error:!!h.sequence,helperText:h.sequence})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"sequenceRate",value:n.sequenceRate,onChange:I,required:!0,error:!!h.sequenceRate,helperText:h.sequenceRate})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",name:"sequenceAmount",value:n.sequenceAmount,onChange:I})})]})," "]}),n.isSolving?e.jsx(r,{item:!0,xs:12,md:6,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(ve,{variant:"h5",gutterBottom:!0,children:"Solving"})})," ",e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Layers",fullWidth:!0,size:"small",type:"number",name:"solvingLayers",value:n.solvingLayers,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Meters",type:"number",fullWidth:!0,size:"small",name:"solvingInMeters",value:n.solvingInMeters,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Rate",fullWidth:!0,type:"number",size:"small",name:"solvingRate",value:n.solvingRate,onChange:I})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Amount",fullWidth:!0,size:"small",type:"number",name:"solvingAmount",value:n.solvingAmount,onChange:I})})]})}):null,e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(Qe,{control:e.jsx(Ge,{checked:n.isSolving,onChange:f,name:"isSolving"}),label:"isSolving"})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ee,{variant:"contained",size:"small",onClick:d,children:"Save"})})]})," "]})," "]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"View Embroidery ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsxs(r,{sx:{marginTop:2},item:!0,xs:12,children:[" ",m?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(ze,{iColumns:y,initialRows:B,setInitialData:i,deleteApi:"https://gecxc.com:4041/api/Embroidery/DeleteEmbroideryById?embroideryId=",deleteBy:"embroideryId",refetch:G,setAccordionExpanded:_,fileName:"Embroidery List"})]})})]})]})},It=xt,bt=()=>{const{user:u}=Fe();console.log("user",u);const[s,o]=a.useState([]),[t,i]=a.useState([]),[m,R]=a.useState({planningId:0,collectionId:"",baseColorId:"",baseColorName:"",noOfDesigns:"",noOfColors:"",planningHeaderId:"",designId:"",batchNo:"",componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:u.empId,lastUpdatedBy:u.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:!1,repeatsInMtr:""});console.log("formData",m),a.useEffect(()=>{R({planningId:(s==null?void 0:s.planningId)||0,collectionId:(s==null?void 0:s.collectionId)||"",baseColorId:(s==null?void 0:s.baseColorId)||"",baseColorName:(s==null?void 0:s.baseColorName)||"",noOfDesigns:(s==null?void 0:s.noOfDesigns)||"",noOfColors:(s==null?void 0:s.noOfColors)||"",planningHeaderId:(s==null?void 0:s.planningHeaderId)||"",designId:(s==null?void 0:s.designId)||"",batchNo:(s==null?void 0:s.batchNo)||"",componentId:(s==null?void 0:s.componentId)||"",cuttingSize:(s==null?void 0:s.cuttingSize)||"",colorId:(s==null?void 0:s.colorId)||"",fabricId:(s==null?void 0:s.fabricId)||"",noOfHeads:(s==null?void 0:s.noOfHeads)||"",repeats:(s==null?void 0:s.repeats)||"",repeatSize:(s==null?void 0:s.repeatSize)||"",uomId:(s==null?void 0:s.uomId)||"",totalFabric:(s==null?void 0:s.totalFabric)||"",shrinkage:(s==null?void 0:s.shrinkage)||"",wastage:(s==null?void 0:s.wastage)||"",total:(s==null?void 0:s.total)||"",appId:1,createdOn:(s==null?void 0:s.createdOn)||new Date().toISOString(),createdBy:(s==null?void 0:s.createdBy)||u.empId,lastUpdatedBy:u.empId,lastUpdatedOn:new Date().toISOString(),isSchiffili:(s==null?void 0:s.isSchiffili)||!1,repeatsInMtr:(s==null?void 0:s.repeatsInMtr)||""})},[s]);const{data:n}=ye(),[N,$]=a.useState(""),{data:Y,refetch:U}=Se(N,{skip:!N}),{data:O,refetch:E}=tt(m.planningHeaderId,{skip:!m.planningHeaderId}),[H,Q]=a.useState([]),{enqueueSnackbar:S}=je();a.useEffect(()=>{Y&&(Q(Y.result),U())},[Y]),a.useEffect(()=>{O&&i(O.result.map((d,g)=>({id:g,...d})))},[O,E]),console.log("designList",H),console.log("collectionData",n);const A=(n==null?void 0:n.result)||[],[Z,T]=a.useState(!1),[M,X]=a.useState([]),[G,j]=a.useState([]),[W,_]=a.useState([]),[te,ue]=a.useState([]),[pe,le]=a.useState([]),[oe,ge]=a.useState([]);a.useEffect(()=>{(async()=>{try{const y=(await ie.get("https://gecxc.com:4041/API/Common/GetPrePlanningLookUp?appID=1")).data.result[0];X(y.componentList),_(y.colorList),j(y.fabricList),le(y.noOfHeadsList),ue(y.uom)}catch(g){console.error("Error fetching pre-planning lookup data:",g)}})()},[]),a.useEffect(()=>{const d=async g=>{try{const y=await ie.get(`https://gecxc.com:4041/api/PrePlanning/GetPrePlanningHeaderByDesignId?designId=${g}`);console.log(y.data),ge(y.data.result)}catch(y){console.error("Error fetching pre-planning lookup data:",y)}};m.designId&&d(m.designId)},[m.designId,m.planningHeaderId]),a.useEffect(()=>{const d=()=>{const c=parseFloat(m.repeats)||0,v=parseFloat(m.repeatSize)||0;return(c*v).toFixed(2)};R(c=>({...c,totalFabric:d()}));const g=()=>{const c=parseFloat(m.totalFabric)||0,v=parseFloat(m.shrinkage)||0,b=parseFloat(m.wastage)||0;return(c*(100+(v+b))/100).toFixed(2)};R(c=>({...c,total:g()}));const y=()=>(parseFloat(m.repeats),(.9144*(parseFloat(m.repeatSize)||0)).toFixed(2));R(c=>({...c,repeatsInMtr:y()}));const p=()=>{const c=parseFloat(m.repeats)||0;return((parseFloat(m.repeatsInMtr)||0)*c).toFixed(2)};R(c=>({...c,totalFabric:c.isSchiffili?p():d()}))},[m.repeats,m.repeatSize,m.totalFabric,m.shrinkage,m.wastage,m.repeatsInMtr,m.isSchiffili]);const[se,ne]=a.useState(!1);a.useState(!1);const F=d=>{const{name:g,value:y}=d.target;if(g==="collectionId"){const p=A.find(c=>c.collectionId===parseInt(y));T(!0),$(y),R({...m,collectionId:y,noOfDesigns:p?p.noOfDesigns:"",noOfColors:p?p.noOfColors:""})}else if(g==="designId"){const p=H.find(c=>c.designId===parseInt(y));R({...m,designId:y,baseColorId:p?p.colorId:"",baseColorName:p?p.colorName:""})}else if(g==="batchNo"){const p=oe.find(c=>c.batchNo===y);R({...m,batchNo:y,planningHeaderId:p?p.planningHeaderId:""}),ne(!0),T(!1)}else R({...m,[g]:y})},[z,ae]=a.useState({}),de=async()=>{const d=q();if(Object.keys(d).length>0){ae(d);return}try{const g=await ie.post("https://gecxc.com:4041/api/PrePlanning/SavePrePlanning",m);console.log("Data saved successfully:",g.data),console.log("Save response:",g.data),g.data.success?S("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(S(`${g.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",g.data.message)),R(y=>({planningId:0,collectionId:y.collectionId,designId:y.designId,batchNo:y.batchNo,planningHeaderId:y.planningHeaderId,baseColorId:y.baseColorId,baseColorName:y.baseColorName,noOfDesigns:y.noOfDesigns,noOfColors:y.noOfColors,componentId:"",cuttingSize:"",colorId:"",fabricId:"",noOfHeads:"",repeats:"",repeatSize:"",uomId:"",totalFabric:"",shrinkage:"",wastage:"",total:"",appId:1,createdOn:new Date().toISOString(),createdBy:u.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId,isSchiffili:!1,repeatsInMtr:""})),E(),ne(!1)}catch(g){console.error("Error saving data:",g),S("Pre Planning not saved successfully!",{variant:"error",autoHideDuration:5e3})}},q=()=>{const d={};return m.componentId||(d.componentId="componentId is required"),m.colorId||(d.colorId="colorId is required"),m.fabricId||(d.fabricId="fabricId is required"),m.cuttingSize||(d.cuttingSize="cuttingSize is required"),m.noOfHeads||(d.noOfHeads="noOfHeads is required"),m.repeats||(d.repeats="repeats is required"),m.repeatSize||(d.repeatSize="repeatSize is required"),m.uomId||(d.uomId="uomId is required"),m.shrinkage||(d.shrinkage="shrinkage is required"),m.wastage||(d.wastage="wastage is required"),d},B=d=>{const{name:g,checked:y}=d.target;R(p=>({...p,[g]:y,uomId:y?139:p.uomId}))};console.log("initialRows",t);const L=t.reduce((d,g)=>d+(g.totalFabric??0),0).toFixed(2),fe=t.reduce((d,g)=>d+(g.total??0),0).toFixed(2),ce=[...t,{id:"TOTAL_FABRIC",label:"Total Fabric",totalFabric:L,total:fe}],K={sortable:!1,pinnable:!1,hideable:!1};console.log("rows",ce);const f=[{field:"componentName",headerName:"Component",...K,colSpan:(d,g)=>{if(g.id==="TOTAL_FABRIC")return 7},valueGetter:(d,g)=>g.id==="TOTAL_FABRIC"?g.label:d},{field:"color",headerName:"Color",...K},{field:"cuttingSize",headerName:"Cutting Size",...K},{field:"fabric",headerName:"Fabrication",...K},{field:"noOfHeadName",headerName:"No. Of Heads",...K},{field:"repeats",headerName:"Repeats",...K},{field:"repeatSize",headerName:"Repeat Size",...K},{field:"totalFabric",headerName:"Total Fabric",...K},{field:"uom",headerName:"UOM",colSpan:(d,g)=>{if(g.id==="TOTAL_FABRIC")return 3},valueGetter:(d,g)=>g.id==="TOTAL_FABRIC"?"OverAll Total":d},{field:"isSchiffili",headerName:"Is Shiffili"},{field:"shrinkage",headerName:"Shrinkage %"},{field:"wastage",headerName:"Wastage %"},{field:"total",headerName:"Total"}],I=({row:d,field:g})=>d.id==="TOTAL_FABRIC"&&(g==="componentName"||g==="uom")?"bold":"";console.log("batchList:",oe);const h="https://gecxc.com:4041/api/PrePlanning/DeletePreplanningByPlanningId?PlanningId=",x=(d,g)=>{ne(!se)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"CardHeader",children:e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Je,{}),title:"Pre Planning",titleTypographyProps:{style:{color:"white"}},children:" "}),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:2,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:m.collectionId,onChange:F,size:"small",required:!0,children:A.map(d=>e.jsx(C,{value:d.collectionId,children:d.collectionName},d.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:m.designId,onChange:F,size:"small",required:!0,children:H.map(d=>e.jsx(C,{value:d.designId,children:d.designNo},d.designId))})}),e.jsxs(r,{item:!0,xs:12,md:2,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:m.batchNo,onChange:F,size:"small",required:!0,children:oe.map(d=>e.jsx(C,{value:d.batchNo,children:d.batchNo},d.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"No of Design",fullWidth:!0,size:"small",name:"noOfDesigns",value:m.noOfDesigns,onChange:F,disabled:!0})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"No of Color",fullWidth:!0,size:"small",name:"noOfColors",value:m.noOfColors,onChange:F,disabled:!0})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:m.baseColorName,onChange:F,disabled:!0})})]})]})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"MainCard",avatar:e.jsx(Ne,{}),title:"Add Pre Planning",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Pe,{onClick:x,children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(Ae,{expanded:se,onChange:x,sx:{},children:[e.jsx(ke,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Oe,{children:e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(He,{fullWidth:!0,options:M,getOptionLabel:d=>d.lookUpName,value:M.find(d=>d.lookUpId===m.componentId)||null,onChange:(d,g)=>{F({target:{name:"componentId",value:g?g.lookUpId:""}})},renderInput:d=>e.jsx(l,{...d,label:"Select Component",size:"small",name:"componentId",value:m.componentId,required:!0,error:!!z.componentId,helperText:z.componentId})})}),e.jsxs(r,{item:!0,xs:12,md:2,children:[" ",e.jsx(He,{fullWidth:!0,options:W,getOptionLabel:d=>d.lookUpName,value:W.find(d=>d.lookUpId===m.colorId)||null,onChange:(d,g)=>{F({target:{name:"colorId",value:g?g.lookUpId:""}})},renderInput:d=>e.jsx(l,{...d,label:"Color",size:"small",value:m.colorId,name:"colorId",required:!0,error:!!z.colorId,helperText:z.colorId})})]}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,size:"small",name:"cuttingSize",type:"number",value:m.cuttingSize,onChange:F,required:!0,error:!!z.cuttingSize,helperText:z.cuttingSize})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(He,{fullWidth:!0,options:G,getOptionLabel:d=>d.lookUpName,value:G.find(d=>d.lookUpId===m.fabricId)||null,onChange:(d,g)=>{F({target:{name:"fabricId",value:g?g.lookUpId:""}})},renderInput:d=>e.jsx(l,{...d,label:"Fabrication",size:"small",name:"fabricId",value:m.fabricId,required:!0,error:!!z.fabricId,helperText:z.fabricId})})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"No of Heads",defaultValue:"",size:"small",name:"noOfHeads",value:m.noOfHeads,onChange:F,error:!!z.noOfHeads,helperText:z.noOfHeads,required:!0,children:pe.map(d=>e.jsx(C,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Repeats",fullWidth:!0,size:"small",name:"repeats",type:"number",value:m.repeats,onChange:F,error:!!z.repeats,helperText:z.repeats,required:!0})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Repeat Size",fullWidth:!0,type:"number",size:"small",name:"repeatSize",value:m.repeatSize,onChange:F,error:!!z.repeatSize,helperText:z.repeatSize,required:!0})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Total Fabric",fullWidth:!0,size:"small",name:"totalFabric",value:m.totalFabric,onChange:F})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",type:"number",defaultValue:"",size:"small",name:"uomId",value:m.uomId,onChange:F,error:!!z.uomId,helperText:z.uomId,required:!0,disabled:m.isSchiffili,children:te.map(d=>e.jsx(C,{value:d.lookUpId,children:d.lookUpName},d.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Shrinkage %",fullWidth:!0,size:"small",type:"number",name:"shrinkage",value:m.shrinkage,onChange:F,error:!!z.shrinkage,helperText:z.shrinkage,required:!0})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Wastage %",fullWidth:!0,size:"small",type:"number",name:"wastage",value:m.wastage,onChange:F,error:!!z.wastage,helperText:z.wastage,required:!0})}),e.jsx(r,{item:!0,xs:12,md:2,children:e.jsx(l,{label:"Total",fullWidth:!0,type:"number",size:"small",name:"total",value:m.total,onChange:F})}),e.jsx(r,{item:!0,xs:12,md:2,textAlign:"right",children:e.jsx(Qe,{control:e.jsx(Ge,{checked:m.isSchiffili,onChange:B,name:"isSchiffili"}),label:"Is Schiffli"})}),m.isSchiffili?e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(r,{container:!0,spacing:1,width:"Inherit",children:e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"repeat in mtr",fullWidth:!0,size:"small",name:"repeatsInMtr",disabled:!0,value:m.repeatsInMtr,onChange:F})})})}):null,e.jsx(r,{item:!0,xs:12,textAlign:"right",children:e.jsx(ee,{variant:"contained",size:"small",onClick:de,children:"Save"})})]})})]})]}),e.jsx(r,{item:!0,xs:12,md:12,children:e.jsx(me,{sx:{height:1,width:"100%",marginTop:1,marginBottom:0}})}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"MainCard",avatar:e.jsx(Te,{}),title:"View",titleTypographyProps:{style:{color:"white"}}}),e.jsx(r,{sx:{paddingY:1,paddingX:1},children:e.jsx(r,{sx:{},item:!0,xs:12,children:Z?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(ze,{iColumns:f,initialRows:ce,setInitialData:o,deleteApi:h,deleteBy:"planningId",refetch:E,getCellClassName:I,setAccordionExpanded:ne,fileName:"PrePlanningList"})})})]})]})},vt=bt,jt="/assets/roller-ezgif.com-instagif-CY-x4C-U.gif",yt=()=>{const{user:u}=Fe();console.log("user",u);const[s,o]=a.useState([]),[t,i]=a.useState({dpId:0,designId:"",batchNo:"",planningHeaderId:"",fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:"",poPcs:"",baseColorName:"",createdBy:u.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId});a.useEffect(()=>{i({dpId:s.dpId||0,designId:(s==null?void 0:s.designId)||"",planningHeaderId:(s==null?void 0:s.planningHeaderId)||0,batchNo:(s==null?void 0:s.batchNo)||"",fabricId:(s==null?void 0:s.fabricId)||"",colorId:(s==null?void 0:s.colorId)||"",color:(s==null?void 0:s.color)||"",vendorId:(s==null?void 0:s.vendorId)||"",processType:(s==null?void 0:s.processType)||"",AvailableQty:(s==null?void 0:s.availableQty)||"",Shrinkage:(s==null?void 0:s.shrinkage)||"",Wastage:(s==null?void 0:s.wastage)||"",OutputQty:(s==null?void 0:s.outputQty)||0,UOM:(s==null?void 0:s.uom)||0,uomId:(s==null?void 0:s.uomId)||"",RatePerUOM:(s==null?void 0:s.ratePerUOM)||0,UnitRatePerPo:(s==null?void 0:s.unitRatePerPo)||"",TotalExclGst:(s==null?void 0:s.totalExclGst)||"",GST:(s==null?void 0:s.gst)||"",TotalIncludingGst:(s==null?void 0:s.totalIncludingGst)||"",poPcs:(s==null?void 0:s.poPcs)||0,baseColorName:(s==null?void 0:s.baseColorName)||0,createdOn:(s==null?void 0:s.createdOn)||new Date().toISOString(),createdBy:(s==null?void 0:s.createdBy)||u.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId})},[s]);const{enqueueSnackbar:m}=je(),[R,n]=a.useState(!1);console.log("Dyeing form data to send",t);const{data:N}=ye(),[$,Y]=a.useState(""),{data:U}=Ce(),{data:O,refetch:E}=Se($,{skip:!$}),{data:H,refetch:Q}=Re(t.designId,{skip:!t.designId}),{data:S}=st(t.planningHeaderId,{skip:!t.planningHeaderId}),{data:A}=rt({fabricId:t.fabricId,planningHeaderId:t.planningHeaderId},{skip:!t.fabricId||!t.planningHeaderId}),{data:Z,refetch:T}=ot(t.planningHeaderId,{skip:!t.planningHeaderId}),[M,X]=a.useState([]),[G,j]=a.useState([]),[W,_]=a.useState([]),[te,ue]=a.useState([]),[pe,le]=a.useState([]),[oe,ge]=a.useState([]),[se,ne]=a.useState([]),[F,z]=a.useState(!1);console.log("batchList",G),console.log("formData",t);const ae=(h,x)=>{z(!F)};a.useEffect(()=>{O&&X(O.result)},[O]),a.useEffect(()=>{H&&j(H.result)},[H]),a.useEffect(()=>{S&&_(S.result)},[S]),a.useEffect(()=>{A&&ge(A.result)},[A]),a.useEffect(()=>{U&&ne(U.result[0].vendorList)},[S]),console.log(se),a.useEffect(()=>{Z&&le(Z.result.map((h,x)=>({id:x,...h})))},[Z,T]),a.useEffect(()=>{if(U){const h=U.result[0];ue(h.uomList)}},[U]);const de=(N==null?void 0:N.result)||[],q=h=>{const{name:x,value:d}=h.target;if(x==="collectionId")de.find(g=>g.collectionId===parseInt(d)),Y(d),n(!0),i({...t,collectionId:d});else if(x==="designId"){const g=M.find(y=>y.designId===parseInt(d));i({...t,designId:d,baseColorId:g?g.colorId:"",baseColorName:g?g.colorName:""})}else if(x==="batchNo"){const g=G.find(y=>y.batchNo===d);i({...t,batchNo:d,planningHeaderId:g?g.planningHeaderId:"",poPcs:g?g.poPcs:""}),z(!0),n(!1)}else if(x==="fabricId")W.find(g=>g.fabricId===d),console.log("Selected Fabric:",W),i({...t,fabricId:d});else if(x==="ColorId"){const g=oe.find(y=>y.colorId===d.colorId);i({...t,ColorId:d.colorId,color:g.color,AvailableQty:g.total,UOM:g.uom,Shrinkage:g.shrinkage,Wastage:g.wastage})}else i(x==="processType"?{...t,processType:d}:x==="vendorId"?{...t,vendorId:d}:{...t,[x]:d})};a.useEffect(()=>{const h=()=>{const P=parseFloat(t.AvailableQty)||0,k=parseFloat(t.Shrinkage)||0,re=parseFloat(t.Wastage)||0;return(P*(100-(k+re))/100).toFixed(2)},x=()=>{const P=parseFloat(t.AvailableQty)||0,k=parseFloat(t.RatePerUOM)||0;return(P*k).toFixed(2)},d=(P,k)=>(P*(1+k/100)).toFixed(2),g=h(),y=x(),p=parseFloat(t.GST)||0,c=d(y,p),v=parseFloat(t.poPcs)||0,b=v?c/v:0;i(P=>({...P,OutputQty:g,TotalExclGst:y,TotalIncludingGst:c,UnitRatePerPo:b.toFixed(2)}))},[t.AvailableQty,t.Shrinkage,t.Wastage,t.RatePerUOM,t.GST,t.poPcs,t.UnitRatePerPo]);const[B,L]=a.useState({}),fe=async()=>{const h=ce();if(Object.keys(h).length>0){L(h);return}try{const x=await ie.post("https://gecxc.com:4041/api/DyeingPrinting/SaveDyeingPrinting",t);console.log("Save response:",x.data),x.data.success?m("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(m(`${x.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",x.data.message)),i(d=>({designId:d.designId,planningHeaderId:d.planningHeaderId,batchNo:d.batchNo,dpId:0,fabricId:"",colorId:"",color:"",vendorId:"",processType:"",AvailableQty:"",Shrinkage:"",Wastage:"",OutputQty:"",UOM:"",uomId:"",RatePerUOM:"",UnitRatePerPo:"",TotalExclGst:"",GST:"0",TotalIncludingGst:"",poPcs:d.poPcs,baseColorName:"",createdOn:new Date().toISOString(),createdBy:u.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId})),T(),z(!1)}catch(x){console.error("Error saving data:",x),m("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},ce=()=>{const h={};return t.fabricId||(h.fabricId="fabricId is required"),t.colorId||(h.colorId="colorId is required"),t.vendorId||(h.vendorId="vendorId is required"),t.processType||(h.processType="processType is required"),t.GST||(h.GST="GST is required"),t.RatePerUOM||(h.RatePerUOM="RatePerUOM is required"),h},K=[{value:"Dyeing",label:"Dyeing"},{value:"Printing",label:"Printing"}],f=[{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"vendorName",headerName:"Vendor"},{field:"processType",headerName:"Process Type"},{field:"uom",headerName:"uom"},{field:"availableQty",headerName:"Available Quantitity"},{field:"shrinkage",headerName:"Shrinkage"},{field:"wastage",headerName:"Wastage"},{field:"outputQty",headerName:"Output Qty"},{field:"ratePerUOM",headerName:"Rate"},{field:"totalExclGst",headerName:"Total Excl. Gst"},{field:"gst",headerName:"GST"},{field:"totalIncludingGst",headerName:"Total Including GST"},{field:"unitRatePerPo",headerName:"UnitRate Per Po."}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:jt,sx:{background:"transparent"}}),title:"Dyeing ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:$,onChange:q,size:"small",children:de.map(h=>e.jsx(C,{value:h.collectionId,children:h.collectionName},h.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:t.designId,onChange:q,size:"small",children:M.map(h=>e.jsx(C,{value:h.designId,children:h.designNo},h.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:t.batchNo,onChange:q,size:"small",children:G.map(h=>e.jsx(C,{value:h.batchNo,children:h.batchNo},h.batchNo))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:t.baseColorName,onChange:q,disabled:!0})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:t.fabricId,onChange:q,error:!!B.fabricId,helperText:B.fabricId,required:!0,children:W.map(h=>e.jsx(C,{value:h.fabricId,children:h.fabric},h.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(mt,{fullWidth:!0,options:oe,getOptionLabel:h=>h.color||"",renderInput:h=>e.jsx(l,{...h,label:"Color",name:"colorId",size:"small",error:!!B.colorId,helperText:B.colorId,required:!0}),value:oe.find(h=>h.colorId===t.colorId)||null,onChange:(h,x)=>{i(d=>({...d,colorId:x?x.colorId:"",color:x?x.color:"",AvailableQty:x?x.total:"",UOM:x?x.uom:"",uomId:x?x.uomId:"",Shrinkage:x?x.shrinkage:"",Wastage:x?x.wastage:""}))}})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ne,{}),title:"Add Dyeing ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Pe,{onClick:ae,children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}}),e.jsxs(Ae,{expanded:F,onChange:ae,sx:{},children:[e.jsx(ke,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Oe,{children:e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:t.vendorId,onChange:q,error:!!B.vendorId,helperText:B.vendorId,required:!0,children:se.map(h=>e.jsx(C,{value:h.lookUpId,children:h.lookUpName},h.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",size:"small",name:"processType",value:t.processType,onChange:q,error:!!B.processType,helperText:B.processType,required:!0,children:K.map(h=>e.jsx(C,{value:h.value,children:h.label},h.value))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:t.poPcs,onChange:q,disabled:!0})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"UOM",fullWidth:!0,size:"small",name:"UOM",value:t.UOM,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"AvailableQty",fullWidth:!0,size:"small",type:"number",name:"AvailableQty",value:t.AvailableQty,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Shrinkage%",type:"number",fullWidth:!0,size:"small",name:"Shrinkage",value:t.Shrinkage,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Wastage%",fullWidth:!0,size:"small",type:"number",name:"Wastage",value:t.Wastage,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Output Qty",fullWidth:!0,size:"small",name:"OutputQty",type:"number",value:t.OutputQty,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",fullWidth:!0,size:"small",type:"number",name:"RatePerUOM",value:t.RatePerUOM,onChange:q,error:!!B.RatePerUOM,helperText:B.RatePerUOM,required:!0})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Excluding GST",type:"number",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalExclGst,onChange:q})}),e.jsxs(r,{item:!0,xs:12,md:1.5,children:[e.jsx(l,{label:"GST",fullWidth:!0,type:"number",size:"small",name:"GST",value:t.GST,onChange:q,error:!!B.GST,helperText:B.GST,required:!0})," "]}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total:Including Gst",fullWidth:!0,size:"small",name:"TotalExclGst",value:t.TotalIncludingGst,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Unit P: T/Po PC's",fullWidth:!0,size:"small",name:"UnitRatePerPo",value:t.UnitRatePerPo,onChange:q})}),e.jsx(r,{item:!0,xs:12,md:12,textAlign:"right",children:e.jsx(ee,{variant:"contained",color:"primary",size:"small",onClick:fe,children:"Save"})})]})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"View Dyeing ",titleTypographyProps:{style:{color:"white"}}})," ",e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(r,{item:!0,xs:12,md:12,paddingTop:1,children:R?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(ze,{iColumns:f,initialRows:pe,setInitialData:o,deleteApi:"https://gecxc.com:4041/api/DyeingPrinting/DeleteDyeingPrintingById?DPId=",deleteBy:"dpId",refetch:T,setAccordionExpanded:z,fileName:"Dyeing&PrintingList"})})})]})]})},Ct=yt,Ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVR4nNXXaciVVRAH8Kv1Jtoi5psFZZYUtoimhUVlaJHZghK2UBFCtGkbZdgiBG1GHyowaaEdWogWElvMFjJpw4oWwrJsVetDtNNevxjeuXW8PPe991rvh/5w4TznnDkzZ87Mf+bWav8H4Dgcgc9wfcPanViFidioL5Rvj2/wIqbgCyzA3XgKH+BI/+DWijMGpYEjO1U+FH8Uh++Jj6yPNzG5YW5wccYxWItF6anwWP9OjJiE7/FuYcCTeDnHjQYsLWR3w8cYi/OxP57AzE49cSGewzgswfJ0/0u4HwfgWYyq3w5deBXH4wXchHU4GgvbVdwPR+EVPI1NMCDesviFos3SqIiTaSl7BW5Pw5/Ho3gYl2Nuu8G3NG+8X85tgcMxCxfhLBxWf/N08bJU+h52xRrciGdwdj7bsFbKx+fbnZTfe+cNflGNX/EQJqQ3Pi+MPgN3pAd/x8GtlO+BT/I2A1P4T+0hMuYdzC/Om56XCW/NyOCt5gs9Lo5oPxBD8u07xesZK5vjtjRqXKEj0vGEZgYsxGXYOKO8U/yE3ZN0PsSVuCHOLHTsgxVVykdmgAzKAGuFryvmLsDVBXnF+w9OCt+60BXcMarRgBA8D91Jvc2URrqNSZkJ+f1dUvRbDfu/wqbpiXmFrluCIUvlke+rsS3OaaJ8WUmxhewO+LYXT52KneLWhcx167EhRtQ3JKNVYUqTuAkmfDBStoncI7kvMmvLHAcdTywPORT35rjqbdfWySPzfDF+wAPF/Hb4skJ2Xa6HzL45fiwCvTRgJq7NvK/CmcXeuQ1rpxdrF1fIBvn0z5ScXuXFGk7Md4nbVeGUYu8lDWvnFmtzKmR/C+JpZcA03JXjqoBaWfD9VplGkqjq890VvUJgTfHuezUzYMdgsBxHRavCpAaZoQ3fQblVWJLrK0suaDSgXwbakCSTKkQp7WoiP6AX5pyVJPd3GjYzYgFmZzT/2OSwVdkLblOU7PuauF4+Z3fGxqWtDBiblawrWbE3hIFv4OcW++Ylta9uqyHVU3rnpNBr/h2WZ1WMrLmmpfJABEnW7uD44dlybwjCk8OyWX0/YqvWLvSUy3jTXbIt77QsL8q+YnReZnTbyuvA1OTuqZkhMyoqXSNWRH+Y8sem8sm1DYWehvLtjPrhObdzZspVuDnL7GnBI4XMPUlQIzZYeR3ZGc1ObzyeFW981viByRtjsttdnO3cyRF8tf8Serj8oPhjmu11tNqfZnpFzz8fh/TJn9O+xl9lMwg6mBWmPgAAAABJRU5ErkJggg==",St=()=>{const{user:u}=Fe(),{enqueueSnackbar:s}=je(),[o,t]=a.useState([]),[i,m]=a.useState({schiffiliId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",poPcs:"",baseColorName:"",fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdBy:u.empId,createdOn:new Date().toISOString(),lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId});a.useEffect(()=>{m({schiffiliId:o.schiffiliId||0,designId:(o==null?void 0:o.designId)||"",planningHeaderId:(o==null?void 0:o.planningHeaderId)||0,batchNo:(o==null?void 0:o.batchNo)||"",componentId:(o==null?void 0:o.componentId)||"",poPcs:(o==null?void 0:o.poPcs)||"",baseColorName:(o==null?void 0:o.baseColorName)||"",fabricId:(o==null?void 0:o.fabricId)||"",vendorId:(o==null?void 0:o.vendorId)||"",colorId:(o==null?void 0:o.colorId)||"",availableQty:(o==null?void 0:o.availableQty)||"",thaanQty:(o==null?void 0:o.thaanQty)||0,operatingMachineId:(o==null?void 0:o.operatingMachineId)||0,operatingMachine:(o==null?void 0:o.operatingMachine)||"",workingHeadId:(o==null?void 0:o.workingHeadId)||0,cuttingSize:(o==null?void 0:o.cuttingSize)||"",rate:(o==null?void 0:o.rate)||"",costPerComponent:(o==null?void 0:o.costPerComponent)||"",totalEmbroidry:(o==null?void 0:o.totalEmbroidry)||0,noOfItemPerThaan:(o==null?void 0:o.noOfItemPerThaan)||0,noOfStichesPerYard:(o==null?void 0:o.noOfStichesPerYard)||0,amountPerYard:(o==null?void 0:o.amountPerYard)||0,totalPcs:(o==null?void 0:o.totalPcs)||0,laserCut:(o==null?void 0:o.laserCut)||!1,laserCutRate:(o==null?void 0:o.laserCutRate)||0,pcsForLaserCut:(o==null?void 0:o.pcsForLaserCut)||0,totalAmount:(o==null?void 0:o.totalAmount)||0,createdOn:(o==null?void 0:o.createdOn)||new Date().toISOString(),createdBy:(o==null?void 0:o.createdBy)||u.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId})},[o]);const[R,n]=a.useState(!1),N=(p,c)=>{n(!R)},[$,Y]=a.useState(!1),{data:U}=ye(),[O,E]=a.useState(""),{data:H}=Ce(),{data:Q,refetch:S}=Se(O,{skip:!O}),{data:A,refetch:Z}=Re(i.designId,{skip:!i.designId}),{data:T}=Ee({batchNo:i.planningHeaderId,componentId:i.componentId},{skip:!i.planningHeaderId||!i.componentId}),{data:M}=Be({batchNo:i.planningHeaderId,componentId:i.componentId,fabricId:i.fabricId},{skip:!i.planningHeaderId||!i.componentId||!i.fabricId}),{data:X,refetch:G}=Ve(i.planningHeaderId,{skip:!i.planningHeaderId}),{data:j}=Me(i.planningHeaderId,{skip:!i.planningHeaderId});console.log("formData.planningHeaderId",i.planningHeaderId),console.log("collectionData",U),console.log("schiffliList",X);const[W,_]=a.useState([]),[te,ue]=a.useState([]),[pe,le]=a.useState([]),[oe,ge]=a.useState([]),[se,ne]=a.useState([]),[F,z]=a.useState([]),[ae,de]=a.useState([]),[q,B]=a.useState([]),[L,fe]=a.useState([]);a.useEffect(()=>{Q&&_(Q.result)},[Q]),a.useEffect(()=>{A&&ue(A.result)},[A]),a.useEffect(()=>{T&&le(T.result)},[T]),a.useEffect(()=>{M&&de(T.result)},[M]),a.useEffect(()=>{j&&fe(j.result)},[j]),a.useEffect(()=>{X&&B(X.result.map((p,c)=>({id:c,...p})))},[X,G]),a.useEffect(()=>{if(H){const p=H.result[0];ge(p.vendorList),ne(p.operatingMachineList),z(p.workingHeadList)}},[H]),console.log("initialRows",q);const ce=(U==null?void 0:U.result)||[];a.useEffect(()=>{const p=()=>{const k=parseFloat(i.thaanQty)||0,re=parseFloat(i.operatingMachine)||0;return(k*re).toFixed(2)};m(k=>({...k,totalEmbroidry:p()}));const c=()=>{const k=parseFloat(i.thaanQty)||0,re=parseFloat(i.noOfStichesPerYard)||0;return(k*re).toFixed(2)};m(k=>({...k,totalPcs:c()}));const v=()=>{const k=parseFloat(i.noOfStichesPerYard)||0,re=parseFloat(i.rate)||0;return(k/1e3*re).toFixed(2)};m(k=>({...k,amountPerYard:v()}));const b=()=>{const k=parseFloat(i.totalAmount)||0,re=parseFloat(i.totalPcs)||0;return(k/re).toFixed(2)};m(k=>({...k,costPerComponent:b()}));const P=()=>{const k=parseFloat(i.amountPerYard)||0,re=parseFloat(i.totalEmbroidry)||0,Ue=parseFloat(i.laserCutRate)||0,Le=parseFloat(i.pcsForLaserCut)||0;return(k*re+Le*Ue).toFixed(2)};m(k=>({...k,totalAmount:P()}))},[i.thaanQty,i.operatingMachine,i.noOfStichesPerYard,i.rate,i.totalAmount,i.totalPcs,i.amountPerYard,i.totalEmbroidry,i.laserCutRate,i.pcsForLaserCut]);const K=p=>{const{name:c,checked:v}=p.target;m(b=>({...b,[c]:v}))},f=p=>{const{name:c,value:v}=p.target;if(c==="collectionId")ce.find(b=>b.collectionId===parseInt(v)),E(v),Y(!0),m({...i,collectionId:v});else if(c==="designId"){const b=W.find(P=>P.designId===parseInt(v));m({...i,designId:v,baseColorId:b?b.colorId:"",baseColorName:b?b.colorName:""})}else if(c==="batchNo"){const b=te.find(P=>P.batchNo===v);m({...i,batchNo:v,planningHeaderId:b?b.planningHeaderId:"",poPcs:b?b.poPcs:""}),n(!0),Y(!1)}else if(c==="colorId"){const b=ae.find(P=>P.colorId===v);m({...i,colorId:v,availableQty:b?b.total:"",cuttingSize:b?b.cuttingSize:"",repeats:b?b.repeats:""})}else if(c==="operatingMachineId"){const b=se.find(P=>P.lookUpId===v);m({...i,operatingMachineId:v,operatingMachine:b?b.lookUpName:""})}else m({...i,[c]:v})};console.log("colors",ae);const[I,h]=a.useState({}),x=async()=>{const p=d();if(Object.keys(p).length>0){h(p);return}try{const c=await ie.post("https://gecxc.com:4041/api/Schiffli/SaveSchiffili",i);console.log("Save response:",c.data),c.data.success?s("Fabrication saved successfully!",{variant:"success",autoHideDuration:5e3}):(s(`${c.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",c.data.message)),m(v=>({designId:v.designId,planningHeaderId:v.planningHeaderId,batchNo:v.batchNo,baseColorName:v.baseColorName,schiffiliId:0,componentId:"",poPcs:v.poPcs,fabricId:"",vendorId:"",colorId:"",availableQty:"",thaanQty:0,operatingMachineId:0,operatingMachine:"",workingHeadId:0,cuttingSize:"",rate:"",costPerComponent:"",totalEmbroidry:0,noOfItemPerThaan:0,noOfStichesPerYard:0,amountPerYard:0,totalPcs:0,laserCut:!1,laserCutRate:0,pcsForLaserCut:0,totalAmount:0,createdOn:new Date().toISOString(),createdBy:u.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:u.empId})),G(),n(!1)}catch(c){console.error("Error saving data:",c),s("Dyeing not saved successfully!",{variant:"error",autoHideDuration:5e3})}},d=()=>{const p={};return i.fabricId||(p.fabricId="fabricId is required"),i.colorId||(p.colorId="colorId is required"),i.vendorId||(p.vendorId="vendorId is required"),i.componentId||(p.componentId="componentId is required"),i.thaanQty||(p.thaanQty="thaanQty is required"),i.workingHeadId||(p.workingHeadId="workingHeadId is required"),i.rate||(p.rate="rate is required"),i.operatingMachineId||(p.operatingMachineId="operatingMachineId is required"),i.noOfStichesPerYard||(p.noOfStichesPerYard="noOfStichesPerYard is required"),i.noOfItemPerThaan||(p.noOfItemPerThaan="noOfItemPerThaan is required"),p};console.log("formData",i);const g=[{field:"componentName",headerName:"Component"},{field:"fabricName",headerName:"Fabric"},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"No. Of Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"No. Of Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry"},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Pcs.For Laser Cut"}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:Ze,sx:{background:"transparent"}}),title:"Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:O,onChange:f,size:"small",children:ce.map(p=>e.jsx(C,{value:p.collectionId,children:p.collectionName},p.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:i.designId,onChange:f,size:"small",children:W.map(p=>e.jsx(C,{value:p.designId,children:p.designNo},p.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:i.batchNo,onChange:f,size:"small",children:te.map(p=>e.jsx(C,{value:p.batchNo,children:p.batchNo},p.batchNo))})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:i.componentId,onChange:f,size:"small",required:!0,error:!!I.componentId,helperText:I.componentId,children:L.map(p=>e.jsx(C,{value:p.componentId,children:p.componentName},p.componentId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:i.baseColorName,onChange:f,disabled:!0})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ne,{}),title:"Add Schiffli ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Pe,{onClick:N,children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(Ae,{expanded:R,onChange:N,sx:{},children:[e.jsx(ke,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Oe,{children:e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:i.fabricId,onChange:f,required:!0,error:!!I.fabricId,helperText:I.fabricId,children:pe.map(p=>e.jsx(C,{value:p.fabricId,children:p.fabric},p.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:i.vendorId,onChange:f,required:!0,error:!!I.vendorId,helperText:I.vendorId,children:oe.map(p=>e.jsx(C,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:i.colorId,onChange:f,required:!0,error:!!I.colorId,helperText:I.colorId,children:ae.map(p=>e.jsx(C,{value:p.colorId,children:p.color},p.colorId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:i.poPcs,disabled:!0,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Available Quantity",fullWidth:!0,size:"small",name:"availableQty",value:i.availableQty,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Thaan Quantity",fullWidth:!0,type:"number",size:"small",name:"thaanQty",value:i.thaanQty,onChange:f,required:!0,error:!!I.thaanQty,helperText:I.thaanQty})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"operatingMachineId",defaultValue:"",size:"small",name:"operatingMachineId",value:i.operatingMachineId,onChange:f,required:!0,error:!!I.operatingMachineId,helperText:I.operatingMachineId,children:se.map(p=>e.jsx(C,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{fullWidth:!0,select:!0,label:"workingHeadId",defaultValue:"",size:"small",name:"workingHeadId",value:i.workingHeadId,onChange:f,required:!0,error:!!I.workingHeadId,helperText:I.workingHeadId,children:F.map(p=>e.jsx(C,{value:p.lookUpId,children:p.lookUpName},p.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cutting Size",fullWidth:!0,type:"number",size:"small",name:"cuttingSize",value:i.cuttingSize,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate",type:"number",fullWidth:!0,size:"small",name:"rate",value:i.rate,onChange:f,required:!0,error:!!I.rate,helperText:I.rate})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"No. Of Stiches Per Yard",fullWidth:!0,type:"number",size:"small",name:"noOfStichesPerYard",value:i.noOfStichesPerYard,onChange:f,required:!0,error:!!I.noOfStichesPerYard,helperText:I.noOfStichesPerYard})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"No. Of Items Per Thaan",fullWidth:!0,size:"small",type:"number",name:"noOfItemPerThaan",value:i.noOfItemPerThaan,onChange:f,required:!0,error:!!I.noOfItemPerThaan,helperText:I.noOfItemPerThaan})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Embroidry",fullWidth:!0,size:"small",name:"totalEmbroidry",type:"number",value:i.totalEmbroidry,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Amount Per Yard",fullWidth:!0,type:"number",size:"small",name:"amountPerYard",value:i.amountPerYard,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Pcs",fullWidth:!0,size:"small",name:"totalPcs",value:i.totalPcs,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",name:"costPerComponent",value:i.costPerComponent,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,size:"small",type:"number",name:"totalAmount",value:i.totalAmount,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(Qe,{control:e.jsx(Ge,{checked:i.laserCut,onChange:K,name:"laserCut"}),label:"Laser Cut"})}),i.laserCut?e.jsx(r,{item:!0,xs:12,md:4.5,children:e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(l,{label:"Laser Cut Rate",fullWidth:!0,size:"small",name:"laserCutRate",value:i.laserCutRate,onChange:f})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(l,{label:"Pcs For LaserCut",fullWidth:!0,size:"small",name:"pcsForLaserCut",value:i.pcsForLaserCut,onChange:f})})]})}):null,e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ee,{variant:"contained",size:"small",onClick:x,children:"Save"})})]})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"View Schiffli ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(r,{sx:{marginTop:2},item:!0,xs:12,children:$?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:qe,alt:"Loading",style:{width:200,height:200}})}):e.jsx(ze,{iColumns:g,initialRows:q,setInitialData:t,deleteApi:"https://gecxc.com:4041/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"schiffiliId",refetch:G,setAccordionExpanded:n,fileName:"Schffili List"})})})]})]})},Pt=St,Nt=()=>{const[u,s]=a.useState([]),[o,t]=a.useState({additionalProcessId:0,designId:"",planningHeaderId:0,batchNo:"",componentId:"",colorId:"",fabricId:"",vendorId:"",baseColorName:"",poPcs:"",pcsPerComponent:"",processTypeId:"",quantity:"",ratePerPcs:0,totalAmount:0,costPerComponent:"",createdOn:new Date().toISOString(),createdBy:0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0});a.useEffect(()=>{t({additionalProcessId:(u==null?void 0:u.additionalProcessId)||0,designId:(u==null?void 0:u.designId)||"",planningHeaderId:(u==null?void 0:u.planningHeaderId)||0,batchNo:(u==null?void 0:u.batchNo)||"",componentId:(u==null?void 0:u.componentId)||"",vendorId:(u==null?void 0:u.vendorId)||"",fabricId:(u==null?void 0:u.fabricId)||"",colorId:(u==null?void 0:u.colorId)||"",poPcs:(u==null?void 0:u.poPcs)||"",baseColorName:(u==null?void 0:u.baseColorName)||"",pcsPerComponent:(u==null?void 0:u.baseColorName)||"",processTypeId:(u==null?void 0:u.processTypeId)||"",quantity:(u==null?void 0:u.quantity)||"",ratePerPcs:(u==null?void 0:u.ratePerPcs)||0,totalAmount:(u==null?void 0:u.totalAmount)||0,costPerComponent:(u==null?void 0:u.costPerComponent)||"",createdOn:(u==null?void 0:u.createdOn)||new Date().toISOString(),createdBy:(u==null?void 0:u.createdBy)||0,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:0})},[u]);const[i,m]=a.useState(!1),R=(f,I)=>{m(!i)},{data:n}=ye(),[N,$]=a.useState(""),{data:Y}=Ce(),{data:U,refetch:O}=Se(N,{skip:!N}),{data:E,refetch:H}=Re(o.designId,{skip:!o.designId}),{data:Q}=Ee({batchNo:o.planningHeaderId,componentId:o.componentId},{skip:!o.planningHeaderId||!o.componentId}),{data:S}=Be({batchNo:o.planningHeaderId,componentId:o.componentId,fabricId:o.fabricId},{skip:!o.planningHeaderId||!o.componentId||!o.fabricId}),{data:A,refetch:Z}=Ve(o.planningHeaderId,{skip:!o.planningHeaderId}),{data:T}=Me(o.planningHeaderId,{skip:!o.planningHeaderId});console.log("formData.planningHeaderId",o.planningHeaderId),console.log("collectionData",n),console.log("schiffliList",A);const[M,X]=a.useState([]),[G,j]=a.useState([]),[W,_]=a.useState([]),[te,ue]=a.useState([]),[pe,le]=a.useState([]),[oe,ge]=a.useState([]),[se,ne]=a.useState([]),[F,z]=a.useState([]),[ae,de]=a.useState([]);console.log("batchData",E),a.useEffect(()=>{U&&X(U.result)},[U]),a.useEffect(()=>{E&&j(E.result)},[E]),a.useEffect(()=>{Q&&_(Q.result)},[Q]),a.useEffect(()=>{S&&ne(Q.result)},[S]),a.useEffect(()=>{T&&de(T.result)},[T]),a.useEffect(()=>{A&&z(A.result.map((f,I)=>({id:I,...f})))},[A,Z]),a.useEffect(()=>{if(Y){const f=Y.result[0];ue(f.vendorList),le(f.operatingMachineList),ge(f.workingHeadList)}},[Y]),console.log("initialRows",F);const q=(n==null?void 0:n.result)||[],B=o.pcsPerComponent;a.useEffect(()=>{const f=()=>{const x=parseFloat(o.quantity)||0;return B-x};t(x=>({...x,pcsPerComponent:f()}));const I=()=>{const x=parseFloat(o.quantity)||0,d=parseFloat(o.ratePerPcs)||0;return(x*d).toFixed(2)};t(x=>({...x,totalAmount:I()}));const h=()=>{const x=parseFloat(o.totalAmount)||0,d=parseFloat(o.poPcs)||0;return(x/d).toFixed(2)};t(x=>({...x,costPerComponent:h()}))},[o.quantity,o.ratePerPcs,o.totalAmount,o.poPcs]);const L=f=>{const{name:I,value:h}=f.target;if(I==="collectionId")q.find(x=>x.collectionId===parseInt(h)),$(h),t({...o,collectionId:h});else if(I==="designId"){const x=M.find(d=>d.designId===parseInt(h));t({...o,designId:h,baseColorId:x?x.colorId:"",baseColorName:x?x.colorName:""})}else if(I==="batchNo"){const x=G.find(d=>d.batchNo===h);t({...o,batchNo:h,planningHeaderId:x?x.planningHeaderId:"",poPcs:x?x.poPcs:""}),m(!0)}else t({...o,[I]:h})};console.log("colors",se);const fe=async()=>{console.log("formData",o)};console.log("formData",o);const ce=[{field:"componentName",headerName:"Component"},{field:"fabricName",headerName:"Fabric"},{field:"vendorName",headerName:"Vendor"},{field:"colourName",headerName:"Color"},{field:"thaanQty",headerName:"Thaan Quantity"},{field:"availableQty",headerName:"Available Quantitity"},{field:"operatingMachineName",headerName:"Operating Machine"},{field:"noOfHeadsName",headerName:"Working Head"},{field:"cuttingSize",headerName:"Cutting Size"},{field:"rate",headerName:"Rate"},{field:"noOfStichesPerYard",headerName:"No. Of Stiches Per Yard"},{field:"noOfItemPerThaan",headerName:"No. Of Item Per Thaan"},{field:"totalEmbroidry",headerName:"Total Embroidry"},{field:"amountPerYard",headerName:"Amount Per Yard"},{field:"totalPcs",headerName:"Total Pcs"},{field:"totalAmount",headerName:"Total Amount"},{field:"costPerComponent",headerName:"Cost Per Component"},{field:"laserCutRate",headerName:"LaserCut Rate"},{field:"pcsForLaserCut",headerName:"Pcs.For Laser Cut"}];return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(We,{src:Ze,sx:{background:"transparent"}}),title:"Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:N,onChange:L,size:"small",children:q.map(f=>e.jsx(C,{value:f.collectionId,children:f.collectionName},f.collectionId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Design",name:"designId",value:o.designId,onChange:L,size:"small",children:M.map(f=>e.jsx(C,{value:f.designId,children:f.designNo},f.designId))})}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Batch No.",name:"batchNo",value:o.batchNo,onChange:L,size:"small",children:G.map(f=>e.jsx(C,{value:f.batchNo,children:f.batchNo},f.batchNo))})," "]}),e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsx(l,{fullWidth:!0,select:!0,label:"Components",name:"componentId",value:o.componentId,onChange:L,size:"small",children:ae.map(f=>e.jsx(C,{value:f.componentId,children:f.componentName},f.componentId))})," "]}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{label:"Base Color",fullWidth:!0,size:"small",name:"baseColorName",value:o.baseColorName,onChange:L,disabled:!0})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Ne,{}),title:"Add Additional Process ",titleTypographyProps:{style:{color:"white"}},action:e.jsx(Pe,{onClick:R,children:e.jsx(he,{style:{color:"white"}})}),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"}})," ",e.jsxs(Ae,{expanded:i,onChange:R,sx:{},children:[e.jsx(ke,{expandIcon:e.jsx(he,{}),"aria-controls":"panel1-content",id:"panel1-header",sx:{display:"none"}}),e.jsx(Oe,{children:e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Fabric",defaultValue:"",size:"small",name:"fabricId",value:o.fabricId,onChange:L,children:W.map(f=>e.jsx(C,{value:f.fabricId,children:f.fabric},f.fabricId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendors",defaultValue:"",size:"small",name:"vendorId",value:o.vendorId,onChange:L,children:te.map(f=>e.jsx(C,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Color",size:"small",name:"colorId",value:o.colorId,onChange:L,children:se.map(f=>e.jsx(C,{value:f.colorId,children:f.color},f.colorId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Po Pcs",fullWidth:!0,size:"small",name:"poPcs",value:o.poPcs,onChange:L,disabled:!0})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Pcs. Per Component",fullWidth:!0,size:"small",name:"pcsPerComponent",value:o.pcsPerComponent,onChange:L})}),e.jsx(r,{item:!0,xs:12,md:3,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Process Type",defaultValue:"",size:"small",name:"processTypeId",value:o.processTypeId,onChange:L,children:pe.map(f=>e.jsx(C,{value:f.lookUpId,children:f.lookUpName},f.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Quantity",fullWidth:!0,type:"number",size:"small",name:"quantity",value:o.quantity,onChange:L})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Rate Per Pcs",type:"number",fullWidth:!0,size:"small",name:"ratePerPcs",value:o.ratePerPcs,onChange:L})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Total Amount",fullWidth:!0,type:"number",size:"small",name:"totalAmount",value:o.totalAmount,onChange:L})}),e.jsx(r,{item:!0,xs:12,md:1.5,children:e.jsx(l,{label:"Cost Per Component",fullWidth:!0,size:"small",type:"number",name:"costPerComponent",value:o.costPerComponent,onChange:L})}),e.jsx(r,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(ee,{variant:"contained",size:"small",onClick:fe,children:"Save"})})]})})]})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",avatar:e.jsx(Te,{}),title:"View Additional Process ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:e.jsx(r,{sx:{marginTop:2},item:!0,xs:12,children:e.jsx(ze,{iColumns:ce,initialRows:F,setInitialData:s,deleteApi:"https://gecxc.com:4041/api/Schiffli/DeleteSchiffiById?schiffiId=",deleteBy:"additionalProcessId",refetch:Z,setAccordionExpanded:m,fileName:"AdditionalProcess"})})})]})]})},At=Nt;function kt({onSaveSuccess:u}){const{data:s}=Ce(),[o,t]=a.useState([]),[i,m]=a.useState([]),[R,n]=a.useState([]),[N,$]=a.useState([]),[Y,U]=a.useState([]);a.useEffect(()=>{s&&(n(s.result[0].vendorList),m(s.result[0].serviceList),t(s.result[0].serviceTypeList),U(s.result[0].uomList))},[s]);const[O,E]=a.useState({collectionId:"",serviceTypeId:0,serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:"",uom:"",createdBy:0,createdOn:new Date().toISOString()}),H=async S=>{const{name:A,value:Z}=S.target;if(console.log(`Updating ${A} to ${Z}`),E({...O,[A]:Z}),A==="collectionId"){const T=N.find(M=>M.collectionId===Z);T&&E(M=>({...M,poPcs:T.poPcs}))}},Q=async()=>{const S={...O,serviceTypeId:0};console.log(S);try{const A=await ie.post("https://gecxc.com:4041/api/AdditionalServices/SaveAdditionalServices",S);console.log("Form data saved:",A.data),E({collectionId:"",serviceTypeId:0,serviceListId:"",vendorId:"",poPcs:"",qty:"",uomId:"string",rate:"",totalAmount:"",costperPiece:""}),u&&u()}catch(A){console.error("Error saving data:",A)}};return a.useEffect(()=>{(async()=>{try{const A=await ie.get("https://gecxc.com:4041/api/CollectionRegistration/GetCollectionList?appId=1");console.log("GetCollectionFromPlanningHeader",A),$(A.data.result)}catch(A){console.error("Error fetching design options:",A)}})()},[]),e.jsxs(r,{container:!0,spacing:2,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Select Collection",name:"collectionId",value:O.collectionId,onChange:H,size:"small",children:N.length>0?N.map(S=>e.jsx(C,{id:"collectionId",value:S.collectionId,children:S.collectionName},S.collectionId)):e.jsx(C,{disabled:!0,children:"No Collections Available"})})}),e.jsx(r,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service Type",name:"serviceTypeId",value:O.serviceTypeId,onChange:H,variant:"outlined",size:"small",fullWidth:!0,children:o.map(S=>e.jsx(C,{value:S.lookUpId,children:S.lookUpName},S.lookUpId))})}),e.jsx(r,{item:!0,md:4,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-select-option",select:!0,label:"Service List Id",name:"serviceListId",value:O.serviceListId,onChange:H,variant:"outlined",size:"small",fullWidth:!0,children:i.map(S=>e.jsx(C,{value:S.lookUpId,children:S.lookUpName},S.lookUpId))})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsx(l,{fullWidth:!0,select:!0,label:"Vendor Name",size:"small",name:"vendorId",value:O.vendorId,onChange:H,children:R.map(S=>e.jsx(C,{value:S.lookUpId,children:S.lookUpName},S.lookUpId))})}),e.jsx(r,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"PO PC's",name:"poPcs",value:O.poPcs,onChange:H,type:"number",size:"small",fullWidth:!0,disabled:!0})}),e.jsx(r,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Qty",name:"qty",value:O.qty,onChange:H,type:"number",size:"small",required:!0,fullWidth:!0})}),e.jsx(r,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{fullWidth:!0,select:!0,label:"UOM",defaultValue:"",size:"small",name:"uomId",value:O.uomId,onChange:H,children:Y.map(S=>e.jsx(C,{value:S.lookUpId,children:S.lookUpName},S.lookUpId))})}),e.jsx(r,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Rate",name:"rate",value:O.rate,onChange:H,type:"number",size:"small",fullWidth:!0,required:!0})}),e.jsx(r,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Total Amount",name:"totalAmount",value:O.totalAmount,onChange:H,type:"number",size:"small",fullWidth:!0,required:!0})}),e.jsx(r,{item:!0,md:2,width:"inherit",paddingX:1,children:e.jsx(l,{id:"outlined-required",label:"Cost per Piece",name:"costperPiece",value:O.costperPiece,onChange:H,type:"number",size:"small",required:!0,fullWidth:!0})}),e.jsx(r,{item:!0,md:12,width:"inherit",paddingX:1,textAlign:"right",children:e.jsx(ee,{variant:"contained",color:"primary",size:"small",onClick:Q,children:"Save"})})]})}function Ot(){const[u,s]=a.useState([]),o=a.useCallback(async()=>{try{const m=(await ie.get("https://gecxc.com:4041/api/AdditionalServices/GetdditionalServicesListByServiceTypeId?serviceTypeId=1")).data.result.map((R,n)=>({id:n,...R}));s(m)}catch(i){console.error("Error fetching data:",i)}},[]);a.useEffect(()=>{o()},[o]);const t=[{field:"serviceTypeId",headerName:"Service Type",width:150},{field:"serviceList",headerName:"Service List",width:200},{field:"vendorId",headerName:"Vendor",minWidth:120},{field:"qty",headerName:"Qty",minWidth:120},{field:"uom",headerName:"UOM",minWidth:120},{field:"rate",headerName:"Rate",minWidth:120},{field:"totalAmount",headerName:"Total Amount",minWidth:120},{field:"uomId",headerName:"UOM Id",minWidth:120},{field:"quantity",headerName:"quantity",minWidth:120},{field:"ratePerPcs",headerName:"rate Per Pcs",minWidth:120},{field:"costperPiece",headerName:"cost per Piece",minWidth:120},{field:"vendor",headerName:"Vendor",minWidth:120},{field:"serviceType",headerName:"Service Type",minWidth:120},{field:"serviceListName",headerName:"Service List Name",minWidth:120}];return e.jsx("div",{style:{height:"auto",width:"100%"},children:e.jsx(it,{rows:u,columns:t,autoHeight:!0,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10,15],localeText:{toolbarDensity:"Size",toolbarDensityLabel:"Size",toolbarDensityCompact:"Small",toolbarDensityStandard:"Medium",toolbarDensityComfortable:"Large"},components:{Toolbar:ut}})})}function Tt(u){return e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",title:"Additional Services  ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(kt,{})]}),e.jsx(me,{color:"#cc8587",sx:{height:1,width:"100%",mt:2}}),e.jsxs(V,{variant:"outlined",children:[e.jsx(J,{className:"css-4rfrnx-MuiCardHeader-root",title:"View Additional Services  ",titleTypographyProps:{style:{color:"white"}}}),e.jsx(Ot,{fetchData:u})]})]})}const we=["Pre Planning","Fabrication","Dyeing/Printing  ","Embroidery ","Schiffli","Additional Process","Additional Services"];function Et(){const[u,s]=a.useState(0),[o,t]=a.useState(new Set),[i,m]=a.useState(null),[R,n]=a.useState([]),{enqueueSnackbar:N}=je(),$=j=>{m(j.currentTarget)},Y=()=>{m(null)},U=!!i,O=U?"simple-popover":void 0,E=j=>j===1,H=j=>o.has(j),Q=()=>{let j=o;H(u)&&(j=new Set(j.values()),j.delete(u)),s(W=>W+1),t(j)},S=()=>{s(j=>j-1)},A=()=>{if(!E(u))throw new Error("You can't skip a step that isn't optional.");s(j=>j+1),t(j=>{const W=new Set(j.values());return W.add(u),W})},Z=()=>{s(0)},[T,M]=a.useState({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),X=async()=>{if(!T.lookUpDomain||!T.lookUpName){N("Please fill in all required fields.",{variant:"error",autoHideDuration:5e3});return}try{const j=await ie.get(`https://gecxc.com:4041/api/Common/SaveLookUp?lookupDomain=${T.lookUpDomain}&LookUpName=${T.lookUpName}&appId=1`);return console.log("Form data saved:",j.data),N("Lookup saved successfully!",{variant:"success",autoHideDuration:5e3}),M({lookUpId:"",lookUpName:"",lookUpDomain:"",lookUpCategory:"",enabled:"",createdOn:new Date().toISOString()}),j.data}catch(j){throw console.error("Error saving data:",j),N("Error saving data. Please try again.",{variant:"error",autoHideDuration:5e3}),j}},G=j=>{M({...T,[j.target.name]:j.target.value})};return a.useEffect(()=>{(async()=>{try{const W=await ie.get("https://gecxc.com:4041/api/Common/GetLookUpDomains?appId=1");console.log("LookupData",W),n(W.data.result)}catch(W){console.error("Error fetching design options:",W)}})()},[]),e.jsxs(be,{sx:{width:"100%"},children:[e.jsxs(r,{container:!0,spacing:1,width:"Inherit",children:[e.jsx(r,{item:!0,sm:6,children:e.jsx(ve,{variant:"h2",gutterBottom:!0,children:"Planning Process"})}),e.jsxs(r,{item:!0,sm:6,textAlign:"right",children:[e.jsx(ee,{"aria-describedby":O,variant:"outlined",size:"small",onClick:$,children:"+Lookup"}),e.jsx(ct,{id:"mouse-over-popover",open:U,anchorEl:i,onClose:Y,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{".MuiPopover-paper":{width:"300px",padding:"16px"}},children:e.jsxs(r,{container:!0,spacing:3,width:"Inherit",children:[e.jsx(r,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,id:"outlined-select-currency",select:!0,label:"Select Lookup",size:"small",value:T.lookUpDomain,name:"lookUpDomain",onChange:G,children:R.map(j=>e.jsx(C,{value:j.lookUpDomain,children:j.lookUpDomain},j.lookUpDomain))})}),e.jsx(r,{item:!0,sm:12,children:e.jsx(l,{fullWidth:!0,label:"Add Lookup Description",value:T.lookUpName,onChange:G,name:"lookUpName",size:"small"})}),e.jsx(r,{item:!0,sm:3,textAlign:"right",children:e.jsx(ee,{variant:"contained",size:"small",onClick:X,children:"Save"})})]})})]})]}),e.jsx(nt,{activeStep:u,children:we.map((j,W)=>{const _={},te={};return E(W)&&(te.optional=e.jsx(ve,{variant:"caption",children:"Optional"})),H(W)&&(_.completed=!1),e.jsx(at,{..._,children:e.jsxs(lt,{...te,onClick:()=>s(W),style:{cursor:"pointer"},children:[" ",j]})},j)})}),e.jsxs(be,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ee,{color:"inherit",disabled:u===0,onClick:S,sx:{mr:1},children:"Back"}),e.jsx(be,{sx:{flex:"1 1 auto"}}),E(u)&&e.jsx(ee,{color:"inherit",onClick:A,sx:{mr:1},children:"Skip"}),e.jsx(ee,{onClick:Q,children:u===we.length-1?"Finish":"Next"})]}),u===we.length?e.jsxs(a.Fragment,{children:[e.jsx(ve,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),e.jsxs(be,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(be,{sx:{flex:"1 1 auto"}}),e.jsx(ee,{onClick:Z,children:"Reset"})]})]}):e.jsxs(a.Fragment,{children:[u===0&&e.jsx(vt,{}),u===1&&e.jsx(dt,{}),u===2&&e.jsx(Ct,{}),u===3&&e.jsx(It,{}),u===4&&e.jsx(Pt,{}),u===5&&e.jsx(At,{}),u===6&&e.jsx(Tt,{}),e.jsxs(be,{sx:{display:"flex",flexDirection:"row",pt:2},children:[e.jsx(ee,{color:"inherit",disabled:u===0,onClick:S,sx:{mr:1},children:"Back"}),e.jsx(be,{sx:{flex:"1 1 auto"}}),E(u)&&e.jsx(ee,{color:"inherit",onClick:A,sx:{mr:1},children:"Skip"}),e.jsx(ee,{onClick:Q,children:u===we.length-1?"Finish":"Next"})]})]})]})}export{Et as default};
