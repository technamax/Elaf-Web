import{u as se,c as re,ab as ne,b as de,z as ce,A as ue,j as e,G as l,e as me,ac as fe,n as pe,N as he,B as q,C as xe,d as ge,T as H,Q as je,M as be}from"./index-k9GWQJOu.js";import{r as s}from"./vendor-BXCbSo2_.js";import{d as ye}from"./CategoryOutlined-MdM7JIJy.js";import{d as L}from"./AssignmentOutlined-DQJc0R_Q.js";import"./ReceivingDetails-DOjPavAN.js";import{R as oe,a as M,b as $,c as U,d as V,B as Ie}from"./ReuseableDataGrid-D6KGNruf.js";import{d as X}from"./Close-CwC_dym4.js";import te from"./Reports-BgemgIcq.js";import{B as w,a as Ne,I as Y}from"./axios-CaswPiu6.js";import{T as u}from"./TextField-Bw61L3Ab.js";import{S as _}from"./StatusChip-DQNIzaKK.js";import{M as ae}from"./MenuItem-BJ2KxKJk.js";import{T as ve,a as Ce,b as R,c as I}from"./TabPanel-CYIvsX5V.js";import"./Skeleton-C1-xTFDk.js";const Se=({iss:r,handleClose:n,refetchData:c})=>{const{user:x}=se(),[d,m]=s.useState({grnHeader:{grnId:0,grnNumber:"",...r,createdBy:x.empId,remarks:"",totalQuantity:r.gradeAQty,totalValue:r.gradeAQty*r.rate}}),{enqueueSnackbar:f}=re(),[g,j]=s.useState([]),[o,G]=s.useState([]),[J,D]=s.useState([]),[k,A]=s.useState([]),[P,W]=s.useState([]),{data:p,refetch:z}=ne(r.inspectionId,{skip:!r.inspectionId}),{data:b,refetch:K}=de(),{data:y,refetch:O}=ce(),{data:N,refetch:v}=ue();s.useEffect(()=>{if((p==null?void 0:p.result)===null){j([]);return}p&&j(p.result.map((t,i)=>({id:i+1,...t})))},[p,z]),s.useEffect(()=>{y&&A(y.result.map((t,i)=>({id:i+1,...t})))},[y,O]),s.useEffect(()=>{N&&W(N.result.map((t,i)=>({id:i+1,...t})))},[N,v]),s.useEffect(()=>{b&&(G(b.result[0].destination.map((t,i)=>({id:i+1,...t}))),D(b.result[0].dispatchFrom.map((t,i)=>({id:i+1,...t}))))},[b]),console.log("iss",r),console.log("formData",d),console.log("GRNList",g),console.log("dispatchFromList",J);const Q=t=>{const{name:i,value:B}=t.target;m(F=>({...F,grnHeader:{...F.grnHeader,[i]:B}}))},C=g.map(t=>({...t,grnId:0,grnItemId:0,total:t.gradeAQty*t.rate,acceptedQty:t.gradeAQty,grnaQty:t.gradeAQty,grnbQty:t.gradeBQty,grncpQty:t.gradeCPQty,bGradetotal:t.gradeBQty*t.rate*t.bGradeRate}));console.log("calRows",C),s.useEffect(()=>{m({...d,grnDetailsList:[...C]})},[g]),console.log("formData",d);const S=[{field:"id",headerName:"Sr#"},{field:"designNo",headerName:"Design"},{field:"fabricName",headerName:"Fabric"},{field:"colorName",headerName:"Color"},{field:"gradeAQty",headerName:"Grade A"},{field:"rate",headerName:"Rate"},{field:"total",headerName:"Total"},{field:"gradeBQty",headerName:"Grade B"},{field:"bGradeRate",headerName:"BGrade Rate",valueGetter:(t,i)=>t*i.rate},{field:"bGradetotal",headerName:"BGradeTotal",renderCell:t=>t.row.bGradetotal.toLocaleString()},{field:"gradeCPQty",headerName:"GradeCP"},{field:"rejectedQty",headerName:"Rejected",renderCell:t=>e.jsx(me,{label:t.value.toLocaleString(),sx:{backgroundColor:"#FF0000",color:"#FFFFFF"}})},{field:"remarks",headerName:"Remarks"},{field:"shortageQty",headerName:"Shortage"}],T=async()=>{try{const t=await Ne.post("http://100.42.177.77:8091/api/GRN/SaveGRN",d);c(),t.data.success?f(`${t.data.message} !`,{variant:"success",autoHideDuration:5e3}):(f(`${t.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",t.data.message)),console.log("Save response:",t.data),n()}catch(t){console.error("Error saving data:",t),f("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};return e.jsxs("div",{children:[e.jsxs(l,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,disabled:!0,label:"Production",name:"productionId",value:r.collectionName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,disabled:!0,label:"PO",name:"poName",value:r.poName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,disabled:!0,label:"Issuance",name:"issuanceId",value:r.issuanceId,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,disabled:!0,label:"IGP",name:"igpNumber",value:r.igpNumber,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:1.5,children:e.jsx(u,{fullWidth:!0,disabled:!0,label:"Proces Type",name:"processTypeName",value:r.processTypeName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,disabled:!0,label:"Vendor",name:"vendorName",value:r.vendorName,size:"small"})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(u,{label:"Remarks",fullWidth:!0,size:"small",name:"remarks",onChange:Q,value:d.grnHeader.remarks,required:!0})})]}),e.jsxs(l,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(oe,{initialRows:C,iColumns:S,hideAction:!0})}),e.jsx(l,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(w,{variant:"contained",size:"small",onClick:T,disabled:r.status===9,children:"Save"})})]})]})},Re=()=>{re();const{user:r}=se(),[n,c]=s.useState({issuanceId:"",poId:"",productionId:"",ogpNumber:"",appId:r.appId,createdOn:new Date().toISOString(),createdBy:r.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:r.empId}),[x,d]=s.useState([]),[m,f]=s.useState([]),[g,j]=s.useState([]),{data:o,error:G,isLoading:J,refetch:D}=fe(n.poId,{skip:!n.poId}),{data:k,refetch:A}=pe(),{data:P,refetch:W}=he(n.productionId,{skip:!n.productionId}),[p,z]=s.useState([]);s.useEffect(()=>{k&&z(k.result.map((a,h)=>({id:h,...a})))},[k,A]),s.useEffect(()=>{o&&d(o.result.map((a,h)=>({id:h+1,...a})))},[o,D]),s.useEffect(()=>{P&&f(P.result.map((a,h)=>({id:h+1,...a})))},[P,W]),console.log("polist",m),console.log("initialRows",x);const b=a=>{const{name:h,value:E}=a.target;if(h==="poId"){const ee=m.find(le=>le.poId===parseInt(E));c({...n,poId:E,issuanceId:ee?ee.issuanceId:""})}else c({...n,[h]:E})};console.log("formData",n);const[K,y]=s.useState(!1),[O,N]=s.useState(!1),[v,Q]=s.useState(!1),C=async a=>{Q(a),y(!0)},S=()=>{y(!1)},T=()=>{N(!1)},t=async a=>{j(a.issuanceId)},[i,B]=s.useState(!1),F=async a=>{Q(a),B(!0)},Z=()=>{B(!1)},ie=[{field:"id",headerName:"Sr#"},{field:"issuanceId",headerName:"issuance#"},{field:"poName",headerName:"PO#"},{field:"igpNumber",headerName:"IGP#"},{field:"collectionName",headerName:"Production"},{field:"processTypeName",headerName:"Process"},{field:"rate",headerName:"Rate",renderCell:a=>e.jsx(_,{label:a.row.rate,status:"Pending"})},{field:"gradeAQty",headerName:"GradeA",renderCell:a=>e.jsx(_,{label:a.row.gradeAQty,status:"Received"})},{field:"statusName",headerName:"Status",renderCell:a=>e.jsx(_,{label:a.value,status:a.value})},{field:"Actions",headerName:"Actions",renderCell:a=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(Ie,{variant:"text",size:"small",sx:{mt:1},children:[e.jsx(w,{size:"small",color:"primary",onClick:()=>C(a.row),disabled:a.row.status===3,children:"Receive"}),e.jsx(w,{size:"small",color:"primary",onClick:()=>t(a.row),children:"POST"}),e.jsx(w,{size:"small",color:"primary",onClick:()=>F(a.row),children:"GRN Report"})]})})}];return e.jsx(q,{sx:{width:"100%",typography:"body1"},children:e.jsxs(xe,{variant:"outlined",children:[e.jsx(ge,{className:"css-4rfrnx-MuiCardHeader-root",title:"GRN",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(l,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"Production",name:"productionId",value:n.productionId,onChange:b,size:"small",children:p.map(a=>e.jsx(ae,{value:a.productionId,children:a.collectionName},a.productionId))})}),e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(u,{fullWidth:!0,select:!0,label:"PO#",name:"poId",value:n.poId,onChange:b,size:"small",children:m.map(a=>e.jsx(ae,{value:a.poId,children:a.poIdName},a.poId))})}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx(oe,{initialRows:x,iColumns:ie,hideAction:!0}),e.jsxs(M,{open:K,onClose:S,fullWidth:!0,maxWidth:"xl",children:[e.jsxs($,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(H,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Details"}),e.jsx(Y,{onClick:S,sx:{color:"#ffffff"},children:e.jsx(X,{})})]}),e.jsxs(U,{children:[e.jsx(V,{id:"alert-dialog-slide-description"}),e.jsx(Se,{iss:v,handleClose:S,refetchData:D})]})]}),e.jsxs(M,{open:O,onClose:T,fullWidth:!0,maxWidth:"xl",children:[e.jsxs($,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(H,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx(Y,{onClick:T,sx:{color:"#ffffff"},children:e.jsx(X,{})})]}),e.jsxs(U,{children:[e.jsx(V,{id:"alert-dialog-slide-description"}),e.jsx(te,{rId:14,OGPNumber:v.igpNumber})]})]}),e.jsxs(M,{open:i,onClose:Z,fullWidth:!0,maxWidth:"xl",children:[e.jsxs($,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(H,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Inspection"}),e.jsx(Y,{onClick:Z,sx:{color:"#ffffff"},children:e.jsx(X,{})})]}),e.jsxs(U,{children:[e.jsx(V,{id:"alert-dialog-slide-description"}),e.jsx(te,{rId:18,GRN:{ParamInspectionId:v.inspectionId}})]})]})]})]})]})})},Ee=()=>{var f,g,j;const r=je(),n=(f=r.state)==null?void 0:f.data,c=(j=(g=r.state)==null?void 0:g.tab)==null?void 0:j.toString();console.log("rowData",n),console.log("tab",c);const[x,d]=s.useState("1"),m=(o,G)=>{d(G),console.log("value",x)};return s.useEffect(()=>{c&&d(c)},[c]),e.jsx(be,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(q,{sx:{width:"100%",typography:"body1"},children:e.jsxs(ve,{value:x,children:[e.jsx(q,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Ce,{onChange:m,children:[e.jsx(R,{icon:e.jsx(ye,{}),label:"Dyeing GRN",value:"1",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(R,{icon:e.jsx(L,{}),label:"Embroidery GRN",value:"2",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(R,{icon:e.jsx(L,{}),label:"Schiffili GRN",value:"3",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(R,{icon:e.jsx(L,{}),label:"Additional Process GRN",value:"4",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})}),e.jsx(R,{icon:e.jsx(L,{}),label:"Additional Services GRN",value:"5",sx:o=>({"& .MuiTouchRipple-child":{backgroundColor:`${o.palette.primary.main} !important`}})})]})}),e.jsx(I,{value:"1",children:e.jsx(Re,{})}),e.jsx(I,{value:"2"}),e.jsx(I,{value:"3"}),e.jsx(I,{value:"4"}),e.jsx(I,{value:"5"}),e.jsx(I,{value:"6"})]})})})};export{Ee as default};
