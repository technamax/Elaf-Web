import{s as Y,c as F,u as H,Y as X,j as e,G as n,T as G,Z as q,B as Q,C as _,d as K,$ as Z,M as J}from"./index-CZjWfJ9S.js";import{r as l,R as O}from"./vendor-BXCbSo2_.js";import{d as ee}from"./CategoryOutlined-CkdYBdZt.js";import{d as w}from"./AssignmentOutlined-VGzQRH7X.js";import{d as E}from"./Close-BtpqQMIF.js";import{u as te,D as ae,R as se,a as A,b as W,c as L,d as M,B as ie}from"./ReuseableDataGrid-D1pMcJDs.js";import{B as R,a as re,I as $}from"./axios--CKk_8iX.js";import{T as g}from"./TextField-C0yoPlRE.js";import ne from"./Reports-rF8ASnPI.js";import{T as le,a as oe,b as C,c as j}from"./TabPanel-HMB-4Jgp.js";import"./MenuItem-EYddAVor.js";import"./Skeleton-B3PPDIKO.js";const b=Y(g)(({theme:s})=>({"& .MuiInputBase-input":{fontSize:"0.875rem",padding:"4px 6px"},width:"auto",height:"auto",minWidth:"100px",minHeight:"30px"})),de=({iss:s,handleClose:o,refetchIssuanceData:h})=>{const[u,v]=l.useState({receivingId:0,...s}),y=te(),{enqueueSnackbar:p}=F(),{user:c}=H(),[x,i]=l.useState([]),{data:d,refetch:N}=X(s.issuanceId,{skip:!s.issuanceId});l.useEffect(()=>{if((d==null?void 0:d.result)===null){i([]);return}d&&i(d.result.map((t,a)=>({id:a+1,...t})))},[d,N]),console.log("iss",s);const m=t=>{const{id:a,field:S,value:B}=t;console.log("Editing cell:",t),i(T=>T.map(f=>f.id===a?{...f,[S]:B,receivingId:0,receivingDetId:0,appId:c.appId,createdOn:new Date().toISOString(),createdBy:c.empId,lastUpdatedOn:new Date().toISOString(),lastUpdatedBy:c.empId}:f))};O.useEffect(()=>{v({...u,receivingTransactionsDetailsModelList:x})},[x,i]),console.log("formData",u),console.log("issuanceDetails",x);const k=[{field:"id",headerName:"Sr#"},{field:"fabricName",headerName:"Fabric"},{field:"issuanceQuantity",headerName:"Quantity Issued"},{field:"uomName",headerName:"UOM"},{field:"receivedQty",headerName:"Received qty",renderCell:t=>e.jsx(b,{variant:"outlined",size:"small",sx:{mt:1,width:"100%"},value:t.row.receivedQty||0,onChange:a=>m({id:t.id,field:"receivedQty",value:Number(a.target.value)}),type:"number",InputProps:{style:{fontSize:"0.875rem"}}})},{field:"gradeAQty",headerName:"Grade A",renderCell:t=>e.jsx(b,{variant:"outlined",size:"small",sx:{mt:1,width:"100%"},value:t.row.gradeAQty||0,onChange:a=>m({id:t.id,field:"gradeAQty",value:Number(a.target.value)}),type:"number",InputProps:{style:{fontSize:"0.875rem"}}})},{field:"gradeBQty",headerName:"Grade B",renderCell:t=>e.jsx(b,{variant:"outlined",size:"small",sx:{mt:1,width:"100%"},value:t.row.gradeBQty||0,onChange:a=>m({id:t.id,field:"gradeBQty",value:Number(a.target.value)}),type:"number",InputProps:{style:{fontSize:"0.875rem"}}})},{field:"gradeCPQty",headerName:"Cut Pc",renderCell:t=>e.jsx(b,{variant:"outlined",size:"small",sx:{mt:1,width:"100%"},value:t.row.gradeCPQty||0,onChange:a=>m({id:t.id,field:"gradeCPQty",value:Number(a.target.value)}),type:"number",InputProps:{style:{fontSize:"0.875rem"}}})},{field:"others1Qty",headerName:"Others",renderCell:t=>e.jsx(b,{variant:"outlined",size:"small",sx:{mt:1,width:"100%"},value:t.row.others1Qty||0,onChange:a=>m({id:t.id,field:"others1Qty",value:Number(a.target.value)}),type:"number",InputProps:{style:{fontSize:"0.875rem"}}})},{field:"remarks",headerName:"Remarks",renderCell:t=>e.jsx(b,{variant:"outlined",size:"small",sx:{mt:1,width:"100%"},value:t.row.remarks||"",onChange:a=>m({id:t.id,field:"remarks",value:a.target.value}),InputProps:{style:{fontSize:"0.875rem"}}})}],D=()=>{y.current.autosizeColumns({includeHeaders:!0,includeOutliers:!0})};O.useEffect(()=>{D()});const z=async()=>{try{const t=await re.post("http://100.42.177.77:83/api/Receiving/SaveReceiving",u);h(),t.data.success?p(`${t.data.message} !`,{variant:"success",autoHideDuration:5e3}):(p(`${t.data.message} !`,{variant:"error",autoHideDuration:5e3}),console.log("response.message",t.data.message)),console.log("Save response:",t.data),o()}catch(t){console.error("Error saving data:",t),p("FAILED: Unable to start Process",{variant:"error",autoHideDuration:5e3})}};return e.jsxs("div",{children:[e.jsxs(n,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(g,{fullWidth:!0,disabled:!0,label:"Production",name:"productionId",value:s.collectionName,size:"small"})}),e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(g,{fullWidth:!0,disabled:!0,label:"Process Type",name:"productionId",value:s.processTypeName,size:"small"})}),e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(g,{size:"small",label:"Issuance Date",name:"issuanceDate",value:new Date(s.issuanceDate).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"}),fullWidth:!0,disabled:!0,InputLabelProps:{shrink:!0,sx:{color:"black"}}})}),e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(g,{size:"small",label:"ExpectedReturn Date",name:"expectedReturnDate",value:new Date(s.expectedReturnDate).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"}),fullWidth:!0,disabled:!0,InputLabelProps:{shrink:!0,sx:{color:"black"}}})}),e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(g,{fullWidth:!0,disabled:!0,label:"Vendor",name:"vendorId",value:s.vendorName,size:"small"})})]}),e.jsxs(n,{container:!0,spacing:2,width:"Inherit",children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(G,{variant:"h2",children:"Details"})}),e.jsx(n,{item:!0,xs:12,children:e.jsx("div",{style:{height:400,width:"100%"},children:e.jsx(ae,{rows:x,columns:k,apiRef:y,disableRowSelectionOnClick:!0})})}),e.jsx(n,{item:!0,xs:12,textAlign:"right",sx:{mt:2},children:e.jsx(R,{variant:"contained",size:"small",onClick:z,children:"Generate IGP"})})]})]})},ce=()=>{F();const{user:s}=H();l.useState([]),l.useState(!1);const[o,h]=l.useState({issuanceId:"",appId:s.appId,createdOn:new Date().toISOString(),createdBy:s.empId,lastUpdatedOn:new Date().toISOString(),LastUpdatedBy:s.empId}),[u,v]=l.useState([]),[y,p]=l.useState(!1),{data:c,error:x,isLoading:i,refetch:d}=q(o.issuanceId,{skip:!y||!o.issuanceId});l.useEffect(()=>{c&&v(c.result.map((r,I)=>({id:I,...r})))},[c,d]),console.log("initialRows",u);const N=r=>{const{name:I,value:V}=r.target;h({...o,[I]:V})},m=()=>{o.issuanceId&&(p(!0),console.log(`Triggering search for issuanceId: ${o.issuanceId}`))};console.log("formData",o);const[k,D]=l.useState(!1),[z,t]=l.useState(!1),[a,S]=l.useState(!1),B=async r=>{S(r),D(!0)},T=async r=>{t(!0),S(r)},f=()=>{D(!1)},P=()=>{t(!1)},U=[{field:"id",headerName:"Sr#"},{field:"issuanceId",headerName:"issuance#"},{field:"ogpNumber",headerName:"OGP#"},{field:"vendorName",headerName:"Vendor"},{field:"issuanceQuantity",headerName:"Total"},{field:"issuanceDate",headerName:"Issuance Date",valueGetter:r=>new Date(r).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"expectedReturnDate",headerName:"Expected Return Date",valueGetter:r=>new Date(r).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"2-digit"})},{field:"fabricCount",headerName:"Fabrics"},{field:"statusName",headerName:"Status"},{field:"Actions",headerName:"Actions",renderCell:r=>e.jsx("div",{style:{display:"flex",justifyContent:"space-around"},children:e.jsxs(ie,{variant:"text",size:"small",sx:{mt:1},children:[e.jsx(R,{size:"small",color:"primary",onClick:()=>B(r.row),children:"View Details"}),e.jsx(R,{size:"small",color:"primary",onClick:()=>T(r.row),children:"IGP"})]})})}];return e.jsx(Q,{sx:{width:"100%",typography:"body1"},children:e.jsxs(_,{variant:"outlined",children:[e.jsx(K,{className:"css-4rfrnx-MuiCardHeader-root",title:"Receiving",titleTypographyProps:{style:{color:"white"}}}),e.jsxs(n,{container:!0,spacing:1,width:"Inherit",sx:{paddingY:2,paddingX:2},children:[e.jsx(n,{item:!0,xs:12,md:3,children:e.jsx(g,{label:"Enter Issuance ID",type:"number",fullWidth:!0,size:"small",name:"issuanceId",onChange:N,onKeyDown:r=>{r.key==="Enter"&&m()},value:o.issuanceId,required:!0})}),e.jsx(n,{item:!0,xs:12,md:3,sx:{mt:.5},children:e.jsx(R,{variant:"contained",size:"small",onClick:m,children:"Search"})}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(se,{initialRows:u,iColumns:U,hideAction:!0}),e.jsxs(A,{open:k,onClose:f,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(W,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px"},children:[e.jsx(G,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"View Details"}),e.jsx($,{onClick:f,sx:{color:"#ffffff"},children:e.jsx(E,{})})]}),e.jsxs(L,{children:[e.jsx(M,{id:"alert-dialog-slide-description"}),e.jsx(de,{iss:a,handleClose:f,refetchIssuanceData:d})]})]}),e.jsxs(A,{open:z,onClose:P,fullWidth:!0,maxWidth:"xl",children:[e.jsxs(W,{sx:{backgroundColor:"#A11F23",color:"#ffffff",display:"flex",justifyContent:"space-between",alignItems:"center",paddingX:"24px",paddingY:"4px",mb:2.5},children:[e.jsx(G,{variant:"h4",component:"div",color:"#ffffff",gutterBottom:!0,fontSize:20,fontWeight:2,fontStyle:"normal",children:"Create OGP"}),e.jsx($,{onClick:P,sx:{color:"#ffffff"},children:e.jsx(E,{})})]}),e.jsxs(L,{children:[e.jsx(M,{id:"alert-dialog-slide-description"}),e.jsx(ne,{rId:14,OGPNumber:a.ogpNumber})]})]})]})]})]})})},Ce=()=>{var p,c,x;const s=Z(),o=(p=s.state)==null?void 0:p.data,h=(x=(c=s.state)==null?void 0:c.tab)==null?void 0:x.toString();console.log("rowData",o),console.log("tab",h);const[u,v]=l.useState("1"),y=(i,d)=>{v(d),console.log("value",u)};return l.useEffect(()=>{h&&v(h)},[h]),e.jsx(J,{style:{borderWidth:1,borderStyle:"dotted",borderColor:"#a11f23",width:"auto",maxHeight:{xs:"80vh",md:"auto"},overflow:"auto"},children:e.jsx(Q,{sx:{width:"100%",typography:"body1"},children:e.jsxs(le,{value:u,children:[e.jsx(Q,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(oe,{onChange:y,children:[e.jsx(C,{icon:e.jsx(ee,{}),label:"Dyeing Receiving",value:"1",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(C,{icon:e.jsx(w,{}),label:"Embroidery Receiving",value:"2",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(C,{icon:e.jsx(w,{}),label:"Schiffili Receiving",value:"3",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(C,{icon:e.jsx(w,{}),label:"Additional Process Receiving",value:"4",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})}),e.jsx(C,{icon:e.jsx(w,{}),label:"Additional Services Receiving",value:"5",sx:i=>({"& .MuiTouchRipple-child":{backgroundColor:`${i.palette.primary.main} !important`}})})]})}),e.jsx(j,{value:"1",children:e.jsx(ce,{rowData:o})}),e.jsx(j,{value:"2"}),e.jsx(j,{value:"3"}),e.jsx(j,{value:"4"}),e.jsx(j,{value:"5"}),e.jsx(j,{value:"6"})]})})})};export{Ce as default};
